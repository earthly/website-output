<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<link rel="icon" type="image/png" href="/blog/assets/images/favicon.png">
<!-- begin _includes/seo.html -->





<title>Building in Visual Studio Code with a Makefile - Earthly Blog</title>
<meta name="description" content="Microsoft announced recently a new Visual Studio Code extension to handle Makefiles. This extension provides a set of commands to the editor that w...">


  <meta name="author" content="Nicolas Bohorquez">
  
  <meta property="article:author" content="Nicolas Bohorquez">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Earthly Blog">
<meta property="og:title" content="Building in Visual Studio Code with a Makefile">
<meta property="og:url" content="https://earthly.dev/blog/vscode-make/">


  <meta property="og:description" content="Microsoft announced recently a new Visual Studio Code extension to handle Makefiles. This extension provides a set of commands to the editor that w...">



  <meta property="og:image" content="/blog/generated/assets/images/vscode-make/header-800-3977ffdf0.jpg">



  <meta name="twitter:site" content="@EarthlyTech">
  <meta name="twitter:title" content="Building in Visual Studio Code with a Makefile">
  <meta name="twitter:description" content="Microsoft announced recently a new Visual Studio Code extension to handle Makefiles. This extension provides a set of commands to the editor that w...">
  <meta name="twitter:url" content="https://earthly.dev/blog/vscode-make/">

  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://earthly.dev/blog/generated/assets/images/vscode-make/header-800-3977ffdf0.jpg">
  

  



  <meta property="article:published_time" content="2021-07-28T00:00:00-04:00">





  

  


<link rel="canonical" href="https://earthly.dev/blog/vscode-make/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Organization",
      "url": "https://earthly.dev/blog/",
      "logo": "/assets/images/logo-header.png"
    
  }
</script>






<!-- end _includes/seo.html -->



  <link href="/blog/feed.xml" type="application/atom+xml" rel="alternate" title="Earthly Blog Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/blog/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-161831101-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-161831101-5');
</script>
  <!-- Facebook Pixel Code -->
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '259843109045285');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=259843109045285&ev=PageView&noscript=1"
    />
</noscript>
 <!-- End Facebook Pixel Code -->
  <!-- Twitter universal website tag code -->
<script>
  !function(e,t,n,s,u,a){e.twq||(s=e.twq=function(){s.exe?s.exe.apply(s,arguments):s.queue.push(arguments);
  },s.version='1.1',s.queue=[],u=t.createElement(n),u.async=!0,u.src='//static.ads-twitter.com/uwt.js',
  a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(u,a))}(window,document,'script');
  // Insert Twitter Pixel ID and Standard Event data below
  twq('init','o5s6p');
  twq('track','PageView');
  </script>
  <!-- End Twitter universal website tag code -->


  </head>

  <body class="layout--single">
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/blog/assets/images/white-logo.png" alt="Earthly"></a>
        
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/blog/">Blog home</a>
            </li><li class="masthead__menu-item">
              <a href="/blog/categories/articles/">Articles</a>
            </li><li class="masthead__menu-item">
              <a href="/blog/categories/news/">News</a>
            </li><li class="masthead__menu-item">
              <a href="/blog/categories/tutorials/">Tutorials</a>
            </li><li class="masthead__menu-item">
              <a href="https://github.com/earthly/earthly">GitHub</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      




  







<div class="page__hero"
  style=" background-image: url('');"
>
  
      <picture class="page__hero-image"><source srcset="/blog/generated/assets/images/vscode-make/header-400-7ecfe789c.webp 400w, /blog/generated/assets/images/vscode-make/header-600-7ecfe789c.webp 600w, /blog/generated/assets/images/vscode-make/header-800-7ecfe789c.webp 800w, /blog/generated/assets/images/vscode-make/header-1000-7ecfe789c.webp 1000w, /blog/generated/assets/images/vscode-make/header-1200-7ecfe789c.webp 1200w" type="image/webp"><source srcset="/blog/generated/assets/images/vscode-make/header-400-7ecfe789c.png 400w, /blog/generated/assets/images/vscode-make/header-600-7ecfe789c.png 600w, /blog/generated/assets/images/vscode-make/header-800-7ecfe789c.png 800w, /blog/generated/assets/images/vscode-make/header-1000-7ecfe789c.png 1000w, /blog/generated/assets/images/vscode-make/header-1200-7ecfe789c.png 1200w" type="image/png"><img src="/blog/generated/assets/images/vscode-make/header-800-7ecfe789c.jpg" alt="Building in Visual Studio Code with a Makefile"></picture>

  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar">
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Building in Visual Studio Code with a Makefile">
    <meta itemprop="description" content="Microsoft announced recently a new Visual Studio Code extension to handle Makefiles. This extension provides a set of commands to the editor that will facilitate working with projects that rely on a Makefile to speed up the build.In this tutorial, you’ll set up a simple C++ project that depends on a well-known Python library to produce some sample charts. This is not a deep tutorial about make and Makefiles, but to get the most out of the extension you will need to have some concepts clear.Make is one of the most used tools to build software projects, for good reason:You can get an implementation for almost any major operating system (POSIX/Windows/MacOS)It’s technology agnostic. You can use it to build projects on any programming language (here’s an example for JavaScript.Its task runner capabilities provide a multipurpose tool for almost any task.A Makefile is a simple text file that defines rules to be executed. The usual purpose for Makefile in C++ projects is to recompile and link necessary files based on the modifications done to dependencies. However, Makefile and make are far more useful than that. The rules defined in a Makefile combine concepts like:Shell scriptingRegular expressionsTarget notationProject structureTo illustrate this power, the sample project contains a single C++ source code file. The source code for the example is pretty simple —- it flips a coin as many times as the iters argument is passed, and then prints the number of heads and tails counted from each flip.#include &lt;cstdio&gt;#include &lt;cstdlib&gt;#include &lt;stdlib.h&gt;#include &lt;assert.h&gt;#include &lt;time.h&gt;  int flip_coins(int iters) {  srand (time(NULL));  int heads, tails = 0;  for(int i=0;i &lt; iters;i++){   (rand() % 10 + 1) &lt;= 5 ? heads++ : tails++;  }  printf(&quot;%d Heads, %d Tails\n&quot;,heads, tails);  return abs(tails-heads);}int main(int argc,char* argv[]) { assert (argc == 2); int iters = atoi(argv[1]); int diff = flip_coins(iters); if(100 &lt; iters) {      printf(&quot;With enough trials Heads should be equal to Tails\n&quot;); }}This code will be compiled and linked with a simple Makefile that also will provide a couple of other standard rules for cleaning the compiled code and run a simple test.Creating C++ Projects with VS CodeThe VS Code extension Makefile Tools is still in preview but is actively developed. The installation process is similar to any other extension in VS Code:Makefile VSCode extensionAfter installing the extension, verify the availability of the make command in the system.The most common implementation is GNU Make, which includes some non-standard extensions. If your installation of make is not available in the default path, you can configure it in VS Code at File &gt; Preferences &gt; Settings &gt; Extensions makefile.Make pathTo compile and link the project, you can add a Makefile to the root of the project folder. It will be detected automatically by the extension. If you have a different structure, with a Makefile in another location, you can configure it at File &gt; Preferences &gt; Settings &gt; Extensions &gt; makefile.Makefile pathThis sample Makefile defines five simple rules:all: Cleans the compiled files from the target folder, then compiles and run the test code.default: Delegates to CoinFlipper.cpp.CoinFlipper.cpp: Compiles the single source file.test: Delegates to CoinFlipper.cpp, then runs the output main function passing an argument.clean: Deletes compiled files.## A simple makefile for compiling a c++ project#SRC=./srcTARGET=./targetGCC = g++CFLAGS = -o $(TARGET)/CoinFlipper.outARGS = 101RM = rm -rfall: clean default testdefault: CoinFlipper.cppCoinFlipper.cpp:    $(GCC) $(CFLAGS) $(SRC)/main/CoinFlipper.cpptest: CoinFlipper.cpp    $(TARGET)/CoinFlipper.out $(ARGS)clean:    $(RM) $(TARGET)/*.outThe Makefile Tools Extension provides a new “perspective” to the Visual Studio Code IDE. This contains three different commands and three different project configurations to run the Makefile:Makefile tools perspectiveThe Configuration:[Default] refers to the make command configurations defined in the .vscode/settings.json file. This configuration is used to pass arguments to the make utility.In the following example, two configurations are defined:DefaultPrint make versionPrint make versions adds the –version argument to the make utility every time the project is built using the Makefile extension. This argument is not especially useful but you can explore different arguments to fit your case.{ &quot;makefile.configurations&quot;: [     {         &quot;name&quot;: &quot;Default&quot;,         &quot;makeArgs&quot;: []     },     {         &quot;name&quot;: &quot;Print make version&quot;,         &quot;makeArgs&quot;: [&quot;--version&quot;]     } ]}The second configuration is the default build target rule for the make utility, which is equivalent to running make [target] directly. The IDE will let show you a list of target rules defined in the Makefile configured for the project:config build targetFinally, the third configuration available in the perspective is the Launch target. This shows you a list of compiled files that can be run from the perspective using the commands Debug and Run. This is useful if you want to debug your source code with GDB or LLDB debuggers.In this example, the only file runnable is CoinFlipper.out, compiled from the source code.make launch targetThe commands in the Makefile are self-explanatory:Build runs make with the target configured previously.all instead of default passes no arguments to the make utility.Debug and Run in terminal commands launch the target (CoinFlipper.out in the example) with/without the debug support.Once you build the project, the terminal view shows the result of the execution:Building target &quot;all&quot; with command: &quot;make all&quot;rm -rf ./target/*.outg++ -o ./target/CoinFlipper.out ./src/main/CoinFlipper.cpp./target/CoinFlipper.out 10150 Heads, 51 TailsWith enough trials Heads should be equal to TailsTarget all built successfully.As you can see from the previous image, the target was built successfully after cleaning, compiling, and running the compiled program. The extension also provides commands to run other targets easily without changing the configurations in the perspective.The following image shows the commands available for the Makefile in the sample project:The makefile commands palette.Building Complex ProjectsMakefiles are more complex than this. Many projects have several levels of dependencies, configurations, and quirks that make supports easily. For example, the FFmpeg project is a collection of libraries to work with audio, video, and subtitles among other utilities. To build it, you can download the source from GitHub and examine the Makefile:The makefile for FFmpeg.The developer documentation for the project states that before building the source code with the provided Makefile, you need to run the configure script located at the root of the project’s source code. Fortunately, the Makefile Tools Extension provides a setting to define the preconfiguration files required to run before executing the make commands, again in File &gt; Preferences &gt; Settings.The makefile preconfiguration.In the Commands section of the Makefile Tools Extension perspective, you can run the preconfigure command. This will run the configure script, and then you’re ready to experiment with the Makefile through the extension.ConclusionLarge codebase projects need a build system to keep them under the development team’s control, and Makefiles are one the most ubiquitous and flexible ways to define building these complex software projects.With the new Makefile Tools Extension, Visual Studio Code greatly simplifies access for new developers. Though it is still tagged as in preview, this extension has been thoroughly tested by the Microsoft Team, building over seventy open-source projects written in different languages (including C, C++, and Python) successfully.If you want to learn about the power of make and Makefile, consider checking out the Makefile Tutorial, and if you want the simplicity of a Makefile with the isolation of containers take a look at Earthly.">
    <meta itemprop="datePublished" content="2021-07-28T00:00:00-04:00">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Building in Visual Studio Code with a Makefile
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
        
        &nbsp;	&nbsp;<i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-07-28T00:00:00-04:00">July 28, 2021</time>
        

      </span>
    
    <span>
      
      
      
      <div class="author__avatar_top">
          <picture class="image-author"><source srcset="/blog/generated/assets/images/authors/nicolasbohorquez-200-81880470a.webp 200w" type="image/webp"><source srcset="/blog/generated/assets/images/authors/nicolasbohorquez-200-052f34577.jpg 200w" type="image/jpeg"><img src="/blog/generated/assets/images/authors/nicolasbohorquez-200-052f34577.jpg" alt="Nicolas Bohorquez %"></picture>

          &nbsp;	&nbsp;
          Nicolas Bohorquez
      </div>
      
    </span>
  </p>


        </header>
      
        
        <p>Microsoft announced <a href="https://devblogs.microsoft.com/cppblog/now-announcing-makefile-support-in-visual-studio-code/">recently</a> a new Visual Studio Code extension to handle Makefiles. This extension provides a set of commands to the editor that will facilitate working with projects that rely on a Makefile to speed up the build.</p>
<p>In this tutorial, you’ll set up a simple C++ project that depends on a well-known Python library to produce some sample charts. This is not a deep tutorial about <a href="/blog/g++-makefile/">make and Makefiles</a>, but to get the most out of the extension you will need to have some concepts clear.</p>
<p><em>Make</em> is one of the most used tools to build software projects, for good reason:</p>
<ul>
<li>You can get an implementation for almost any major operating system (POSIX/Windows/MacOS)</li>
<li>It’s technology agnostic. You can use it to build projects on any programming language (here’s an example for <a href="https://medium.com/lithictech/makefile-javascript-26731fb26867">JavaScript</a>.</li>
<li>Its task runner capabilities provide a multipurpose tool for almost any task.</li>
</ul>
<p>A <em>Makefile</em> is a simple text file that defines rules to be executed. The usual purpose for Makefile in C++ projects is to recompile and link necessary files based on the modifications done to dependencies. However, Makefile and make are far more useful than that. The rules defined in a Makefile combine concepts like:</p>
<ul>
<li>Shell scripting</li>
<li>Regular expressions</li>
<li>Target notation</li>
<li>Project structure</li>
</ul>
<p>To illustrate this power, the <a href="https://github.com/nickmancol/vscode_makefile">sample project</a> contains a single C++ source code file. The source code for the example is pretty simple —- it flips a coin as many times as the <code>iters</code> argument is passed, and then prints the number of heads and tails counted from each flip.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdlib&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;assert.h&gt;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;time.h&gt;</span><span class="pp">  </span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> flip_coins<span class="op">(</span><span class="dt">int</span> iters<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  srand <span class="op">(</span>time<span class="op">(</span>NULL<span class="op">));</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> heads<span class="op">,</span> tails <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i <span class="op">&lt;</span> iters<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>   <span class="op">(</span>rand<span class="op">()</span> <span class="op">%</span> <span class="dv">10</span> <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="dv">5</span> <span class="op">?</span> heads<span class="op">++</span> <span class="op">:</span> tails<span class="op">++;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st"> Heads, </span><span class="sc">%d</span><span class="st"> Tails</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span>heads<span class="op">,</span> tails<span class="op">);</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> abs<span class="op">(</span>tails<span class="op">-</span>heads<span class="op">);</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span><span class="dt">char</span><span class="op">*</span> argv<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a> <span class="ot">assert</span> <span class="op">(</span>argc <span class="op">==</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a> <span class="dt">int</span> iters <span class="op">=</span> atoi<span class="op">(</span>argv<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a> <span class="dt">int</span> diff <span class="op">=</span> flip_coins<span class="op">(</span>iters<span class="op">);</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span><span class="op">(</span><span class="dv">100</span> <span class="op">&lt;</span> iters<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>      printf<span class="op">(</span><span class="st">&quot;With enough trials Heads should be equal to Tails</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a> <span class="op">}</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>This code will be compiled and linked with a simple Makefile that also will provide a couple of other standard rules for cleaning the compiled code and run a simple test.</p>
<h2 id="creating-c-projects-with-vs-code">Creating C++ Projects with VS Code</h2>
<p>The <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.makefile-tools">VS Code extension <strong>Makefile Tools</strong></a> is still in preview but is actively developed. The installation process is similar to any other extension in VS Code:</p>
<figure>
<img src="/blog/assets/images/vscode-make/9360.png" alt="Makefile VSCode extension" /><figcaption aria-hidden="true">Makefile VSCode extension</figcaption>
</figure>
<p>After installing the extension, verify the availability of the <code>make</code> command in the system.</p>
<p>The most common implementation is <a href="https://www.gnu.org/software/make/">GNU Make</a>, which includes some non-standard extensions. If your installation of <code>make</code> is not available in the default path, you can configure it in VS Code at <strong>File &gt; Preferences &gt; Settings &gt; Extensions makefile</strong>.</p>
<figure>
<img src="/blog/assets/images/vscode-make/9380.png" alt="Make path" /><figcaption aria-hidden="true">Make path</figcaption>
</figure>
<p>To compile and link the project, you can add a Makefile to the root of the project folder. It will be detected automatically by the extension. If you have a different structure, with a Makefile in another location, you can configure it at <strong>File &gt; Preferences &gt; Settings &gt; Extensions &gt; makefile</strong>.</p>
<figure>
<img src="/blog/assets/images/vscode-make/9450.png" alt="Makefile path" /><figcaption aria-hidden="true">Makefile path</figcaption>
</figure>
<p>This sample Makefile defines five simple rules:</p>
<ul>
<li><code>all</code>: Cleans the compiled files from the target folder, then compiles and run the test code.</li>
<li><code>default</code>: Delegates to <code>CoinFlipper.cpp</code>.</li>
<li><code>CoinFlipper.cpp</code>: Compiles the single source file.</li>
<li><code>test</code>: Delegates to <code>CoinFlipper.cpp</code>, then runs the output main function passing an argument.</li>
<li><code>clean</code>: Deletes compiled files.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode makefile"><code class="sourceCode makefile"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A simple makefile for compiling a c++ project</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="dt">SRC</span><span class="ch">=</span><span class="st">./src</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="dt">TARGET</span><span class="ch">=</span><span class="st">./target</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="dt">GCC </span><span class="ch">=</span><span class="st"> g++</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="dt">CFLAGS </span><span class="ch">=</span><span class="st"> -o </span><span class="ch">$(</span><span class="dt">TARGET</span><span class="ch">)</span><span class="st">/CoinFlipper.out</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="dt">ARGS </span><span class="ch">=</span><span class="st"> 101</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="dt">RM </span><span class="ch">=</span><span class="st"> rm -rf</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="dv">all:</span><span class="dt"> clean default test</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="dv">default:</span><span class="dt"> CoinFlipper.cpp</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="dv">CoinFlipper.cpp:</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="ch">$(</span><span class="dt">GCC</span><span class="ch">)</span> <span class="ch">$(</span><span class="dt">CFLAGS</span><span class="ch">)</span> <span class="ch">$(</span><span class="dt">SRC</span><span class="ch">)</span>/main/CoinFlipper.cpp</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="dv">test:</span><span class="dt"> CoinFlipper.cpp</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="ch">$(</span><span class="dt">TARGET</span><span class="ch">)</span>/CoinFlipper.out <span class="ch">$(</span><span class="dt">ARGS</span><span class="ch">)</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="dv">clean:</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="ch">$(</span><span class="dt">RM</span><span class="ch">)</span> <span class="ch">$(</span><span class="dt">TARGET</span><span class="ch">)</span>/*.out</span></code></pre></div>
<p>The Makefile Tools Extension provides a new “perspective” to the Visual Studio Code IDE. This contains three different commands and three different project configurations to run the Makefile:</p>
<figure>
<img src="/blog/assets/images/vscode-make/9480.png" alt="Makefile tools perspective" /><figcaption aria-hidden="true">Makefile tools perspective</figcaption>
</figure>
<p>The <code>Configuration:[Default]</code> refers to the make command configurations defined in the <code>.vscode/settings.json</code> file. This configuration is used to pass arguments to the make utility.</p>
<p>In the following example, two configurations are defined:</p>
<ul>
<li><code>Default</code></li>
<li><code>Print make version</code></li>
</ul>
<p><code>Print make versions</code> adds the <code>--version</code> argument to the make utility every time the project is built using the Makefile extension. This argument is not especially useful but you can explore different arguments to fit your case.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a> <span class="dt">&quot;makefile.configurations&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">{</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>         <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Default&quot;</span><span class="fu">,</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>         <span class="dt">&quot;makeArgs&quot;</span><span class="fu">:</span> <span class="ot">[]</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">{</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>         <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Print make version&quot;</span><span class="fu">,</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>         <span class="dt">&quot;makeArgs&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;--version&quot;</span><span class="ot">]</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">}</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a> <span class="ot">]</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>The second configuration is the default build target rule for the make utility, which is equivalent to running <code>make [target]</code> directly. The IDE will let show you a list of target rules defined in the Makefile configured for the project:</p>
<figure>
<img src="/blog/assets/images/vscode-make/9540.png" alt="config build target" /><figcaption aria-hidden="true">config build target</figcaption>
</figure>
<p>Finally, the third configuration available in the perspective is the <code>Launch target</code>. This shows you a list of compiled files that can be run from the perspective using the commands <code>Debug</code> and <code>Run</code>. This is useful if you want to debug your source code with GDB or LLDB debuggers.</p>
<p>In this example, the only file runnable is <code>CoinFlipper.out</code>, compiled from the source code.</p>
<figure>
<img src="/blog/assets/images/vscode-make/9560.png" alt="make launch target" /><figcaption aria-hidden="true">make launch target</figcaption>
</figure>
<p>The commands in the Makefile are self-explanatory:</p>
<ul>
<li><code>Build</code> runs make with the target configured previously.</li>
<li><code>all</code> instead of <code>default</code> passes no arguments to the make utility.</li>
<li><code>Debug</code> and <code>Run in terminal</code> commands launch the target (<code>CoinFlipper.out</code> in the example) with/without the debug support.</li>
</ul>
<p>Once you build the project, the terminal view shows the result of the execution:</p>
<pre><code>Building target &quot;all&quot; with command: &quot;make all&quot;
rm -rf ./target/*.out
g++ -o ./target/CoinFlipper.out ./src/main/CoinFlipper.cpp
./target/CoinFlipper.out 101
50 Heads, 51 Tails
With enough trials Heads should be equal to Tails
Target all built successfully.</code></pre>
<p>As you can see from the previous image, the target was built successfully after cleaning, compiling, and running the compiled program. The extension also provides commands to run other targets easily without changing the configurations in the perspective.</p>
<p>The following image shows the commands available for the Makefile in the sample project:</p>
<figure>
<img src="/blog/assets/images/vscode-make/9630.png" alt="The makefile commands palette." /><figcaption aria-hidden="true">The makefile commands palette.</figcaption>
</figure>
<h2 id="building-complex-projects">Building Complex Projects</h2>
<p>Makefiles are more complex than this. Many projects have several levels of dependencies, configurations, and quirks that make supports easily. For example, the <a href="https://github.com/FFmpeg/FFmpeg">FFmpeg</a> project is a collection of libraries to work with audio, video, and subtitles among other utilities. To build it, you can download the source from GitHub and examine the Makefile:</p>
<figure>
<img src="/blog/assets/images/vscode-make/9680.png" alt="The makefile for FFmpeg." /><figcaption aria-hidden="true">The makefile for FFmpeg.</figcaption>
</figure>
<p>The <a href="https://trac.ffmpeg.org/wiki/CompilationGuide/Generic">developer documentation</a> for the project states that before building the source code with the provided Makefile, you need to run the <a href="/blog/autoconf/"><code>configure</code></a> script located at the root of the project’s source code. Fortunately, the Makefile Tools Extension provides a setting to define the preconfiguration files required to run before executing the make commands, again in <strong>File &gt; Preferences &gt; Settings</strong>.</p>
<figure>
<img src="/blog/assets/images/vscode-make/9730.png" alt="The makefile preconfiguration." /><figcaption aria-hidden="true">The makefile preconfiguration.</figcaption>
</figure>
<p>In the <strong>Commands</strong> section of the Makefile Tools Extension perspective, you can run the preconfigure command. This will run the configure script, and then you’re ready to experiment with the Makefile through the extension.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Large codebase projects need a build system to keep them under the development team’s control, and Makefiles are one the most ubiquitous and flexible ways to define building these complex software projects.</p>
<p>With the new <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.makefile-tools">Makefile Tools Extension</a>, Visual Studio Code greatly simplifies access for new developers. Though it is still tagged as in preview, this extension has been thoroughly tested by the Microsoft Team, building over seventy open-source projects written in different languages (including C, C++, and Python) successfully.</p>
<p>If you want to learn about the power of make and Makefile, consider checking out the <a href="https://makefiletutorial.com/#include-makefiles">Makefile Tutorial</a>, and if you want the simplicity of a Makefile with the isolation of containers take a look at <a href="https://earthly.dev/">Earthly</a>.</p>

        
      </section>

      


<div itemscope itemtype="https://schema.org/Person">
  
    <div class="author__avatar">
      
        <picture class="image-author"><source srcset="/blog/generated/assets/images/authors/nicolasbohorquez-200-81880470a.webp 200w" type="image/webp"><source srcset="/blog/generated/assets/images/authors/nicolasbohorquez-200-052f34577.jpg 200w" type="image/jpeg"><img src="/blog/generated/assets/images/authors/nicolasbohorquez-200-052f34577.jpg" alt="Nicolas Bohorquez %"></picture>

      
    </div>
  
  <div class="author__content">
    
      <div class="author__name heading" itemprop="name">
        Nicolas Bohorquez
    
    
      </div>
    
      <div class="author__bio" itemprop="description">
        <p>Nicolas Bohorquez is a data architect at Merqueo, has been part of development teams in a handful of startups, and has founded three companies in the Americas. He is passionate about the modeling of complexity and the use of data science to improve the world.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <!-- <button class="btn btn--inverse">Follow</button> -->
    <ul class="author__urls social-icons">
      

     

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

      <footer class="page__meta">
        
        



  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/blog/categories/tutorials" class="page__taxonomy-item" rel="tag">Tutorials</a>
    
    </span>
  </p>






        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-07-28T00:00:00-04:00">July 28, 2021</time></p>


      </footer>

      

      
  <nav class="pagination">
    
      <a href="/blog/continuous-testing-in-devops/" class="pagination--pager" title="Using Continuous Testing in DevOps Workflows
">Previous</a>
    
    
      <a href="/blog/idiots-and-maniacs/" class="pagination--pager" title="Idiots And Maniacs
">Next</a>
    
  </nav>

    </div>
  </article>

  
  
    <div class="page__related">
      <div class="page__related-title heading">You may also enjoy</div>
      <div class="grid__wrapper">
        
          










<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <picture><source srcset="/blog/generated/assets/images/convert-to-from-json/header-600-e0b643a02.webp 600w, /blog/generated/assets/images/convert-to-from-json/header-800-e0b643a02.webp 800w" type="image/webp"><source srcset="/blog/generated/assets/images/convert-to-from-json/header-600-27cd7a486.jpg 600w, /blog/generated/assets/images/convert-to-from-json/header-800-27cd7a486.jpg 800w" type="image/jpeg"><img src="/blog/generated/assets/images/convert-to-from-json/header-800-27cd7a486.jpg"></picture>

      </div>
    
    
    <div class="archive__item-title no_toc heading" itemprop="headline">
    
      
      
        <a href="/blog/convert-to-from-json/" rel="permalink">How to Convert from JSON to CSV at The Command Line
</a>
      
    
    </div>
    
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
How do you convert JSON values to CSV and back at the command line? I’ve done this task on many occasions and been stung by the edge cases frequently enough...</p>
  </article>
</div>

        
          










<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <picture><source srcset="/blog/generated/assets/images/idiots-and-maniacs/header-600-161d4ea73.webp 600w, /blog/generated/assets/images/idiots-and-maniacs/header-800-161d4ea73.webp 800w" type="image/webp"><source srcset="/blog/generated/assets/images/idiots-and-maniacs/header-600-00dc94dde.jpg 600w, /blog/generated/assets/images/idiots-and-maniacs/header-800-00dc94dde.jpg 800w" type="image/jpeg"><img src="/blog/generated/assets/images/idiots-and-maniacs/header-800-00dc94dde.jpg"></picture>

      </div>
    
    
    <div class="archive__item-title no_toc heading" itemprop="headline">
    
      
      
        <a href="/blog/idiots-and-maniacs/" rel="permalink">Idiots And Maniacs
</a>
      
    
    </div>
    
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
Observability


If you do software-as-a-service development and you have paying customers, you at some point learn about the need for operational monitoring...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/earthlytech" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/earthly/earthly" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
    

    
      <li><a href="/blog/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 <a href="https://earthly.dev/">Earthly</a>. </div>

      </footer>
    </div>

    <script src="/blog/assets/js/vendor/jquery/jquery-3.5.1.js"></script>
<script src="/blog/assets/js/plugins/jquery.fitvids.js"></script>
<script src="/blog/assets/js/plugins/smooth-scroll.js"></script>
<script src="/blog/assets/js/plugins/gumshoe.js"></script>
<script src="/blog/assets/js/plugins/jquery.magnific-popup.js"></script>
<script src="/blog/assets/js/main.min.js"></script>
<script src="/blog/assets/js/externallinks.js"></script>

  <script> // minified version of https://earthly.dev/assets/js/analytics.js
    function setCookie(e,t,r){var i="";if(r){var o=new Date;o.setTime(o.getTime()+24*r*60*60*1e3),i="; expires="+o.toUTCString()}document.cookie=e+"="+(t||"")+i+"; path=/"}function getCookie(e){for(var t=e+"=",r=document.cookie.split(";"),i=0;i<r.length;i++){for(var o=r[i];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null}function uuidv4(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))}function getAnalyticCookie(){cookieName="earthlyID";var e=getCookie(cookieName);return null==e&&(e=uuidv4()),setCookie(cookieName,e,36500),e}jQuery.ajax({type:"POST",url:"https://api.earthly.dev/analytics",data:JSON.stringify({key:"website",url:window.location.href,referrer:document.referrer,earthlyID:getAnalyticCookie()})});
</script>




  </body>
</html>

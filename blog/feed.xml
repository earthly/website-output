<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.1.1">Jekyll</generator><link href="https://earthly.dev/blog/feed.xml" rel="self" type="application/atom+xml" /><link href="https://earthly.dev/blog/" rel="alternate" type="text/html" /><updated>2021-07-08T13:00:13-04:00</updated><id>https://earthly.dev/blog/feed.xml</id><title type="html">Earthly Blog</title><subtitle>Build automation for the container era.</subtitle><entry><title type="html">Example Post</title><link href="https://earthly.dev/blog/example/" rel="alternate" type="text/html" title="Example Post" /><published>2029-01-01T00:00:00-05:00</published><updated>2029-01-01T00:00:00-05:00</updated><id>https://earthly.dev/blog/example</id><content type="html" xml:base="https://earthly.dev/blog/example/">&lt;!-- vale off --&gt;
&lt;p&gt;This post is in the future, and won’t show up in the published site&lt;/p&gt;
&lt;h2 id=&quot;image-without-figure&quot;&gt;Image without figure&lt;/h2&gt;
&lt;p&gt;An image with the alt text hidden.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/blog/assets/images/example/alex-draw.png&quot; alt=&quot;some alt text&quot; /&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;p&gt;An image with alt text printed below.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/example/alex-draw.png&quot; alt=&quot;some alt text&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;some alt text&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;image-with-explicit-figure&quot;&gt;Image with explicit figure&lt;/h2&gt;
&lt;figure class&gt;
&lt;img src=&quot;/blog/assets/images/example/alex-draw.png&quot;
       alt=&quot;handddrawn cartoon for a person talking to a computer server&quot;&gt;
&lt;figcaption&gt;
&lt;p&gt;Alex likes to draw and add a caption&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;image-with-implicit-figure&quot;&gt;Image with implicit figure&lt;/h2&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/example/alex-draw.png&quot; alt=&quot;This is my alt text and my figure. The alt text is used as the default figure if not specified.&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;This is my alt text and my figure. The alt text is used as the default figure if not specified.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;image-wide&quot;&gt;Image Wide&lt;/h2&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/example/alex-draw.png&quot; alt=&quot;This should be wide&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;This should be wide&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/div&gt;
&lt;h3 id=&quot;graph-using-matplotlib&quot;&gt;graph using matplotlib&lt;/h3&gt;
&lt;figure&gt;
&lt;img src=&quot;_site/assets/images/15298945686075526262.svg&quot; /&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;code-blocks-with-syntax-highlighting&quot;&gt;Code blocks (with syntax highlighting)&lt;/h3&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode go&quot;&gt;&lt;code class=&quot;sourceCode go&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    syntax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;proto3&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;package&lt;/span&gt; simplekeyvalue&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    option go_package &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;kvapi&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;co&quot;&gt;// The key/value API contains two procedures for storing and retrieving data&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-6&quot;&gt;&lt;a href=&quot;#cb1-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    service KeyValue &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-7&quot;&gt;&lt;a href=&quot;#cb1-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      rpc Set &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;SetRequest&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; returns &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;SetReply&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-8&quot;&gt;&lt;a href=&quot;#cb1-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      rpc Get &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;GetRequest&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; returns &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;GetReply&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-9&quot;&gt;&lt;a href=&quot;#cb1-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;raw-code-blocks&quot;&gt;Raw code blocks&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;
{{ raw template code}}
&lt;/code&gt;&lt;/pre&gt;
&lt;figcaption&gt;
Use &lt;code&gt;raw&lt;/code&gt; and &lt;code&gt;endraw&lt;/code&gt; for code that overlaps with the liquid templates
&lt;/figcaption&gt;
&lt;h2 id=&quot;fensed-code-blocks&quot;&gt;Fensed code blocks&lt;/h2&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode scala&quot;&gt;&lt;code class=&quot;sourceCode scala&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;object&lt;/span&gt; Main &lt;span class=&quot;kw&quot;&gt;extends&lt;/span&gt; App &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;Hello, World!&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;code-with-captions&quot;&gt;Code with Captions&lt;/h3&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode scala&quot;&gt;&lt;code class=&quot;sourceCode scala&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;object&lt;/span&gt; Main &lt;span class=&quot;kw&quot;&gt;extends&lt;/span&gt; App &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;Hello, World!&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figcaption&gt;
Main.scala
&lt;/figcaption&gt;
&lt;div class=&quot;notice&quot;&gt;
&lt;p&gt;&lt;strong&gt;Notice&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Markdown here&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;one&lt;/li&gt;
&lt;li&gt;two&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;ℹ️ Notice Info&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Markdown here&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;one&lt;/li&gt;
&lt;li&gt;two&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;notice--warning&quot;&gt;
&lt;p&gt;&lt;strong&gt;Warning&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Markdown here&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;one&lt;/li&gt;
&lt;li&gt;two&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;notice--success&quot;&gt;
&lt;p&gt;&lt;strong&gt;Success&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Markdown here&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;more-example-image-layouts&quot;&gt;More example Image layouts&lt;/h3&gt;
&lt;!-- vale HouseStyle.Spelling = NO --&gt;
&lt;p&gt;&lt;img src=&quot;/blog/assets/images/authors/coreylarson.jpg&quot; class=&quot;align-center&quot; alt=&quot;align center&quot; /&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/blog/assets/images/authors/coreylarson.jpg&quot; class=&quot;align-right&quot; alt=&quot;alighn right&quot; /&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/blog/assets/images/authors/coreylarson.jpg&quot; class=&quot;align-left&quot; alt=&quot;align left&quot; /&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa.&lt;/p&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. &lt;img src=&quot;/blog/assets/images/example/alex-draw.png&quot; class=&quot;align-right&quot; width=&quot;300&quot; alt=&quot;pic with only 100px width&quot; /&gt;&lt;br /&gt;
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. &lt;!-- vale HouseStyle.Spelling = YES --&gt; ### More Example Usage&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://mmistakes.github.io/minimal-mistakes/docs/quick-start-guide/&quot;&gt;Theme Guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Sample &lt;a href=&quot;https://mmistakes.github.io/minimal-mistakes/year-archive/&quot;&gt;Rendered Posts&lt;/a&gt; and &lt;a href=&quot;https://github.com/mmistakes/minimal-mistakes/tree/d6444412c63aea5e47241ef536509fb1bfef4830/docs/_posts&quot;&gt;Raw mardown&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Markdown stuff (pandoc): &lt;a href=&quot;https://laurentrdc.github.io/pandoc-plot/&quot;&gt;Graphs&lt;/a&gt; and &lt;a href=&quot;https://pandoc.org/MANUAL.html#pandocs-markdown&quot;&gt;markdown&lt;/a&gt; &lt;!-- vale on --&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Adam Gordon Bell</name></author><category term="News" /><summary type="html">This post is in the future, and won’t show up in the published site Image without figure An image with the alt text hidden. An image with alt text printed below. some alt text Image with explicit figure Alex likes to draw and add a caption Image with implicit figure This is my alt text and my figure. The alt text is used as the default figure if not specified. Image Wide This should be wide graph using matplotlib Code blocks (with syntax highlighting) syntax = &amp;quot;proto3&amp;quot;; package simplekeyvalue; option go_package = &amp;quot;kvapi&amp;quot;; // The key/value API contains two procedures for storing and retrieving data service KeyValue { rpc Set (SetRequest) returns (SetReply) {} rpc Get (GetRequest) returns (GetReply) {} } Raw code blocks {{ raw template code}} Use raw and endraw for code that overlaps with the liquid templates Fensed code blocks object Main extends App { println(&amp;quot;Hello, World!&amp;quot;) } Code with Captions object Main extends App { println(&amp;quot;Hello, World!&amp;quot;) } Main.scala Notice Markdown here one two ℹ️ Notice Info Markdown here one two Warning Markdown here one two Success Markdown here More example Image layouts Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. ### More Example Usage Theme Guide Sample Rendered Posts and Raw mardown Markdown stuff (pandoc): Graphs and markdown</summary></entry><entry><title type="html">Creating a Golang Makefile</title><link href="https://earthly.dev/blog/golang-makefile/" rel="alternate" type="text/html" title="Creating a Golang Makefile" /><published>2021-07-15T00:00:00-04:00</published><updated>2021-07-15T00:00:00-04:00</updated><id>https://earthly.dev/blog/golang-makefile</id><content type="html" xml:base="https://earthly.dev/blog/golang-makefile/">&lt;div class=&quot;narrow-code&quot;&gt;
&lt;p&gt;Building and testing any large codebase is time-consuming, error-prone, and repetitive. Golang supports multi-platform builds, which is excellent, but it needs multiple commands to build the binaries for different platforms, which means more time-consuming and repetitive steps when building binaries. If that’s not enough, most projects have some dependencies that need to be installed before building the binary, and you probably want to run tests and ensure the code quality with linters and code coverage tools.&lt;/p&gt;
&lt;p&gt;If this is starting to sound like a nightmare, rest assured: there is an easier way. The utility tool &lt;a href=&quot;https://en.wikipedia.org/wiki/Make_(software)&quot;&gt;Make&lt;/a&gt; is used to automate tasks. It streamlines development and automates repetitive tasks with a single command. Make helps with testing, building, cleaning, and installing Go projects. In this tutorial, you will learn how you can leverage make and makefiles to automate all those frustrating and repetitive Golang tasks. You will learn how to build, clean, and test a Go sample project using make and a &lt;code&gt;Makefile&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&quot;adding-a-makefile-to-your-project&quot;&gt;Adding a Makefile To Your Project&lt;/h2&gt;
&lt;p&gt;To start using make commands, you first need to create a &lt;code&gt;Makefile&lt;/code&gt; in the root directory of your project. Let’s create a simple &lt;code&gt;hello world&lt;/code&gt; project with a &lt;code&gt;Makefile&lt;/code&gt; in it.&lt;/p&gt;
&lt;h3 id=&quot;main.go&quot;&gt;&lt;code&gt;main.go&lt;/code&gt;&lt;/h3&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode go&quot;&gt;&lt;code class=&quot;sourceCode go&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;package&lt;/span&gt; main&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;fmt&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;func&lt;/span&gt; main&lt;span class=&quot;op&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-6&quot;&gt;&lt;a href=&quot;#cb1-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; fmt&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;Println&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;hello world&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-7&quot;&gt;&lt;a href=&quot;#cb1-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To run this project, you would normally need to build the project and run the binary:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;go&lt;/span&gt; build main.go&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you want a different binary name and also want to create a build for a specific OS, you can specify this during the build:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;va&quot;&gt;GOARCH&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;amd64 &lt;span class=&quot;va&quot;&gt;GOOS&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;darwin &lt;span class=&quot;ex&quot;&gt;go&lt;/span&gt; build &lt;span class=&quot;at&quot;&gt;-o&lt;/span&gt; hello-world main.go&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You may want the build to create binary for multiple OS. For that, you will need to run multiple commands:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GOARCH=amd64 GOOS=darwin go build -o hello-world-darwin main.go
GOARCH=amd64 GOOS=linux go build -o hello-world-linux main.go
GOARCH=amd64 GOOS=window go build -o hello-world-windows main.go&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;go run hello-world&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The above commands can be simplified using Makefile. You can specify rules to a specific command and run a simple make command. You would not need to remember the commands and the flags or environment variables needed for executing it.&lt;/p&gt;
&lt;h3 id=&quot;makefile&quot;&gt;Makefile&lt;/h3&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;hello-world&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-2&quot;&gt;&lt;a href=&quot;#cb6-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-3&quot;&gt;&lt;a href=&quot;#cb6-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;build:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-4&quot;&gt;&lt;a href=&quot;#cb6-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; GOARCH=amd64 GOOS=darwin go build -o &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-darwin main.go&lt;/span&gt;
&lt;span id=&quot;cb6-5&quot;&gt;&lt;a href=&quot;#cb6-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; GOARCH=amd64 GOOS=linux go build -o &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-linux main.go&lt;/span&gt;
&lt;span id=&quot;cb6-6&quot;&gt;&lt;a href=&quot;#cb6-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; GOARCH=amd64 GOOS=window go build -o &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-windows main.go&lt;/span&gt;
&lt;span id=&quot;cb6-7&quot;&gt;&lt;a href=&quot;#cb6-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-8&quot;&gt;&lt;a href=&quot;#cb6-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;run:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-9&quot;&gt;&lt;a href=&quot;#cb6-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; ./&lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-10&quot;&gt;&lt;a href=&quot;#cb6-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-11&quot;&gt;&lt;a href=&quot;#cb6-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;build_and_run:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; build run&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-12&quot;&gt;&lt;a href=&quot;#cb6-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-13&quot;&gt;&lt;a href=&quot;#cb6-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;clean:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-14&quot;&gt;&lt;a href=&quot;#cb6-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; go clean&lt;/span&gt;
&lt;span id=&quot;cb6-15&quot;&gt;&lt;a href=&quot;#cb6-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-darwin&lt;/span&gt;
&lt;span id=&quot;cb6-16&quot;&gt;&lt;a href=&quot;#cb6-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-linux&lt;/span&gt;
&lt;span id=&quot;cb6-17&quot;&gt;&lt;a href=&quot;#cb6-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-windows&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now with these simple commands, you can build and run the Go project:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make run
make build&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Or you can use a single command for both build and run:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make build_and_run&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Finally, you can run the clean command for the cleanup of binaries:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make clean&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;These commands are very handy and help to streamline the development process. Now all of your team members can use the same command. This reduces inconsistency and helps to eliminate project build-related errors that can arise with inconsistent manual commands.&lt;/p&gt;
&lt;h2 id=&quot;improving-the-development-experience-with-makefiles&quot;&gt;Improving the Development Experience with Makefiles&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;make&lt;/code&gt; uses the Makefile as its source of commands to execute and these commands are defined as a &lt;em&gt;rules&lt;/em&gt; in the Makefile. A single rule defines target, dependencies, and the recipe of the Makefile.&lt;/p&gt;
&lt;h3 id=&quot;terminology&quot;&gt;Terminology&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Target:&lt;/strong&gt; Targets are the main component of a Makefile. The make command executes the recipe by its target name. As you saw in the last section, I used commands like &lt;code&gt;build&lt;/code&gt;, &lt;code&gt;run&lt;/code&gt;, and &lt;code&gt;build_and_clean&lt;/code&gt;. These are called &lt;em&gt;targets&lt;/em&gt;. Targets are the interface to the commands I want to execute.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Dependencies:&lt;/strong&gt; A target can have dependencies that need to be executed before running the target. For example, the &lt;code&gt;build_and_clean&lt;/code&gt; command has two dependencies: &lt;code&gt;build&lt;/code&gt; and &lt;code&gt;run&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Recipe:&lt;/strong&gt; Recipes are the actual commands that will be executed when the target is run. A recipe can be a single command or a collection of commands. You can specify multiple commands in a target using a line break. In the example above, the recipe for the run target is &lt;code&gt;./${BINARY_NAME}&lt;/code&gt;. A recipe should always contain a tab at the start.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;variables&quot;&gt;Variables&lt;/h3&gt;
&lt;p&gt;Variables are essential to any kind of script you write. So Makefiles also have a mechanism to use variables. These are useful when you want the same configs or outputs to be used for different targets. In the example above, I have added the &lt;code&gt;BINARY_NAME&lt;/code&gt; variable, which is reused across different targets.&lt;/p&gt;
&lt;p&gt;The variable can be substituted by enclosing it &lt;code&gt;${&amp;lt;variable_name&amp;gt;}&lt;/code&gt;. I have used the variable in the run command to execute the binary that was created from the build command:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;hello-world&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-2&quot;&gt;&lt;a href=&quot;#cb10-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-3&quot;&gt;&lt;a href=&quot;#cb10-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;run:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-4&quot;&gt;&lt;a href=&quot;#cb10-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; ./&lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Variables can be defined either by using &lt;code&gt;=&lt;/code&gt; or &lt;code&gt;:=&lt;/code&gt;. &lt;code&gt;=&lt;/code&gt; will recursively expand the variable. This will replace the value at the point when it is substituted. For example:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;x &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; foo&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-2&quot;&gt;&lt;a href=&quot;#cb11-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;y &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; bar&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-3&quot;&gt;&lt;a href=&quot;#cb11-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;x &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; later&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-4&quot;&gt;&lt;a href=&quot;#cb11-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-5&quot;&gt;&lt;a href=&quot;#cb11-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;all:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-6&quot;&gt;&lt;a href=&quot;#cb11-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; echo &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;When you run the &lt;code&gt;all&lt;/code&gt; command, it will replace the value of &lt;code&gt;x&lt;/code&gt; with the last updated value. The value has been changed to &lt;code&gt;later&lt;/code&gt;, so it will print:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt; later bar&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The other kind of variable assignment is &lt;code&gt;:=&lt;/code&gt;. These are &lt;em&gt;simple expanded&lt;/em&gt; variables. The variable is expanded at the first scan. So if you assign the variable using this operator, it will print the first value:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb13&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb13-1&quot;&gt;&lt;a href=&quot;#cb13-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;x &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;:=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; foo&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-2&quot;&gt;&lt;a href=&quot;#cb13-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;y &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;:=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; bar&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-3&quot;&gt;&lt;a href=&quot;#cb13-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;x &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;:=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; later&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-4&quot;&gt;&lt;a href=&quot;#cb13-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-5&quot;&gt;&lt;a href=&quot;#cb13-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;all:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-6&quot;&gt;&lt;a href=&quot;#cb13-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; echo &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt; foo bar&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;some-useful-tips&quot;&gt;Some Useful Tips&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;To make comments in a Makefile, you can simply add a &lt;code&gt;#&lt;/code&gt; before any line.&lt;/li&gt;
&lt;li&gt;To disable printing the recipe while running the target command, use &lt;code&gt;@&lt;/code&gt; before the recipe.&lt;/li&gt;
&lt;li&gt;Use the &lt;code&gt;SHELL&lt;/code&gt; variable to define the shell to execute the recipe.&lt;/li&gt;
&lt;li&gt;Define the &lt;code&gt;.DEFAULT_GOAL&lt;/code&gt; with the name of the target.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You can also define functions or loops in the Makefile. You can find more details on it &lt;a href=&quot;https://makefiletutorial.com&quot;&gt;in this make file tutorial&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;automating-tasks-using-makefile&quot;&gt;Automating Tasks Using Makefile&lt;/h2&gt;
&lt;p&gt;While developing a project, you will have a lot of repetitive tasks that you might like to automate. In Golang, some of those tasks are testing, running test coverage, linting, and managing dependencies. I will be creating a Makefile that contains all the rules to automate these tasks:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb15&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb15-1&quot;&gt;&lt;a href=&quot;#cb15-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;hello-world&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-2&quot;&gt;&lt;a href=&quot;#cb15-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-3&quot;&gt;&lt;a href=&quot;#cb15-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;build:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-4&quot;&gt;&lt;a href=&quot;#cb15-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; GOARCH=amd64 GOOS=darwin go build -o &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-darwin main.go&lt;/span&gt;
&lt;span id=&quot;cb15-5&quot;&gt;&lt;a href=&quot;#cb15-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; GOARCH=amd64 GOOS=linux go build -o &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-linux main.go&lt;/span&gt;
&lt;span id=&quot;cb15-6&quot;&gt;&lt;a href=&quot;#cb15-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; GOARCH=amd64 GOOS=window go build -o &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-windows main.go&lt;/span&gt;
&lt;span id=&quot;cb15-7&quot;&gt;&lt;a href=&quot;#cb15-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-8&quot;&gt;&lt;a href=&quot;#cb15-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;run:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-9&quot;&gt;&lt;a href=&quot;#cb15-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; ./&lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-10&quot;&gt;&lt;a href=&quot;#cb15-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-11&quot;&gt;&lt;a href=&quot;#cb15-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;build_and_run:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; build run&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-12&quot;&gt;&lt;a href=&quot;#cb15-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-13&quot;&gt;&lt;a href=&quot;#cb15-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;clean:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-14&quot;&gt;&lt;a href=&quot;#cb15-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; go clean&lt;/span&gt;
&lt;span id=&quot;cb15-15&quot;&gt;&lt;a href=&quot;#cb15-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-darwin&lt;/span&gt;
&lt;span id=&quot;cb15-16&quot;&gt;&lt;a href=&quot;#cb15-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-linux&lt;/span&gt;
&lt;span id=&quot;cb15-17&quot;&gt;&lt;a href=&quot;#cb15-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-windows&lt;/span&gt;
&lt;span id=&quot;cb15-18&quot;&gt;&lt;a href=&quot;#cb15-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-19&quot;&gt;&lt;a href=&quot;#cb15-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;test:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-20&quot;&gt;&lt;a href=&quot;#cb15-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; go test ./...&lt;/span&gt;
&lt;span id=&quot;cb15-21&quot;&gt;&lt;a href=&quot;#cb15-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-22&quot;&gt;&lt;a href=&quot;#cb15-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;test_coverage:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-23&quot;&gt;&lt;a href=&quot;#cb15-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; go test ./... -coverprofile=coverage.out&lt;/span&gt;
&lt;span id=&quot;cb15-24&quot;&gt;&lt;a href=&quot;#cb15-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-25&quot;&gt;&lt;a href=&quot;#cb15-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;dep:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-26&quot;&gt;&lt;a href=&quot;#cb15-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; go mod download&lt;/span&gt;
&lt;span id=&quot;cb15-27&quot;&gt;&lt;a href=&quot;#cb15-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-28&quot;&gt;&lt;a href=&quot;#cb15-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;vet:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-29&quot;&gt;&lt;a href=&quot;#cb15-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; go vet&lt;/span&gt;
&lt;span id=&quot;cb15-30&quot;&gt;&lt;a href=&quot;#cb15-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-31&quot;&gt;&lt;a href=&quot;#cb15-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;lint:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-32&quot;&gt;&lt;a href=&quot;#cb15-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; golangci-lint run --enable-all&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;With this simple Makefile, you can now easily execute commands to run tasks:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make test
make test_coverage
make dep
make vet
make lint&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; I am using an external package, &lt;a href=&quot;https://github.com/golangci/golangci-lint&quot;&gt;&lt;code&gt;golangci-lint&lt;/code&gt;&lt;/a&gt;, for linting. If you are using &lt;code&gt;go mod&lt;/code&gt;, make sure to add it to your &lt;code&gt;go.mod&lt;/code&gt; file.&lt;/p&gt;
&lt;p&gt;Any CI/CD tool that you are using can now simply use these targets.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Golang is a popular language for developing large-scale projects. Larger projects have multiple developers and require continuous automation to scale. Streamlining the development process by automating the tasks that are required during development, testing, and release will pay off with a faster and more reliable development process and a easier release process.&lt;/p&gt;
&lt;p&gt;For next-level automation and to further improve the automation, tools like &lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly.dev&lt;/a&gt; can be helpful. If you are also using Docker along with Makefile, Earthly can help make your development process smoother, taking some of the best ideas from Makefiles and Dockerfiles and combining them into one specification.&lt;/p&gt;
&lt;/div&gt;</content><author><name>Milap Neupane</name></author><category term="Tutorials" /><summary type="html">Building and testing any large codebase is time-consuming, error-prone, and repetitive. Golang supports multi-platform builds, which is excellent, but it needs multiple commands to build the binaries for different platforms, which means more time-consuming and repetitive steps when building binaries. If that’s not enough, most projects have some dependencies that need to be installed before building the binary, and you probably want to run tests and ensure the code quality with linters and code coverage tools. If this is starting to sound like a nightmare, rest assured: there is an easier way. The utility tool Make is used to automate tasks. It streamlines development and automates repetitive tasks with a single command. Make helps with testing, building, cleaning, and installing Go projects. In this tutorial, you will learn how you can leverage make and makefiles to automate all those frustrating and repetitive Golang tasks. You will learn how to build, clean, and test a Go sample project using make and a Makefile. Adding a Makefile To Your Project To start using make commands, you first need to create a Makefile in the root directory of your project. Let’s create a simple hello world project with a Makefile in it. main.go package main import &amp;quot;fmt&amp;quot; func main() { fmt.Println(&amp;quot;hello world&amp;quot;) } To run this project, you would normally need to build the project and run the binary: go build main.go If you want a different binary name and also want to create a build for a specific OS, you can specify this during the build: GOARCH=amd64 GOOS=darwin go build -o hello-world main.go You may want the build to create binary for multiple OS. For that, you will need to run multiple commands: GOARCH=amd64 GOOS=darwin go build -o hello-world-darwin main.go GOARCH=amd64 GOOS=linux go build -o hello-world-linux main.go GOARCH=amd64 GOOS=window go build -o hello-world-windows main.go go run hello-world The above commands can be simplified using Makefile. You can specify rules to a specific command and run a simple make command. You would not need to remember the commands and the flags or environment variables needed for executing it. Makefile BINARY_NAME=hello-world build: GOARCH=amd64 GOOS=darwin go build -o ${BINARY_NAME}-darwin main.go GOARCH=amd64 GOOS=linux go build -o ${BINARY_NAME}-linux main.go GOARCH=amd64 GOOS=window go build -o ${BINARY_NAME}-windows main.go run: ./${BINARY_NAME} build_and_run: build run clean: go clean rm ${BINARY_NAME}-darwin rm ${BINARY_NAME}-linux rm ${BINARY_NAME}-windows Now with these simple commands, you can build and run the Go project: make run make build Or you can use a single command for both build and run: make build_and_run Finally, you can run the clean command for the cleanup of binaries: make clean These commands are very handy and help to streamline the development process. Now all of your team members can use the same command. This reduces inconsistency and helps to eliminate project build-related errors that can arise with inconsistent manual commands. Improving the Development Experience with Makefiles make uses the Makefile as its source of commands to execute and these commands are defined as a rules in the Makefile. A single rule defines target, dependencies, and the recipe of the Makefile. Terminology Target: Targets are the main component of a Makefile. The make command executes the recipe by its target name. As you saw in the last section, I used commands like build, run, and build_and_clean. These are called targets. Targets are the interface to the commands I want to execute. Dependencies: A target can have dependencies that need to be executed before running the target. For example, the build_and_clean command has two dependencies: build and run. Recipe: Recipes are the actual commands that will be executed when the target is run. A recipe can be a single command or a collection of commands. You can specify multiple commands in a target using a line break. In the example above, the recipe for the run target is ./${BINARY_NAME}. A recipe should always contain a tab at the start. Variables Variables are essential to any kind of script you write. So Makefiles also have a mechanism to use variables. These are useful when you want the same configs or outputs to be used for different targets. In the example above, I have added the BINARY_NAME variable, which is reused across different targets. The variable can be substituted by enclosing it ${&amp;lt;variable_name&amp;gt;}. I have used the variable in the run command to execute the binary that was created from the build command: BINARY_NAME=hello-world run: ./${BINARY_NAME} Variables can be defined either by using = or :=. = will recursively expand the variable. This will replace the value at the point when it is substituted. For example: x = foo y = $(x) bar x = later all: echo $(y) When you run the all command, it will replace the value of x with the last updated value. The value has been changed to later, so it will print: &amp;gt; later bar The other kind of variable assignment is :=. These are simple expanded variables. The variable is expanded at the first scan. So if you assign the variable using this operator, it will print the first value: x := foo y := $(x) bar x := later all: echo $(y) &amp;gt; foo bar Some Useful Tips To make comments in a Makefile, you can simply add a # before any line. To disable printing the recipe while running the target command, use @ before the recipe. Use the SHELL variable to define the shell to execute the recipe. Define the .DEFAULT_GOAL with the name of the target. You can also define functions or loops in the Makefile. You can find more details on it in this make file tutorial. Automating Tasks Using Makefile While developing a project, you will have a lot of repetitive tasks that you might like to automate. In Golang, some of those tasks are testing, running test coverage, linting, and managing dependencies. I will be creating a Makefile that contains all the rules to automate these tasks: BINARY_NAME=hello-world build: GOARCH=amd64 GOOS=darwin go build -o ${BINARY_NAME}-darwin main.go GOARCH=amd64 GOOS=linux go build -o ${BINARY_NAME}-linux main.go GOARCH=amd64 GOOS=window go build -o ${BINARY_NAME}-windows main.go run: ./${BINARY_NAME} build_and_run: build run clean: go clean rm ${BINARY_NAME}-darwin rm ${BINARY_NAME}-linux rm ${BINARY_NAME}-windows test: go test ./... test_coverage: go test ./... -coverprofile=coverage.out dep: go mod download vet: go vet lint: golangci-lint run --enable-all With this simple Makefile, you can now easily execute commands to run tasks: make test make test_coverage make dep make vet make lint Note: I am using an external package, golangci-lint, for linting. If you are using go mod, make sure to add it to your go.mod file. Any CI/CD tool that you are using can now simply use these targets. Conclusion Golang is a popular language for developing large-scale projects. Larger projects have multiple developers and require continuous automation to scale. Streamlining the development process by automating the tasks that are required during development, testing, and release will pay off with a faster and more reliable development process and a easier release process. For next-level automation and to further improve the automation, tools like Earthly.dev can be helpful. If you are also using Docker along with Makefile, Earthly can help make your development process smoother, taking some of the best ideas from Makefiles and Dockerfiles and combining them into one specification.</summary></entry><entry><title type="html">Creating a Python Makefile</title><link href="https://earthly.dev/blog/python-makefile/" rel="alternate" type="text/html" title="Creating a Python Makefile" /><published>2021-07-08T00:00:00-04:00</published><updated>2021-07-08T00:00:00-04:00</updated><id>https://earthly.dev/blog/python-makefile</id><content type="html" xml:base="https://earthly.dev/blog/python-makefile/">&lt;p&gt;Even though Python is regarded as an interpreted language and the files need not be compiled separately, many developers are unaware that you can still use &lt;code&gt;make&lt;/code&gt; to automate different parts of developing a Python project, like running tests, cleaning builds, and installing dependencies. It’s honestly an underutilized function, and by integrating it into your routine, you can save time and avoid errors.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;make&lt;/code&gt; is a commonplace tool in the world of software development, especially compiled languages like C or C++. It is a tool which controls the generation of executable and other non-source files from a program’s source file. It can automate the process of building software by tracking its dependencies and compiling the program only when the dependencies change.&lt;/p&gt;
&lt;p&gt;The reason &lt;code&gt;make&lt;/code&gt; is very common with compiled languages is because the compilation commands for those languages can be long and complicated and difficult to remember. Also, you need to compile each file and link the resulting object files together. So, whenever one of the files changes, it becomes necessary to recompile it.&lt;/p&gt;
&lt;p&gt;In this tutorial, you will learn the basics of &lt;code&gt;make&lt;/code&gt; and how it can be used in a Python project.&lt;/p&gt;
&lt;h2 id=&quot;is-python-compiled-or-interpreted&quot;&gt;Is Python Compiled or Interpreted?&lt;/h2&gt;
&lt;p&gt;Usually, all the programming languages can be classified into compiled or interpreted languages. In simple words, in a compiled language, the program is converted from a high level language to machine language. Whereas, in case of interpreted language, the source code is read and executed one line at a time.&lt;/p&gt;
&lt;p&gt;Since in an interpreted language you cannot compile the source files independently beforehand, you cannot utilize &lt;code&gt;make&lt;/code&gt; like you would do for a compiled language. This makes &lt;code&gt;make&lt;/code&gt; relatively underutilized for an interpreted language.&lt;/p&gt;
&lt;p&gt;Now, Python is usually considered to be an interpreted language. When you run a Python code, the Python interpreter reads the file line-by-line and runs it.&lt;/p&gt;
&lt;p&gt;But behind-the-scenes, the source code is compiled into bytecode. These are similar to CPU instructions, but instead of being run by the actual CPU, these are executed by a software called a Virtual Machine (VM), which acts as a pseudo-microprocessor that runs the bytecodes. The advantage is that you can run Python on any platform as long as the VM is installed.&lt;/p&gt;
&lt;p&gt;When you run a Python code, the interpreter implicitly compiles the code into bytecode and interprets it with the VM. The reason Python is regarded to be an interpreted language is because the &lt;a href=&quot;/blog/compiling-containers-dockerfiles-llvm-and-buildkit&quot;&gt;compilation&lt;/a&gt; step is implicit. You don’t have to invoke a compiler manually.&lt;/p&gt;
&lt;p&gt;When you import a module into your code, Python compiles those modules into bytecode for caching purposes. These are stored in a directory named &lt;code&gt;__pycache__&lt;/code&gt; in the current directory, which contains compiled &lt;code&gt;.pyc&lt;/code&gt; files.&lt;/p&gt;
&lt;p&gt;Although you cannot compile these modules using &lt;code&gt;make&lt;/code&gt;, you can still use &lt;code&gt;make&lt;/code&gt; for automation tasks like running tests, installing dependencies, cleaning the &lt;code&gt;.pyc&lt;/code&gt; files etc.&lt;/p&gt;
&lt;h2 id=&quot;using-make-with-python&quot;&gt;Using Make With Python&lt;/h2&gt;
&lt;p&gt;In this tutorial, you’ll create a simple app that makes requests to &lt;code&gt;http://numbersapi.com&lt;/code&gt; and fetches random trivia about a user given number.&lt;/p&gt;
&lt;h3 id=&quot;the-sample-source-code&quot;&gt;The Sample Source Code&lt;/h3&gt;
&lt;p&gt;First, you’ll start by creating a file &lt;code&gt;api.py&lt;/code&gt; with the following code:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; requests&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; get_fact(number):&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    url &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;http://numbersapi.com/&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;.&lt;span class=&quot;bu&quot;&gt;format&lt;/span&gt;(number)&lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-6&quot;&gt;&lt;a href=&quot;#cb1-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    r &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; requests.get(url)&lt;/span&gt;
&lt;span id=&quot;cb1-7&quot;&gt;&lt;a href=&quot;#cb1-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; r.status_code &lt;span class=&quot;op&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;200&lt;/span&gt;:&lt;/span&gt;
&lt;span id=&quot;cb1-8&quot;&gt;&lt;a href=&quot;#cb1-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;bu&quot;&gt;print&lt;/span&gt;(r.text)&lt;/span&gt;
&lt;span id=&quot;cb1-9&quot;&gt;&lt;a href=&quot;#cb1-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;else&lt;/span&gt;:&lt;/span&gt;
&lt;span id=&quot;cb1-10&quot;&gt;&lt;a href=&quot;#cb1-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;bu&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;An error occurred, code=&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;.&lt;span class=&quot;bu&quot;&gt;format&lt;/span&gt;(r.status_code))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Create another file &lt;code&gt;app.py&lt;/code&gt; with the following code:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; api&lt;/span&gt;
&lt;span id=&quot;cb2-2&quot;&gt;&lt;a href=&quot;#cb2-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-3&quot;&gt;&lt;a href=&quot;#cb2-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;api.get_fact(&lt;span class=&quot;bu&quot;&gt;input&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Enter a number: &amp;quot;&lt;/span&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This file simply imports the &lt;code&gt;api&lt;/code&gt; module and calls the &lt;code&gt;get_fact()&lt;/code&gt; function with a user provided number.&lt;/p&gt;
&lt;p&gt;Finally, create a file &lt;code&gt;requirements.txt&lt;/code&gt; with the dependencies of the app:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;requests&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This app only depends on the &lt;code&gt;requests&lt;/code&gt; module, but a real life project possibly depends on a large number of modules. Let’s run the app and see how it works.&lt;/p&gt;
&lt;p&gt;First, install the dependencies:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;pip&lt;/span&gt; install &lt;span class=&quot;at&quot;&gt;-r&lt;/span&gt; requirements.txt&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then, run the actual app:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;python&lt;/span&gt; app.py&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will prompt you for a number and show you a trivia about that number:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$  python app.py
Enter a number: 20
20 is the number of questions in the popular party game Twenty Questions.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now let’s integrate &lt;code&gt;make&lt;/code&gt; with our project to automate the installation of dependencies and running the app.&lt;/p&gt;
&lt;h3 id=&quot;the-makefile&quot;&gt;The Makefile&lt;/h3&gt;
&lt;p&gt;To use &lt;code&gt;make&lt;/code&gt; in your project, you need to have a file named &lt;code&gt;Makefile&lt;/code&gt; at the root of your project. This file instructs &lt;code&gt;make&lt;/code&gt; on what to do. The Makefile consists of a set of rules. Each rule has 3 parts: a target, a list of prerequisites, and a recipe. They follow this format:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb7&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb7-1&quot;&gt;&lt;a href=&quot;#cb7-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;target:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; pre-req1 pre-req2 pre-req3 ...&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb7-2&quot;&gt;&lt;a href=&quot;#cb7-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    recipes&lt;/span&gt;
&lt;span id=&quot;cb7-3&quot;&gt;&lt;a href=&quot;#cb7-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;Note that there are &lt;a href=&quot;/blog/repeatable-builds-every-time/#tips-for-taming-makefiles-in-large-teams&quot;&gt;tabs&lt;/a&gt; before the recipe lists. Anything other than tabs will result in an error.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;target&lt;/code&gt; represents a goal that you want to achieve, usually this is a file that needs to be created in your build. The prerequisites list tells &lt;code&gt;make&lt;/code&gt; which files are this target dependent on. The prerequisites can be a file or another target. Finally the recipes are a list of shell commands that will be executed by make as part of building the target.&lt;/p&gt;
&lt;p&gt;When &lt;code&gt;make&lt;/code&gt; executes a target, it looks at its prerequisites. If those prerequisites have their own recipes, &lt;code&gt;make&lt;/code&gt; executes them and when all the prerequisites are ready for a target, it executes the corresponding recipe for the current target. For each target, the recipes are executed only if the target doesn’t exist or the pre-requisites are newer than the target.&lt;/p&gt;
&lt;p&gt;Our app has two targets. First, the dependencies must be installed and then the app can be run.&lt;/p&gt;
&lt;p&gt;Let’s create the rule for running the app first:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb8&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb8-1&quot;&gt;&lt;a href=&quot;#cb8-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;run:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-2&quot;&gt;&lt;a href=&quot;#cb8-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    python app.py&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The target is named &lt;code&gt;run&lt;/code&gt; and it has no prerequisites, which it will be run every time you run &lt;code&gt;make run&lt;/code&gt;. You can test it by running &lt;code&gt;make run&lt;/code&gt; in a terminal.&lt;/p&gt;
&lt;p&gt;Create another target for the setup stage:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb9&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb9-1&quot;&gt;&lt;a href=&quot;#cb9-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;setup:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; requirements.txt&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb9-2&quot;&gt;&lt;a href=&quot;#cb9-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    pip install -r requirements.txt&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code&gt;setup&lt;/code&gt; target depends on the &lt;code&gt;requirements.txt&lt;/code&gt; file. Whenever the &lt;code&gt;requirements.txt&lt;/code&gt; file changes, the dependencies will be refreshed by running &lt;code&gt;pip install -r&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Finally, let’s have a &lt;code&gt;clean&lt;/code&gt; rule to clean up the &lt;code&gt;__pycache__&lt;/code&gt; folder:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;clean:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-2&quot;&gt;&lt;a href=&quot;#cb10-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    rm -rf __pycache__&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;creating-a-virtual-environment&quot;&gt;Creating a Virtual Environment&lt;/h3&gt;
&lt;p&gt;The sample app depends on the &lt;code&gt;requests&lt;/code&gt; library only. However, in a large project, there might be numerous dependencies. And if you are running multiple apps, it’s possible that some apps require the same dependencies, but a different version. This means that one Python installation may not be capable of satisfying the requirements of all applications. The solution for this is to use a &lt;a href=&quot;https://docs.python.org/3/glossary.html#term-virtual-environment&quot;&gt;virtual environment&lt;/a&gt;. This is a self-contained directory tree that contains a Python installation of a specific version.&lt;/p&gt;
&lt;p&gt;Different apps can use their own virtual environment where they can install their requirements. The virtual environments are isolated from each other, which means there will be no dependency conflicts.&lt;/p&gt;
&lt;p&gt;Python provides a module called &lt;a href=&quot;https://docs.python.org/3/library/venv.html#module-venv&quot;&gt;&lt;code&gt;venv&lt;/code&gt;&lt;/a&gt; which is used to create and manage virtual environments. Let’s see how a virtual environment can be used in the sample app.&lt;/p&gt;
&lt;p&gt;First, you need to create a virtual environment in the project root:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;python3&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-m&lt;/span&gt; venv venv&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This creates a &lt;code&gt;venv&lt;/code&gt; folder in your current directory, which contains the necessary files to make the virtual environment.&lt;/p&gt;
&lt;p&gt;There are two ways to use this virtual environment. Instead of using &lt;code&gt;python3&lt;/code&gt; or &lt;code&gt;pip&lt;/code&gt;, you have to use &lt;code&gt;./venv/bin/python3&lt;/code&gt; or &lt;code&gt;./venv/bin/pip&lt;/code&gt; to run the app or install dependencies:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb12&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb12-1&quot;&gt;&lt;a href=&quot;#cb12-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;python3&lt;/span&gt; app.py &lt;span class=&quot;co&quot;&gt;# Uses the system Python&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-2&quot;&gt;&lt;a href=&quot;#cb12-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;./venv/bin/python3&lt;/span&gt; &lt;span class=&quot;co&quot;&gt;# USes the virtualenv Python&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;But writing &lt;code&gt;./venv.bin/&lt;/code&gt; every time can be time consuming, especially if you have to run a lot of commands that use Python or pip. To overcome this, you can “activate” the virtual environment by running:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb13&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb13-1&quot;&gt;&lt;a href=&quot;#cb13-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;./venv/bin/activate&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will load the virtual environment in the current shell. This environment will stay active as long as you don’t close the shell, or deactivate manually.&lt;/p&gt;
&lt;p&gt;Once activated, running &lt;code&gt;python3&lt;/code&gt; or &lt;code&gt;pip&lt;/code&gt; will use the executables from the virtual environment. If you now run &lt;code&gt;pip install -r requirements.txt&lt;/code&gt;, the modules will be installed in the &lt;code&gt;venv&lt;/code&gt; directory.&lt;/p&gt;
&lt;p&gt;Once you are done with the virtual environment, you can deactivate the environment by running the &lt;code&gt;deactivate&lt;/code&gt; command.&lt;/p&gt;
&lt;h3 id=&quot;venv-in-make&quot;&gt;&lt;code&gt;venv&lt;/code&gt; in Make&lt;/h3&gt;
&lt;p&gt;You can utilize &lt;code&gt;make&lt;/code&gt; to automatically refresh your virtual environment and run your app with this virtual environment. To automatically reinstall the dependencies whenever the &lt;code&gt;requirements.txt&lt;/code&gt; file changes, write the following in your Makefile:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb14&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb14-1&quot;&gt;&lt;a href=&quot;#cb14-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;venv/bin/activate:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; requirements.txt&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb14-2&quot;&gt;&lt;a href=&quot;#cb14-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; python3 -m venv venv&lt;/span&gt;
&lt;span id=&quot;cb14-3&quot;&gt;&lt;a href=&quot;#cb14-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; ./venv/bin/pip install -r requirements.txt&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Here the target is &lt;code&gt;venv/bin/activate&lt;/code&gt; which depends on &lt;code&gt;requirements.txt&lt;/code&gt;. Whenever &lt;code&gt;requirements.txt&lt;/code&gt; changes, it rebuilds the environment and installs the dependencies with pip, which re-creates the &lt;code&gt;activate&lt;/code&gt;. The actual goal here is the existence of the &lt;code&gt;venv&lt;/code&gt; directory, but since &lt;code&gt;make&lt;/code&gt; can only work with files, &lt;code&gt;venv/bin/activate&lt;/code&gt; is used instead.&lt;/p&gt;
&lt;p&gt;To run the app with this environment, create the following rule:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb15&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb15-1&quot;&gt;&lt;a href=&quot;#cb15-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;run:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; venv/bin/activate&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-2&quot;&gt;&lt;a href=&quot;#cb15-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; ./venv/bin/python3 app.py&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code&gt;run&lt;/code&gt; target depends on the &lt;code&gt;venv/bin/activate&lt;/code&gt; target. Once that target is satisfied, it runs the app using the virtual environment.&lt;/p&gt;
&lt;p&gt;Finally, update the &lt;code&gt;clean&lt;/code&gt; target to also delete the &lt;code&gt;venv&lt;/code&gt; directory:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb16&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb16-1&quot;&gt;&lt;a href=&quot;#cb16-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-2&quot;&gt;&lt;a href=&quot;#cb16-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;clean:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-3&quot;&gt;&lt;a href=&quot;#cb16-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm -rf __pycache__&lt;/span&gt;
&lt;span id=&quot;cb16-4&quot;&gt;&lt;a href=&quot;#cb16-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm -rf venv&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let’s test this all out. First, delete the &lt;code&gt;venv&lt;/code&gt; directory if you have one. Now run &lt;code&gt;make run&lt;/code&gt;. Since the &lt;code&gt;venv/bin/activate&lt;/code&gt; file does not exist, &lt;code&gt;make&lt;/code&gt; will run the &lt;code&gt;venv/bin/activate&lt;/code&gt; target, which will install the dependencies and finally run the app using the virtual environment.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/python-makefile/makerun.png&quot; alt=&quot;make run for Python venv&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;&lt;code&gt;make run&lt;/code&gt; for Python &lt;code&gt;venv&lt;/code&gt;&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;If you run &lt;code&gt;make run&lt;/code&gt; once again, only the app will be run and the virtual environment will not be refreshed. You can use the &lt;code&gt;touch&lt;/code&gt; command to stimulate a change in the &lt;code&gt;requiremenst.txt&lt;/code&gt; file which will cause &lt;code&gt;make&lt;/code&gt; to run the setup step again -&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;touch requirements.txt&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now if you run &lt;code&gt;make run&lt;/code&gt;, the virtual environment will be recreated and then the app will be run.&lt;/p&gt;
&lt;h3 id=&quot;using-variables&quot;&gt;Using Variables&lt;/h3&gt;
&lt;p&gt;Observe that in our Makefile, we have references to the &lt;code&gt;venv&lt;/code&gt; directory in multiple places. In future, if we want to change the directory name to something else, we have to remember to perform the change in all the places. Also there isn’t any way for the user to customize the directory name without editing the Makefile. To overcome this, we can use variables. The variables not only make the Makefile cleaner, they can be overridden by the user without editing Makefile.&lt;/p&gt;
&lt;p&gt;A variable in Makefile starts with a $ and is enclosed in parentheses () or braces {}, unless its a single character variable.&lt;/p&gt;
&lt;p&gt;To set a variable, write a line starting with a variable name followed by &lt;code&gt;=&lt;/code&gt;, &lt;code&gt;:=&lt;/code&gt; or &lt;code&gt;::=&lt;/code&gt;, followed by the value of the variable:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb18&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb18-1&quot;&gt;&lt;a href=&quot;#cb18-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;VENV &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; venv&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Here the variable &lt;code&gt;VENV&lt;/code&gt; is set to &lt;code&gt;venv&lt;/code&gt;. Now whenever you use this variable in a rule, it will be replaced by its value.&lt;/p&gt;
&lt;p&gt;The rules now can be rewritten using the &lt;code&gt;VENV&lt;/code&gt; variable:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb19&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb19-1&quot;&gt;&lt;a href=&quot;#cb19-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;VENV &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; venv&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-2&quot;&gt;&lt;a href=&quot;#cb19-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;PYTHON &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;VENV&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;/bin/python3&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-3&quot;&gt;&lt;a href=&quot;#cb19-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;PIP &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;VENV&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;/bin/pip&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-4&quot;&gt;&lt;a href=&quot;#cb19-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-5&quot;&gt;&lt;a href=&quot;#cb19-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;run:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;VENV&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;/bin/activate&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-6&quot;&gt;&lt;a href=&quot;#cb19-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;PYTHON&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt; app.py&lt;/span&gt;
&lt;span id=&quot;cb19-7&quot;&gt;&lt;a href=&quot;#cb19-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-8&quot;&gt;&lt;a href=&quot;#cb19-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-9&quot;&gt;&lt;a href=&quot;#cb19-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;$(VENV)/bin/activate:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; requirements.txt&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-10&quot;&gt;&lt;a href=&quot;#cb19-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; python3 -m venv &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;VENV&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-11&quot;&gt;&lt;a href=&quot;#cb19-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;PIP&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt; install -r requirements.txt&lt;/span&gt;
&lt;span id=&quot;cb19-12&quot;&gt;&lt;a href=&quot;#cb19-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-13&quot;&gt;&lt;a href=&quot;#cb19-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-14&quot;&gt;&lt;a href=&quot;#cb19-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;clean:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-15&quot;&gt;&lt;a href=&quot;#cb19-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm -rf __pycache__&lt;/span&gt;
&lt;span id=&quot;cb19-16&quot;&gt;&lt;a href=&quot;#cb19-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm -rf &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;VENV&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I have also replaced references to &lt;code&gt;python3&lt;/code&gt; and &lt;code&gt;pip&lt;/code&gt; with a variable. By default, they will use the binaries from the virtual environment.&lt;/p&gt;
&lt;p&gt;The variables can be overridden by providing the values when running the make command:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb20&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb20-1&quot;&gt;&lt;a href=&quot;#cb20-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;make&lt;/span&gt; VENV=my_venv run&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Using &lt;code&gt;VENV=my_venv&lt;/code&gt; overrides the default value of &lt;code&gt;VENV&lt;/code&gt; and now the virtual environment will be created in &lt;code&gt;my_venv&lt;/code&gt; directory. It is a good practice to use variables for all commands used in the Makefile, as well as their options and directories. This provides an easy way for the user to substitute alternatives.&lt;/p&gt;
&lt;h3 id=&quot;phony-targets&quot;&gt;Phony Targets&lt;/h3&gt;
&lt;p&gt;Your Makefile contains two special targets - run and clean. Special in the sense they don’t represent an actual file that exists. And since &lt;code&gt;make&lt;/code&gt; executes the recipes of a target if that target does not exist, these two targets will always be executed. However, if later if you have a file called &lt;code&gt;run&lt;/code&gt; or &lt;code&gt;clean&lt;/code&gt;, then since these targets have no prerequisites, &lt;code&gt;make&lt;/code&gt; will consider these to always be newer and so, will not execute the recipes.&lt;/p&gt;
&lt;p&gt;To overcome this, &lt;code&gt;make&lt;/code&gt; has something called a Phony target. By declaring a target to be Phony, you tell &lt;code&gt;make&lt;/code&gt; not to consider an existing file with the same name. To make the &lt;code&gt;run&lt;/code&gt; and &lt;code&gt;clean&lt;/code&gt; targets phony, add this to the top:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb21&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb21-1&quot;&gt;&lt;a href=&quot;#cb21-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;.PHONY:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; run clean&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Using &lt;code&gt;make&lt;/code&gt; in your Python projects opens the door to lots of possibilities in terms of automation. You can use &lt;code&gt;make&lt;/code&gt; to run linters like &lt;code&gt;flake8&lt;/code&gt;, run tests using &lt;code&gt;pytest&lt;/code&gt;, or run code coverage using &lt;code&gt;coverage&lt;/code&gt;. If you wish to learn all the features of &lt;code&gt;make&lt;/code&gt;, be sure to check out the &lt;a href=&quot;http://www.gnu.org/software/make/manual/make.html&quot;&gt;manual&lt;/a&gt; by GNU.&lt;/p&gt;
&lt;p&gt;Being full of features, and primarily targeted towards compiled languages, &lt;code&gt;make&lt;/code&gt; can be difficult to use in a Python project, especially in large ones. If you are looking for a solution to avoid the complexities of Makefile, while still retaining the powerful automation capabilities, check out &lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt;. Earthly takes a modern approach towards project builds and combines the best of both Makefile and Dockerfile. Earthly provides understandable and repeatable build scripts without any complexity.&lt;/p&gt;</content><author><name>Adam Gordon Bell</name></author><category term="Tutorials" /><summary type="html">Even though Python is regarded as an interpreted language and the files need not be compiled separately, many developers are unaware that you can still use make to automate different parts of developing a Python project, like running tests, cleaning builds, and installing dependencies. It’s honestly an underutilized function, and by integrating it into your routine, you can save time and avoid errors. make is a commonplace tool in the world of software development, especially compiled languages like C or C++. It is a tool which controls the generation of executable and other non-source files from a program’s source file. It can automate the process of building software by tracking its dependencies and compiling the program only when the dependencies change. The reason make is very common with compiled languages is because the compilation commands for those languages can be long and complicated and difficult to remember. Also, you need to compile each file and link the resulting object files together. So, whenever one of the files changes, it becomes necessary to recompile it. In this tutorial, you will learn the basics of make and how it can be used in a Python project. Is Python Compiled or Interpreted? Usually, all the programming languages can be classified into compiled or interpreted languages. In simple words, in a compiled language, the program is converted from a high level language to machine language. Whereas, in case of interpreted language, the source code is read and executed one line at a time. Since in an interpreted language you cannot compile the source files independently beforehand, you cannot utilize make like you would do for a compiled language. This makes make relatively underutilized for an interpreted language. Now, Python is usually considered to be an interpreted language. When you run a Python code, the Python interpreter reads the file line-by-line and runs it. But behind-the-scenes, the source code is compiled into bytecode. These are similar to CPU instructions, but instead of being run by the actual CPU, these are executed by a software called a Virtual Machine (VM), which acts as a pseudo-microprocessor that runs the bytecodes. The advantage is that you can run Python on any platform as long as the VM is installed. When you run a Python code, the interpreter implicitly compiles the code into bytecode and interprets it with the VM. The reason Python is regarded to be an interpreted language is because the compilation step is implicit. You don’t have to invoke a compiler manually. When you import a module into your code, Python compiles those modules into bytecode for caching purposes. These are stored in a directory named __pycache__ in the current directory, which contains compiled .pyc files. Although you cannot compile these modules using make, you can still use make for automation tasks like running tests, installing dependencies, cleaning the .pyc files etc. Using Make With Python In this tutorial, you’ll create a simple app that makes requests to http://numbersapi.com and fetches random trivia about a user given number. The Sample Source Code First, you’ll start by creating a file api.py with the following code: import requests def get_fact(number): url = &amp;quot;http://numbersapi.com/{}&amp;quot;.format(number) r = requests.get(url) if r.status_code == 200: print(r.text) else: print(&amp;quot;An error occurred, code={}&amp;quot;.format(r.status_code)) Create another file app.py with the following code: import api api.get_fact(input(&amp;quot;Enter a number: &amp;quot;)) This file simply imports the api module and calls the get_fact() function with a user provided number. Finally, create a file requirements.txt with the dependencies of the app: requests This app only depends on the requests module, but a real life project possibly depends on a large number of modules. Let’s run the app and see how it works. First, install the dependencies: pip install -r requirements.txt Then, run the actual app: python app.py This will prompt you for a number and show you a trivia about that number: $ python app.py Enter a number: 20 20 is the number of questions in the popular party game Twenty Questions. Now let’s integrate make with our project to automate the installation of dependencies and running the app. The Makefile To use make in your project, you need to have a file named Makefile at the root of your project. This file instructs make on what to do. The Makefile consists of a set of rules. Each rule has 3 parts: a target, a list of prerequisites, and a recipe. They follow this format: target: pre-req1 pre-req2 pre-req3 ... recipes ... Note that there are tabs before the recipe lists. Anything other than tabs will result in an error. The target represents a goal that you want to achieve, usually this is a file that needs to be created in your build. The prerequisites list tells make which files are this target dependent on. The prerequisites can be a file or another target. Finally the recipes are a list of shell commands that will be executed by make as part of building the target. When make executes a target, it looks at its prerequisites. If those prerequisites have their own recipes, make executes them and when all the prerequisites are ready for a target, it executes the corresponding recipe for the current target. For each target, the recipes are executed only if the target doesn’t exist or the pre-requisites are newer than the target. Our app has two targets. First, the dependencies must be installed and then the app can be run. Let’s create the rule for running the app first: run: python app.py The target is named run and it has no prerequisites, which it will be run every time you run make run. You can test it by running make run in a terminal. Create another target for the setup stage: setup: requirements.txt pip install -r requirements.txt The setup target depends on the requirements.txt file. Whenever the requirements.txt file changes, the dependencies will be refreshed by running pip install -r. Finally, let’s have a clean rule to clean up the __pycache__ folder: clean: rm -rf __pycache__ Creating a Virtual Environment The sample app depends on the requests library only. However, in a large project, there might be numerous dependencies. And if you are running multiple apps, it’s possible that some apps require the same dependencies, but a different version. This means that one Python installation may not be capable of satisfying the requirements of all applications. The solution for this is to use a virtual environment. This is a self-contained directory tree that contains a Python installation of a specific version. Different apps can use their own virtual environment where they can install their requirements. The virtual environments are isolated from each other, which means there will be no dependency conflicts. Python provides a module called venv which is used to create and manage virtual environments. Let’s see how a virtual environment can be used in the sample app. First, you need to create a virtual environment in the project root: python3 -m venv venv This creates a venv folder in your current directory, which contains the necessary files to make the virtual environment. There are two ways to use this virtual environment. Instead of using python3 or pip, you have to use ./venv/bin/python3 or ./venv/bin/pip to run the app or install dependencies: python3 app.py # Uses the system Python ./venv/bin/python3 # USes the virtualenv Python But writing ./venv.bin/ every time can be time consuming, especially if you have to run a lot of commands that use Python or pip. To overcome this, you can “activate” the virtual environment by running: ./venv/bin/activate This will load the virtual environment in the current shell. This environment will stay active as long as you don’t close the shell, or deactivate manually. Once activated, running python3 or pip will use the executables from the virtual environment. If you now run pip install -r requirements.txt, the modules will be installed in the venv directory. Once you are done with the virtual environment, you can deactivate the environment by running the deactivate command. venv in Make You can utilize make to automatically refresh your virtual environment and run your app with this virtual environment. To automatically reinstall the dependencies whenever the requirements.txt file changes, write the following in your Makefile: venv/bin/activate: requirements.txt python3 -m venv venv ./venv/bin/pip install -r requirements.txt Here the target is venv/bin/activate which depends on requirements.txt. Whenever requirements.txt changes, it rebuilds the environment and installs the dependencies with pip, which re-creates the activate. The actual goal here is the existence of the venv directory, but since make can only work with files, venv/bin/activate is used instead. To run the app with this environment, create the following rule: run: venv/bin/activate ./venv/bin/python3 app.py The run target depends on the venv/bin/activate target. Once that target is satisfied, it runs the app using the virtual environment. Finally, update the clean target to also delete the venv directory: clean: rm -rf __pycache__ rm -rf venv Let’s test this all out. First, delete the venv directory if you have one. Now run make run. Since the venv/bin/activate file does not exist, make will run the venv/bin/activate target, which will install the dependencies and finally run the app using the virtual environment. make run for Python venv If you run make run once again, only the app will be run and the virtual environment will not be refreshed. You can use the touch command to stimulate a change in the requiremenst.txt file which will cause make to run the setup step again - touch requirements.txt Now if you run make run, the virtual environment will be recreated and then the app will be run. Using Variables Observe that in our Makefile, we have references to the venv directory in multiple places. In future, if we want to change the directory name to something else, we have to remember to perform the change in all the places. Also there isn’t any way for the user to customize the directory name without editing the Makefile. To overcome this, we can use variables. The variables not only make the Makefile cleaner, they can be overridden by the user without editing Makefile. A variable in Makefile starts with a $ and is enclosed in parentheses () or braces {}, unless its a single character variable. To set a variable, write a line starting with a variable name followed by =, := or ::=, followed by the value of the variable: VENV = venv Here the variable VENV is set to venv. Now whenever you use this variable in a rule, it will be replaced by its value. The rules now can be rewritten using the VENV variable: VENV = venv PYTHON = $(VENV)/bin/python3 PIP = $(VENV)/bin/pip run: $(VENV)/bin/activate $(PYTHON) app.py $(VENV)/bin/activate: requirements.txt python3 -m venv $(VENV) $(PIP) install -r requirements.txt clean: rm -rf __pycache__ rm -rf $(VENV) I have also replaced references to python3 and pip with a variable. By default, they will use the binaries from the virtual environment. The variables can be overridden by providing the values when running the make command: make VENV=my_venv run Using VENV=my_venv overrides the default value of VENV and now the virtual environment will be created in my_venv directory. It is a good practice to use variables for all commands used in the Makefile, as well as their options and directories. This provides an easy way for the user to substitute alternatives. Phony Targets Your Makefile contains two special targets - run and clean. Special in the sense they don’t represent an actual file that exists. And since make executes the recipes of a target if that target does not exist, these two targets will always be executed. However, if later if you have a file called run or clean, then since these targets have no prerequisites, make will consider these to always be newer and so, will not execute the recipes. To overcome this, make has something called a Phony target. By declaring a target to be Phony, you tell make not to consider an existing file with the same name. To make the run and clean targets phony, add this to the top: .PHONY: run clean Conclusion Using make in your Python projects opens the door to lots of possibilities in terms of automation. You can use make to run linters like flake8, run tests using pytest, or run code coverage using coverage. If you wish to learn all the features of make, be sure to check out the manual by GNU. Being full of features, and primarily targeted towards compiled languages, make can be difficult to use in a Python project, especially in large ones. If you are looking for a solution to avoid the complexities of Makefile, while still retaining the powerful automation capabilities, check out Earthly. Earthly takes a modern approach towards project builds and combines the best of both Makefile and Dockerfile. Earthly provides understandable and repeatable build scripts without any complexity.</summary></entry><entry><title type="html">Creating a G++ Makefile</title><link href="https://earthly.dev/blog/g++-makefile/" rel="alternate" type="text/html" title="Creating a G++ Makefile" /><published>2021-07-06T00:00:00-04:00</published><updated>2021-07-06T00:00:00-04:00</updated><id>https://earthly.dev/blog/g++-makefile</id><content type="html" xml:base="https://earthly.dev/blog/g++-makefile/">&lt;p&gt;C++ is one of the &lt;a href=&quot;https://www.tiobe.com/tiobe-index/cplusplus/&quot;&gt;most dominant programming languages&lt;/a&gt;. Although there are many compilers available, &lt;a href=&quot;http://gcc.gnu.org/&quot;&gt;GCC&lt;/a&gt; still ranks as one of the most popular choices for C++. GCC is part of the GNU toolchain, which comes with utilities like GNU make, GNU bison, and GNU &lt;a href=&quot;/blog/autoconf&quot;&gt;AutoTools&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;what-is-gcc&quot;&gt;What Is GCC?&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://gcc.gnu.org/&quot;&gt;GNU Compiler Collection&lt;/a&gt;, also known as GCC, started as a C compiler, created by Richard Stallman in 1984 as a part of his GNU project. GCC now supports many languages, including C++, Objective C, Java, Fortran, and Go. The latest version as of writing this article is GCC 11.1, released April 27, 2021.&lt;/p&gt;
&lt;p&gt;The C++ compiler of GCC is known as &lt;code&gt;g++&lt;/code&gt;. The &lt;code&gt;g++&lt;/code&gt; utility supports almost all mainstream C++ standards, including &lt;code&gt;c++98&lt;/code&gt;, &lt;code&gt;c++03&lt;/code&gt;, &lt;code&gt;c++11&lt;/code&gt;, &lt;code&gt;c++14&lt;/code&gt;, &lt;code&gt;c++17&lt;/code&gt;, and experimentally &lt;code&gt;c++20&lt;/code&gt; and &lt;code&gt;c++23&lt;/code&gt;. It also provides some GNU extensions to the standard to enable more useful features. You can check out the detailed standard support &lt;a href=&quot;https://gcc.gnu.org/projects/cxx-status.html&quot;&gt;on gnu.org&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In this tutorial, you will learn how to compile C++ programs with the &lt;code&gt;g++&lt;/code&gt; compiler provided by GCC, and how to use &lt;a href=&quot;https://www.gnu.org/software/make/&quot;&gt;Make&lt;/a&gt; to automate the compilation process.&lt;/p&gt;
&lt;h2 id=&quot;installing-gcc&quot;&gt;Installing GCC&lt;/h2&gt;
&lt;p&gt;I’ll touch briefly on installing for Linux, Mac, and Windows.&lt;/p&gt;
&lt;h3 id=&quot;linux&quot;&gt;Linux&lt;/h3&gt;
&lt;p&gt;GCC is one of the most common tools in the unix world, and is available in every single Linux distribution. Here, I show you how to install the GNU toolchain for some famous distributions.&lt;/p&gt;
&lt;p&gt;For Ubuntu, you need to run the following command:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;sudo&lt;/span&gt; apt update &lt;span class=&quot;kw&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;sudo&lt;/span&gt; apt install build-essentials&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Arch Linux, run:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;sudo&lt;/span&gt; pacman &lt;span class=&quot;at&quot;&gt;-S&lt;/span&gt; base-devel&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For &lt;a href=&quot;/blog/creating-and-hosting-your-own-rpm-packages-and-yum-repo&quot;&gt;Fedora&lt;/a&gt;, run:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;dnf&lt;/span&gt; groupinstall &lt;span class=&quot;st&quot;&gt;&amp;#39;Development Tools&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For other distributions, consult the official wiki of your distribution.&lt;/p&gt;
&lt;h3 id=&quot;mac&quot;&gt;Mac&lt;/h3&gt;
&lt;p&gt;To install GCC on Mac, run &lt;code&gt;brew install gcc&lt;/code&gt; which will place &lt;code&gt;g++-11&lt;/code&gt; in &lt;code&gt;/usr/local/bin&lt;/code&gt;. Then create an alias to &lt;code&gt;g++&lt;/code&gt;: &lt;code&gt;alias g++='g++-11'&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&quot;windows&quot;&gt;Windows&lt;/h3&gt;
&lt;p&gt;To use GCC in Windows, use &lt;a href=&quot;https://docs.microsoft.com/en-us/windows/wsl/install-win10&quot;&gt;WSL2&lt;/a&gt;. You can install GCC inside the Windows Subsystem for Linux (WSL) and use it from there.&lt;/p&gt;
&lt;h2 id=&quot;compiling-with-g&quot;&gt;Compiling With G++&lt;/h2&gt;
&lt;p&gt;Let’s take a look at how the compilation with G++ works. You will compile a simple &lt;code&gt;Hello, World!&lt;/code&gt; program. Save the following file as &lt;code&gt;hello.cpp&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode cpp&quot;&gt;&lt;code class=&quot;sourceCode cpp&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include&lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; main&lt;span class=&quot;op&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-4&quot;&gt;&lt;a href=&quot;#cb4-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;bu&quot;&gt;std::&lt;/span&gt;cout&lt;span class=&quot;op&quot;&gt; &amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Hello, World!&amp;quot;&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;std::&lt;/span&gt;endl&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-5&quot;&gt;&lt;a href=&quot;#cb4-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-6&quot;&gt;&lt;a href=&quot;#cb4-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-7&quot;&gt;&lt;a href=&quot;#cb4-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To compile this file, simply pass this file to &lt;code&gt;g++&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;g++&lt;/span&gt; hello.cpp&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;By default, &lt;code&gt;g++&lt;/code&gt; will create an executable file named &lt;code&gt;a.out&lt;/code&gt;. You can change the output file name by passing the name to the &lt;code&gt;-o&lt;/code&gt; flag.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;g++&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-o&lt;/span&gt; hello hello.cpp&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will compile &lt;code&gt;hello.cpp&lt;/code&gt; to an executable named &lt;code&gt;hello&lt;/code&gt;. You can run the executable and see the output:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb7&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb7-1&quot;&gt;&lt;a href=&quot;#cb7-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;./hello&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;the-compilation-process&quot;&gt;The Compilation Process&lt;/h2&gt;
&lt;p&gt;Although the compilation can be done with one command, the compilation process can be divided into four distinct phases:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Preprocessing&lt;/li&gt;
&lt;li&gt;Compilation&lt;/li&gt;
&lt;li&gt;Assembly&lt;/li&gt;
&lt;li&gt;Linking&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In the preprocessing part, the GNU preprocessor (&lt;code&gt;cpp&lt;/code&gt;) is invoked, which copies the header files included via &lt;code&gt;#include&lt;/code&gt;, and expands all macros defined with &lt;code&gt;#define&lt;/code&gt;. You can perform this step manually by running the &lt;code&gt;cpp&lt;/code&gt; command.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb8&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb8-1&quot;&gt;&lt;a href=&quot;#cb8-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;cpp&lt;/span&gt; hello.cpp &lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; hello.i&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The file &lt;code&gt;hello.i&lt;/code&gt; contains the preprocessed source code.&lt;/p&gt;
&lt;p&gt;In the next phase, the &lt;code&gt;g++&lt;/code&gt; compiler compiles the preprocessed source code to assembly language. You can run this step manually with the following command:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb9&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb9-1&quot;&gt;&lt;a href=&quot;#cb9-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;g++&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-S&lt;/span&gt; hello.i&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code&gt;-S&lt;/code&gt; flag creates a file &lt;code&gt;hello.s&lt;/code&gt;, which contains the assembly code.&lt;/p&gt;
&lt;p&gt;In the next step, the assembler &lt;code&gt;as&lt;/code&gt; converts the assembly to machine code.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-o&lt;/span&gt; hello.o hello.s&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Finally, the linker &lt;code&gt;ld&lt;/code&gt; links the object code with the library code to produce an executable.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;ld&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-o&lt;/span&gt; hello hello.o ...libraries...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code&gt;libraries&lt;/code&gt; argument above is a long list of libraries that you need to find out. I omitted the exact arguments because the list is really long and complicated, and depends on which libraries &lt;code&gt;g++&lt;/code&gt; is using on your system. If you are interested to find out, you can run the command &lt;code&gt;g++ -Q -v -o hello hello.cpp&lt;/code&gt; and take a look at the last line where &lt;code&gt;g++&lt;/code&gt; invokes &lt;code&gt;collect2&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/g++-makefile/libs.png&quot; alt=&quot;Libraries Used By g++&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Libraries Used By g++&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/div&gt;
&lt;p&gt;Thankfully, you do not have to perform these steps manually, as invoking &lt;code&gt;g++&lt;/code&gt; itself will take care of all these steps.&lt;/p&gt;
&lt;h2 id=&quot;using-the-make-utility&quot;&gt;Using the &lt;code&gt;make&lt;/code&gt; Utility&lt;/h2&gt;
&lt;p&gt;Even though the compilation commands have been simple so far, this is not necessarily the case when you have multiple source files. As an example, consider this program:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb12&quot;&gt;&lt;pre class=&quot;sourceCode cpp&quot;&gt;&lt;code class=&quot;sourceCode cpp&quot;&gt;&lt;span id=&quot;cb12-1&quot;&gt;&lt;a href=&quot;#cb12-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;quot;func.h&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-2&quot;&gt;&lt;a href=&quot;#cb12-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-3&quot;&gt;&lt;a href=&quot;#cb12-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; main&lt;span class=&quot;op&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-4&quot;&gt;&lt;a href=&quot;#cb12-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    func&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-5&quot;&gt;&lt;a href=&quot;#cb12-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    func&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-6&quot;&gt;&lt;a href=&quot;#cb12-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;/span&gt;
&lt;span id=&quot;cb12-7&quot;&gt;&lt;a href=&quot;#cb12-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-8&quot;&gt;&lt;a href=&quot;#cb12-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figcaption&gt;
&lt;code&gt;hello.cpp&lt;/code&gt;
&lt;/figcaption&gt;
&lt;p&gt;This file includes &lt;code&gt;func.h&lt;/code&gt;, which contains the declaration for a simple function:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb13&quot;&gt;&lt;pre class=&quot;sourceCode cpp&quot;&gt;&lt;code class=&quot;sourceCode cpp&quot;&gt;&lt;span id=&quot;cb13-1&quot;&gt;&lt;a href=&quot;#cb13-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#ifndef MAKE_GPP_FUNC&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-2&quot;&gt;&lt;a href=&quot;#cb13-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#define MAKE_GPP_FUNC&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-3&quot;&gt;&lt;a href=&quot;#cb13-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-4&quot;&gt;&lt;a href=&quot;#cb13-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include&lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-5&quot;&gt;&lt;a href=&quot;#cb13-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-6&quot;&gt;&lt;a href=&quot;#cb13-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;void&lt;/span&gt; func&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; i&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-7&quot;&gt;&lt;a href=&quot;#cb13-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-8&quot;&gt;&lt;a href=&quot;#cb13-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#endif&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figcaption&gt;
&lt;code&gt;func.h&lt;/code&gt;
&lt;/figcaption&gt;
&lt;p&gt;Finally, the definition of &lt;code&gt;func&lt;/code&gt; resides in &lt;code&gt;func.cpp&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb14&quot;&gt;&lt;pre class=&quot;sourceCode cpp&quot;&gt;&lt;code class=&quot;sourceCode cpp&quot;&gt;&lt;span id=&quot;cb14-1&quot;&gt;&lt;a href=&quot;#cb14-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;quot;func.h&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb14-2&quot;&gt;&lt;a href=&quot;#cb14-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb14-3&quot;&gt;&lt;a href=&quot;#cb14-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;void&lt;/span&gt; func&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; i&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb14-4&quot;&gt;&lt;a href=&quot;#cb14-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;bu&quot;&gt;std::&lt;/span&gt;cout&lt;span class=&quot;op&quot;&gt; &amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;You passed: &amp;quot;&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; i &lt;span class=&quot;op&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;std::&lt;/span&gt;endl&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb14-5&quot;&gt;&lt;a href=&quot;#cb14-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figcaption&gt;
&lt;code&gt;func.c&lt;/code&gt;
&lt;/figcaption&gt;
&lt;p&gt;In order to compile your program, you need to compile both &lt;code&gt;hello.cpp&lt;/code&gt; and &lt;code&gt;func.cpp&lt;/code&gt;, since the former depends on the latter.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb15&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb15-1&quot;&gt;&lt;a href=&quot;#cb15-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;g++&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-o&lt;/span&gt; hello hello.cpp func.cpp&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you have more files, then you need to list all of them, while taking care to set the correct include paths and library paths. Moreover, if your code uses any library, you need to list those libraries, too. The resultant command is likely massive and difficult to remember and type. Also, the compilation command will compile all of the source files every time it is executed. But if some of the source files haven’t been modified since the last compilation, it’s a waste of time and resources to compile all the files. But keeping track of what has changed manually is also a difficult task.&lt;/p&gt;
&lt;p&gt;This is where the &lt;code&gt;make&lt;/code&gt; utility helps. &lt;code&gt;make&lt;/code&gt; lets you define your target, and how to reach the target and what are the dependencies. Then it automatically keeps track of which dependencies have changed and recompiles only the necessary parts.&lt;/p&gt;
&lt;p&gt;So let’s see how you can utilize &lt;code&gt;make&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&quot;the-makefile&quot;&gt;The Makefile&lt;/h2&gt;
&lt;p&gt;In order to let &lt;code&gt;make&lt;/code&gt; know what to do, you need to create a file named &lt;code&gt;Makefile&lt;/code&gt; in the root of your project. This file can also be named &lt;code&gt;makefile&lt;/code&gt; but is traditionally named &lt;code&gt;Makefile&lt;/code&gt; so that it appears near other important files such as &lt;code&gt;README&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Create an empty &lt;code&gt;Makefile&lt;/code&gt; in the project root and run the command &lt;code&gt;make&lt;/code&gt; from the project directory. You should see the following output:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make: *** No targets. Stop.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It means &lt;code&gt;make&lt;/code&gt; has found the Makefile, but since it is empty, it doesn’t know what to do.&lt;/p&gt;
&lt;p&gt;Now let’s see how you can utilize Makefile to tell &lt;code&gt;make&lt;/code&gt; what to do. The Makefile consists of a set of rules. Each rule has three parts—a target, a list of prerequisites, and a recipe—like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb17&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb17-1&quot;&gt;&lt;a href=&quot;#cb17-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;target:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; pre-req1 pre-req2 pre-req3 ...&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb17-2&quot;&gt;&lt;a href=&quot;#cb17-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    recipes&lt;/span&gt;
&lt;span id=&quot;cb17-3&quot;&gt;&lt;a href=&quot;#cb17-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;Note that there are tabs before the recipe lists. You can’t use any other whitespace character. You must use &lt;a href=&quot;/blog/repeatable-builds-every-time/#tips-for-taming-makefiles-in-large-teams&quot;&gt;tabs&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;When &lt;code&gt;make&lt;/code&gt; executes a target, it looks at its prerequisites. If those prerequisites have their own recipes, &lt;code&gt;make&lt;/code&gt; executes them and when all the prerequisites are ready for a target, it executes the corresponding recipe for the current target. For each target, the recipes are executed only if the target doesn’t exist or the prerequisites are newer than the target.&lt;/p&gt;
&lt;p&gt;Let’s update the &lt;code&gt;Makefile&lt;/code&gt; for the example program:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb18&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb18-1&quot;&gt;&lt;a href=&quot;#cb18-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;all:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; hello&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-2&quot;&gt;&lt;a href=&quot;#cb18-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-3&quot;&gt;&lt;a href=&quot;#cb18-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;hello:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; hello.o func.o&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-4&quot;&gt;&lt;a href=&quot;#cb18-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; g++ -o hello hello.o func.o&lt;/span&gt;
&lt;span id=&quot;cb18-5&quot;&gt;&lt;a href=&quot;#cb18-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-6&quot;&gt;&lt;a href=&quot;#cb18-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;func.o:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; func.cpp func.h&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-7&quot;&gt;&lt;a href=&quot;#cb18-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; g++ -c func.cpp&lt;/span&gt;
&lt;span id=&quot;cb18-8&quot;&gt;&lt;a href=&quot;#cb18-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-9&quot;&gt;&lt;a href=&quot;#cb18-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;hello.o:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; hello.cpp&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-10&quot;&gt;&lt;a href=&quot;#cb18-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; g++ -c hello.cpp&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now, run the &lt;code&gt;make&lt;/code&gt; command again. You should see the commands being run by &lt;code&gt;make&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;g++ -c hello.cpp
g++ -c func.cpp
g++ -o hello hello.o func.o&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And you’ll notice that an executable called &lt;code&gt;hello&lt;/code&gt; has been created in the directory. So, how did &lt;code&gt;make&lt;/code&gt; do that? Let’s analyze.&lt;/p&gt;
&lt;p&gt;When you run &lt;code&gt;make&lt;/code&gt; without any arguments, it executes the first target. In the Makefile, the &lt;code&gt;all&lt;/code&gt; target has a prerequisite &lt;code&gt;hello&lt;/code&gt;. So, &lt;code&gt;make&lt;/code&gt; looks for a rule to create &lt;code&gt;hello&lt;/code&gt;. The rule &lt;code&gt;hello&lt;/code&gt; has two prerequisites &lt;code&gt;hello.o&lt;/code&gt; and &lt;code&gt;func.o&lt;/code&gt;. Now, the target &lt;code&gt;hello.o&lt;/code&gt; depends on &lt;code&gt;hello.cpp&lt;/code&gt; which exists and is newer than the target &lt;code&gt;hello.o&lt;/code&gt; (which does not exist). So, &lt;code&gt;make&lt;/code&gt; now executes the recipe for &lt;code&gt;hello.o&lt;/code&gt; and runs the command &lt;code&gt;g++ -c hello.cpp&lt;/code&gt;. This creates the &lt;code&gt;hello.o&lt;/code&gt; file.&lt;/p&gt;
&lt;p&gt;Now &lt;code&gt;make&lt;/code&gt; starts resolving &lt;code&gt;func.o&lt;/code&gt;. Both of its pre-requisites exist and are newer than the target. So &lt;code&gt;make&lt;/code&gt; executes the command &lt;code&gt;g++ -c func.cpp&lt;/code&gt;. Now that the target &lt;code&gt;hello&lt;/code&gt; has both the prerequisites satisfied, its recipe can be executed and the &lt;code&gt;hello&lt;/code&gt; file is created.&lt;/p&gt;
&lt;p&gt;Now what happens if one of the files is changed? Let’s change the &lt;code&gt;hello.cpp&lt;/code&gt; file and change the &lt;code&gt;func(10)&lt;/code&gt; line to &lt;code&gt;func(20)&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb20&quot;&gt;&lt;pre class=&quot;sourceCode cpp&quot;&gt;&lt;code class=&quot;sourceCode cpp&quot;&gt;&lt;span id=&quot;cb20-1&quot;&gt;&lt;a href=&quot;#cb20-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;quot;func.h&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb20-2&quot;&gt;&lt;a href=&quot;#cb20-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb20-3&quot;&gt;&lt;a href=&quot;#cb20-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; main&lt;span class=&quot;op&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb20-4&quot;&gt;&lt;a href=&quot;#cb20-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    func&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb20-5&quot;&gt;&lt;a href=&quot;#cb20-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    func&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb20-6&quot;&gt;&lt;a href=&quot;#cb20-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;/span&gt;
&lt;span id=&quot;cb20-7&quot;&gt;&lt;a href=&quot;#cb20-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb20-8&quot;&gt;&lt;a href=&quot;#cb20-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now if you run &lt;code&gt;make&lt;/code&gt;, you’ll notice that it does not execute all the steps:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;g++ -c hello.cpp
g++ -o hello hello.o func.o&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This time, &lt;code&gt;make&lt;/code&gt; does not compile &lt;code&gt;func.c&lt;/code&gt; because the file &lt;code&gt;func.o&lt;/code&gt; exists, and its prerequisites are not newer than itself. This is because you have not changed &lt;code&gt;func.cpp&lt;/code&gt; or &lt;code&gt;func.h&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;On the other hand, the file &lt;code&gt;hello.cpp&lt;/code&gt; is newer than &lt;code&gt;hello.o&lt;/code&gt;. So it needs to be recompiled, and when &lt;code&gt;hello.o&lt;/code&gt; is re-created, the target &lt;code&gt;hello&lt;/code&gt; needs to be executed, since it depends on &lt;code&gt;hello.o&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;You can also call &lt;code&gt;make&lt;/code&gt; with the name of a specific rule. For example, running &lt;code&gt;make func.o&lt;/code&gt; will only run the rule for &lt;code&gt;func.o&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&quot;comments-in-makefile&quot;&gt;Comments in Makefile&lt;/h2&gt;
&lt;p&gt;You can have comments in Makefile, which start with a # and last till the end of the line.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb22&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb22-1&quot;&gt;&lt;a href=&quot;#cb22-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;all:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; hello &lt;/span&gt;&lt;span class=&quot;co&quot;&gt;# This is a comment&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb22-2&quot;&gt;&lt;a href=&quot;#cb22-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb22-3&quot;&gt;&lt;a href=&quot;#cb22-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;hello:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; hello.o&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb22-4&quot;&gt;&lt;a href=&quot;#cb22-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;using-variables&quot;&gt;Using Variables&lt;/h2&gt;
&lt;p&gt;Observe that in your Makefile, there are quite a lot of repetitions. For example:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb23&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb23-1&quot;&gt;&lt;a href=&quot;#cb23-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;func.o:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; func.cpp func.h&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb23-2&quot;&gt;&lt;a href=&quot;#cb23-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; g++ -c func.cpp&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this rule, we have the string &lt;code&gt;func&lt;/code&gt; repeated four times. Since here the base name of the source file and the compiled file are the same (&lt;code&gt;func&lt;/code&gt;), we can use variables to tidy up the rules. The variables not only make the Makefile cleaner, they can be overridden by the user so that they can customize the Makefile without editing it.&lt;/p&gt;
&lt;p&gt;A variable in Makefile starts with a &lt;code&gt;$&lt;/code&gt; and is enclosed in parentheses &lt;code&gt;()&lt;/code&gt;or braces &lt;code&gt;{}&lt;/code&gt;, unless it’s a single character variable.&lt;/p&gt;
&lt;p&gt;To set a variable, write a line starting with a variable name followed by &lt;code&gt;=&lt;/code&gt;, &lt;code&gt;:=&lt;/code&gt; or &lt;code&gt;::=&lt;/code&gt;, followed by the value of the variable:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb24&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb24-1&quot;&gt;&lt;a href=&quot;#cb24-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;objects &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; hello.o func.o&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Here the variable &lt;code&gt;objects&lt;/code&gt; is set to &lt;code&gt;hello.o func.o&lt;/code&gt;. Now whenever you use this variable in a rule, it will be replaced by its value.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb25&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb25-1&quot;&gt;&lt;a href=&quot;#cb25-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;objects &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; hello.o func.o&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-2&quot;&gt;&lt;a href=&quot;#cb25-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-3&quot;&gt;&lt;a href=&quot;#cb25-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;all:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; hello&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-4&quot;&gt;&lt;a href=&quot;#cb25-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-5&quot;&gt;&lt;a href=&quot;#cb25-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;hello:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;objects&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-6&quot;&gt;&lt;a href=&quot;#cb25-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    g++ -o hello &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;objects&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is the same as writing:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb26&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb26-1&quot;&gt;&lt;a href=&quot;#cb26-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;hello:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; hello.o func.o&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb26-2&quot;&gt;&lt;a href=&quot;#cb26-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    g++ -o hello hello.o func.o&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;There is another way of defining variables using the &lt;code&gt;?=&lt;/code&gt; operator. This defines the variable only if it has not been defined before.&lt;/p&gt;
&lt;p&gt;When you invoke &lt;code&gt;make&lt;/code&gt;, it converts all the environment variables available to it with a &lt;code&gt;make&lt;/code&gt; variable with the same name and value. This means you can set variables using environment variables. Also, you can override any variable by passing them while invoking make. For example, the &lt;code&gt;g++&lt;/code&gt; command can be invoked through a variable.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb27&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb27-1&quot;&gt;&lt;a href=&quot;#cb27-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;CXX &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; g++&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb27-2&quot;&gt;&lt;a href=&quot;#cb27-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;objects &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; hello.o func.o&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb27-3&quot;&gt;&lt;a href=&quot;#cb27-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb27-4&quot;&gt;&lt;a href=&quot;#cb27-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;all:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; hello&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb27-5&quot;&gt;&lt;a href=&quot;#cb27-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb27-6&quot;&gt;&lt;a href=&quot;#cb27-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;hello:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;objects&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb27-7&quot;&gt;&lt;a href=&quot;#cb27-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;CXX&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt; -o &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;objects&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now running &lt;code&gt;make&lt;/code&gt; will compile the files with &lt;code&gt;g++&lt;/code&gt;. However, the user can now substitute alternative if they want to.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb28&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb28-1&quot;&gt;&lt;a href=&quot;#cb28-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;make&lt;/span&gt; CXX=clang++&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now the files will be compiled by &lt;code&gt;clang++&lt;/code&gt; since &lt;code&gt;CXX=clang++&lt;/code&gt; overrides the variable &lt;code&gt;CXX&lt;/code&gt; defined in the Makefile.&lt;/p&gt;
&lt;h2 id=&quot;phony-target&quot;&gt;Phony Target&lt;/h2&gt;
&lt;p&gt;So far, you have only created files, but &lt;code&gt;make&lt;/code&gt; can also “clean” files. Usually it’s a good idea to have a &lt;code&gt;clean&lt;/code&gt; target to delete all the generated files, basically returning the project to a clean slate.&lt;/p&gt;
&lt;p&gt;Here is an example for your Makefile:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb29&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb29-1&quot;&gt;&lt;a href=&quot;#cb29-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;clean:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb29-2&quot;&gt;&lt;a href=&quot;#cb29-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    rm *.o hello&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can run it via &lt;code&gt;make clean&lt;/code&gt;. This cleans all the &lt;code&gt;.o&lt;/code&gt; files and the &lt;code&gt;hello&lt;/code&gt; file. Because the &lt;code&gt;rm&lt;/code&gt; command does not create a file named &lt;code&gt;clean&lt;/code&gt;, the &lt;code&gt;rm&lt;/code&gt; command will be executed every time you invoke &lt;code&gt;make clean&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;But if you ever create a file called &lt;code&gt;clean&lt;/code&gt; in the directory, &lt;code&gt;make&lt;/code&gt; will get confused. Since the &lt;code&gt;clean&lt;/code&gt; file is there, and the &lt;code&gt;clean&lt;/code&gt; target has no prerequisites, it is always considered to be newer than its prerequisites. Therefore, the recipe will not run.&lt;/p&gt;
&lt;p&gt;The same problem will arise with the &lt;code&gt;all&lt;/code&gt; target if there is ever a file named &lt;code&gt;all&lt;/code&gt;. To fix this, you can declare the targets to be “phony”.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb30&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb30-1&quot;&gt;&lt;a href=&quot;#cb30-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;.PHONY:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; all clean&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb30-2&quot;&gt;&lt;a href=&quot;#cb30-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb30-3&quot;&gt;&lt;a href=&quot;#cb30-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;clean:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb30-4&quot;&gt;&lt;a href=&quot;#cb30-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    rm *.o hello&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Makefile is one of the most important components of compiling C++ using &lt;code&gt;g++&lt;/code&gt;. It makes compilation easy and predictable and also saves time and resources by compiling only the necessary files. In this tutorial you learned how to install &lt;code&gt;g++&lt;/code&gt;, and compile C++ programs with &lt;code&gt;g++&lt;/code&gt;. You also learned how to write Makefiles and utilize &lt;code&gt;make&lt;/code&gt; for increased productivity and automation.&lt;/p&gt;
&lt;p&gt;Because &lt;code&gt;make&lt;/code&gt; is a feature rich utility and supports a wide range of systems, it has a steep learning curve. As your project grows in size, the Makefile also grows in complexity. If you are looking for a solution to avoid the complexities of Makefile, check out &lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt;. Earthly takes the best ideas from Makefile and Dockerfile, and provides understandable and repeatable build scripts, minus the head-scratching parts of the Makefile.&lt;/p&gt;</content><author><name>Aniket Bhattacharyea</name></author><category term="Tutorials" /><summary type="html">C++ is one of the most dominant programming languages. Although there are many compilers available, GCC still ranks as one of the most popular choices for C++. GCC is part of the GNU toolchain, which comes with utilities like GNU make, GNU bison, and GNU AutoTools. What Is GCC? GNU Compiler Collection, also known as GCC, started as a C compiler, created by Richard Stallman in 1984 as a part of his GNU project. GCC now supports many languages, including C++, Objective C, Java, Fortran, and Go. The latest version as of writing this article is GCC 11.1, released April 27, 2021. The C++ compiler of GCC is known as g++. The g++ utility supports almost all mainstream C++ standards, including c++98, c++03, c++11, c++14, c++17, and experimentally c++20 and c++23. It also provides some GNU extensions to the standard to enable more useful features. You can check out the detailed standard support on gnu.org. In this tutorial, you will learn how to compile C++ programs with the g++ compiler provided by GCC, and how to use Make to automate the compilation process. Installing GCC I’ll touch briefly on installing for Linux, Mac, and Windows. Linux GCC is one of the most common tools in the unix world, and is available in every single Linux distribution. Here, I show you how to install the GNU toolchain for some famous distributions. For Ubuntu, you need to run the following command: sudo apt update &amp;amp;&amp;amp; sudo apt install build-essentials For Arch Linux, run: sudo pacman -S base-devel For Fedora, run: dnf groupinstall &amp;#39;Development Tools&amp;#39; For other distributions, consult the official wiki of your distribution. Mac To install GCC on Mac, run brew install gcc which will place g++-11 in /usr/local/bin. Then create an alias to g++: alias g++='g++-11'. Windows To use GCC in Windows, use WSL2. You can install GCC inside the Windows Subsystem for Linux (WSL) and use it from there. Compiling With G++ Let’s take a look at how the compilation with G++ works. You will compile a simple Hello, World! program. Save the following file as hello.cpp: #include&amp;lt;iostream&amp;gt; int main() { std::cout &amp;lt;&amp;lt; &amp;quot;Hello, World!&amp;quot; &amp;lt;&amp;lt; std::endl; return 0; } To compile this file, simply pass this file to g++: g++ hello.cpp By default, g++ will create an executable file named a.out. You can change the output file name by passing the name to the -o flag. g++ -o hello hello.cpp This will compile hello.cpp to an executable named hello. You can run the executable and see the output: ./hello The Compilation Process Although the compilation can be done with one command, the compilation process can be divided into four distinct phases: Preprocessing Compilation Assembly Linking In the preprocessing part, the GNU preprocessor (cpp) is invoked, which copies the header files included via #include, and expands all macros defined with #define. You can perform this step manually by running the cpp command. cpp hello.cpp &amp;gt; hello.i The file hello.i contains the preprocessed source code. In the next phase, the g++ compiler compiles the preprocessed source code to assembly language. You can run this step manually with the following command: g++ -S hello.i The -S flag creates a file hello.s, which contains the assembly code. In the next step, the assembler as converts the assembly to machine code. as -o hello.o hello.s Finally, the linker ld links the object code with the library code to produce an executable. ld -o hello hello.o ...libraries... The libraries argument above is a long list of libraries that you need to find out. I omitted the exact arguments because the list is really long and complicated, and depends on which libraries g++ is using on your system. If you are interested to find out, you can run the command g++ -Q -v -o hello hello.cpp and take a look at the last line where g++ invokes collect2 Libraries Used By g++ Thankfully, you do not have to perform these steps manually, as invoking g++ itself will take care of all these steps. Using the make Utility Even though the compilation commands have been simple so far, this is not necessarily the case when you have multiple source files. As an example, consider this program: #include &amp;quot;func.h&amp;quot; int main() { func(10); func(100); return 0; } hello.cpp This file includes func.h, which contains the declaration for a simple function: #ifndef MAKE_GPP_FUNC #define MAKE_GPP_FUNC #include&amp;lt;iostream&amp;gt; void func(int i); #endif func.h Finally, the definition of func resides in func.cpp: #include &amp;quot;func.h&amp;quot; void func(int i) { std::cout &amp;lt;&amp;lt; &amp;quot;You passed: &amp;quot; &amp;lt;&amp;lt; i &amp;lt;&amp;lt; std::endl; } func.c In order to compile your program, you need to compile both hello.cpp and func.cpp, since the former depends on the latter. g++ -o hello hello.cpp func.cpp If you have more files, then you need to list all of them, while taking care to set the correct include paths and library paths. Moreover, if your code uses any library, you need to list those libraries, too. The resultant command is likely massive and difficult to remember and type. Also, the compilation command will compile all of the source files every time it is executed. But if some of the source files haven’t been modified since the last compilation, it’s a waste of time and resources to compile all the files. But keeping track of what has changed manually is also a difficult task. This is where the make utility helps. make lets you define your target, and how to reach the target and what are the dependencies. Then it automatically keeps track of which dependencies have changed and recompiles only the necessary parts. So let’s see how you can utilize make. The Makefile In order to let make know what to do, you need to create a file named Makefile in the root of your project. This file can also be named makefile but is traditionally named Makefile so that it appears near other important files such as README. Create an empty Makefile in the project root and run the command make from the project directory. You should see the following output: make: *** No targets. Stop. It means make has found the Makefile, but since it is empty, it doesn’t know what to do. Now let’s see how you can utilize Makefile to tell make what to do. The Makefile consists of a set of rules. Each rule has three parts—a target, a list of prerequisites, and a recipe—like this: target: pre-req1 pre-req2 pre-req3 ... recipes ... Note that there are tabs before the recipe lists. You can’t use any other whitespace character. You must use tabs. When make executes a target, it looks at its prerequisites. If those prerequisites have their own recipes, make executes them and when all the prerequisites are ready for a target, it executes the corresponding recipe for the current target. For each target, the recipes are executed only if the target doesn’t exist or the prerequisites are newer than the target. Let’s update the Makefile for the example program: all: hello hello: hello.o func.o g++ -o hello hello.o func.o func.o: func.cpp func.h g++ -c func.cpp hello.o: hello.cpp g++ -c hello.cpp Now, run the make command again. You should see the commands being run by make: g++ -c hello.cpp g++ -c func.cpp g++ -o hello hello.o func.o And you’ll notice that an executable called hello has been created in the directory. So, how did make do that? Let’s analyze. When you run make without any arguments, it executes the first target. In the Makefile, the all target has a prerequisite hello. So, make looks for a rule to create hello. The rule hello has two prerequisites hello.o and func.o. Now, the target hello.o depends on hello.cpp which exists and is newer than the target hello.o (which does not exist). So, make now executes the recipe for hello.o and runs the command g++ -c hello.cpp. This creates the hello.o file. Now make starts resolving func.o. Both of its pre-requisites exist and are newer than the target. So make executes the command g++ -c func.cpp. Now that the target hello has both the prerequisites satisfied, its recipe can be executed and the hello file is created. Now what happens if one of the files is changed? Let’s change the hello.cpp file and change the func(10) line to func(20): #include &amp;quot;func.h&amp;quot; int main() { func(20); func(100); return 0; } Now if you run make, you’ll notice that it does not execute all the steps: g++ -c hello.cpp g++ -o hello hello.o func.o This time, make does not compile func.c because the file func.o exists, and its prerequisites are not newer than itself. This is because you have not changed func.cpp or func.h. On the other hand, the file hello.cpp is newer than hello.o. So it needs to be recompiled, and when hello.o is re-created, the target hello needs to be executed, since it depends on hello.o. You can also call make with the name of a specific rule. For example, running make func.o will only run the rule for func.o Comments in Makefile You can have comments in Makefile, which start with a # and last till the end of the line. all: hello # This is a comment hello: hello.o ... Using Variables Observe that in your Makefile, there are quite a lot of repetitions. For example: func.o: func.cpp func.h g++ -c func.cpp In this rule, we have the string func repeated four times. Since here the base name of the source file and the compiled file are the same (func), we can use variables to tidy up the rules. The variables not only make the Makefile cleaner, they can be overridden by the user so that they can customize the Makefile without editing it. A variable in Makefile starts with a $ and is enclosed in parentheses ()or braces {}, unless it’s a single character variable. To set a variable, write a line starting with a variable name followed by =, := or ::=, followed by the value of the variable: objects = hello.o func.o Here the variable objects is set to hello.o func.o. Now whenever you use this variable in a rule, it will be replaced by its value. objects = hello.o func.o all: hello hello: $(objects) g++ -o hello $(objects) This is the same as writing: hello: hello.o func.o g++ -o hello hello.o func.o There is another way of defining variables using the ?= operator. This defines the variable only if it has not been defined before. When you invoke make, it converts all the environment variables available to it with a make variable with the same name and value. This means you can set variables using environment variables. Also, you can override any variable by passing them while invoking make. For example, the g++ command can be invoked through a variable. CXX = g++ objects = hello.o func.o all: hello hello: $(objects) $(CXX) -o $(objects) Now running make will compile the files with g++. However, the user can now substitute alternative if they want to. make CXX=clang++ Now the files will be compiled by clang++ since CXX=clang++ overrides the variable CXX defined in the Makefile. Phony Target So far, you have only created files, but make can also “clean” files. Usually it’s a good idea to have a clean target to delete all the generated files, basically returning the project to a clean slate. Here is an example for your Makefile: clean: rm *.o hello You can run it via make clean. This cleans all the .o files and the hello file. Because the rm command does not create a file named clean, the rm command will be executed every time you invoke make clean. But if you ever create a file called clean in the directory, make will get confused. Since the clean file is there, and the clean target has no prerequisites, it is always considered to be newer than its prerequisites. Therefore, the recipe will not run. The same problem will arise with the all target if there is ever a file named all. To fix this, you can declare the targets to be “phony”. .PHONY: all clean clean: rm *.o hello Conclusion Makefile is one of the most important components of compiling C++ using g++. It makes compilation easy and predictable and also saves time and resources by compiling only the necessary files. In this tutorial you learned how to install g++, and compile C++ programs with g++. You also learned how to write Makefiles and utilize make for increased productivity and automation. Because make is a feature rich utility and supports a wide range of systems, it has a steep learning curve. As your project grows in size, the Makefile also grows in complexity. If you are looking for a solution to avoid the complexities of Makefile, check out Earthly. Earthly takes the best ideas from Makefile and Dockerfile, and provides understandable and repeatable build scripts, minus the head-scratching parts of the Makefile.</summary></entry><entry><title type="html">Python Concatenate Lists</title><link href="https://earthly.dev/blog/python-concatenate-lists/" rel="alternate" type="text/html" title="Python Concatenate Lists" /><published>2021-07-06T00:00:00-04:00</published><updated>2021-07-06T00:00:00-04:00</updated><id>https://earthly.dev/blog/python-concatenate-lists</id><content type="html" xml:base="https://earthly.dev/blog/python-concatenate-lists/">&lt;div class=&quot;narrow-code&quot;&gt;

&lt;h2 id=&quot;concatenate-two-lists-in-python&quot;&gt;Concatenate Two Lists in Python&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Problem:&lt;/strong&gt; You have two lists and you’d like to join them into a new list. Solution:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;Python &lt;span class=&quot;fl&quot;&gt;3.8.2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; one &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [&lt;span class=&quot;st&quot;&gt;&amp;quot;one&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;two&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;three&amp;quot;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; two &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [&lt;span class=&quot;st&quot;&gt;&amp;quot;four&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;five&amp;quot;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; one &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; two&lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;[&lt;span class=&quot;st&quot;&gt;&amp;#39;one&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;two&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;three&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;four&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;five&amp;#39;&lt;/span&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;notice--warning notice--big&quot;&gt;
&lt;p&gt;&lt;strong&gt;📢 TLDR: Use &lt;code&gt;+&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;In almost all simple situations, &lt;strong&gt;using &lt;code&gt;list1 + list2&lt;/code&gt; is the way you want to concatenate lists&lt;/strong&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The edge cases below are better in some situations, but &lt;code&gt;+&lt;/code&gt; is generally the best choice. All options covered work in Python 2.3, Python 2.7, and all versions of Python 3&lt;a href=&quot;#fn1&quot; class=&quot;footnote-ref&quot; id=&quot;fnref1&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;combine-lists-in-place-in-python&quot;&gt;Combine Lists In Place In Python&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Problem:&lt;/strong&gt; You have a huge list, and you want to add a smaller list on the end while minimizing memory usage.&lt;/p&gt;
&lt;p&gt;In this case, it may be best to append to the existing list, reusing it instead of recreating a new list.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;longlist &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [&lt;span class=&quot;st&quot;&gt;&amp;quot;one&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;two&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;three&amp;quot;&lt;/span&gt;] &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1000&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-2&quot;&gt;&lt;a href=&quot;#cb2-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;[&lt;span class=&quot;st&quot;&gt;&amp;#39;one&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;two&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;three&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;one&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;two&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;three&amp;#39;&lt;/span&gt;, ... ]&lt;/span&gt;
&lt;span id=&quot;cb2-3&quot;&gt;&lt;a href=&quot;#cb2-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;shortlist &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [&lt;span class=&quot;st&quot;&gt;&amp;quot;four&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;five&amp;quot;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb2-4&quot;&gt;&lt;a href=&quot;#cb2-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;[&lt;span class=&quot;st&quot;&gt;&amp;quot;four&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;five&amp;quot;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb2-5&quot;&gt;&lt;a href=&quot;#cb2-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; x.extend(y)&lt;/span&gt;
&lt;span id=&quot;cb2-6&quot;&gt;&lt;a href=&quot;#cb2-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; x&lt;/span&gt;
&lt;span id=&quot;cb2-7&quot;&gt;&lt;a href=&quot;#cb2-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;[&lt;span class=&quot;st&quot;&gt;&amp;#39;one&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;two&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;three&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;one&amp;#39;&lt;/span&gt;,  ..., &lt;span class=&quot;st&quot;&gt;&amp;quot;four&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;five&amp;quot;&lt;/span&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As with any optimization, you should verify that this reduces memory thrash in your specific case and stick to the simple idiomatic &lt;code&gt;x + y&lt;/code&gt; otherwise.&lt;/p&gt;
&lt;p&gt;Let’s use the &lt;a href=&quot;https://docs.python.org/3/library/timeit.html&quot;&gt;&lt;code&gt;timeit&lt;/code&gt;&lt;/a&gt; module to check some performance numbers.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# Performance Check&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; setup &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&amp;quot;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;x = [&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;,&amp;quot;three&amp;quot;] * 1000 &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-4&quot;&gt;&lt;a href=&quot;#cb3-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;y = [&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;,&amp;quot;six&amp;quot;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-5&quot;&gt;&lt;a href=&quot;#cb3-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-6&quot;&gt;&lt;a href=&quot;#cb3-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# x + y with large x&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-7&quot;&gt;&lt;a href=&quot;#cb3-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; timeit.timeit(&lt;span class=&quot;st&quot;&gt;&amp;#39;x + y&amp;#39;&lt;/span&gt;, setup&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;setup, number&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1000000&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb3-8&quot;&gt;&lt;a href=&quot;#cb3-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fl&quot;&gt;3.6260274310000113&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-9&quot;&gt;&lt;a href=&quot;#cb3-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# x.extend(y) with large x&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-10&quot;&gt;&lt;a href=&quot;#cb3-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; timeit.timeit(&lt;span class=&quot;st&quot;&gt;&amp;#39;x.extend(y)&amp;#39;&lt;/span&gt;, setup&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;setup, number&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1000000&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb3-11&quot;&gt;&lt;a href=&quot;#cb3-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fl&quot;&gt;0.06857255800002804&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this example, where x is 3000 elements, extend is around 50x faster.&lt;/p&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;❗ Concatenating Lists With Large Elements is Fine&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;If the elements in your list are huge (million character strings), but the list size is less than a thousand elements, the previous solution &lt;code&gt;x + y&lt;/code&gt; will work just fine. This is because Python stores references to the values in the list, not the values themselves. Thus, the element size makes no difference to the runtime complexity.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; x &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [&lt;span class=&quot;st&quot;&gt;&amp;quot;one&amp;quot;&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1000&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;two&amp;quot;&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1000&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;three&amp;quot;&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1000&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; y &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [&lt;span class=&quot;st&quot;&gt;&amp;quot;four&amp;quot;&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1000&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;five&amp;quot;&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1000&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;co&quot;&gt;#This is fine&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-4&quot;&gt;&lt;a href=&quot;#cb4-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; z &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; x &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; y&lt;/span&gt;
&lt;span id=&quot;cb4-5&quot;&gt;&lt;a href=&quot;#cb4-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;co&quot;&gt;#Performance Testing (extend is slower for large elements)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-6&quot;&gt;&lt;a href=&quot;#cb4-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;  setup &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&amp;quot;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-7&quot;&gt;&lt;a href=&quot;#cb4-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;x = [&amp;quot;one&amp;quot; * 1000, &amp;quot;two&amp;quot; * 1000, &amp;quot;three&amp;quot; * 1000]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-8&quot;&gt;&lt;a href=&quot;#cb4-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;y = [&amp;quot;four&amp;quot; * 1000, &amp;quot;five&amp;quot; * 1000]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-9&quot;&gt;&lt;a href=&quot;#cb4-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-10&quot;&gt;&lt;a href=&quot;#cb4-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; timeit.timeit(&lt;span class=&quot;st&quot;&gt;&amp;#39;x + y&amp;#39;&lt;/span&gt;, setup&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;setup, number&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1000000&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb4-11&quot;&gt;&lt;a href=&quot;#cb4-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fl&quot;&gt;0.05397573999994165&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-12&quot;&gt;&lt;a href=&quot;#cb4-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; timeit.timeit(&lt;span class=&quot;st&quot;&gt;&amp;#39;x.extend(y)&amp;#39;&lt;/span&gt;, setup&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;setup, number&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1000000&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb4-13&quot;&gt;&lt;a href=&quot;#cb4-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fl&quot;&gt;0.06511967799997365&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, &lt;code&gt;extend&lt;/code&gt; does not have an advantage.&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;avoid-chain-from-itertools-for-two-lists&quot;&gt;Avoid Chain From &lt;code&gt;itertools&lt;/code&gt; For Two Lists&lt;/h3&gt;
&lt;p&gt;It is possible to use &lt;code&gt;chain&lt;/code&gt; from &lt;code&gt;itertools&lt;/code&gt; to create an iterable of two lists.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;longlist &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [&lt;span class=&quot;st&quot;&gt;&amp;quot;one&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;two&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;three&amp;quot;&lt;/span&gt;] &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1000&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-2&quot;&gt;&lt;a href=&quot;#cb5-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;[&lt;span class=&quot;st&quot;&gt;&amp;#39;one&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;two&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;three&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;one&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;two&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;three&amp;#39;&lt;/span&gt;,, .......... ]&lt;/span&gt;
&lt;span id=&quot;cb5-3&quot;&gt;&lt;a href=&quot;#cb5-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;shortlist &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [&lt;span class=&quot;st&quot;&gt;&amp;quot;four&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;five&amp;quot;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb5-4&quot;&gt;&lt;a href=&quot;#cb5-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;[&lt;span class=&quot;st&quot;&gt;&amp;quot;four&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;five&amp;quot;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb5-5&quot;&gt;&lt;a href=&quot;#cb5-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;im&quot;&gt;from&lt;/span&gt; itertools &lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; chain&lt;/span&gt;
&lt;span id=&quot;cb5-6&quot;&gt;&lt;a href=&quot;#cb5-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; z &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;list&lt;/span&gt;(chain(longlist, shortlist)&lt;/span&gt;
&lt;span id=&quot;cb5-7&quot;&gt;&lt;a href=&quot;#cb5-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;[&lt;span class=&quot;st&quot;&gt;&amp;#39;one&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;two&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;three&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;one&amp;#39;&lt;/span&gt;, , .........., &lt;span class=&quot;st&quot;&gt;&amp;quot;four&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;five&amp;quot;&lt;/span&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We can check the performance of using chain:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; setup &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&amp;quot;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-2&quot;&gt;&lt;a href=&quot;#cb6-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;from itertools import chain&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-3&quot;&gt;&lt;a href=&quot;#cb6-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;x = [&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;,&amp;quot;three&amp;quot;] * 1000 &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-4&quot;&gt;&lt;a href=&quot;#cb6-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;y = [&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;,&amp;quot;six&amp;quot;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-5&quot;&gt;&lt;a href=&quot;#cb6-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-6&quot;&gt;&lt;a href=&quot;#cb6-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# x + y with large x&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-7&quot;&gt;&lt;a href=&quot;#cb6-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# x.extend(y) with large x&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-8&quot;&gt;&lt;a href=&quot;#cb6-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; timeit.timeit(&lt;span class=&quot;st&quot;&gt;&amp;#39;x.extend(y)&amp;#39;&lt;/span&gt;, setup&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;setup, number&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1000000&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb6-9&quot;&gt;&lt;a href=&quot;#cb6-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fl&quot;&gt;0.06857255800002804&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-10&quot;&gt;&lt;a href=&quot;#cb6-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; timeit.timeit(&lt;span class=&quot;st&quot;&gt;&amp;#39;list(chain(x, y))&amp;#39;&lt;/span&gt;, setup&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;setup, number&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1000000&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb6-11&quot;&gt;&lt;a href=&quot;#cb6-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fl&quot;&gt;16.810488051999982&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Using &lt;code&gt;chain&lt;/code&gt; with two lists is slower in all cases tested, and &lt;code&gt;x + y&lt;/code&gt; is easier to understand.&lt;/p&gt;
&lt;h2 id=&quot;combining-n-lists-in-python&quot;&gt;Combining N Lists in Python&lt;/h2&gt;
&lt;p&gt;If you need to add three or even ten lists together and the lists are statically known, then &lt;code&gt;+&lt;/code&gt; for concatenate works great.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb7&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb7-1&quot;&gt;&lt;a href=&quot;#cb7-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; one &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [&lt;span class=&quot;st&quot;&gt;&amp;quot;one&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;two&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;three&amp;quot;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb7-2&quot;&gt;&lt;a href=&quot;#cb7-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; two &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [&lt;span class=&quot;st&quot;&gt;&amp;quot;four&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;five&amp;quot;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb7-3&quot;&gt;&lt;a href=&quot;#cb7-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; three &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb7-4&quot;&gt;&lt;a href=&quot;#cb7-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; z &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; one &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; two &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; three&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;flatten-a-list-of-lists-in-python&quot;&gt;Flatten a List of Lists in Python&lt;/h2&gt;
&lt;p&gt;However, if the number of lists is dynamic and unknown until runtime, &lt;code&gt;chain&lt;/code&gt; from &lt;code&gt;itertools&lt;/code&gt; becomes a great option. Chain takes a list of lists and flattens it into a single list.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb8&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb8-1&quot;&gt;&lt;a href=&quot;#cb8-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; l &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [[&lt;span class=&quot;st&quot;&gt;&amp;quot;one&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;two&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;three&amp;quot;&lt;/span&gt;],[&lt;span class=&quot;st&quot;&gt;&amp;quot;four&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;five&amp;quot;&lt;/span&gt;],[]] &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;99&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-2&quot;&gt;&lt;a href=&quot;#cb8-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;[[&lt;span class=&quot;st&quot;&gt;&amp;#39;one&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;two&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;three&amp;#39;&lt;/span&gt;], [&lt;span class=&quot;st&quot;&gt;&amp;#39;four&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;five&amp;#39;&lt;/span&gt;], [], ...&lt;/span&gt;
&lt;span id=&quot;cb8-3&quot;&gt;&lt;a href=&quot;#cb8-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;list&lt;/span&gt;(chain.from_iterable(l))&lt;/span&gt;
&lt;span id=&quot;cb8-4&quot;&gt;&lt;a href=&quot;#cb8-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;[&lt;span class=&quot;st&quot;&gt;&amp;#39;one&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;two&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;three&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;four&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;five&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;one&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;two&amp;#39;&lt;/span&gt;, ... ]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;chain&lt;/code&gt; can take anything iterable, making it an excellent choice for combining lists, dictionaries, and other iterable structures.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb9&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb9-1&quot;&gt;&lt;a href=&quot;#cb9-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;im&quot;&gt;from&lt;/span&gt; itertools &lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; chain&lt;/span&gt;
&lt;span id=&quot;cb9-2&quot;&gt;&lt;a href=&quot;#cb9-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; one &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb9-3&quot;&gt;&lt;a href=&quot;#cb9-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; two &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; {&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;}&lt;/span&gt;
&lt;span id=&quot;cb9-4&quot;&gt;&lt;a href=&quot;#cb9-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;list&lt;/span&gt;(chain(one, two, one))&lt;/span&gt;
&lt;span id=&quot;cb9-5&quot;&gt;&lt;a href=&quot;#cb9-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;[&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;performance-of-flattening-a-list-of-lists&quot;&gt;Performance of Flattening a List of Lists&lt;/h3&gt;
&lt;p&gt;Performance doesn’t always matter, but readability always does, and the chain method is a straightforward way to combine lists of lists. That said, let’s put readability aside for a moment and try to find the fastest way to flatten lists.&lt;/p&gt;
&lt;p&gt;One option is iterating ourselves:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;result &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb10-2&quot;&gt;&lt;a href=&quot;#cb10-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; nestedlist &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; l:&lt;/span&gt;
&lt;span id=&quot;cb10-3&quot;&gt;&lt;a href=&quot;#cb10-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    result.extend(nestedlist)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let’s check its performance vs chain:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; setup &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&amp;quot;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-2&quot;&gt;&lt;a href=&quot;#cb11-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;from itertools import chain&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-3&quot;&gt;&lt;a href=&quot;#cb11-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;l = [[&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;],[&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;],[]] * 99&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-4&quot;&gt;&lt;a href=&quot;#cb11-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-5&quot;&gt;&lt;a href=&quot;#cb11-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;co&quot;&gt;# Add Nested Lists using chain.from_iterable&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-6&quot;&gt;&lt;a href=&quot;#cb11-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; timeit.timeit(&lt;span class=&quot;st&quot;&gt;&amp;#39;list(chain.from_iterable(l))&amp;#39;&lt;/span&gt;, setup&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;setup, number&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100000&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb11-7&quot;&gt;&lt;a href=&quot;#cb11-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fl&quot;&gt;1.0384087909997106&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-8&quot;&gt;&lt;a href=&quot;#cb11-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;co&quot;&gt;### Add using our own iteration&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-9&quot;&gt;&lt;a href=&quot;#cb11-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; run &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&amp;quot;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-10&quot;&gt;&lt;a href=&quot;#cb11-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;result = []&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-11&quot;&gt;&lt;a href=&quot;#cb11-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;for nestedlist in l:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-12&quot;&gt;&lt;a href=&quot;#cb11-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;    result.extend(nestedlist)  &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-13&quot;&gt;&lt;a href=&quot;#cb11-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-14&quot;&gt;&lt;a href=&quot;#cb11-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; timeit.timeit(run, setup&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;setup, number&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100000&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb11-15&quot;&gt;&lt;a href=&quot;#cb11-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fl&quot;&gt;1.8619721710001613&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This shows that &lt;code&gt;chain.from_iterable&lt;/code&gt; is faster than extend.&lt;/p&gt;
&lt;h2 id=&quot;flattening-and-merging-lists-with-one-big-list&quot;&gt;Flattening and Merging Lists With One Big List&lt;/h2&gt;
&lt;p&gt;What about adding a list of lists to an existing and large list? We saw that using extend can be faster with two lists when one is significantly longer than the other so let’s test the performance of &lt;code&gt;extend&lt;/code&gt; with N lists.&lt;/p&gt;
&lt;p&gt;First, we use our standard &lt;code&gt;chain.from_iterable&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb12&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb12-1&quot;&gt;&lt;a href=&quot;#cb12-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;co&quot;&gt;# Method 1 - chain.from_iterable &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-2&quot;&gt;&lt;a href=&quot;#cb12-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; longlist &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [&lt;span class=&quot;st&quot;&gt;&amp;quot;one&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;two&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;three&amp;quot;&lt;/span&gt;] &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1000&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-3&quot;&gt;&lt;a href=&quot;#cb12-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; nestedlist &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [longlist, [&lt;span class=&quot;st&quot;&gt;&amp;quot;one&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;two&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;three&amp;quot;&lt;/span&gt;],[&lt;span class=&quot;st&quot;&gt;&amp;quot;four&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;five&amp;quot;&lt;/span&gt;],[]]&lt;/span&gt;
&lt;span id=&quot;cb12-4&quot;&gt;&lt;a href=&quot;#cb12-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;list&lt;/span&gt;(chain.from_iterable(nestedlist))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We then test its performance:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb13&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb13-1&quot;&gt;&lt;a href=&quot;#cb13-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; setup &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&amp;quot;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-2&quot;&gt;&lt;a href=&quot;#cb13-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;from itertools import chain&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-3&quot;&gt;&lt;a href=&quot;#cb13-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;longlist = [&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;] * 1000;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-4&quot;&gt;&lt;a href=&quot;#cb13-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;combinedlist = [longlist, [&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;],[&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;],[]]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-5&quot;&gt;&lt;a href=&quot;#cb13-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-6&quot;&gt;&lt;a href=&quot;#cb13-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; timeit.timeit(&lt;span class=&quot;st&quot;&gt;&amp;#39;list(chain.from_iterable(combinedlist))&amp;#39;&lt;/span&gt;, setup&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;setup, number&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100000&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb13-7&quot;&gt;&lt;a href=&quot;#cb13-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fl&quot;&gt;1.8676087710009597&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Next, let’s try concatenating by adding everything onto the long list:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb14&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb14-1&quot;&gt;&lt;a href=&quot;#cb14-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;co&quot;&gt;# Method 2 - extend&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb14-2&quot;&gt;&lt;a href=&quot;#cb14-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;  longlist &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [&lt;span class=&quot;st&quot;&gt;&amp;quot;one&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;two&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;three&amp;quot;&lt;/span&gt;] &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1000&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb14-3&quot;&gt;&lt;a href=&quot;#cb14-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;  nestedlist &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [[&lt;span class=&quot;st&quot;&gt;&amp;quot;one&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;two&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;three&amp;quot;&lt;/span&gt;],[&lt;span class=&quot;st&quot;&gt;&amp;quot;four&amp;quot;&lt;/span&gt;,&lt;span class=&quot;st&quot;&gt;&amp;quot;five&amp;quot;&lt;/span&gt;],[]]&lt;/span&gt;
&lt;span id=&quot;cb14-4&quot;&gt;&lt;a href=&quot;#cb14-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; item &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; nestedlist:&lt;/span&gt;
&lt;span id=&quot;cb14-5&quot;&gt;&lt;a href=&quot;#cb14-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;     longlist.extent(item)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Performance Test:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb15&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb15-1&quot;&gt;&lt;a href=&quot;#cb15-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; setup &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&amp;quot;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-2&quot;&gt;&lt;a href=&quot;#cb15-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;from itertools import chain&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-3&quot;&gt;&lt;a href=&quot;#cb15-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;longlist = [&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;] * 1000;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-4&quot;&gt;&lt;a href=&quot;#cb15-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;nestedlist = [[&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;],[&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;],[]]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-5&quot;&gt;&lt;a href=&quot;#cb15-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-6&quot;&gt;&lt;a href=&quot;#cb15-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; run &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&amp;quot;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-7&quot;&gt;&lt;a href=&quot;#cb15-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;for item in nestedlist:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-8&quot;&gt;&lt;a href=&quot;#cb15-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;   longlist.extend(item)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-9&quot;&gt;&lt;a href=&quot;#cb15-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;   &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-10&quot;&gt;&lt;a href=&quot;#cb15-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; timeit.timeit(run, setup&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;setup, number&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100000&lt;/span&gt;) &lt;/span&gt;
&lt;span id=&quot;cb15-11&quot;&gt;&lt;a href=&quot;#cb15-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fl&quot;&gt;0.02403609199973289&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;There we go, &lt;code&gt;extend&lt;/code&gt; is much faster when flattening lists or concatenating many lists with one long list. If you encounter this, using &lt;code&gt;extend&lt;/code&gt; to add the smaller lists to the long list can decrease the work that has to be done and increase performance.&lt;/p&gt;
&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;
&lt;p&gt;These are the main variants of combining lists in python. Use this table to guide you in the future.&lt;/p&gt;
&lt;p&gt;Also, if you are looking for a nice way to standardize the processes around your python projects – running tests, installing dependencies, and linting code – take a look at Earthly for &lt;a href=&quot;https://earthly.dev/&quot;&gt;Repeatable Builds&lt;/a&gt;.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&quot;header&quot;&gt;
&lt;th&gt;Condition&lt;/th&gt;
&lt;th&gt;Solution&lt;/th&gt;
&lt;th style=&quot;text-align: center;&quot;&gt;Performance Optimization&lt;a href=&quot;#fn2&quot; class=&quot;footnote-ref&quot; id=&quot;fnref2&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td&gt;2 lists&lt;/td&gt;
&lt;td&gt;&lt;code&gt;x + y&lt;/code&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;No&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td&gt;1 large list, 1 small list&lt;/td&gt;
&lt;td&gt;&lt;code&gt;x.extend(y)&lt;/code&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;Yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td&gt;Known number of N lists&lt;/td&gt;
&lt;td&gt;&lt;code&gt;x + y + z&lt;/code&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;No&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td&gt;Unknown number of N lists&lt;/td&gt;
&lt;td&gt;&lt;code&gt;list(chain.from_iterable(l))&lt;/code&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;No&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td&gt;List of Lists&lt;/td&gt;
&lt;td&gt;&lt;code&gt;list(chain.from_iterable(l))&lt;/code&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;No&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td&gt;1 large list, many small lists&lt;/td&gt;
&lt;td&gt;&lt;code&gt;for l1 in l: x.extend(...)&lt;/code&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;Yes&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;section class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&quot;fn1&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;I did all the performance testing using Python 3.9.5 on MacOS BigSur.&lt;a href=&quot;#fnref1&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn2&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;If you don’t have a performance bottleneck, clarity trumps performance, and you should ignore the performance suggestions.&lt;/p&gt;
&lt;/div&gt;
&lt;a href=&quot;#fnref2&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;</content><author><name>Adam Gordon Bell</name></author><category term="Tutorials" /><summary type="html">Concatenate Two Lists in Python Problem: You have two lists and you’d like to join them into a new list. Solution: Python 3.8.2 &amp;gt;&amp;gt;&amp;gt; one = [&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;] &amp;gt;&amp;gt;&amp;gt; two = [&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;] &amp;gt;&amp;gt;&amp;gt; one + two [&amp;#39;one&amp;#39;, &amp;#39;two&amp;#39;, &amp;#39;three&amp;#39;, &amp;#39;four&amp;#39;, &amp;#39;five&amp;#39;] 📢 TLDR: Use + In almost all simple situations, using list1 + list2 is the way you want to concatenate lists. The edge cases below are better in some situations, but + is generally the best choice. All options covered work in Python 2.3, Python 2.7, and all versions of Python 31. Combine Lists In Place In Python Problem: You have a huge list, and you want to add a smaller list on the end while minimizing memory usage. In this case, it may be best to append to the existing list, reusing it instead of recreating a new list. &amp;gt;&amp;gt;&amp;gt;longlist = [&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;] * 1000 [&amp;#39;one&amp;#39;, &amp;#39;two&amp;#39;, &amp;#39;three&amp;#39;, &amp;#39;one&amp;#39;, &amp;#39;two&amp;#39;, &amp;#39;three&amp;#39;, ... ] &amp;gt;&amp;gt;&amp;gt;shortlist = [&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;] [&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;] &amp;gt;&amp;gt;&amp;gt; x.extend(y) &amp;gt;&amp;gt;&amp;gt; x [&amp;#39;one&amp;#39;, &amp;#39;two&amp;#39;, &amp;#39;three&amp;#39;, &amp;#39;one&amp;#39;, ..., &amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;] As with any optimization, you should verify that this reduces memory thrash in your specific case and stick to the simple idiomatic x + y otherwise. Let’s use the timeit module to check some performance numbers. # Performance Check &amp;gt;&amp;gt;&amp;gt; setup = &amp;quot;&amp;quot;&amp;quot;\ x = [&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;,&amp;quot;three&amp;quot;] * 1000 y = [&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;,&amp;quot;six&amp;quot;] &amp;quot;&amp;quot;&amp;quot; # x + y with large x &amp;gt;&amp;gt;&amp;gt; timeit.timeit(&amp;#39;x + y&amp;#39;, setup=setup, number=1000000) 3.6260274310000113 # x.extend(y) with large x &amp;gt;&amp;gt;&amp;gt; timeit.timeit(&amp;#39;x.extend(y)&amp;#39;, setup=setup, number=1000000) 0.06857255800002804 In this example, where x is 3000 elements, extend is around 50x faster. ❗ Concatenating Lists With Large Elements is Fine If the elements in your list are huge (million character strings), but the list size is less than a thousand elements, the previous solution x + y will work just fine. This is because Python stores references to the values in the list, not the values themselves. Thus, the element size makes no difference to the runtime complexity. &amp;gt;&amp;gt;&amp;gt; x = [&amp;quot;one&amp;quot; * 1000, &amp;quot;two&amp;quot; * 1000, &amp;quot;three&amp;quot; * 1000] &amp;gt;&amp;gt;&amp;gt; y = [&amp;quot;four&amp;quot; * 1000, &amp;quot;five&amp;quot; * 1000] &amp;gt;&amp;gt;&amp;gt; #This is fine &amp;gt;&amp;gt;&amp;gt; z = x + y &amp;gt;&amp;gt;&amp;gt; #Performance Testing (extend is slower for large elements) &amp;gt;&amp;gt;&amp;gt; setup = &amp;quot;&amp;quot;&amp;quot;\ x = [&amp;quot;one&amp;quot; * 1000, &amp;quot;two&amp;quot; * 1000, &amp;quot;three&amp;quot; * 1000] y = [&amp;quot;four&amp;quot; * 1000, &amp;quot;five&amp;quot; * 1000] &amp;quot;&amp;quot;&amp;quot; &amp;gt;&amp;gt;&amp;gt; timeit.timeit(&amp;#39;x + y&amp;#39;, setup=setup, number=1000000) 0.05397573999994165 &amp;gt;&amp;gt;&amp;gt; timeit.timeit(&amp;#39;x.extend(y)&amp;#39;, setup=setup, number=1000000) 0.06511967799997365 In this case, extend does not have an advantage. Avoid Chain From itertools For Two Lists It is possible to use chain from itertools to create an iterable of two lists. &amp;gt;&amp;gt;&amp;gt;longlist = [&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;] * 1000 [&amp;#39;one&amp;#39;, &amp;#39;two&amp;#39;, &amp;#39;three&amp;#39;, &amp;#39;one&amp;#39;, &amp;#39;two&amp;#39;, &amp;#39;three&amp;#39;,, .......... ] &amp;gt;&amp;gt;&amp;gt;shortlist = [&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;] [&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;] &amp;gt;&amp;gt;&amp;gt; from itertools import chain &amp;gt;&amp;gt;&amp;gt; z = list(chain(longlist, shortlist) [&amp;#39;one&amp;#39;, &amp;#39;two&amp;#39;, &amp;#39;three&amp;#39;, &amp;#39;one&amp;#39;, , .........., &amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;] We can check the performance of using chain: &amp;gt;&amp;gt;&amp;gt; setup = &amp;quot;&amp;quot;&amp;quot;\ from itertools import chain x = [&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;,&amp;quot;three&amp;quot;] * 1000 y = [&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;,&amp;quot;six&amp;quot;] &amp;quot;&amp;quot;&amp;quot; # x + y with large x # x.extend(y) with large x &amp;gt;&amp;gt;&amp;gt; timeit.timeit(&amp;#39;x.extend(y)&amp;#39;, setup=setup, number=1000000) 0.06857255800002804 &amp;gt;&amp;gt;&amp;gt; timeit.timeit(&amp;#39;list(chain(x, y))&amp;#39;, setup=setup, number=1000000) 16.810488051999982 Using chain with two lists is slower in all cases tested, and x + y is easier to understand. Combining N Lists in Python If you need to add three or even ten lists together and the lists are statically known, then + for concatenate works great. &amp;gt;&amp;gt;&amp;gt; one = [&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;] &amp;gt;&amp;gt;&amp;gt; two = [&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;] &amp;gt;&amp;gt;&amp;gt; three = [] &amp;gt;&amp;gt;&amp;gt; z = one + two + three Flatten a List of Lists in Python However, if the number of lists is dynamic and unknown until runtime, chain from itertools becomes a great option. Chain takes a list of lists and flattens it into a single list. &amp;gt;&amp;gt;&amp;gt; l = [[&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;],[&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;],[]] * 99 [[&amp;#39;one&amp;#39;, &amp;#39;two&amp;#39;, &amp;#39;three&amp;#39;], [&amp;#39;four&amp;#39;, &amp;#39;five&amp;#39;], [], ... &amp;gt;&amp;gt;&amp;gt; list(chain.from_iterable(l)) [&amp;#39;one&amp;#39;, &amp;#39;two&amp;#39;, &amp;#39;three&amp;#39;, &amp;#39;four&amp;#39;, &amp;#39;five&amp;#39;, &amp;#39;one&amp;#39;, &amp;#39;two&amp;#39;, ... ] chain can take anything iterable, making it an excellent choice for combining lists, dictionaries, and other iterable structures. &amp;gt;&amp;gt;&amp;gt; from itertools import chain &amp;gt;&amp;gt;&amp;gt; one = [1,2,3] &amp;gt;&amp;gt;&amp;gt; two = {1,2,3} &amp;gt;&amp;gt;&amp;gt; list(chain(one, two, one)) [1, 2, 3, 1, 2, 3, 1, 2, 3] Performance of Flattening a List of Lists Performance doesn’t always matter, but readability always does, and the chain method is a straightforward way to combine lists of lists. That said, let’s put readability aside for a moment and try to find the fastest way to flatten lists. One option is iterating ourselves: result = [] for nestedlist in l: result.extend(nestedlist) Let’s check its performance vs chain: &amp;gt;&amp;gt;&amp;gt; setup = &amp;quot;&amp;quot;&amp;quot;\ from itertools import chain l = [[&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;],[&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;],[]] * 99 &amp;quot;&amp;quot;&amp;quot; &amp;gt;&amp;gt;&amp;gt; # Add Nested Lists using chain.from_iterable &amp;gt;&amp;gt;&amp;gt; timeit.timeit(&amp;#39;list(chain.from_iterable(l))&amp;#39;, setup=setup, number=100000) 1.0384087909997106 &amp;gt;&amp;gt;&amp;gt; ### Add using our own iteration &amp;gt;&amp;gt;&amp;gt; run = &amp;quot;&amp;quot;&amp;quot;\ result = [] for nestedlist in l: result.extend(nestedlist) &amp;quot;&amp;quot;&amp;quot; &amp;gt;&amp;gt;&amp;gt; timeit.timeit(run, setup=setup, number=100000) 1.8619721710001613 This shows that chain.from_iterable is faster than extend. Flattening and Merging Lists With One Big List What about adding a list of lists to an existing and large list? We saw that using extend can be faster with two lists when one is significantly longer than the other so let’s test the performance of extend with N lists. First, we use our standard chain.from_iterable. &amp;gt;&amp;gt;&amp;gt; # Method 1 - chain.from_iterable &amp;gt;&amp;gt;&amp;gt; longlist = [&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;] * 1000 &amp;gt;&amp;gt;&amp;gt; nestedlist = [longlist, [&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;],[&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;],[]] &amp;gt;&amp;gt;&amp;gt; list(chain.from_iterable(nestedlist)) We then test its performance: &amp;gt;&amp;gt;&amp;gt; setup = &amp;quot;&amp;quot;&amp;quot;\ from itertools import chain longlist = [&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;] * 1000; combinedlist = [longlist, [&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;],[&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;],[]] &amp;quot;&amp;quot;&amp;quot; &amp;gt;&amp;gt;&amp;gt; timeit.timeit(&amp;#39;list(chain.from_iterable(combinedlist))&amp;#39;, setup=setup, number=100000) 1.8676087710009597 Next, let’s try concatenating by adding everything onto the long list: &amp;gt;&amp;gt;&amp;gt; # Method 2 - extend &amp;gt;&amp;gt;&amp;gt; longlist = [&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;] * 1000 &amp;gt;&amp;gt;&amp;gt; nestedlist = [[&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;],[&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;],[]] &amp;gt;&amp;gt;&amp;gt; for item in nestedlist: &amp;gt;&amp;gt;&amp;gt; longlist.extent(item) Performance Test: &amp;gt;&amp;gt;&amp;gt; setup = &amp;quot;&amp;quot;&amp;quot;\ from itertools import chain longlist = [&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;] * 1000; nestedlist = [[&amp;quot;one&amp;quot;,&amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;],[&amp;quot;four&amp;quot;,&amp;quot;five&amp;quot;],[]] &amp;quot;&amp;quot;&amp;quot; &amp;gt;&amp;gt;&amp;gt; run = &amp;quot;&amp;quot;&amp;quot;\ for item in nestedlist: longlist.extend(item) &amp;quot;&amp;quot;&amp;quot; &amp;gt;&amp;gt;&amp;gt; timeit.timeit(run, setup=setup, number=100000) 0.02403609199973289 There we go, extend is much faster when flattening lists or concatenating many lists with one long list. If you encounter this, using extend to add the smaller lists to the long list can decrease the work that has to be done and increase performance. Summary These are the main variants of combining lists in python. Use this table to guide you in the future. Also, if you are looking for a nice way to standardize the processes around your python projects – running tests, installing dependencies, and linting code – take a look at Earthly for Repeatable Builds. Condition Solution Performance Optimization2 2 lists x + y No 1 large list, 1 small list x.extend(y) Yes Known number of N lists x + y + z No Unknown number of N lists list(chain.from_iterable(l)) No List of Lists list(chain.from_iterable(l)) No 1 large list, many small lists for l1 in l: x.extend(...) Yes I did all the performance testing using Python 3.9.5 on MacOS BigSur.↩︎ If you don’t have a performance bottleneck, clarity trumps performance, and you should ignore the performance suggestions. ↩︎</summary></entry><entry><title type="html">SQL Errors and Video Cameras</title><link href="https://earthly.dev/blog/video-camera-on/" rel="alternate" type="text/html" title="SQL Errors and Video Cameras" /><published>2021-06-29T00:00:00-04:00</published><updated>2021-06-29T00:00:00-04:00</updated><id>https://earthly.dev/blog/video-camera-on</id><content type="html" xml:base="https://earthly.dev/blog/video-camera-on/">&lt;div class=&quot;narrow-code&quot;&gt;
&lt;p&gt;Some years ago, when I worked in a physical office, I was having trouble with a new report I was developing. The reasonably complex SQL that generated the report would sometimes be missing a single row that would reappear if I reran things.&lt;/p&gt;
&lt;p&gt;The SQL looked something like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode sql&quot;&gt;&lt;code class=&quot;sourceCode sql&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;-- sort and insert first partition into repo&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;INTO&lt;/span&gt; Report&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;SELECT&lt;/span&gt; name &lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; input1 &lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;BY&lt;/span&gt; val;&lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;/span&gt;
&lt;span id=&quot;cb1-6&quot;&gt;&lt;a href=&quot;#cb1-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; Report;&lt;/span&gt;
&lt;span id=&quot;cb1-7&quot;&gt;&lt;a href=&quot;#cb1-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;one&lt;/span&gt;
&lt;span id=&quot;cb1-8&quot;&gt;&lt;a href=&quot;#cb1-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;two&lt;/span&gt;
&lt;span id=&quot;cb1-9&quot;&gt;&lt;a href=&quot;#cb1-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;three &lt;span class=&quot;co&quot;&gt;-- yep&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-10&quot;&gt;&lt;a href=&quot;#cb1-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-11&quot;&gt;&lt;a href=&quot;#cb1-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;-- sort and insert second partition into repo&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-12&quot;&gt;&lt;a href=&quot;#cb1-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;INTO&lt;/span&gt; Report&lt;/span&gt;
&lt;span id=&quot;cb1-13&quot;&gt;&lt;a href=&quot;#cb1-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;SELECT&lt;/span&gt; name &lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; input2 &lt;/span&gt;
&lt;span id=&quot;cb1-14&quot;&gt;&lt;a href=&quot;#cb1-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;BY&lt;/span&gt; val;&lt;/span&gt;
&lt;span id=&quot;cb1-15&quot;&gt;&lt;a href=&quot;#cb1-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-16&quot;&gt;&lt;a href=&quot;#cb1-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; Report;&lt;/span&gt;
&lt;span id=&quot;cb1-17&quot;&gt;&lt;a href=&quot;#cb1-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;one&lt;/span&gt;
&lt;span id=&quot;cb1-18&quot;&gt;&lt;a href=&quot;#cb1-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;two&lt;/span&gt;
&lt;span id=&quot;cb1-19&quot;&gt;&lt;a href=&quot;#cb1-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;three&lt;/span&gt;
&lt;span id=&quot;cb1-20&quot;&gt;&lt;a href=&quot;#cb1-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;four &lt;/span&gt;
&lt;span id=&quot;cb1-21&quot;&gt;&lt;a href=&quot;#cb1-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;five &lt;/span&gt;
&lt;span id=&quot;cb1-22&quot;&gt;&lt;a href=&quot;#cb1-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;six &lt;span class=&quot;co&quot;&gt;-- yep&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-23&quot;&gt;&lt;a href=&quot;#cb1-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-24&quot;&gt;&lt;a href=&quot;#cb1-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;SELECT&lt;/span&gt; top &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; Report;&lt;/span&gt;
&lt;span id=&quot;cb1-25&quot;&gt;&lt;a href=&quot;#cb1-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;one&lt;/span&gt;
&lt;span id=&quot;cb1-26&quot;&gt;&lt;a href=&quot;#cb1-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;two&lt;/span&gt;
&lt;span id=&quot;cb1-27&quot;&gt;&lt;a href=&quot;#cb1-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;four &lt;span class=&quot;co&quot;&gt;-- wait, what?&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I was going to spend the morning tracking this down. That was my daily stand-up update. But when I gave it, I caught a look from my teammate Isabella (not her real name). The look helped me solve the problem. We’ll get to the solution in a moment, but I want to talk about that facial expression – I am always on the lookout for it now.&lt;/p&gt;
&lt;h2 id=&quot;the-wait-what-look&quot;&gt;The Wait-What? Look&lt;/h2&gt;
&lt;div class=&quot;align-right&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/video-camera-on/confused1-500-a0a7ebe24.webp 500w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/video-camera-on/confused1-500-b12c046e3.png 500w&quot; type=&quot;image/png&quot;&gt;&lt;img width=&quot;260px&quot; src=&quot;/blog/generated/assets/images/video-camera-on/confused1-800-b12c046e3.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
“I’ve traced it to a bug in the SMTP protocol”
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;I once saw someone go up to a post-office box and confidently empty their lunch garbage into it - like it was a food court garbage bin. I made the facial expression then - I could feel my lips pull to one side and my eyes narrow in confusion. Am I seeing this correctly?&lt;/p&gt;
&lt;p&gt;I’ve spotted this look in so many daily stand-ups since then. Usually, it’s very fleeting, but I try not to let it pass by unremarked because unpacking it can save so much time. It easy to thrash on a problem and forget some simple assumption you’ve made. This face is a sign you’ve overlooked something important.&lt;/p&gt;
&lt;p&gt;Are daily stand-ups valuable? Sometimes they are, and sometimes they aren’t&lt;a href=&quot;#fn1&quot; class=&quot;footnote-ref&quot; id=&quot;fnref1&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt;. If you’re blocked on something, then telling the team is essential, but you shouldn’t wait for the next stand-up to share that. There are also all kinds of social reasons why a stand-up is healthy. I work from my home office and have for many years, and a video stand-up is a great way to actually have some small talk, screen to screen, with my teammates. Some parts of a daily stand-up are just a status report, and I’m not sure that ‘what I did yesterday and what I’m doing today part’ is always valuable. But the actual off-topic parts of a stand-up – the part where I complain about how difficult it is to get a permit for building my deck, and where Alex explains about foraging for mushrooms – those parts help keep me sane and happy.&lt;/p&gt;
&lt;h2 id=&quot;thats-not-quite-right&quot;&gt;That’s Not Quite Right&lt;/h2&gt;
&lt;div class=&quot;align-left&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/video-camera-on/confused2-500-1f53a66bd.webp 500w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/video-camera-on/confused2-500-4089110d6.png 500w&quot; type=&quot;image/png&quot;&gt;&lt;img width=&quot;260px&quot; src=&quot;/blog/generated/assets/images/video-camera-on/confused2-800-4089110d6.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
“I’m inserting ‘foo’ but retrieving ‘disk is full’”
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;We are always simulating the world around us on some subconscious level. It helps us predict what is going to happen next. For example, my neighbor is out watering his grass right now – I can see him out my office window. If his hose wasn’t on, I’m not sure I would notice because I’m not paying that much attention. But if he casually jumped from the ground to the second-story roof of his house, it would become the center of my attention. It would trigger some that’s-not-quite-right effect, and I would unconsciously make that confused face.&lt;/p&gt;
&lt;p&gt;That is why a stand-up can be valuable, in person or screen to screen. You can give your update when you are stuck, and you can watch for that failed-simulation face. Then ask them what they are thinking. Chances are they know where you missed a step or where you have a false assumption. At the very least, you’ve violated their intuition about the problem, and unpacking that feeling is a good idea.&lt;/p&gt;
&lt;h2 id=&quot;non-verbal-communication-requires-cameras-on&quot;&gt;Non-Verbal Communication Requires Cameras On&lt;/h2&gt;
&lt;div class=&quot;align-right&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/video-camera-on/confused3-500-957022048.webp 500w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/video-camera-on/confused3-500-7d0fb7a4e.png 500w&quot; type=&quot;image/png&quot;&gt;&lt;img width=&quot;260px&quot; src=&quot;/blog/generated/assets/images/video-camera-on/confused3-800-7d0fb7a4e.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
“All users were created on a Thursday in 1970”
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;I’ve heard many times before that 70% of communication is non-verbal. This seems to oversell non-verbals or maybe I’m just not great at reading them. This whole confused-face signal could be replaced with chin-scratching emoji or a sign that said: “Wait, What?”. But, when I do get a non-verbal signal, it can save me hours and days of time. I don’t think you can easily replicate this signal with asynchronous communication. One reason is that these non-verbal cues often represent subtle feelings. Someone can hear your update and think to themselves, “That doesn’t sound right”, but they may not be comfortable enough or care enough to say it out loud. Or it’s just fleeting thought before they start their own update. You have to catch these expressions, and you can’t do it without seeing the person.&lt;/p&gt;
&lt;p&gt;This doesn’t mean that everyone should always be able to see everyone in every meeting. If you are joining a 50 person meeting with a single presenter and everyone has their camera off, then follow suit. If you are eating your lunch in a meeting, I don’t need to see or hear you chew. But if you are seeking help or giving help or pairing on an issue with me, then I want to see your face. The examples and facial expressions here are extreme but even just seeing that I’ve gone too fast and lost you, or that you’re starting to say something, can improve the fidelity of the conversation.&lt;/p&gt;
&lt;p&gt;People find zoom meetings fatiguing, and I get that. The world contains too many meetings. But I’m shocked when I talk to someone on a remote team that never uses video. If you’re not seeing your teammate’s face when you describe a problem, who knows what you are missing&lt;a href=&quot;#fn2&quot; class=&quot;footnote-ref&quot; id=&quot;fnref2&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;the-sql-solution&quot;&gt;The SQL Solution&lt;/h2&gt;
&lt;div class=&quot;align-left&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/video-camera-on/confused4-500-55b7c9ac2.webp 500w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/video-camera-on/confused4-500-4d79dd6c3.png 500w&quot; type=&quot;image/png&quot;&gt;&lt;img width=&quot;260px&quot; src=&quot;/blog/generated/assets/images/video-camera-on/confused4-800-4d79dd6c3.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
“the max message size in the queue&lt;br/&gt; is now 2 gigabytes”
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;So about the SQL. I got &lt;code&gt;the look&lt;/code&gt; from Isabella because a select statement like I was describing should be deterministic. Isabella’s spidey-sense told her either I was wrong about results changing or I was misusing SQL. It turned out to be the latter.&lt;/p&gt;
&lt;p&gt;You see, I was inserting records sorted and selecting them out without an explicit order. Also, my simple recounting of the report’s logic (and my code snippet above) was missing a critical detail – one I had forgotten about&lt;a href=&quot;#fn3&quot; class=&quot;footnote-ref&quot; id=&quot;fnref3&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt;. Sometimes I had to delete duplicate keys from the report table. Guess what happens when you insert things in-order into a table with deleted rows? Its implementation-specific, but sometimes, the invisible spaces left by the deleted rows will be filled in by the inserted data, undoing the insertion order. My row wasn’t missing. My data just wasn’t sorted correctly. Once I added in an &lt;code&gt;order by&lt;/code&gt; everything worked.&lt;/p&gt;
&lt;/div&gt;
&lt;!-- markdownlint-disable MD046 --&gt;
&lt;section class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&quot;fn1&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;&lt;a href=&quot;http://localhost:4002/blog/thought-leaders/&quot;&gt;Like everything&lt;/a&gt;, they work well in some contexts and not in others. If they aren’t helpful, drop them and try something else.&lt;a href=&quot;#fnref1&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn2&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;I’ve run this idea by people I know who work remotely and never turn their camera on. Not everyone is convinced, and I find that genuinely confusing. Maybe they have a lot of useless meetings? Perhaps the local culture is against cameras? Or maybe they always know what they are doing, and I never do?&lt;a href=&quot;#fnref2&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn3&quot; role=&quot;doc-endnote&quot;&gt;Here is a minimal reproduction in Postgres.
&lt;div class=&quot;narrow-code&quot;&gt;
&lt;p&gt;I have some tables with summary data in it:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode sql&quot;&gt;&lt;code class=&quot;sourceCode sql&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;-- simplified tables&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-2&quot;&gt;&lt;a href=&quot;#cb2-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;TABLE&lt;/span&gt; Report (name &lt;span class=&quot;dt&quot;&gt;varchar&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;13&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&quot;cb2-3&quot;&gt;&lt;a href=&quot;#cb2-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;TABLE&lt;/span&gt; input1(name &lt;span class=&quot;dt&quot;&gt;varchar&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;13&lt;/span&gt;), val bigint);&lt;/span&gt;
&lt;span id=&quot;cb2-4&quot;&gt;&lt;a href=&quot;#cb2-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;TABLE&lt;/span&gt; input2(name &lt;span class=&quot;dt&quot;&gt;varchar&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;13&lt;/span&gt;), val bigint);&lt;/span&gt;
&lt;span id=&quot;cb2-5&quot;&gt;&lt;a href=&quot;#cb2-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-6&quot;&gt;&lt;a href=&quot;#cb2-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;-- which, per user, had summary data something like this&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-7&quot;&gt;&lt;a href=&quot;#cb2-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;INTO&lt;/span&gt; input1&lt;/span&gt;
&lt;span id=&quot;cb2-8&quot;&gt;&lt;a href=&quot;#cb2-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;VALUES&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-9&quot;&gt;&lt;a href=&quot;#cb2-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    (&lt;span class=&quot;st&quot;&gt;&amp;#39;one&amp;#39;&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;),&lt;/span&gt;
&lt;span id=&quot;cb2-10&quot;&gt;&lt;a href=&quot;#cb2-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    (&lt;span class=&quot;st&quot;&gt;&amp;#39;two&amp;#39;&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;),&lt;/span&gt;
&lt;span id=&quot;cb2-11&quot;&gt;&lt;a href=&quot;#cb2-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    (&lt;span class=&quot;st&quot;&gt;&amp;#39;three&amp;#39;&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;),&lt;/span&gt;
&lt;span id=&quot;cb2-12&quot;&gt;&lt;a href=&quot;#cb2-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    (&lt;span class=&quot;st&quot;&gt;&amp;#39;three&amp;#39;&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&quot;cb2-13&quot;&gt;&lt;a href=&quot;#cb2-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-14&quot;&gt;&lt;a href=&quot;#cb2-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;INTO&lt;/span&gt; input2&lt;/span&gt;
&lt;span id=&quot;cb2-15&quot;&gt;&lt;a href=&quot;#cb2-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;VALUES&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-16&quot;&gt;&lt;a href=&quot;#cb2-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    (&lt;span class=&quot;st&quot;&gt;&amp;#39;four&amp;#39;&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;),&lt;/span&gt;
&lt;span id=&quot;cb2-17&quot;&gt;&lt;a href=&quot;#cb2-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    (&lt;span class=&quot;st&quot;&gt;&amp;#39;five&amp;#39;&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt;),&lt;/span&gt;
&lt;span id=&quot;cb2-18&quot;&gt;&lt;a href=&quot;#cb2-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    (&lt;span class=&quot;st&quot;&gt;&amp;#39;six&amp;#39;&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;6&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I sort it and put it in the report table then remove any duplicates:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode sql&quot;&gt;&lt;code class=&quot;sourceCode sql&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;-- sort and insert first partition&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;INTO&lt;/span&gt; Report&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;SELECT&lt;/span&gt; name &lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; input1 &lt;/span&gt;
&lt;span id=&quot;cb3-4&quot;&gt;&lt;a href=&quot;#cb3-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;BY&lt;/span&gt; val;&lt;/span&gt;
&lt;span id=&quot;cb3-5&quot;&gt;&lt;a href=&quot;#cb3-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-6&quot;&gt;&lt;a href=&quot;#cb3-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;-- delete duplicate records &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-7&quot;&gt;&lt;a href=&quot;#cb3-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;DELETE&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; Report &lt;span class=&quot;kw&quot;&gt;where&lt;/span&gt; name &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; ( &lt;/span&gt;
&lt;span id=&quot;cb3-8&quot;&gt;&lt;a href=&quot;#cb3-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;select&lt;/span&gt; name&lt;/span&gt;
&lt;span id=&quot;cb3-9&quot;&gt;&lt;a href=&quot;#cb3-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;from&lt;/span&gt; Report &lt;/span&gt;
&lt;span id=&quot;cb3-10&quot;&gt;&lt;a href=&quot;#cb3-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;group&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;by&lt;/span&gt; name &lt;/span&gt;
&lt;span id=&quot;cb3-11&quot;&gt;&lt;a href=&quot;#cb3-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;having&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;count&lt;/span&gt;(&lt;span class=&quot;op&quot;&gt;*&lt;/span&gt;) &lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-12&quot;&gt;&lt;a href=&quot;#cb3-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;);&lt;/span&gt;
&lt;span id=&quot;cb3-13&quot;&gt;&lt;a href=&quot;#cb3-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-14&quot;&gt;&lt;a href=&quot;#cb3-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;-- sort and insert second partition&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-15&quot;&gt;&lt;a href=&quot;#cb3-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;INTO&lt;/span&gt; Report&lt;/span&gt;
&lt;span id=&quot;cb3-16&quot;&gt;&lt;a href=&quot;#cb3-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;SELECT&lt;/span&gt; name &lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; input2 &lt;/span&gt;
&lt;span id=&quot;cb3-17&quot;&gt;&lt;a href=&quot;#cb3-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;BY&lt;/span&gt; val;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then I return the N results as part of the report:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode sql&quot;&gt;&lt;code class=&quot;sourceCode sql&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;-- show Top N report&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; Report &lt;span class=&quot;kw&quot;&gt;limit&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;one&lt;/span&gt;
&lt;span id=&quot;cb4-4&quot;&gt;&lt;a href=&quot;#cb4-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;two&lt;/span&gt;
&lt;span id=&quot;cb4-5&quot;&gt;&lt;a href=&quot;#cb4-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;four&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The actual problem was more complex, involved abusing row_number() and was in SQL SERVER, but the solution is still the same: use an &lt;code&gt;order by&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode sql&quot;&gt;&lt;code class=&quot;sourceCode sql&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;co&quot;&gt;-- show Top N report&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-2&quot;&gt;&lt;a href=&quot;#cb5-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; Report &lt;span class=&quot;kw&quot;&gt;Order&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;By&lt;/span&gt; name &lt;span class=&quot;kw&quot;&gt;limit&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&quot;cb5-3&quot;&gt;&lt;a href=&quot;#cb5-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  one&lt;/span&gt;
&lt;span id=&quot;cb5-4&quot;&gt;&lt;a href=&quot;#cb5-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  two&lt;/span&gt;
&lt;span id=&quot;cb5-5&quot;&gt;&lt;a href=&quot;#cb5-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  three&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
SQL makes no guarantees about tables being in insertion order. &lt;!-- markdownlint-enable MD046 --&gt;
&lt;/div&gt;
&lt;a href=&quot;#fnref3&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;</content><author><name>Adam Gordon Bell</name></author><category term="Articles" /><summary type="html">Some years ago, when I worked in a physical office, I was having trouble with a new report I was developing. The reasonably complex SQL that generated the report would sometimes be missing a single row that would reappear if I reran things. The SQL looked something like this: -- sort and insert first partition into repo INSERT INTO Report SELECT name FROM input1 ORDER BY val; SELECT * FROM Report; one two three -- yep -- sort and insert second partition into repo INSERT INTO Report SELECT name FROM input2 ORDER BY val; SELECT * FROM Report; one two three four five six -- yep SELECT top 3 * FROM Report; one two four -- wait, what? I was going to spend the morning tracking this down. That was my daily stand-up update. But when I gave it, I caught a look from my teammate Isabella (not her real name). The look helped me solve the problem. We’ll get to the solution in a moment, but I want to talk about that facial expression – I am always on the lookout for it now. The Wait-What? Look “I’ve traced it to a bug in the SMTP protocol” I once saw someone go up to a post-office box and confidently empty their lunch garbage into it - like it was a food court garbage bin. I made the facial expression then - I could feel my lips pull to one side and my eyes narrow in confusion. Am I seeing this correctly? I’ve spotted this look in so many daily stand-ups since then. Usually, it’s very fleeting, but I try not to let it pass by unremarked because unpacking it can save so much time. It easy to thrash on a problem and forget some simple assumption you’ve made. This face is a sign you’ve overlooked something important. Are daily stand-ups valuable? Sometimes they are, and sometimes they aren’t1. If you’re blocked on something, then telling the team is essential, but you shouldn’t wait for the next stand-up to share that. There are also all kinds of social reasons why a stand-up is healthy. I work from my home office and have for many years, and a video stand-up is a great way to actually have some small talk, screen to screen, with my teammates. Some parts of a daily stand-up are just a status report, and I’m not sure that ‘what I did yesterday and what I’m doing today part’ is always valuable. But the actual off-topic parts of a stand-up – the part where I complain about how difficult it is to get a permit for building my deck, and where Alex explains about foraging for mushrooms – those parts help keep me sane and happy. That’s Not Quite Right “I’m inserting ‘foo’ but retrieving ‘disk is full’” We are always simulating the world around us on some subconscious level. It helps us predict what is going to happen next. For example, my neighbor is out watering his grass right now – I can see him out my office window. If his hose wasn’t on, I’m not sure I would notice because I’m not paying that much attention. But if he casually jumped from the ground to the second-story roof of his house, it would become the center of my attention. It would trigger some that’s-not-quite-right effect, and I would unconsciously make that confused face. That is why a stand-up can be valuable, in person or screen to screen. You can give your update when you are stuck, and you can watch for that failed-simulation face. Then ask them what they are thinking. Chances are they know where you missed a step or where you have a false assumption. At the very least, you’ve violated their intuition about the problem, and unpacking that feeling is a good idea. Non-Verbal Communication Requires Cameras On “All users were created on a Thursday in 1970” I’ve heard many times before that 70% of communication is non-verbal. This seems to oversell non-verbals or maybe I’m just not great at reading them. This whole confused-face signal could be replaced with chin-scratching emoji or a sign that said: “Wait, What?”. But, when I do get a non-verbal signal, it can save me hours and days of time. I don’t think you can easily replicate this signal with asynchronous communication. One reason is that these non-verbal cues often represent subtle feelings. Someone can hear your update and think to themselves, “That doesn’t sound right”, but they may not be comfortable enough or care enough to say it out loud. Or it’s just fleeting thought before they start their own update. You have to catch these expressions, and you can’t do it without seeing the person. This doesn’t mean that everyone should always be able to see everyone in every meeting. If you are joining a 50 person meeting with a single presenter and everyone has their camera off, then follow suit. If you are eating your lunch in a meeting, I don’t need to see or hear you chew. But if you are seeking help or giving help or pairing on an issue with me, then I want to see your face. The examples and facial expressions here are extreme but even just seeing that I’ve gone too fast and lost you, or that you’re starting to say something, can improve the fidelity of the conversation. People find zoom meetings fatiguing, and I get that. The world contains too many meetings. But I’m shocked when I talk to someone on a remote team that never uses video. If you’re not seeing your teammate’s face when you describe a problem, who knows what you are missing2. The SQL Solution “the max message size in the queue is now 2 gigabytes” So about the SQL. I got the look from Isabella because a select statement like I was describing should be deterministic. Isabella’s spidey-sense told her either I was wrong about results changing or I was misusing SQL. It turned out to be the latter. You see, I was inserting records sorted and selecting them out without an explicit order. Also, my simple recounting of the report’s logic (and my code snippet above) was missing a critical detail – one I had forgotten about3. Sometimes I had to delete duplicate keys from the report table. Guess what happens when you insert things in-order into a table with deleted rows? Its implementation-specific, but sometimes, the invisible spaces left by the deleted rows will be filled in by the inserted data, undoing the insertion order. My row wasn’t missing. My data just wasn’t sorted correctly. Once I added in an order by everything worked. Like everything, they work well in some contexts and not in others. If they aren’t helpful, drop them and try something else.↩︎ I’ve run this idea by people I know who work remotely and never turn their camera on. Not everyone is convinced, and I find that genuinely confusing. Maybe they have a lot of useless meetings? Perhaps the local culture is against cameras? Or maybe they always know what they are doing, and I never do?↩︎ Here is a minimal reproduction in Postgres. I have some tables with summary data in it: -- simplified tables CREATE TABLE Report (name varchar(13)); CREATE TABLE input1(name varchar(13), val bigint); CREATE TABLE input2(name varchar(13), val bigint); -- which, per user, had summary data something like this INSERT INTO input1 VALUES (&amp;#39;one&amp;#39;, 1), (&amp;#39;two&amp;#39;, 2), (&amp;#39;three&amp;#39;, 3), (&amp;#39;three&amp;#39;, 3); INSERT INTO input2 VALUES (&amp;#39;four&amp;#39;, 4), (&amp;#39;five&amp;#39;, 5), (&amp;#39;six&amp;#39;, 6); I sort it and put it in the report table then remove any duplicates: -- sort and insert first partition INSERT INTO Report SELECT name FROM input1 ORDER BY val; -- delete duplicate records DELETE FROM Report where name in ( select name from Report group by name having count(*) &amp;gt; 1 ); -- sort and insert second partition INSERT INTO Report SELECT name FROM input2 ORDER BY val; Then I return the N results as part of the report: -- show Top N report SELECT * FROM Report limit 3; one two four The actual problem was more complex, involved abusing row_number() and was in SQL SERVER, but the solution is still the same: use an order by: -- show Top N report SELECT * FROM Report Order By name limit 3; one two three SQL makes no guarantees about tables being in insertion order. ↩︎</summary></entry><entry><title type="html">Linting Markdown And Documentation</title><link href="https://earthly.dev/blog/markdown-lint/" rel="alternate" type="text/html" title="Linting Markdown And Documentation" /><published>2021-06-25T00:00:00-04:00</published><updated>2021-06-25T00:00:00-04:00</updated><id>https://earthly.dev/blog/markdown-lint</id><content type="html" xml:base="https://earthly.dev/blog/markdown-lint/">&lt;p&gt;Many linting, code formatting, and static analysis tools exist for code. You can use &lt;code&gt;eslint&lt;/code&gt;, &lt;code&gt;gofmt&lt;/code&gt;, or many other static analysis tools, combined with a great continuous integration process, and ensure that your code stays in good shape. But what about markdown files and documentation? How do you ensure you aren’t committing spelling and grammar mistakes? How do you ensure your files are valid markdown and that the language you are using is clear and correct? You can do this and more with a documentation linter.&lt;/p&gt;
&lt;p&gt;Many tools exist for finding problems in text files. You can use this list as a starting point for finding the markdown and prose linting tools that best fit your needs.&lt;/p&gt;
&lt;div class=&quot;notice--success notice--big&quot;&gt;
&lt;p&gt;&lt;strong&gt;Docs as Code&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The movement behind testing and linting prose is known as &lt;a href=&quot;https://www.writethedocs.org/guide/docs-as-code/&quot;&gt;Docs as Code&lt;/a&gt;, and the &lt;a href=&quot;https://www.writethedocs.org/&quot;&gt;Writing The Docs&lt;/a&gt; website is a great place to learn more.&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;criteria&quot;&gt;Criteria&lt;/h2&gt;
&lt;p&gt;For Ease of skimming, I’ll rate each tool based on this criteria:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Formatting:&lt;/strong&gt; The ability to find errors in the formatting of text files (markdown, txt, asciidoc).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Spelling:&lt;/strong&gt; The ability to find spelling mistakes.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Grammar:&lt;/strong&gt; The ability to detect grammar errors.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Clarity:&lt;/strong&gt; The ability to suggest changes that can improve writing clarity.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Additionally, I will rate tools based on their feature set:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Remediation:&lt;/strong&gt; The ability to fix errors without manual intervention.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Customization:&lt;/strong&gt; How well the tool can be customized to fit your use case. If you can’t exclude a rule or disable a warning, CI usage may be challenging. The most robust tools support custom rules and documentation style guides.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Integrated Developer Environment (IDE) support:&lt;/strong&gt; Ability to use in common code editors&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Continuous Integration (CI) / Command Line Interface (CLI) Usage:&lt;/strong&gt; Ability to be used at the command line and in a continuous integration environment.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;markdown-lint&quot;&gt;&lt;a href=&quot;https://github.com/DavidAnson/markdownlint&quot;&gt;Markdown Lint&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/markdown-lint/markdownlint4-800-99dd9fb9b.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/markdown-lint/markdownlint4-800-6efec2026.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img width=&quot;1200px&quot; src=&quot;/blog/generated/assets/images/markdown-lint/markdownlint4-800-6efec2026.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;code&gt;markdownlint&lt;/code&gt; is a node.js markdown linter that is easy to install and easy to customize. It is based on an earlier Ruby tool, also called &lt;a href=&quot;https://github.com/markdownlint/markdownlint&quot;&gt;markdownlint&lt;/a&gt;. Both are great, but the Node.js tool is easy to install and easy to customize.&lt;/p&gt;
&lt;p&gt;You can disable specific rules inline ( &lt;code&gt;&amp;lt;!-- markdownlint-disable-file MD001 --&amp;gt;&lt;/code&gt; ) and set up a per-project config in a &lt;code&gt;.markdownlintrc&lt;/code&gt; file. It also supports writing custom rules in JavaScript and can remediate many problems itself with the &lt;code&gt;fix&lt;/code&gt; option:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;markdownlint --fix &amp;quot;./_posts/*.md&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It doesn’t handle spelling, grammar, or sentence structure, but it can’t be beaten for dealing with markdown structure and it has a great online &lt;a href=&quot;https://dlaa.me/markdownlint/&quot;&gt;demo site&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;coverage&quot;&gt;Coverage&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Formatting: 5&lt;/li&gt;
&lt;li&gt;Spelling: 0&lt;/li&gt;
&lt;li&gt;Grammar: 0&lt;/li&gt;
&lt;li&gt;Clarity: 0&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;features&quot;&gt;Features&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Ease of Use: 5&lt;/li&gt;
&lt;li&gt;Remediation: 5&lt;/li&gt;
&lt;li&gt;Customization: 5&lt;/li&gt;
&lt;li&gt;IDE support: 5&lt;/li&gt;
&lt;li&gt;CI / CLI Support: 5&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;mdspell&quot;&gt;&lt;a href=&quot;https://www.npmjs.com/package/markdown-spellcheck&quot;&gt;mdspell&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/markdown-lint/mdspell1-800-4bbda79e3.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/markdown-lint/mdspell1-800-bd48f06c2.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img width=&quot;1200px&quot; src=&quot;/blog/generated/assets/images/markdown-lint/mdspell1-800-bd48f06c2.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;code&gt;mdspell&lt;/code&gt; is a tool specifically for spelling checking markdown documents. Install it like this:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;npm i markdown-spellcheck -g    &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can run it on markdown files in an interactive mode that builds up a custom dictionary of exceptions. You can then use that list later in a continuous integration process.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mdspell -n -a --en-us  ./blog/_posts/2021-02-11-mitmproxy.md&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The downsides of &lt;code&gt;mdspell&lt;/code&gt; are that the dictionary will likely complain about lots of words that are quite common. It may take some time to build up a list of exceptions. As a shortcut, you might be able to find some more &lt;code&gt;.spelling&lt;/code&gt; files on GitHub.&lt;/p&gt;
&lt;h3 id=&quot;coverage-1&quot;&gt;Coverage&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Formatting: 0&lt;/li&gt;
&lt;li&gt;Spelling: 5&lt;/li&gt;
&lt;li&gt;Grammar: 0&lt;/li&gt;
&lt;li&gt;Clarity: 0&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;features-1&quot;&gt;Features&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Ease of Use: 5&lt;/li&gt;
&lt;li&gt;Remediation: 5&lt;/li&gt;
&lt;li&gt;Customization: 5&lt;/li&gt;
&lt;li&gt;IDE support: 5&lt;/li&gt;
&lt;li&gt;CI / CLI Support: 5&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;alex&quot;&gt;&lt;a href=&quot;https://alexjs.com/&quot;&gt;alex&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/markdown-lint/alex-800-446c930fd.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/markdown-lint/alex-800-f6710f0a0.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img width=&quot;1200px&quot; src=&quot;/blog/generated/assets/images/markdown-lint/alex-800-f6710f0a0.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;code&gt;alex&lt;/code&gt; does one thing: catches insensitive and inconsiderate writing. It supports markdown files, and works via command-line, and has various IDE integrations. The specificity of &lt;code&gt;alex&lt;/code&gt; is its strength. For my rubric, I am scoring it under clarity as catching insensitive writing certainly improves clarity.&lt;/p&gt;
&lt;h3 id=&quot;coverage-2&quot;&gt;Coverage&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Formatting: 0&lt;/li&gt;
&lt;li&gt;Spelling: 0&lt;/li&gt;
&lt;li&gt;Grammar: 0&lt;/li&gt;
&lt;li&gt;Clarity: 3&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;features-2&quot;&gt;Features&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Ease of Use: 5&lt;/li&gt;
&lt;li&gt;Remediation: 5&lt;/li&gt;
&lt;li&gt;Customization: 5&lt;/li&gt;
&lt;li&gt;IDE support: 5&lt;/li&gt;
&lt;li&gt;CI / CLI Support: 5&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;write-good&quot;&gt;&lt;a href=&quot;https://github.com/btford/write-good&quot;&gt;&lt;code&gt;write-good&lt;/code&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/markdown-lint/write-good-800-b8501ff39.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/markdown-lint/write-good-800-425f5519d.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img width=&quot;1200px&quot; src=&quot;/blog/generated/assets/images/markdown-lint/write-good-800-425f5519d.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;code&gt;write-good&lt;/code&gt; is designed for “developers who can’t write good and wanna learn to do other stuff good too.” The tool’s focus is on improving the clarity of writing (and helping developers write well).&lt;/p&gt;
&lt;p&gt;Install:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;npm install -g write-good&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Run:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ write-good ./blog/_posts/2021-02-11-mitmproxy.md
here are several ways to accomplish this.
                         ^^^^^^^^^^
&amp;quot;accomplish&amp;quot; is wordy or unneeded on line 305 at column 26
-------------
e-ca-certificates` is an excellent proof of concept, but if you want to run a do
                         ^^^^^^^^^
&amp;quot;excellent&amp;quot; is a weasel word on line 367 at column 84&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;write-good&lt;/code&gt; has many exciting suggestions. It will highlight passive voice, cliches, weak adverbs, and much more. Unfortunately, it’s not easy to exclude items or configure rules. It might be helpful as a writing suggestion tool, but this lack of configurability means you will have difficulty using it in a continuous integration process.&lt;/p&gt;
&lt;h3 id=&quot;coverage-3&quot;&gt;Coverage&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Formatting: 0&lt;/li&gt;
&lt;li&gt;Spelling: 0&lt;/li&gt;
&lt;li&gt;Grammar: 0&lt;/li&gt;
&lt;li&gt;Clarity: 2&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;features-3&quot;&gt;Features&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Ease of Use: 5&lt;/li&gt;
&lt;li&gt;Remediation: 0&lt;/li&gt;
&lt;li&gt;Customization: 1&lt;/li&gt;
&lt;li&gt;IDE support: 2&lt;/li&gt;
&lt;li&gt;CI / CLI Support: 2&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;textlint&quot;&gt;&lt;a href=&quot;https://textlint.github.io/&quot;&gt;textlint&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/markdown-lint/textlint-800-6eb4f859e.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/markdown-lint/textlint-800-17ad92e53.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img width=&quot;1200px&quot; src=&quot;/blog/generated/assets/images/markdown-lint/textlint-800-17ad92e53.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;code&gt;textlint&lt;/code&gt; is a pluggable linting tool that supports markdown, plain text, and HTML. The plug-in architecture means that it can offer the features of some of the previous items by wrapping them up as a plug-in. It has a &lt;a href=&quot;https://github.com/textlint/textlint/wiki/Collection-of-textlint-rule#rules-english&quot;&gt;plug-in&lt;/a&gt; for &lt;code&gt;alex&lt;/code&gt;, &lt;code&gt;write-good&lt;/code&gt;, and for many spell checkers and grammar checkers. The downside of this flexibility is that it is a bit harder to set up and configure: you have to install each plug-in separately.&lt;/p&gt;
&lt;p&gt;Install:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ npm install textlint --global
# install each plugin
$ npm install --global textlint-rule-no-todo
....
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Run:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;textlint &amp;quot;docs/**&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;textlint&lt;/code&gt; is configurable via an &lt;code&gt;textlintrc&lt;/code&gt; and has inline exclude rules ( &lt;code&gt;&amp;lt;!-- textlint-disable ruleA,ruleB --&amp;gt;&lt;/code&gt; ) – which may make it a possible way to use &lt;code&gt;write-good&lt;/code&gt; or other tools that lack this functionality.&lt;/p&gt;
&lt;h3 id=&quot;coverage-4&quot;&gt;Coverage&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Formatting: 0&lt;/li&gt;
&lt;li&gt;Spelling: 3&lt;/li&gt;
&lt;li&gt;Grammar: 3&lt;/li&gt;
&lt;li&gt;Clarity: 4&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;features-4&quot;&gt;Features&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Ease of Use: 1&lt;/li&gt;
&lt;li&gt;Remediation: 3&lt;/li&gt;
&lt;li&gt;Customization: 4&lt;/li&gt;
&lt;li&gt;IDE support: 5&lt;/li&gt;
&lt;li&gt;CI / CLI Support: 2&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;proselint&quot;&gt;&lt;a href=&quot;http://proselint.com/&quot;&gt;proselint&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/markdown-lint/proselint-800-b152ebcc0.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/markdown-lint/proselint-800-e7264b476.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img width=&quot;1200px&quot; src=&quot;/blog/generated/assets/images/markdown-lint/proselint-800-e7264b476.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;code&gt;proselint&lt;/code&gt; goes deep on writing clarity improvements in the same way the &lt;code&gt;alex&lt;/code&gt; goes deep on inclusive writing:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;proselint&lt;/code&gt; places the world’s greatest writers and editors by your side, where they whisper suggestions on how to improve your prose. You’ll be guided by advice inspired by Bryan Garner, David Foster Wallace, Chuck Palahniuk, Steve Pinker, Mary Norris, Mark Twain, Elmore Leonard, George Orwell, Matthew Butterick, William Strunk, E. B. White, Philip Corbett, Ernest Gowers, and the editorial staff of the world’s finest literary magazines and newspapers, among others. Our goal is to aggregate knowledge about best practices in writing and to make that knowledge immediately accessible to all authors in the form of a linter for prose.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Some of the writing advice included is great:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;echo &amp;quot;The very first thing you&amp;#39;ll see at the top of every (well-written) bash script &amp;quot; | proselint
&amp;lt;stdin&amp;gt;:1:5: weasel_words.very Substitute &amp;#39;damn&amp;#39; every time you&amp;#39;re inclined to write &amp;#39;very&amp;#39;; your editor will delete it and the writing will be just as it should be.&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;echo &amp;quot;Thankfully, not all the advice I received was bad. &amp;quot; | proselint
&amp;lt;stdin&amp;gt;:1:2: skunked_terms.misc &amp;#39;Thankfully,&amp;#39; is a bit of a skunked term — impossible to use without issue. Find some other way to say it.&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;echo &amp;quot;it is worth noting that both for CI and CD, the operating principles and coding philosophy are equally as important as the technical aspect of the implementation.&amp;quot; | proselint
&amp;lt;stdin&amp;gt;:1:96: after_the_deadline.redundancy Redundancy. Use &amp;#39;as&amp;#39; instead of &amp;#39;equally as&amp;#39;.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This one is awesome considering the context of the &lt;a href=&quot;/blog/thought-leaders/&quot;&gt;original article&lt;/a&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;echo &amp;quot;thought leaders&amp;quot; | proselint
&amp;lt;stdin&amp;gt;:1:2: cliches.garner &amp;#39;thought leaders&amp;#39; is cliché.&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt; echo &amp;quot;One elephant in the room with ngrok is&amp;quot; | proselint
&amp;lt;stdin&amp;gt;:1:5: corporate_speak.misc Minimize your use of corporate catchphrases like this one.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Learning from all the best writers is a very lofty objective, and &lt;code&gt;proselint&lt;/code&gt; has accumulated some valuable rules, but it falls short of its goal of collecting all the worlds writing advice in a parsable form. Ignoring and excluding rules are also not fully supported.&lt;/p&gt;
&lt;h3 id=&quot;coverage-5&quot;&gt;Coverage&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Formatting: 0&lt;/li&gt;
&lt;li&gt;Spelling: 0&lt;/li&gt;
&lt;li&gt;Grammar: 0&lt;/li&gt;
&lt;li&gt;Clarity: 5&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;features-5&quot;&gt;Features&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Ease of Use: 5&lt;/li&gt;
&lt;li&gt;Remediation: 0&lt;/li&gt;
&lt;li&gt;Customization: 0&lt;/li&gt;
&lt;li&gt;IDE support: 5&lt;/li&gt;
&lt;li&gt;CI / CLI Support: 2&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;vale&quot;&gt;&lt;a href=&quot;https://github.com/errata-ai/vale&quot;&gt;Vale&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/markdown-lint/vale-800-337217691.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/markdown-lint/vale-800-8ff190de8.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img width=&quot;1200px&quot; src=&quot;/blog/generated/assets/images/markdown-lint/vale-800-8ff190de8.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Vale, created by Joseph Kato, supports spelling, grammar, and clarity checks. It is extendable using a YAML rule format and is designed around the idea of a style guide – a specific house style that you put together and vale enforces. It has an implementation of most &lt;code&gt;proselint&lt;/code&gt; as a style guide, most of &lt;code&gt;write-good&lt;/code&gt;, as well as the &lt;a href=&quot;https://docs.microsoft.com/en-us/style-guide/welcome/&quot;&gt;Microsoft Writing Style Guide&lt;/a&gt; and the Google &lt;a href=&quot;https://developers.google.com/style/&quot;&gt;developer documentation style guide&lt;/a&gt;. Vale is targeted directly at the Docs-as-Code community and documentation teams, who take the writing style of documents very seriously.&lt;/p&gt;
&lt;p&gt;Vale is fast and configurable but not necessarily easy to get started with. Initially, I couldn’t get it to find any problems until I realized that it needs a config file to run:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;MinAlertLevel = suggestion

[*]
BasedOnStyles = Vale&lt;/code&gt;&lt;/pre&gt;
&lt;figcaption&gt;
.vale.ini
&lt;/figcaption&gt;
&lt;p&gt;Additionally, to use it effectively, you will need to copy an existing style-guide into your repository. Separating the styles from the tool is Vale’s biggest strength. It’s also could be a weakness as the rules you build up are specific to your repository. It is easy to write and customize rules but hard to share them back as they need to live in your source code repository.&lt;/p&gt;
&lt;p&gt;Besides the official Vale style guides &lt;a href=&quot;https://buildkite.com/blog/linting-the-buildkite-docs&quot;&gt;Buildkite&lt;/a&gt;, &lt;a href=&quot;https://github.com/linode/docs/tree/develop/ci/vale/styles&quot;&gt;Linode&lt;/a&gt;, and &lt;a href=&quot;https://github.com/testthedocs/vale-styles&quot;&gt;Write The Docs&lt;/a&gt; have rules online that you can copy into your repo or use as inspiration for your own rules.&lt;/p&gt;
&lt;p&gt;If you are taking linting documentation seriously and can take the time to set up a style that works for you, then Vale is the way to go. The rules of most other tools can be implemented inside value, and many already are.&lt;/p&gt;
&lt;h3 id=&quot;coverage-6&quot;&gt;Coverage&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Formatting: 2&lt;/li&gt;
&lt;li&gt;Spelling: 5&lt;/li&gt;
&lt;li&gt;Grammar: 5&lt;/li&gt;
&lt;li&gt;Clarity: 5&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;features-6&quot;&gt;Features&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Ease of Use: 1&lt;/li&gt;
&lt;li&gt;Remediation: 0&lt;/li&gt;
&lt;li&gt;Customization: 5&lt;/li&gt;
&lt;li&gt;IDE support: 5&lt;/li&gt;
&lt;li&gt;CI / CLI Support: 5&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;vale-styles&quot;&gt;Vale Styles&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/topics/vale-linter-style&quot;&gt;Official Styles&lt;/a&gt;&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/search?q=topic%3Avale-linter-style+org%3Atestthedocs+fork%3Atrue&quot;&gt;Write The Docs Styles&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/testthedocs/Openly&quot;&gt;Grammarly Clone in Vale&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;
&lt;p&gt;Many tools exist for testing and linting English prose. You can start as simply as just spelling checking your readme before you commit it or go as complex as a full style guide running on every change to your software documentation.&lt;/p&gt;
&lt;p&gt;If you are willing to invest the time, then &lt;code&gt;Vale&lt;/code&gt;, with its flexible rules, is the clear leader. Combining &lt;code&gt;Vale&lt;/code&gt; with &lt;code&gt;markdownlint&lt;/code&gt; and running both in a continuous integration build should ensure that documents are spelling correctly, grammatically correct, and written in a properly formatted and exclusive way.&lt;/p&gt;
&lt;p&gt;If you’re looking for a more accessible place to start or don’t need the grammar and clarity suggestions, then &lt;code&gt;mdspell&lt;/code&gt; and &lt;code&gt;markdownlint&lt;/code&gt; make a great combination.&lt;/p&gt;
&lt;p&gt;Once you have decided on what tools will work best for you, make sure you find a way to automate their usage. This blog uses &lt;code&gt;Vale&lt;/code&gt; and &lt;code&gt;markdownlint&lt;/code&gt; inside an &lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthfile&lt;/a&gt; that is run every commit. This helps us prevent mistakes from getting into the blog.&lt;/p&gt;</content><author><name>Adam Gordon Bell</name></author><category term="+" /><category term="Tutorials" /><summary type="html">Many linting, code formatting, and static analysis tools exist for code. You can use eslint, gofmt, or many other static analysis tools, combined with a great continuous integration process, and ensure that your code stays in good shape. But what about markdown files and documentation? How do you ensure you aren’t committing spelling and grammar mistakes? How do you ensure your files are valid markdown and that the language you are using is clear and correct? You can do this and more with a documentation linter. Many tools exist for finding problems in text files. You can use this list as a starting point for finding the markdown and prose linting tools that best fit your needs. Docs as Code The movement behind testing and linting prose is known as Docs as Code, and the Writing The Docs website is a great place to learn more. Criteria For Ease of skimming, I’ll rate each tool based on this criteria: Formatting: The ability to find errors in the formatting of text files (markdown, txt, asciidoc). Spelling: The ability to find spelling mistakes. Grammar: The ability to detect grammar errors. Clarity: The ability to suggest changes that can improve writing clarity. Additionally, I will rate tools based on their feature set: Remediation: The ability to fix errors without manual intervention. Customization: How well the tool can be customized to fit your use case. If you can’t exclude a rule or disable a warning, CI usage may be challenging. The most robust tools support custom rules and documentation style guides. Integrated Developer Environment (IDE) support: Ability to use in common code editors Continuous Integration (CI) / Command Line Interface (CLI) Usage: Ability to be used at the command line and in a continuous integration environment. Markdown Lint markdownlint is a node.js markdown linter that is easy to install and easy to customize. It is based on an earlier Ruby tool, also called markdownlint. Both are great, but the Node.js tool is easy to install and easy to customize. You can disable specific rules inline ( &amp;lt;!-- markdownlint-disable-file MD001 --&amp;gt; ) and set up a per-project config in a .markdownlintrc file. It also supports writing custom rules in JavaScript and can remediate many problems itself with the fix option: markdownlint --fix &amp;quot;./_posts/*.md&amp;quot; It doesn’t handle spelling, grammar, or sentence structure, but it can’t be beaten for dealing with markdown structure and it has a great online demo site. Coverage Formatting: 5 Spelling: 0 Grammar: 0 Clarity: 0 Features Ease of Use: 5 Remediation: 5 Customization: 5 IDE support: 5 CI / CLI Support: 5 mdspell mdspell is a tool specifically for spelling checking markdown documents. Install it like this: npm i markdown-spellcheck -g You can run it on markdown files in an interactive mode that builds up a custom dictionary of exceptions. You can then use that list later in a continuous integration process. mdspell -n -a --en-us ./blog/_posts/2021-02-11-mitmproxy.md The downsides of mdspell are that the dictionary will likely complain about lots of words that are quite common. It may take some time to build up a list of exceptions. As a shortcut, you might be able to find some more .spelling files on GitHub. Coverage Formatting: 0 Spelling: 5 Grammar: 0 Clarity: 0 Features Ease of Use: 5 Remediation: 5 Customization: 5 IDE support: 5 CI / CLI Support: 5 alex alex does one thing: catches insensitive and inconsiderate writing. It supports markdown files, and works via command-line, and has various IDE integrations. The specificity of alex is its strength. For my rubric, I am scoring it under clarity as catching insensitive writing certainly improves clarity. Coverage Formatting: 0 Spelling: 0 Grammar: 0 Clarity: 3 Features Ease of Use: 5 Remediation: 5 Customization: 5 IDE support: 5 CI / CLI Support: 5 write-good write-good is designed for “developers who can’t write good and wanna learn to do other stuff good too.” The tool’s focus is on improving the clarity of writing (and helping developers write well). Install: npm install -g write-good Run: $ write-good ./blog/_posts/2021-02-11-mitmproxy.md here are several ways to accomplish this. ^^^^^^^^^^ &amp;quot;accomplish&amp;quot; is wordy or unneeded on line 305 at column 26 ------------- e-ca-certificates` is an excellent proof of concept, but if you want to run a do ^^^^^^^^^ &amp;quot;excellent&amp;quot; is a weasel word on line 367 at column 84 write-good has many exciting suggestions. It will highlight passive voice, cliches, weak adverbs, and much more. Unfortunately, it’s not easy to exclude items or configure rules. It might be helpful as a writing suggestion tool, but this lack of configurability means you will have difficulty using it in a continuous integration process. Coverage Formatting: 0 Spelling: 0 Grammar: 0 Clarity: 2 Features Ease of Use: 5 Remediation: 0 Customization: 1 IDE support: 2 CI / CLI Support: 2 textlint textlint is a pluggable linting tool that supports markdown, plain text, and HTML. The plug-in architecture means that it can offer the features of some of the previous items by wrapping them up as a plug-in. It has a plug-in for alex, write-good, and for many spell checkers and grammar checkers. The downside of this flexibility is that it is a bit harder to set up and configure: you have to install each plug-in separately. Install: $ npm install textlint --global # install each plugin $ npm install --global textlint-rule-no-todo .... Run: textlint &amp;quot;docs/**&amp;quot; textlint is configurable via an textlintrc and has inline exclude rules ( &amp;lt;!-- textlint-disable ruleA,ruleB --&amp;gt; ) – which may make it a possible way to use write-good or other tools that lack this functionality. Coverage Formatting: 0 Spelling: 3 Grammar: 3 Clarity: 4 Features Ease of Use: 1 Remediation: 3 Customization: 4 IDE support: 5 CI / CLI Support: 2 proselint proselint goes deep on writing clarity improvements in the same way the alex goes deep on inclusive writing: proselint places the world’s greatest writers and editors by your side, where they whisper suggestions on how to improve your prose. You’ll be guided by advice inspired by Bryan Garner, David Foster Wallace, Chuck Palahniuk, Steve Pinker, Mary Norris, Mark Twain, Elmore Leonard, George Orwell, Matthew Butterick, William Strunk, E. B. White, Philip Corbett, Ernest Gowers, and the editorial staff of the world’s finest literary magazines and newspapers, among others. Our goal is to aggregate knowledge about best practices in writing and to make that knowledge immediately accessible to all authors in the form of a linter for prose. Some of the writing advice included is great: echo &amp;quot;The very first thing you&amp;#39;ll see at the top of every (well-written) bash script &amp;quot; | proselint &amp;lt;stdin&amp;gt;:1:5: weasel_words.very Substitute &amp;#39;damn&amp;#39; every time you&amp;#39;re inclined to write &amp;#39;very&amp;#39;; your editor will delete it and the writing will be just as it should be. echo &amp;quot;Thankfully, not all the advice I received was bad. &amp;quot; | proselint &amp;lt;stdin&amp;gt;:1:2: skunked_terms.misc &amp;#39;Thankfully,&amp;#39; is a bit of a skunked term — impossible to use without issue. Find some other way to say it. echo &amp;quot;it is worth noting that both for CI and CD, the operating principles and coding philosophy are equally as important as the technical aspect of the implementation.&amp;quot; | proselint &amp;lt;stdin&amp;gt;:1:96: after_the_deadline.redundancy Redundancy. Use &amp;#39;as&amp;#39; instead of &amp;#39;equally as&amp;#39;. This one is awesome considering the context of the original article: echo &amp;quot;thought leaders&amp;quot; | proselint &amp;lt;stdin&amp;gt;:1:2: cliches.garner &amp;#39;thought leaders&amp;#39; is cliché. echo &amp;quot;One elephant in the room with ngrok is&amp;quot; | proselint &amp;lt;stdin&amp;gt;:1:5: corporate_speak.misc Minimize your use of corporate catchphrases like this one. Learning from all the best writers is a very lofty objective, and proselint has accumulated some valuable rules, but it falls short of its goal of collecting all the worlds writing advice in a parsable form. Ignoring and excluding rules are also not fully supported. Coverage Formatting: 0 Spelling: 0 Grammar: 0 Clarity: 5 Features Ease of Use: 5 Remediation: 0 Customization: 0 IDE support: 5 CI / CLI Support: 2 Vale Vale, created by Joseph Kato, supports spelling, grammar, and clarity checks. It is extendable using a YAML rule format and is designed around the idea of a style guide – a specific house style that you put together and vale enforces. It has an implementation of most proselint as a style guide, most of write-good, as well as the Microsoft Writing Style Guide and the Google developer documentation style guide. Vale is targeted directly at the Docs-as-Code community and documentation teams, who take the writing style of documents very seriously. Vale is fast and configurable but not necessarily easy to get started with. Initially, I couldn’t get it to find any problems until I realized that it needs a config file to run: MinAlertLevel = suggestion [*] BasedOnStyles = Vale .vale.ini Additionally, to use it effectively, you will need to copy an existing style-guide into your repository. Separating the styles from the tool is Vale’s biggest strength. It’s also could be a weakness as the rules you build up are specific to your repository. It is easy to write and customize rules but hard to share them back as they need to live in your source code repository. Besides the official Vale style guides Buildkite, Linode, and Write The Docs have rules online that you can copy into your repo or use as inspiration for your own rules. If you are taking linting documentation seriously and can take the time to set up a style that works for you, then Vale is the way to go. The rules of most other tools can be implemented inside value, and many already are. Coverage Formatting: 2 Spelling: 5 Grammar: 5 Clarity: 5 Features Ease of Use: 1 Remediation: 0 Customization: 5 IDE support: 5 CI / CLI Support: 5 Vale Styles Official Styles Write The Docs Styles Grammarly Clone in Vale Summary Many tools exist for testing and linting English prose. You can start as simply as just spelling checking your readme before you commit it or go as complex as a full style guide running on every change to your software documentation. If you are willing to invest the time, then Vale, with its flexible rules, is the clear leader. Combining Vale with markdownlint and running both in a continuous integration build should ensure that documents are spelling correctly, grammatically correct, and written in a properly formatted and exclusive way. If you’re looking for a more accessible place to start or don’t need the grammar and clarity suggestions, then mdspell and markdownlint make a great combination. Once you have decided on what tools will work best for you, make sure you find a way to automate their usage. This blog uses Vale and markdownlint inside an Earthfile that is run every commit. This helps us prevent mistakes from getting into the blog.</summary></entry><entry><title type="html">Creating and hosting your own rpm packages and yum repo</title><link href="https://earthly.dev/blog/creating-and-hosting-your-own-rpm-packages-and-yum-repo/" rel="alternate" type="text/html" title="Creating and hosting your own rpm packages and yum repo" /><published>2021-06-24T00:00:00-04:00</published><updated>2021-06-24T00:00:00-04:00</updated><id>https://earthly.dev/blog/creating-and-hosting-your-own-rpm-packages-and-yum-repo</id><content type="html" xml:base="https://earthly.dev/blog/creating-and-hosting-your-own-rpm-packages-and-yum-repo/">&lt;div class=&quot;narrow-code&quot;&gt;
&lt;p&gt;This tutorial is a follow up to &lt;a href=&quot;/blog/creating-and-hosting-your-own-deb-and-apt-repo&quot;&gt;creating and hosting your own deb and apt repo&lt;/a&gt;, but is written for creating rpm packages for redhat-based Linux distributions such as Fedora, CentOS, and Rocky Linux.&lt;/p&gt;
&lt;h2 id=&quot;prerequisites&quot;&gt;Prerequisites&lt;/h2&gt;
&lt;p&gt;This tutorial assumes you are using CentOS 8, and that the following packages are installed:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;sudo&lt;/span&gt; yum install &lt;span class=&quot;at&quot;&gt;-y&lt;/span&gt; createrepo rpm-build rpm-sign wget gcc python3 yum-utils&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;If you don’t have a CentOS machine, you can still follow along using docker, just run&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; run &lt;span class=&quot;at&quot;&gt;-ti&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--rm&lt;/span&gt; centos:8 /bin/bash&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;to create a temporary CentOS environment to follow along with.&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;step-0-creating-a-simple-hello-world-program&quot;&gt;Step 0: Creating a Simple Hello World Program&lt;/h2&gt;
&lt;p&gt;We will be using the same basic hello world program that was used in the &lt;a href=&quot;/blog/creating-and-hosting-your-own-deb-and-apt-repo&quot;&gt;previous tutorial&lt;/a&gt;. In this tutorial, we will assume you have a binary located under &lt;code&gt;~/example/hello-world-program/hello-world&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;To quickly create a hello world binary using C, run:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-p&lt;/span&gt; ~/example/hello-world-program&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;#include &amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;int main() {&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-4&quot;&gt;&lt;a href=&quot;#cb3-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;    printf(&amp;quot;Hello World!\\n&amp;quot;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-5&quot;&gt;&lt;a href=&quot;#cb3-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;    return 0;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-6&quot;&gt;&lt;a href=&quot;#cb3-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;}&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;gcc&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-o&lt;/span&gt; ~/example/hello-world-program/hello-world &lt;span class=&quot;at&quot;&gt;-x&lt;/span&gt; c &lt;span class=&quot;at&quot;&gt;-&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This tutorial will only cover distributing binaries in rpm packages and will not cover creating source-based &lt;code&gt;rpm&lt;/code&gt;s. There’s other &lt;a href=&quot;https://www.thegeekstuff.com/2015/02/rpm-build-package-example/&quot;&gt;tutorials&lt;/a&gt; that cover creating spec files – the main goal of this tutorial is to document how to package a pre-compiled binary, and show how to generate your own self-hosted yum repository.&lt;/p&gt;
&lt;h2 id=&quot;step-1-creating-a-rpm-package&quot;&gt;Step 1: Creating a &lt;code&gt;rpm&lt;/code&gt; Package&lt;/h2&gt;
&lt;p&gt;Redhat-based Linux distributions use &lt;code&gt;.rpm&lt;/code&gt; packages to package and distribute programs.&lt;/p&gt;
&lt;p&gt;let’s start by making a directory to work out of:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-p&lt;/span&gt; ~/example/rpm-work-dir&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Inside this directory, we will create a &lt;code&gt;spec&lt;/code&gt; file which contains package metadata such as the name, and summary of the package:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;cd&lt;/span&gt; ~/example/rpm-work-dir&lt;/span&gt;
&lt;span id=&quot;cb5-2&quot;&gt;&lt;a href=&quot;#cb5-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Summary: A simple program that prints hello&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-3&quot;&gt;&lt;a href=&quot;#cb5-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;Name: hello-world&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-4&quot;&gt;&lt;a href=&quot;#cb5-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;Version: 1.0.0&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-5&quot;&gt;&lt;a href=&quot;#cb5-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;Release: 1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-6&quot;&gt;&lt;a href=&quot;#cb5-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;URL: https://example.com&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-7&quot;&gt;&lt;a href=&quot;#cb5-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;Group: System&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-8&quot;&gt;&lt;a href=&quot;#cb5-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;License: example # https://fedoraproject.org/wiki/Licensing:Main?rd=Licensing#Software_License_List&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-9&quot;&gt;&lt;a href=&quot;#cb5-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;Packager: Example Team&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-10&quot;&gt;&lt;a href=&quot;#cb5-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;Requires: bash&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-11&quot;&gt;&lt;a href=&quot;#cb5-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;BuildRoot: ~/example/rpm-work-dir # this should be replaced with your working directory where the spec is saved&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-12&quot;&gt;&lt;a href=&quot;#cb5-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-13&quot;&gt;&lt;a href=&quot;#cb5-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;%description&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-14&quot;&gt;&lt;a href=&quot;#cb5-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;An example package containing a hello-world binary&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-15&quot;&gt;&lt;a href=&quot;#cb5-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-16&quot;&gt;&lt;a href=&quot;#cb5-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;%install&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-17&quot;&gt;&lt;a href=&quot;#cb5-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;mkdir -p %{buildroot}/usr/bin/&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-18&quot;&gt;&lt;a href=&quot;#cb5-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;cp ~/example/hello-world-program/hello-world %{buildroot}/usr/bin/hello-world&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-19&quot;&gt;&lt;a href=&quot;#cb5-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-20&quot;&gt;&lt;a href=&quot;#cb5-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;%files&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-21&quot;&gt;&lt;a href=&quot;#cb5-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;/usr/bin/hello-world&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-22&quot;&gt;&lt;a href=&quot;#cb5-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-23&quot;&gt;&lt;a href=&quot;#cb5-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;%changelog&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-24&quot;&gt;&lt;a href=&quot;#cb5-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;* Thu Jun 17 2021 alex &amp;lt;alex@earthly.dev&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-25&quot;&gt;&lt;a href=&quot;#cb5-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;- initial example&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-26&quot;&gt;&lt;a href=&quot;#cb5-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; hello-world.spec&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Next, we will use &lt;code&gt;rpmbuild&lt;/code&gt; to produce the &lt;code&gt;rpm&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;rpmbuild&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--target&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;x86_64&amp;quot;&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-bb&lt;/span&gt; hello-world.spec&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will output an rpm under &lt;code&gt;/root/rpmbuild/RPMS/x86_64/hello-world-1.0.0-1.x86_64.rpm&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;We can inspect the contents with:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb7&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb7-1&quot;&gt;&lt;a href=&quot;#cb7-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;rpm&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-qpivl&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--changelog&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--nomanifest&lt;/span&gt; /root/rpmbuild/RPMS/x86_64/hello-world-1.0.0-1.x86_64.rpm&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;which will output something similar to:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Name        : hello-world
Version     : 1.0.0
Release     : 1
Architecture: x86_64
Install Date: (not installed)
Group       : System
Size        : 10832
License     : example # https://fedoraproject.org/wiki/Licensing:Main?rd=Licensing#Software_License_List
Signature   : (none)
Source RPM  : hello-world-1.0.0-1.src.rpm
Build Date  : Fri 18 Jun 2021 09:21:39 PM UTC
Build Host  : 83f4a9d4e295
Relocations : (not relocatable)
Packager    : Example Team
URL         : https://example.com
Summary     : A simple program that prints hello
Description :
An example package containing a hello-world binary
* Thu Jun 17 2021 alex &amp;lt;alex@earthly.dev&amp;gt;
- initial example

-rwxr-xr-x    1 root    root                    10832 Jun 18 21:21 /usr/bin/hello-world
drwxr-xr-x    2 root    root                        0 Jun 18 21:21 /usr/lib/.build-id
drwxr-xr-x    2 root    root                        0 Jun 18 21:21 /usr/lib/.build-id/b9
lrwxrwxrwx    1 root    root                       31 Jun 18 21:21 /usr/lib/.build-id/b9/fea765874fcd0863841bc8f5d1aa1d65396751 -&amp;gt; ../../../../usr/bin/hello-world&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;You can also inspect the content via &lt;code&gt;less /root/rpmbuild/RPMS/x86_64/hello-world-1.0.0-1.x86_64.rpm&lt;/code&gt;. Under the hood &lt;code&gt;less&lt;/code&gt; will invoke &lt;code&gt;/usr/bin/lesspipe.sh&lt;/code&gt;. You can perform a global regular expression print (grep) against the script to find the same command being used:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb9&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb9-1&quot;&gt;&lt;a href=&quot;#cb9-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;grep&lt;/span&gt; rpm /usr/bin/lesspipe.sh&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This should print the line where the same &lt;code&gt;rpm -qpivl ...&lt;/code&gt; command is being invoked:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;*.rpm&lt;/span&gt;&lt;span class=&quot;er&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;rpm&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-qpivl&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--changelog&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--nomanifest&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$1&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;exit&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;$?&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Next, we can install our &lt;code&gt;rpm&lt;/code&gt; via:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;yum install -y /root/rpmbuild/RPMS/x86_64/hello-world-1.0.0-1.x86_64.rpm&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Then finally, we can test it was installed by running&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb12&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb12-1&quot;&gt;&lt;a href=&quot;#cb12-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;hello-world&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;which should print&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Hello World!&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;step-2-creating-a-yum-repository&quot;&gt;Step 2: Creating a &lt;code&gt;yum&lt;/code&gt; Repository&lt;/h2&gt;
&lt;p&gt;Next we’re going to create a yum repository which can be uploaded to a server to make it easier to share your package with other users.&lt;/p&gt;
&lt;p&gt;Our first step will be to import a pgp key which we will be using to sign our rpm packages and repo, to allow our users to verify the packages have not been tampered. Creating pgp keys was covered in our &lt;a href=&quot;/blog/creating-and-hosting-your-own-deb-and-apt-repo&quot;&gt;previous tutorial&lt;/a&gt;; in particular, we will assume you have public and private keys stored under &lt;code&gt;~/example/pgp-key.public&lt;/code&gt; and &lt;code&gt;~/example/pgp-key.private&lt;/code&gt; respectively.&lt;/p&gt;
&lt;p&gt;First let’s import our private key, so we have access to it for signing the repo:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb14&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb14-1&quot;&gt;&lt;a href=&quot;#cb14-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;gpg&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--import&lt;/span&gt; ~/example/pgp-key.private&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This should output something similar to:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gpg: directory &amp;#39;/root/.gnupg&amp;#39; created
gpg: keybox &amp;#39;/root/.gnupg/pubring.kbx&amp;#39; created
gpg: /root/.gnupg/trustdb.gpg: trustdb created
gpg: key E1933532750E9EEF: public key &amp;quot;example &amp;lt;example@example.com&amp;gt;&amp;quot; imported
gpg: key E1933532750E9EEF: secret key imported
gpg: Total number processed: 1
gpg:               imported: 1
gpg:       secret keys read: 1
gpg:   secret keys imported: 1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We will then configure the rpm tools to use this key for signing our packages and repository:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb16&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb16-1&quot;&gt;&lt;a href=&quot;#cb16-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;%_signature gpg&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-2&quot;&gt;&lt;a href=&quot;#cb16-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;%_gpg_name E1933532750E9EEF&amp;quot;&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; /root/.rpmmacros&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;Don’t forget to replace &lt;code&gt;E1933532750E9EEF&lt;/code&gt; with your key’s ID.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Let’s create a directory for our packages:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb17&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb17-1&quot;&gt;&lt;a href=&quot;#cb17-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-p&lt;/span&gt; ~/example/packages/&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then copy our rpm(s) into this directory:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb18&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb18-1&quot;&gt;&lt;a href=&quot;#cb18-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;cp&lt;/span&gt; /root/rpmbuild/RPMS/x86_64/hello-world-1.0.0-1.x86_64.rpm ~/example/packages/.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Since we didn’t configure a key in step 1, the rpm we created was not signed. We can add a signature to it by running:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb19&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb19-1&quot;&gt;&lt;a href=&quot;#cb19-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;rpm&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--addsign&lt;/span&gt; ~/example/packages/&lt;span class=&quot;pp&quot;&gt;*&lt;/span&gt;.rpm&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;If you forgot to create &lt;code&gt;/root/.rpmmacros&lt;/code&gt;, or forgot to update the key ID, you might see an error such as &lt;code&gt;You must set &quot;%_gpg_name&quot; in your macro file&lt;/code&gt; or &lt;code&gt;gpg: signing failed: No secret key&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Once all the packages are signed, we will use &lt;code&gt;createrepo&lt;/code&gt; to create the repository:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb20&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb20-1&quot;&gt;&lt;a href=&quot;#cb20-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;cd&lt;/span&gt; ~/example/packages/&lt;/span&gt;
&lt;span id=&quot;cb20-2&quot;&gt;&lt;a href=&quot;#cb20-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;createrepo&lt;/span&gt; .&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Finally, we will sign the repodata metadata by running:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb21&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb21-1&quot;&gt;&lt;a href=&quot;#cb21-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;gpg&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--detach-sign&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--armor&lt;/span&gt; repodata/repomd.xml&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;step-3-testing-the-repository&quot;&gt;Step 3: Testing the Repository&lt;/h2&gt;
&lt;p&gt;We are going to use python to temporarily create a web server to serve the contents of our repository:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb22&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb22-1&quot;&gt;&lt;a href=&quot;#cb22-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;cd&lt;/span&gt; ~/example&lt;/span&gt;
&lt;span id=&quot;cb22-2&quot;&gt;&lt;a href=&quot;#cb22-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;python3&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-m&lt;/span&gt; http.server&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We will create a config for this server:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb23&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb23-1&quot;&gt;&lt;a href=&quot;#cb23-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;[example-repo]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb23-2&quot;&gt;&lt;a href=&quot;#cb23-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;name=Example Repo&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb23-3&quot;&gt;&lt;a href=&quot;#cb23-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;baseurl=http://127.0.0.1:8000/packages&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb23-4&quot;&gt;&lt;a href=&quot;#cb23-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;enabled=1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb23-5&quot;&gt;&lt;a href=&quot;#cb23-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;gpgcheck=1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb23-6&quot;&gt;&lt;a href=&quot;#cb23-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;gpgkey=http://127.0.0.1:8000/pgp-key.public&amp;quot;&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; ~/example/example.repo&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Next let’s configure our machine to use this new repository:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb24&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb24-1&quot;&gt;&lt;a href=&quot;#cb24-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;yum-config-manager&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--add-repo&lt;/span&gt; http://127.0.0.1:8000/example.repo&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then we can install our package from the self-hosted repository with:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb25&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb25-1&quot;&gt;&lt;a href=&quot;#cb25-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;yum&lt;/span&gt; install &lt;span class=&quot;at&quot;&gt;-y&lt;/span&gt; hello-world&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;In this example, we were hosting the entire contents of &lt;code&gt;~/example&lt;/code&gt;, which may include your private key if you followed this tutorial completely and created it under &lt;code&gt;~/example/pgp-key.private&lt;/code&gt;. In practice, you would never serve a directory containing your private key.&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;appendix-a-a-complete-example-using-earthly&quot;&gt;Appendix A: A Complete Example using Earthly&lt;/h2&gt;
&lt;p&gt;A complete example has been created under &lt;a href=&quot;https://github.com/earthly/example-yum-repo/blob/main/Earthfile&quot;&gt;github.com/earthly/example-yum-repo/Earthfile&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This Earthfile contains all the above steps from this tutorial in a single location, which can be run directly in a single shot with:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb26&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb26-1&quot;&gt;&lt;a href=&quot;#cb26-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;earthly&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-P&lt;/span&gt; github.com/earthly/example-yum-repo:main+test&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Alternatively, you can clone the repo and run &lt;code&gt;+test&lt;/code&gt; directly.&lt;/p&gt;
&lt;/div&gt;</content><author><name>Alex Couture-Beil</name></author><category term="Tutorials" /><summary type="html">This tutorial is a follow up to creating and hosting your own deb and apt repo, but is written for creating rpm packages for redhat-based Linux distributions such as Fedora, CentOS, and Rocky Linux. Prerequisites This tutorial assumes you are using CentOS 8, and that the following packages are installed: sudo yum install -y createrepo rpm-build rpm-sign wget gcc python3 yum-utils If you don’t have a CentOS machine, you can still follow along using docker, just run docker run -ti --rm centos:8 /bin/bash to create a temporary CentOS environment to follow along with. Step 0: Creating a Simple Hello World Program We will be using the same basic hello world program that was used in the previous tutorial. In this tutorial, we will assume you have a binary located under ~/example/hello-world-program/hello-world. To quickly create a hello world binary using C, run: mkdir -p ~/example/hello-world-program echo &amp;#39;#include &amp;lt;stdio.h&amp;gt; int main() { printf(&amp;quot;Hello World!\\n&amp;quot;); return 0; }&amp;#39; | gcc -o ~/example/hello-world-program/hello-world -x c - This tutorial will only cover distributing binaries in rpm packages and will not cover creating source-based rpms. There’s other tutorials that cover creating spec files – the main goal of this tutorial is to document how to package a pre-compiled binary, and show how to generate your own self-hosted yum repository. Step 1: Creating a rpm Package Redhat-based Linux distributions use .rpm packages to package and distribute programs. let’s start by making a directory to work out of: mkdir -p ~/example/rpm-work-dir Inside this directory, we will create a spec file which contains package metadata such as the name, and summary of the package: cd ~/example/rpm-work-dir echo &amp;quot;Summary: A simple program that prints hello Name: hello-world Version: 1.0.0 Release: 1 URL: https://example.com Group: System License: example # https://fedoraproject.org/wiki/Licensing:Main?rd=Licensing#Software_License_List Packager: Example Team Requires: bash BuildRoot: ~/example/rpm-work-dir # this should be replaced with your working directory where the spec is saved %description An example package containing a hello-world binary %install mkdir -p %{buildroot}/usr/bin/ cp ~/example/hello-world-program/hello-world %{buildroot}/usr/bin/hello-world %files /usr/bin/hello-world %changelog * Thu Jun 17 2021 alex &amp;lt;alex@earthly.dev&amp;gt; - initial example &amp;quot; &amp;gt; hello-world.spec Next, we will use rpmbuild to produce the rpm: rpmbuild --target &amp;quot;x86_64&amp;quot; -bb hello-world.spec This will output an rpm under /root/rpmbuild/RPMS/x86_64/hello-world-1.0.0-1.x86_64.rpm. We can inspect the contents with: rpm -qpivl --changelog --nomanifest /root/rpmbuild/RPMS/x86_64/hello-world-1.0.0-1.x86_64.rpm which will output something similar to: Name : hello-world Version : 1.0.0 Release : 1 Architecture: x86_64 Install Date: (not installed) Group : System Size : 10832 License : example # https://fedoraproject.org/wiki/Licensing:Main?rd=Licensing#Software_License_List Signature : (none) Source RPM : hello-world-1.0.0-1.src.rpm Build Date : Fri 18 Jun 2021 09:21:39 PM UTC Build Host : 83f4a9d4e295 Relocations : (not relocatable) Packager : Example Team URL : https://example.com Summary : A simple program that prints hello Description : An example package containing a hello-world binary * Thu Jun 17 2021 alex &amp;lt;alex@earthly.dev&amp;gt; - initial example -rwxr-xr-x 1 root root 10832 Jun 18 21:21 /usr/bin/hello-world drwxr-xr-x 2 root root 0 Jun 18 21:21 /usr/lib/.build-id drwxr-xr-x 2 root root 0 Jun 18 21:21 /usr/lib/.build-id/b9 lrwxrwxrwx 1 root root 31 Jun 18 21:21 /usr/lib/.build-id/b9/fea765874fcd0863841bc8f5d1aa1d65396751 -&amp;gt; ../../../../usr/bin/hello-world You can also inspect the content via less /root/rpmbuild/RPMS/x86_64/hello-world-1.0.0-1.x86_64.rpm. Under the hood less will invoke /usr/bin/lesspipe.sh. You can perform a global regular expression print (grep) against the script to find the same command being used: grep rpm /usr/bin/lesspipe.sh This should print the line where the same rpm -qpivl ... command is being invoked: *.rpm) rpm -qpivl --changelog --nomanifest -- &amp;quot;$1&amp;quot;; exit $? ;; Next, we can install our rpm via: yum install -y /root/rpmbuild/RPMS/x86_64/hello-world-1.0.0-1.x86_64.rpm Then finally, we can test it was installed by running hello-world which should print Hello World! Step 2: Creating a yum Repository Next we’re going to create a yum repository which can be uploaded to a server to make it easier to share your package with other users. Our first step will be to import a pgp key which we will be using to sign our rpm packages and repo, to allow our users to verify the packages have not been tampered. Creating pgp keys was covered in our previous tutorial; in particular, we will assume you have public and private keys stored under ~/example/pgp-key.public and ~/example/pgp-key.private respectively. First let’s import our private key, so we have access to it for signing the repo: gpg --import ~/example/pgp-key.private This should output something similar to: gpg: directory &amp;#39;/root/.gnupg&amp;#39; created gpg: keybox &amp;#39;/root/.gnupg/pubring.kbx&amp;#39; created gpg: /root/.gnupg/trustdb.gpg: trustdb created gpg: key E1933532750E9EEF: public key &amp;quot;example &amp;lt;example@example.com&amp;gt;&amp;quot; imported gpg: key E1933532750E9EEF: secret key imported gpg: Total number processed: 1 gpg: imported: 1 gpg: secret keys read: 1 gpg: secret keys imported: 1 We will then configure the rpm tools to use this key for signing our packages and repository: echo &amp;quot;%_signature gpg %_gpg_name E1933532750E9EEF&amp;quot; &amp;gt; /root/.rpmmacros Don’t forget to replace E1933532750E9EEF with your key’s ID. Let’s create a directory for our packages: mkdir -p ~/example/packages/ Then copy our rpm(s) into this directory: cp /root/rpmbuild/RPMS/x86_64/hello-world-1.0.0-1.x86_64.rpm ~/example/packages/. Since we didn’t configure a key in step 1, the rpm we created was not signed. We can add a signature to it by running: rpm --addsign ~/example/packages/*.rpm If you forgot to create /root/.rpmmacros, or forgot to update the key ID, you might see an error such as You must set &quot;%_gpg_name&quot; in your macro file or gpg: signing failed: No secret key. Once all the packages are signed, we will use createrepo to create the repository: cd ~/example/packages/ createrepo . Finally, we will sign the repodata metadata by running: gpg --detach-sign --armor repodata/repomd.xml Step 3: Testing the Repository We are going to use python to temporarily create a web server to serve the contents of our repository: cd ~/example python3 -m http.server We will create a config for this server: echo &amp;quot;[example-repo] name=Example Repo baseurl=http://127.0.0.1:8000/packages enabled=1 gpgcheck=1 gpgkey=http://127.0.0.1:8000/pgp-key.public&amp;quot; &amp;gt; ~/example/example.repo Next let’s configure our machine to use this new repository: yum-config-manager --add-repo http://127.0.0.1:8000/example.repo Then we can install our package from the self-hosted repository with: yum install -y hello-world In this example, we were hosting the entire contents of ~/example, which may include your private key if you followed this tutorial completely and created it under ~/example/pgp-key.private. In practice, you would never serve a directory containing your private key. Appendix A: A Complete Example using Earthly A complete example has been created under github.com/earthly/example-yum-repo/Earthfile. This Earthfile contains all the above steps from this tutorial in a single location, which can be run directly in a single shot with: earthly -P github.com/earthly/example-yum-repo:main+test Alternatively, you can clone the repo and run +test directly.</summary></entry><entry><title type="html">The 15-Minute Project</title><link href="https://earthly.dev/blog/15-minute-project/" rel="alternate" type="text/html" title="The 15-Minute Project" /><published>2021-06-22T00:00:00-04:00</published><updated>2021-06-22T00:00:00-04:00</updated><id>https://earthly.dev/blog/15-minute-project</id><content type="html" xml:base="https://earthly.dev/blog/15-minute-project/">&lt;p&gt;Like many others, 2020 encouraged me to find some new interests and hobbies to fill the time spent at home. At risk of sounding terribly boring, one of my newfound interests is that of city planning.&lt;/p&gt;
&lt;h2 id=&quot;what-is-city-planning&quot;&gt;What Is City Planning?&lt;/h2&gt;
&lt;p&gt;According to Wikipedia, city planning is &lt;a href=&quot;https://en.wikipedia.org/wiki/Urban_planning&quot;&gt;“…a technical and political process that is focused on the development and design of land use and the built environment…”&lt;/a&gt;. It includes basically everything, from air, and water to transportation and accessibility. Seems like a fairly broad and ill-specified discipline!&lt;/p&gt;
&lt;p&gt;In a typical American city or town, there is a city planning board that controls development and design. They meet regularly, and in public at their city hall. During 2020, many of these meetings became much more accessible and easy to observe through video calls. It was very interesting to watch how this big, broad concept of “city planning” was boiled down to actual, concrete actions that affected my day-to-day life.&lt;/p&gt;
&lt;h2 id=&quot;the-built-environment&quot;&gt;The Built Environment&lt;/h2&gt;
&lt;p&gt;One phrase I kept hearing over and over in planning meetings, in videos on YouTube&lt;a href=&quot;#fn1&quot; class=&quot;footnote-ref&quot; id=&quot;fnref1&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt;, and other literature is that of the “built environment”. Tuns out that the phrase “built environment” is actually a well defined, distinct concept! It even has &lt;a href=&quot;https://en.wikipedia.org/wiki/Built_environment&quot;&gt;its own Wikipedia page, too&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;Simply put, the built environment is the stuff we’ve “built” around us; like roads, sidewalks, buildings, parks, and utilities. Feels tautological; but the built environment also encompasses &lt;em&gt;how&lt;/em&gt; these things affect us in our day-to-day life.&lt;/p&gt;
&lt;p&gt;The built environment is &lt;em&gt;why&lt;/em&gt; some areas are more desirable than others, and &lt;em&gt;how&lt;/em&gt; you can improve the lives of people within a city.&lt;/p&gt;
&lt;h2 id=&quot;building-a-built-environment&quot;&gt;Building A Built Environment&lt;/h2&gt;
&lt;p&gt;City planners are very concerned with designing the built environment within a city. To this end, they have many tools to guide development in a way that is (hopefully) beneficial and equitable to the community. Things like zoning, building codes, affordable housing, and traffic management can all influence the built environment in very consequential ways.&lt;/p&gt;
&lt;p&gt;But, a planning commission can’t design a built environment without a goal. Or, at least if they try, it won’t create the kind of built environment that people want to live in. Cities need targets and goals to help them design the places that people want to make their home.&lt;/p&gt;
&lt;p&gt;One model that I really like is that of the “&lt;a href=&quot;https://www.cnu.org/publicsquare/2021/02/08/defining-15-minute-city&quot;&gt;15 Minute City&lt;/a&gt;”. Originally conceived in 2016, it has since become a global movement; with many cities around the world adopting variations of the concept into their future planning goals. The idea behind a 15-minute city is that &lt;em&gt;most&lt;/em&gt; residents should be able to satisfy &lt;em&gt;most&lt;/em&gt; of their needs within a 15 minute bike ride from their home. This promotes a well-mixed, accessible, and human scale to target when designing a built environment.&lt;/p&gt;
&lt;h2 id=&quot;what-does-this-have-to-do-with-software-development&quot;&gt;What Does This Have To Do With Software Development?&lt;/h2&gt;
&lt;p&gt;At the risk of falling into the analogy trap, I think we can learn a lot by applying the “built environment” to our software projects. The code, tooling, and infrastructure we use constitutes the physical component, and the contributors working on the project are the citizens living within it.&lt;/p&gt;
&lt;p&gt;After all, &lt;a href=&quot;http://www.catb.org/~esr/writings/cathedral-bazaar/cathedral-bazaar/index.html#catbmain&quot;&gt;the cathedral &lt;em&gt;and&lt;/em&gt; the bazaar&lt;/a&gt; both have to exist &lt;em&gt;somewhere&lt;/em&gt;.&lt;/p&gt;
&lt;h2 id=&quot;the-15-minute-project&quot;&gt;The 15-Minute Project?&lt;/h2&gt;
&lt;p&gt;Like cities may strive to become a “15-minute city”, I propose that software projects should strive to be “15-minute projects”. To become a 15-minute project, any blocked contributor should be able to find what they need to continue progressing within 15 minutes. Finding what you need could involve any piece of your project - the code, documentation, or the community.&lt;/p&gt;
&lt;p&gt;Yes, software is &lt;em&gt;hard&lt;/em&gt;. But so is city planning. Just as no city will achieve a “100% 15-minute city” goal, no software project will either. But, keeping this goal top of mind will do wonders for your project, and make it a desirable place for contributors to congregate.&lt;/p&gt;
&lt;h2 id=&quot;how-do-we-get-there&quot;&gt;How Do We Get There?&lt;/h2&gt;
&lt;p&gt;Before we begin, I am well aware that city planners are not perfect; and that cities quite often make poor decisions. For this analogy, we are considering the platonic ideal of a city and of the planners within it. Frictionless cities with perfectly spherical planners, if you will.&lt;/p&gt;
&lt;p&gt;From this, there are some lessons we can learn when applying city planning concepts to software projects. Below are a couple that I feel can really make a difference to the built environment within your project, and help inch closer to that 15-minute ideal.&lt;/p&gt;
&lt;h3 id=&quot;zoning&quot;&gt;Zoning&lt;/h3&gt;
&lt;p&gt;While we can &lt;a href=&quot;https://www.urban.org/debates/land-use-regulation-whats-it-worth-anyway&quot;&gt;argue about the necessity and efficacy of zoning&lt;/a&gt; within a city plan, having a general plan for your software project can make life a lot easier. If you have a general idea of what will go where, eventually, you can make intelligent decisions about what gets built &lt;em&gt;now&lt;/em&gt;. In a city, these plans are typically public, and can be viewed by everyone. So too should they be in a software project.&lt;/p&gt;
&lt;p&gt;Just like software, requirements for cities also tend to drift (just on a longer timescale). To this end, general plans should also be revisited and re-approved on a regular basis.&lt;/p&gt;
&lt;h3 id=&quot;building-codes&quot;&gt;Building Codes&lt;/h3&gt;
&lt;p&gt;Just like new construction within a city is governed by a &lt;a href=&quot;https://codes.iccsafe.org/content/IBC2021P1&quot;&gt;building code&lt;/a&gt;, so too should new contributions. Building codes typically get very verbose for safety reasons, but ours don’t need to be quite that strict (well, unless your code actually &lt;em&gt;is&lt;/em&gt; safety critical). Often, listing what tools and languages are to be used is sufficient. Most importantly, the building code for your software project should also be public and accessible.&lt;/p&gt;
&lt;p&gt;You can take this even further and codify the languages and tools. One approach I have seen is to use tools like &lt;code&gt;eslint&lt;/code&gt; on a Git commit hook to keep the code looking uniform, so things like formatting aren’t even a question. (This is why the author loves Go, for instance.) Earthly is a great tool to help you codify all parts of your pipeline.&lt;/p&gt;
&lt;h3 id=&quot;transportation&quot;&gt;Transportation&lt;/h3&gt;
&lt;p&gt;Getting people from place to place efficiently is a challenge that most cities face. Proper planning can help mitigate the inevitable traffic jam. Roads, public transit, and sidewalks are all part of the infrastructure that keeps a city moving.&lt;/p&gt;
&lt;p&gt;Likewise, our choices in communication tools affect the transportation of ideas and contributions within a project. Different tools are appropriate for different projects, because they have different citizens. But, if your project’s Slack channels and JIRA boards feel like rush hour in LA, then perhaps it is time to consider improvements.&lt;/p&gt;
&lt;h3 id=&quot;equity&quot;&gt;Equity&lt;/h3&gt;
&lt;p&gt;Cities and towns should be places for people from all walks of life, not just the “elites”. One common way to accomplish this is by enforcing affordable housing in new developments, and by making sure general improvements are evenly distributed across the city.&lt;/p&gt;
&lt;p&gt;Software projects, like cities, should try to improve the lives of all contributors, not just an insular group with the most control. Reserving “easy” issues for first time contributors, keeping documentation up to date, and making decisions in public can go a long way toward leveling the playing field for all contributors.&lt;/p&gt;
&lt;p&gt;A project that is known for being clear, fair, and equitable will end up with a more vibrant community that can carry it far further than it could otherwise travel on its own. A rising tide lifts all boats.&lt;/p&gt;
&lt;h3 id=&quot;taxes&quot;&gt;Taxes&lt;/h3&gt;
&lt;p&gt;Public infrastructure isn’t free. Cities levy taxes, typically in the form of property taxes, to pay for installation and ongoing maintenance. If the city is responsible, the taxes aren’t too onerous and the infrastructure isn’t too extravagant.&lt;/p&gt;
&lt;p&gt;In our software projects, there is also some form of “tax” to be paid for the shared infrastructure. The tax is paid in updating and maintaining shared resources, from build scripts, to CI/CD, to documentation.&lt;/p&gt;
&lt;p&gt;By keeping this shared infrastructure well maintained and right-sized for the project, you can also keep your takes low and the benefits high.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;At this point, I think we’ve mined this analogy for almost all its worth. It really is fascinating how applicable some of these concepts are to two domains that initially appear entirely separate. For me, it has certainly opened my eyes and changed how I approach new and existing projects, and I hope it will for you too.&lt;/p&gt;
&lt;section class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&quot;fn1&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;You would be surprised at how many &lt;a href=&quot;https://www.youtube.com/channel/UCGc8ZVCsrR3dAuhvUbkbToQ&quot;&gt;beautiful&lt;/a&gt; &lt;a href=&quot;https://www.youtube.com/channel/UC0intLFzLaudFG-xAvUEO-A&quot;&gt;channels&lt;/a&gt; &lt;a href=&quot;https://www.youtube.com/channel/UCqdUXv9yQiIhspWPYgp8_XA&quot;&gt;there&lt;/a&gt; &lt;a href=&quot;https://www.youtube.com/user/strongtowns&quot;&gt;are&lt;/a&gt; in this space!&lt;a href=&quot;#fnref1&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;</content><author><name>Corey Larson</name></author><category term="Articles" /><summary type="html">Applying city planning to software development</summary></entry><entry><title type="html">Git Branching Strategies and The Greek Revival</title><link href="https://earthly.dev/blog/git-branching/" rel="alternate" type="text/html" title="Git Branching Strategies and The Greek Revival" /><published>2021-06-16T00:00:00-04:00</published><updated>2021-06-16T00:00:00-04:00</updated><id>https://earthly.dev/blog/git-branching</id><content type="html" xml:base="https://earthly.dev/blog/git-branching/">&lt;p&gt;Some modern development practices are easiest to understand from a historical perspective: things started a certain way, and then steps were added or removed as conditions changed. Git branching, for example, is like that.&lt;/p&gt;
&lt;p&gt;I’m going to explain various git branching strategies with a story. We will start with something straightforward and add complexity as we go. Eventually, we will end up back simple again.&lt;/p&gt;
&lt;p&gt;I hope that explaining things this way will give you a deeper understanding of when to use specific branching and merging strategies. So instead of telling you how to cherry-pick a bug fix into a hotfix branch using GitFlow work, I can describe the conditions that would lead to adopting that process. Once you understand the whys, the hows will be easier.&lt;/p&gt;
&lt;h2 id=&quot;ashelysoft-2006&quot;&gt;AshelySoft 2006&lt;/h2&gt;
&lt;p&gt;The year is 2006, and Ashley Protagonist starts a software business. She builds and sells an eCommerce solution she wrote in PHP. It’s just her building and selling it, but she uses a new source control solution called git to store her software. She starts with trunk-based development.&lt;/p&gt;
&lt;h2 id=&quot;trunk-based-development&quot;&gt;Trunk Based Development&lt;/h2&gt;
&lt;p&gt;Trunk-based development is working on the main, or trunk branch. Ashley commits her code right into the main branch on her local machine and, when she has complete a feature, she pushes her code to the source control server.&lt;/p&gt;
&lt;p&gt;Customers pay for her software, and she emails them a link to the current version as an archive file using &lt;a href=&quot;https://git-scm.com/docs/git-archive&quot;&gt;git archive&lt;/a&gt;. She is a PHP developer, so she whips up a simple PHP script that returns the git archive for the branch requested.&lt;/p&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/git-branching/email2-800-c3cecc459.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/git-branching/email2-800-2d6f208ff.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/git-branching/email2-800-2d6f208ff.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Simple Release Distribution
&lt;/figcaption&gt;
&lt;p&gt;Her customers then install her software on their web servers, where they use it to run their eCommerce businesses.&lt;/p&gt;
&lt;section id=&quot;mainline-development&quot; class=&quot;notice--info&quot;&gt;
&lt;h2&gt;MainLine Development&lt;/h2&gt;
&lt;h3 id=&quot;ℹ️-fun-fact-trunk-vs.-main&quot;&gt;ℹ️ Fun Fact: Trunk VS. Main&lt;/h3&gt;
&lt;p&gt;If Ashley had chosen subversion or CVS, which were more prevalent in 2006, she would have called her branch &lt;code&gt;trunk&lt;/code&gt; because every branch is branched off the trunk like a real-world tree. This is where the term trunk-based development comes from. However, Ashley uses &lt;code&gt;main&lt;/code&gt;, so she may prefer the term mainline development. It’s the same thing, just a different name.&lt;/p&gt;
&lt;/section&gt;
&lt;h2 id=&quot;release-branches&quot;&gt;Release Branches&lt;/h2&gt;
&lt;p&gt;Ashley’s business succeeds. She acquires many more customers and hires more developers and a customer-support person. Support becomes problematic, though, as some customers are very slow to upgrade, and it’s unclear what version any given customer is on. Additionally, customers can’t keep up with the latest version when every commit is a new version, and there are no version numbers.&lt;/p&gt;
&lt;p&gt;So she decides to batch up the changes into monthly releases and create a new release branch for each revision. Of course, she could use tags for these releases, but branches and tags are pretty similar, and she already has her release script in place.&lt;/p&gt;
&lt;p&gt;Now her support people can ask customers what version they are on. If it’s more than two releases back, they ask them to upgrade. That is, AshelySoft only supports the current release and the two previous versions.&lt;/p&gt;
&lt;section id=&quot;cutting-a-release&quot; class=&quot;notice--info&quot;&gt;
&lt;h2&gt;Cutting a Release&lt;/h2&gt;
&lt;p&gt;There was a time before modern source control when creating a release branch was an expensive process that had to be planned. “Cutting a Release” was the name for this process, which involved locking down the source and starting the lengthy process of ‘cutting a release branch off the trunk’. People still use the phrase today.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“Well, the performance was so bad that when they wanted to cut a branch, they would announce it ahead of time. They would schedule the branching because you didn’t want anybody else committing while you were branching, because that would totally screw things up. Right? And I said,”Okay, Friday at 2:00 pm., we’re going to cut the branch.&quot; Then all activity would stop, access to the server would be cut off.&quot;&lt;/p&gt;
&lt;p&gt;And it would take 45 minutes to cut this branch. And then you’d say, “Okay, we’ve opened up the branch. Everybody can start working again.”&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://corecursive.com/software-that-doesnt-suck-with-jim-blandy/&quot;&gt;Jim Blandy&lt;/a&gt; creator of Subversion&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/section&gt;
&lt;h2 id=&quot;hot-fixes-and-the-multiverse&quot;&gt;Hot Fixes and the Multiverse&lt;/h2&gt;
&lt;p&gt;This is all working great. Ashley starts scaling the development team, and they start shipping more features. Unfortunately, while each monthly release now contains more cool new features, more regressions and bugs start slipping into the releases as well.&lt;/p&gt;
&lt;p&gt;Some customers respond to this by not upgrading right away. If they are well-served by the current product, they can stay two releases back and get active support while giving the latest release time to stabilize. Bugs do show up in the old versions, though, and this is where things get interesting.&lt;/p&gt;
&lt;p&gt;Up until now, time, as viewed by AshelySoft’s source control, moves forward in a single line. There is one &lt;code&gt;main&lt;/code&gt; branch that represents one linear release timeline. But now, when bugs are found, they need to be addressed in multiple versions of the product. And you can’t simply ask people to upgrade because they are still on a supported version, and they are correctly worried about the quality of the latest release. They want the version they have plus the bug fixes, with no new development.&lt;/p&gt;
&lt;p&gt;You are now in the hot fixing multiverse. AshelySoft has to fix bugs in the latest version and all other active versions. Each release is a separate timeline where active development ceased at the release date, but bugs continued to be fixed.&lt;/p&gt;
&lt;p&gt;If you’ve seen any time travel movies, you probably realize that this can get complex. What if a bug fix to back release introduces a bug of its own? Thankfully AshelySoft is only supporting two active versions back and only supporting them for a couple of months. Suppose they were supporting back versions for several years. In that case, they might find themselves spending more and more time maintaining all these versions, and the various versions would slowly drift away from each other.&lt;/p&gt;
&lt;p&gt;Nevertheless, release branches are an enormous help for AshelySoft. They help customers stay on a version that works for them, while AshelySoft can still push new features. However, it does increase the amount of effort that fixing bugs requires, and dealing with that will lead to AshelySoft’s next innovation.&lt;/p&gt;
&lt;h2 id=&quot;the-develop-branch&quot;&gt;The &lt;code&gt;develop&lt;/code&gt; Branch&lt;/h2&gt;
&lt;p&gt;The cost of shipping bugs has now increased for AshelySoft. In the worse case, a bug isn’t discovered until it’s in all active versions of the software and the code between versions has changed enough that the fix is slightly different in each version, tripling the bug fix cost.&lt;/p&gt;
&lt;p&gt;Fortunately, a solution for this does exist: Continuing with our time travel/multiverse analogy, we need to travel back in time and stop the bug before our releases branches off the main timeline. Unfortunately, AshelySoft does not have access to literal time travel machines, but Ashley has a more straightforward idea: Catch the bugs before they are released.&lt;/p&gt;
&lt;h2 id=&quot;gitflow-to-the-rescue&quot;&gt;GitFlow to the Rescue&lt;/h2&gt;
&lt;p&gt;A popular branching method called &lt;a href=&quot;https://nvie.com/posts/a-successful-git-branching-model/&quot;&gt;GitFlow&lt;/a&gt; has excellent suggestions for achieving this: you create a &lt;code&gt;develop&lt;/code&gt; branch. So now all new work goes into &lt;code&gt;develop,&lt;/code&gt; and instead of 4 weeks of development in each release, you spend the last week stabilizing &lt;code&gt;develop&lt;/code&gt;. You make sure &lt;code&gt;develop&lt;/code&gt; has no bugs as best you can, and when it seems stable, you merge it into main and then cut a release branch off main.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“We consider origin/develop to be the main branch where the source code of HEAD always reflects a state with the latest delivered development changes for the next release. Some would call this the”integration branch“. This is where any automatic nightly builds are built from.”&lt;/p&gt;
&lt;p&gt;“When the source code in the develop branch reaches a stable point and is ready to be released, all of the changes should be merged back into master somehow and then tagged with a release number.”&lt;/p&gt;
&lt;p&gt;GitFlow Explanation&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This whole process adds more overhead to the branching and release process, but it’s a fixed cost overhead, and it saves a lot of HotFixing bugs on release branches. AshelySoft, following the git-flow model, also adds a &lt;a href=&quot;/blog/continuous-integration&quot;&gt;continuous integration&lt;/a&gt; service. When new code shows up in &lt;code&gt;develop&lt;/code&gt;, &lt;a href=&quot;/blog/unit-vs-integration&quot;&gt;automated tests&lt;/a&gt; are run.&lt;/p&gt;
&lt;p&gt;This setup, git-flow and CI on develop branch, with release branches and hot fixing serves AshelySoft for several years. However, it is a complicated process. Thankfully, from here on out, AshelySoft’s process will only get simpler. The first thing that helps to simplify things is &lt;code&gt;The Cloud&lt;/code&gt;™️.&lt;/p&gt;
&lt;h2 id=&quot;the-cloud&quot;&gt;The Cloud&lt;/h2&gt;
&lt;p&gt;AshelySoft customers want to run an eCommerce store. However, they don’t want to run a web server. After repeatedly getting this feedback, Ashley shifts the company to be a Software-As-A-Service (SAAS) company. It takes some extensive work, but AshelySoft eCommerce becomes a multi-tenant eCommerce platform. No more &lt;code&gt;git archive&lt;/code&gt; releases. Now the release process is deploying the latest version of the main branch onto the production server.&lt;/p&gt;
&lt;p&gt;There are downsides to this SAAS model. AshelySoft now owns the uptime of all their customers, and this is eCommerce, so real money is lost when things go down. But, the customers are willing to pay more for AshelySoft to worry about these problems. They no longer have to support multi releases at a time - no more hot fixing bugs back into old versions, no more multiverse of drifting branches to update, and no more release branches. To make this work, AshelySoft works off a simple rule: &lt;code&gt;main&lt;/code&gt; must be releasable. Before anyone can merge &lt;code&gt;develop&lt;/code&gt; into &lt;code&gt;main&lt;/code&gt; they must make sure the continuous integration build is passing, and if they find problems that the CI process missed, they do their best to make sure CI will catch it in the future.&lt;/p&gt;
&lt;h2 id=&quot;github-flow&quot;&gt;GitHub Flow&lt;/h2&gt;
&lt;p&gt;Around this time, GitHub private repositories appear, and AshelySoft moves from their own git hosting to GitHub and starts following a Pull Request process. Instead of pushing code straight into &lt;code&gt;develop&lt;/code&gt; and then ensuring they didn’t break the build, developers now create pull-requests. Other team members review the pull-requests, and the continuous integration service runs its suite of tests right on the PR. As a result, the speed of getting code into &lt;code&gt;develop&lt;/code&gt; has decreased, but with each PR being manually reviewed and automatically tested, the quality of code that makes it into the &lt;code&gt;develop&lt;/code&gt; branch is way up.&lt;/p&gt;
&lt;h2 id=&quot;death-to-develop&quot;&gt;Death to &lt;code&gt;develop&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;With the quality of &lt;code&gt;develop&lt;/code&gt; now increased, AshelySoft can increase its release velocity. They even adopt a continuous deployment model where a merge into &lt;code&gt;main&lt;/code&gt; causes the software to be automatically deployed. From there, they move to a &lt;a href=&quot;/blog/deployment-strategies/#canary-deployment&quot;&gt;Canary deployment model&lt;/a&gt; where a new release is tested on a small portion of web traffic before it’s fully deployed. Once a PR is merged, Ashley just has to merge &lt;code&gt;develop&lt;/code&gt; into &lt;code&gt;main&lt;/code&gt; to perform a release.&lt;/p&gt;
&lt;p&gt;But what is the point of having &lt;code&gt;develop&lt;/code&gt; and merging it into &lt;code&gt;main&lt;/code&gt;? It was introduced to prevent the release of bugs by giving the software time to ‘integrate’, but AshelySoft is doing all the integration as part of the PR process. So they drop the &lt;code&gt;develop&lt;/code&gt; branch.&lt;/p&gt;
&lt;p&gt;Ashley has come a long way but sometimes what is old is new again. She is now back to doing trunk-based or mainline development. Just like when she built the first version: features go into &lt;code&gt;main&lt;/code&gt;, and the HEAD of &lt;code&gt;main&lt;/code&gt; is constantly released.&lt;/p&gt;
&lt;h2 id=&quot;lessons-learned&quot;&gt;Lessons Learned&lt;/h2&gt;
&lt;p&gt;There is a lot about git merging strategies, continuous integration, and deployment that doesn’t seem to make sense without going through a long journey like Ashely’s.&lt;/p&gt;
&lt;p&gt;For instance, calling software that builds and tests code a continuous integration process only makes sense when you understand what non-continuous integration was. It was spending time manually testing the upcoming release for days or even weeks before feeling confident enough to release it.&lt;/p&gt;
&lt;p&gt;Ashely’s story is fictional, and history didn’t necessarily unfold this way for all or even most software shops, but I think it’s helpful to understand where we are coming from and how cloud and SAAS workflows influence branching models.&lt;/p&gt;
&lt;p&gt;Some software always had an extensive review process, and much software will never be cloud-based and will continue to deal with release branches and backporting fixes. But some software has moved to the cloud and yet hasn’t embraced the simplified workflows that cloud deployment can enable.&lt;/p&gt;
&lt;h2 id=&quot;appendix-develop-and-the-greek-revival-style&quot;&gt;Appendix: Develop and The Greek Revival Style&lt;/h2&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/git-branching/greek-columns-550-93c2aaf0b.webp 550w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/git-branching/greek-columns-550-9fd39c02f.jpg 550w&quot; type=&quot;image/jpeg&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/git-branching/greek-columns-550-9fd39c02f.jpg&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;p&gt;The Parthenon was built in ancient Greece using columns of marble. These columns of marble held it up.&lt;/p&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/git-branching/greek-revival-800-bc37602f4.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/git-branching/greek-revival-800-ce1d10ab6.jpg 800w&quot; type=&quot;image/jpeg&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/git-branching/greek-revival-800-ce1d10ab6.jpg&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;p&gt;This is a greek-revival style house. These columns are not about function but form – they are unnecessary and were chosen for aesthetic purposes.&lt;/p&gt;
&lt;p&gt;If you don’t need to maintain and support multiple versions of your software and it only runs on your servers, then you might have a purely decorative &lt;code&gt;develop&lt;/code&gt; branch. You may be using a git branching model that is very effective for a software lifecycle that you yourself are not in fact practicing. Those might not be load-bearing functional columns – you might be copying the visual appearance of the ancients without understanding the purpose they had in mind.&lt;/p&gt;
&lt;p&gt;The creator of GitFlow offers similar thoughts:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Web apps are typically continuously delivered, not rolled back, and you don’t have to support multiple versions of the software running in the wild.&lt;/p&gt;
&lt;p&gt;If your team is doing continuous delivery of software, I would suggest to adopt a much simpler workflow (like GitHub flow) instead of trying to shoehorn git-flow into your team.&lt;/p&gt;
&lt;p&gt;GitFlow Creator Vincent Driessen&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The closer you can stay to trunk-based or mainline development, the less overhead you will have and the smaller the batches you’ll be able to release.&lt;/p&gt;</content><author><name>Adam Gordon Bell</name></author><category term="Tutorials" /><summary type="html">Some modern development practices are easiest to understand from a historical perspective: things started a certain way, and then steps were added or removed as conditions changed. Git branching, for example, is like that. I’m going to explain various git branching strategies with a story. We will start with something straightforward and add complexity as we go. Eventually, we will end up back simple again. I hope that explaining things this way will give you a deeper understanding of when to use specific branching and merging strategies. So instead of telling you how to cherry-pick a bug fix into a hotfix branch using GitFlow work, I can describe the conditions that would lead to adopting that process. Once you understand the whys, the hows will be easier. AshelySoft 2006 The year is 2006, and Ashley Protagonist starts a software business. She builds and sells an eCommerce solution she wrote in PHP. It’s just her building and selling it, but she uses a new source control solution called git to store her software. She starts with trunk-based development. Trunk Based Development Trunk-based development is working on the main, or trunk branch. Ashley commits her code right into the main branch on her local machine and, when she has complete a feature, she pushes her code to the source control server. Customers pay for her software, and she emails them a link to the current version as an archive file using git archive. She is a PHP developer, so she whips up a simple PHP script that returns the git archive for the branch requested. Simple Release Distribution Her customers then install her software on their web servers, where they use it to run their eCommerce businesses. MainLine Development ℹ️ Fun Fact: Trunk VS. Main If Ashley had chosen subversion or CVS, which were more prevalent in 2006, she would have called her branch trunk because every branch is branched off the trunk like a real-world tree. This is where the term trunk-based development comes from. However, Ashley uses main, so she may prefer the term mainline development. It’s the same thing, just a different name. Release Branches Ashley’s business succeeds. She acquires many more customers and hires more developers and a customer-support person. Support becomes problematic, though, as some customers are very slow to upgrade, and it’s unclear what version any given customer is on. Additionally, customers can’t keep up with the latest version when every commit is a new version, and there are no version numbers. So she decides to batch up the changes into monthly releases and create a new release branch for each revision. Of course, she could use tags for these releases, but branches and tags are pretty similar, and she already has her release script in place. Now her support people can ask customers what version they are on. If it’s more than two releases back, they ask them to upgrade. That is, AshelySoft only supports the current release and the two previous versions. Cutting a Release There was a time before modern source control when creating a release branch was an expensive process that had to be planned. “Cutting a Release” was the name for this process, which involved locking down the source and starting the lengthy process of ‘cutting a release branch off the trunk’. People still use the phrase today. “Well, the performance was so bad that when they wanted to cut a branch, they would announce it ahead of time. They would schedule the branching because you didn’t want anybody else committing while you were branching, because that would totally screw things up. Right? And I said,”Okay, Friday at 2:00 pm., we’re going to cut the branch.&quot; Then all activity would stop, access to the server would be cut off.&quot; And it would take 45 minutes to cut this branch. And then you’d say, “Okay, we’ve opened up the branch. Everybody can start working again.” Jim Blandy creator of Subversion Hot Fixes and the Multiverse This is all working great. Ashley starts scaling the development team, and they start shipping more features. Unfortunately, while each monthly release now contains more cool new features, more regressions and bugs start slipping into the releases as well. Some customers respond to this by not upgrading right away. If they are well-served by the current product, they can stay two releases back and get active support while giving the latest release time to stabilize. Bugs do show up in the old versions, though, and this is where things get interesting. Up until now, time, as viewed by AshelySoft’s source control, moves forward in a single line. There is one main branch that represents one linear release timeline. But now, when bugs are found, they need to be addressed in multiple versions of the product. And you can’t simply ask people to upgrade because they are still on a supported version, and they are correctly worried about the quality of the latest release. They want the version they have plus the bug fixes, with no new development. You are now in the hot fixing multiverse. AshelySoft has to fix bugs in the latest version and all other active versions. Each release is a separate timeline where active development ceased at the release date, but bugs continued to be fixed. If you’ve seen any time travel movies, you probably realize that this can get complex. What if a bug fix to back release introduces a bug of its own? Thankfully AshelySoft is only supporting two active versions back and only supporting them for a couple of months. Suppose they were supporting back versions for several years. In that case, they might find themselves spending more and more time maintaining all these versions, and the various versions would slowly drift away from each other. Nevertheless, release branches are an enormous help for AshelySoft. They help customers stay on a version that works for them, while AshelySoft can still push new features. However, it does increase the amount of effort that fixing bugs requires, and dealing with that will lead to AshelySoft’s next innovation. The develop Branch The cost of shipping bugs has now increased for AshelySoft. In the worse case, a bug isn’t discovered until it’s in all active versions of the software and the code between versions has changed enough that the fix is slightly different in each version, tripling the bug fix cost. Fortunately, a solution for this does exist: Continuing with our time travel/multiverse analogy, we need to travel back in time and stop the bug before our releases branches off the main timeline. Unfortunately, AshelySoft does not have access to literal time travel machines, but Ashley has a more straightforward idea: Catch the bugs before they are released. GitFlow to the Rescue A popular branching method called GitFlow has excellent suggestions for achieving this: you create a develop branch. So now all new work goes into develop, and instead of 4 weeks of development in each release, you spend the last week stabilizing develop. You make sure develop has no bugs as best you can, and when it seems stable, you merge it into main and then cut a release branch off main. “We consider origin/develop to be the main branch where the source code of HEAD always reflects a state with the latest delivered development changes for the next release. Some would call this the”integration branch“. This is where any automatic nightly builds are built from.” “When the source code in the develop branch reaches a stable point and is ready to be released, all of the changes should be merged back into master somehow and then tagged with a release number.” GitFlow Explanation This whole process adds more overhead to the branching and release process, but it’s a fixed cost overhead, and it saves a lot of HotFixing bugs on release branches. AshelySoft, following the git-flow model, also adds a continuous integration service. When new code shows up in develop, automated tests are run. This setup, git-flow and CI on develop branch, with release branches and hot fixing serves AshelySoft for several years. However, it is a complicated process. Thankfully, from here on out, AshelySoft’s process will only get simpler. The first thing that helps to simplify things is The Cloud™️. The Cloud AshelySoft customers want to run an eCommerce store. However, they don’t want to run a web server. After repeatedly getting this feedback, Ashley shifts the company to be a Software-As-A-Service (SAAS) company. It takes some extensive work, but AshelySoft eCommerce becomes a multi-tenant eCommerce platform. No more git archive releases. Now the release process is deploying the latest version of the main branch onto the production server. There are downsides to this SAAS model. AshelySoft now owns the uptime of all their customers, and this is eCommerce, so real money is lost when things go down. But, the customers are willing to pay more for AshelySoft to worry about these problems. They no longer have to support multi releases at a time - no more hot fixing bugs back into old versions, no more multiverse of drifting branches to update, and no more release branches. To make this work, AshelySoft works off a simple rule: main must be releasable. Before anyone can merge develop into main they must make sure the continuous integration build is passing, and if they find problems that the CI process missed, they do their best to make sure CI will catch it in the future. GitHub Flow Around this time, GitHub private repositories appear, and AshelySoft moves from their own git hosting to GitHub and starts following a Pull Request process. Instead of pushing code straight into develop and then ensuring they didn’t break the build, developers now create pull-requests. Other team members review the pull-requests, and the continuous integration service runs its suite of tests right on the PR. As a result, the speed of getting code into develop has decreased, but with each PR being manually reviewed and automatically tested, the quality of code that makes it into the develop branch is way up. Death to develop With the quality of develop now increased, AshelySoft can increase its release velocity. They even adopt a continuous deployment model where a merge into main causes the software to be automatically deployed. From there, they move to a Canary deployment model where a new release is tested on a small portion of web traffic before it’s fully deployed. Once a PR is merged, Ashley just has to merge develop into main to perform a release. But what is the point of having develop and merging it into main? It was introduced to prevent the release of bugs by giving the software time to ‘integrate’, but AshelySoft is doing all the integration as part of the PR process. So they drop the develop branch. Ashley has come a long way but sometimes what is old is new again. She is now back to doing trunk-based or mainline development. Just like when she built the first version: features go into main, and the HEAD of main is constantly released. Lessons Learned There is a lot about git merging strategies, continuous integration, and deployment that doesn’t seem to make sense without going through a long journey like Ashely’s. For instance, calling software that builds and tests code a continuous integration process only makes sense when you understand what non-continuous integration was. It was spending time manually testing the upcoming release for days or even weeks before feeling confident enough to release it. Ashely’s story is fictional, and history didn’t necessarily unfold this way for all or even most software shops, but I think it’s helpful to understand where we are coming from and how cloud and SAAS workflows influence branching models. Some software always had an extensive review process, and much software will never be cloud-based and will continue to deal with release branches and backporting fixes. But some software has moved to the cloud and yet hasn’t embraced the simplified workflows that cloud deployment can enable. Appendix: Develop and The Greek Revival Style The Parthenon was built in ancient Greece using columns of marble. These columns of marble held it up. This is a greek-revival style house. These columns are not about function but form – they are unnecessary and were chosen for aesthetic purposes. If you don’t need to maintain and support multiple versions of your software and it only runs on your servers, then you might have a purely decorative develop branch. You may be using a git branching model that is very effective for a software lifecycle that you yourself are not in fact practicing. Those might not be load-bearing functional columns – you might be copying the visual appearance of the ancients without understanding the purpose they had in mind. The creator of GitFlow offers similar thoughts: Web apps are typically continuously delivered, not rolled back, and you don’t have to support multiple versions of the software running in the wild. If your team is doing continuous delivery of software, I would suggest to adopt a much simpler workflow (like GitHub flow) instead of trying to shoehorn git-flow into your team. GitFlow Creator Vincent Driessen The closer you can stay to trunk-based or mainline development, the less overhead you will have and the smaller the batches you’ll be able to release.</summary></entry></feed>
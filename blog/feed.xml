<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.1.1">Jekyll</generator><link href="https://earthly.dev/blog/feed.xml" rel="self" type="application/atom+xml" /><link href="https://earthly.dev/blog/" rel="alternate" type="text/html" /><updated>2021-08-27T12:03:00-04:00</updated><id>https://earthly.dev/blog/feed.xml</id><title type="html">Earthly Blog</title><subtitle>Build automation for the container era.</subtitle><entry><title type="html">Example Post</title><link href="https://earthly.dev/blog/example/" rel="alternate" type="text/html" title="Example Post" /><published>2029-01-01T00:00:00-05:00</published><updated>2029-01-01T00:00:00-05:00</updated><id>https://earthly.dev/blog/example</id><content type="html" xml:base="https://earthly.dev/blog/example/">&lt;!-- vale off --&gt;
&lt;p&gt;This post is in the future, and won’t show up in the published site&lt;/p&gt;
&lt;h2 id=&quot;image-without-figure&quot;&gt;Image without figure&lt;/h2&gt;
&lt;p&gt;An image with the alt text hidden.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/blog/assets/images/example/alex-draw.png&quot; alt=&quot;some alt text&quot; /&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;p&gt;An image with alt text printed below.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/example/alex-draw.png&quot; alt=&quot;some alt text&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;some alt text&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;image-with-explicit-figure&quot;&gt;Image with explicit figure&lt;/h2&gt;
&lt;figure class&gt;
&lt;img src=&quot;/blog/assets/images/example/alex-draw.png&quot;
       alt=&quot;handddrawn cartoon for a person talking to a computer server&quot;&gt;
&lt;figcaption&gt;
&lt;p&gt;Alex likes to draw and add a caption&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;image-with-implicit-figure&quot;&gt;Image with implicit figure&lt;/h2&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/example/alex-draw.png&quot; alt=&quot;This is my alt text and my figure. The alt text is used as the default figure if not specified.&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;This is my alt text and my figure. The alt text is used as the default figure if not specified.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;image-wide&quot;&gt;Image Wide&lt;/h2&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/example/alex-draw.png&quot; alt=&quot;This should be wide&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;This should be wide&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/div&gt;
&lt;h3 id=&quot;graph-using-matplotlib&quot;&gt;graph using matplotlib&lt;/h3&gt;
&lt;figure&gt;
&lt;img src=&quot;_site/assets/images/15298945686075526262.svg&quot; /&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;code-blocks-with-syntax-highlighting&quot;&gt;Code blocks (with syntax highlighting)&lt;/h3&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode go&quot;&gt;&lt;code class=&quot;sourceCode go&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    syntax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;proto3&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;package&lt;/span&gt; simplekeyvalue&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    option go_package &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;kvapi&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;co&quot;&gt;// The key/value API contains two procedures for storing and retrieving data&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-6&quot;&gt;&lt;a href=&quot;#cb1-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    service KeyValue &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-7&quot;&gt;&lt;a href=&quot;#cb1-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      rpc Set &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;SetRequest&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; returns &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;SetReply&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-8&quot;&gt;&lt;a href=&quot;#cb1-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      rpc Get &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;GetRequest&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; returns &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;GetReply&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-9&quot;&gt;&lt;a href=&quot;#cb1-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;raw-code-blocks&quot;&gt;Raw code blocks&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;
{{ raw template code}}
&lt;/code&gt;&lt;/pre&gt;
&lt;figcaption&gt;
Use &lt;code&gt;raw&lt;/code&gt; and &lt;code&gt;endraw&lt;/code&gt; for code that overlaps with the liquid templates
&lt;/figcaption&gt;
&lt;h2 id=&quot;fensed-code-blocks&quot;&gt;Fensed code blocks&lt;/h2&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode scala&quot;&gt;&lt;code class=&quot;sourceCode scala&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;object&lt;/span&gt; Main &lt;span class=&quot;kw&quot;&gt;extends&lt;/span&gt; App &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;Hello, World!&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;code-with-captions&quot;&gt;Code with Captions&lt;/h3&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode scala&quot;&gt;&lt;code class=&quot;sourceCode scala&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;object&lt;/span&gt; Main &lt;span class=&quot;kw&quot;&gt;extends&lt;/span&gt; App &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;Hello, World!&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figcaption&gt;
Main.scala
&lt;/figcaption&gt;
&lt;div class=&quot;notice&quot;&gt;
&lt;p&gt;&lt;strong&gt;Notice&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Markdown here&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;one&lt;/li&gt;
&lt;li&gt;two&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;ℹ️ Notice Info&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Markdown here&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;one&lt;/li&gt;
&lt;li&gt;two&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;notice--warning&quot;&gt;
&lt;p&gt;&lt;strong&gt;Warning&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Markdown here&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;one&lt;/li&gt;
&lt;li&gt;two&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;notice--success&quot;&gt;
&lt;p&gt;&lt;strong&gt;Success&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Markdown here&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;more-example-image-layouts&quot;&gt;More example Image layouts&lt;/h3&gt;
&lt;!-- vale HouseStyle.Spelling = NO --&gt;
&lt;p&gt;&lt;img src=&quot;/blog/assets/images/authors/coreylarson.jpg&quot; class=&quot;align-center&quot; alt=&quot;align center&quot; /&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/blog/assets/images/authors/coreylarson.jpg&quot; class=&quot;align-right&quot; alt=&quot;alighn right&quot; /&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/blog/assets/images/authors/coreylarson.jpg&quot; class=&quot;align-left&quot; alt=&quot;align left&quot; /&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa.&lt;/p&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. &lt;img src=&quot;/blog/assets/images/example/alex-draw.png&quot; class=&quot;align-right&quot; width=&quot;300&quot; alt=&quot;pic with only 100px width&quot; /&gt;&lt;br /&gt;
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. &lt;!-- vale HouseStyle.Spelling = YES --&gt; ### More Example Usage&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://mmistakes.github.io/minimal-mistakes/docs/quick-start-guide/&quot;&gt;Theme Guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Sample &lt;a href=&quot;https://mmistakes.github.io/minimal-mistakes/year-archive/&quot;&gt;Rendered Posts&lt;/a&gt; and &lt;a href=&quot;https://github.com/mmistakes/minimal-mistakes/tree/d6444412c63aea5e47241ef536509fb1bfef4830/docs/_posts&quot;&gt;Raw mardown&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Markdown stuff (pandoc): &lt;a href=&quot;https://laurentrdc.github.io/pandoc-plot/&quot;&gt;Graphs&lt;/a&gt; and &lt;a href=&quot;https://pandoc.org/MANUAL.html#pandocs-markdown&quot;&gt;markdown&lt;/a&gt; &lt;!-- vale on --&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Adam Gordon Bell</name></author><category term="News" /><summary type="html">This post is in the future, and won’t show up in the published site Image without figure An image with the alt text hidden. An image with alt text printed below. some alt text Image with explicit figure Alex likes to draw and add a caption Image with implicit figure This is my alt text and my figure. The alt text is used as the default figure if not specified. Image Wide This should be wide graph using matplotlib Code blocks (with syntax highlighting) syntax = &amp;quot;proto3&amp;quot;; package simplekeyvalue; option go_package = &amp;quot;kvapi&amp;quot;; // The key/value API contains two procedures for storing and retrieving data service KeyValue { rpc Set (SetRequest) returns (SetReply) {} rpc Get (GetRequest) returns (GetReply) {} } Raw code blocks {{ raw template code}} Use raw and endraw for code that overlaps with the liquid templates Fensed code blocks object Main extends App { println(&amp;quot;Hello, World!&amp;quot;) } Code with Captions object Main extends App { println(&amp;quot;Hello, World!&amp;quot;) } Main.scala Notice Markdown here one two ℹ️ Notice Info Markdown here one two Warning Markdown here one two Success Markdown here More example Image layouts Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. ### More Example Usage Theme Guide Sample Rendered Posts and Raw mardown Markdown stuff (pandoc): Graphs and markdown</summary></entry><entry><title type="html">10+ Best Continuous Delivery Tools</title><link href="https://earthly.dev/blog/10-continous-delivery/" rel="alternate" type="text/html" title="10+ Best Continuous Delivery Tools" /><published>2022-08-10T00:00:00-04:00</published><updated>2022-08-10T00:00:00-04:00</updated><id>https://earthly.dev/blog/10-continous-delivery</id><content type="html" xml:base="https://earthly.dev/blog/10-continous-delivery/">&lt;h2 id=&quot;draft.dev-article-checklist&quot;&gt;Draft.dev Article Checklist&lt;/h2&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;input type=&quot;checkbox&quot; disabled=&quot;&quot; /&gt;
Add in Author page&lt;/li&gt;
&lt;li&gt;&lt;input type=&quot;checkbox&quot; disabled=&quot;&quot; /&gt;
Create header image in Canva&lt;/li&gt;
&lt;li&gt;&lt;input type=&quot;checkbox&quot; disabled=&quot;&quot; /&gt;
Optional: Find ways to break up content with quotes or images&lt;/li&gt;
&lt;li&gt;&lt;input type=&quot;checkbox&quot; disabled=&quot;&quot; /&gt;
Verify look of article locally&lt;/li&gt;
&lt;li&gt;&lt;input type=&quot;checkbox&quot; disabled=&quot;&quot; /&gt;
Run mark down linter (&lt;code&gt;earthly +blog-lint-apply&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;&lt;input type=&quot;checkbox&quot; disabled=&quot;&quot; /&gt;
Add keywords for internal links to front-matter&lt;/li&gt;
&lt;li&gt;&lt;input type=&quot;checkbox&quot; disabled=&quot;&quot; /&gt;
Run &lt;code&gt;earthly +link-opportunity&lt;/code&gt; and find 1-5 places to incorporate links&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Chinedu Imoh</name></author><category term="Tutorials" /><summary type="html">Draft.dev Article Checklist Add in Author page Create header image in Canva Optional: Find ways to break up content with quotes or images Verify look of article locally Run mark down linter (earthly +blog-lint-apply) Add keywords for internal links to front-matter Run earthly +link-opportunity and find 1-5 places to incorporate links</summary></entry><entry><title type="html">Understanding and Using Makefile Flags</title><link href="https://earthly.dev/blog/make-flags/" rel="alternate" type="text/html" title="Understanding and Using Makefile Flags" /><published>2021-09-02T00:00:00-04:00</published><updated>2021-09-02T00:00:00-04:00</updated><id>https://earthly.dev/blog/make-flags</id><content type="html" xml:base="https://earthly.dev/blog/make-flags/">&lt;p&gt;&lt;code&gt;make&lt;/code&gt; is a commonplace utility in the development world. It automates the process of generating executables, documentations, and other non-source files from the source code by dividing the build process into separate interrelated steps. Using &lt;code&gt;make&lt;/code&gt; eliminates the need for typing out long and complex commands to compile the source code. &lt;code&gt;make&lt;/code&gt; also compiles only the modified files, thereby saving time and processing resources.&lt;/p&gt;
&lt;p&gt;Usually, the build process involves invoking various command-line tools, like the compiler or preprocessor. Often you need to pass options to these tools as per your requirements. However, hard-coding these options in your &lt;code&gt;makefile&lt;/code&gt; can lead to difficulties. As an example, consider the following &lt;code&gt;makefile&lt;/code&gt; snippet:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
main.o: main.c
    gcc -Wall -c main.c&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This snippet compiles &lt;code&gt;main.c&lt;/code&gt; to &lt;code&gt;main.o&lt;/code&gt; by invoking &lt;code&gt;gcc&lt;/code&gt; with the &lt;code&gt;-Wall&lt;/code&gt; option. But let’s say that you do not wish to pass the &lt;code&gt;-Wall&lt;/code&gt; option; instead, you want to pass the &lt;code&gt;-Werror&lt;/code&gt; option. The only way of doing that is to edit the &lt;code&gt;makefile&lt;/code&gt; to change the options. There is no convenient way to override the options without modifying the &lt;code&gt;makefile&lt;/code&gt;. This is where &lt;code&gt;make&lt;/code&gt; flags come into play.&lt;/p&gt;
&lt;p&gt;Flags in &lt;code&gt;make&lt;/code&gt; are just variables containing options that should be passed to the tools used in the compilation process. Although you can use any variable for this purpose, &lt;code&gt;make&lt;/code&gt; defines some commonly used flags with default values for some common tools, including C and C++ compiler, C preprocessor, &lt;code&gt;lex&lt;/code&gt;, and &lt;code&gt;yacc&lt;/code&gt;. For example, &lt;code&gt;CFLAGS&lt;/code&gt; is used to pass options to the C compiler, while &lt;code&gt;CXXFLAGS&lt;/code&gt; is used in conjunction with the C++ compiler.&lt;/p&gt;
&lt;h2 id=&quot;why-should-you-use-flags&quot;&gt;Why Should You Use Flags?&lt;/h2&gt;
&lt;p&gt;There are a few benefits to using flags over hard-coded options.&lt;/p&gt;
&lt;p&gt;First, just like any other &lt;code&gt;makefile&lt;/code&gt; variable, these flags can be overridden when invoking &lt;code&gt;make&lt;/code&gt; from the command line. This feature offers a way to use any flag the user desires, as well as provides a default. For example, consider the following &lt;code&gt;makefile&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
CFLAGS = -g

all: main.o
    gcc -o main $(CFLAGS) main.o&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;When you run &lt;code&gt;make&lt;/code&gt;, it executes &lt;code&gt;gcc -o main -g main.o&lt;/code&gt;. The value of &lt;code&gt;$(CFLAGS)&lt;/code&gt; is substituted when the command is executed. However, you can change the value of &lt;code&gt;$(CFLAGS)&lt;/code&gt; by providing the new value when invoking &lt;code&gt;make&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;shell
make CFLAGS=&amp;quot;-Wall&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This time, the command that will be executed is &lt;code&gt;gcc -o main -Wall main.o&lt;/code&gt;. The value of &lt;code&gt;$(CFLAGS)&lt;/code&gt; provided in the command line overrides the defined value in the &lt;code&gt;makefile&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Since any &lt;code&gt;make&lt;/code&gt; variable can be overridden by providing its value in the command line, you may wonder why the manual recommends using special names for the variables. The reason is that by using the flags you can make use of the implicit rules provided by &lt;code&gt;make&lt;/code&gt;. The &lt;a href=&quot;https://www.gnu.org/software/make/manual/html_node/Catalogue-of-Rules.html#Catalogue-of-Rules&quot;&gt;implicit rules&lt;/a&gt; are a list of built-in rules that utilize the flags. For example, consider the following &lt;code&gt;makefile&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
CC = gcc
CFLAGS = -g # Flag to pass to gcc
CPPFLAGS = -I. # Flag to pass to the C preprocessor

all: main.o&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If you have a &lt;code&gt;main.c&lt;/code&gt; file in the project directory, running &lt;code&gt;make&lt;/code&gt; will automatically compile it to &lt;code&gt;main.o&lt;/code&gt;, even though you did not explicitly add any coding to build &lt;code&gt;main.o&lt;/code&gt;. This is because &lt;code&gt;make&lt;/code&gt; uses a built-in rule of the form &lt;code&gt;$(CC) $(CPPFLAGS) $(CFLAGS) -c -o x.o x.c&lt;/code&gt; to compile any C file &lt;code&gt;x.c&lt;/code&gt; into &lt;code&gt;x.o&lt;/code&gt;. Thus, using implicit rules, you don’t have to explicitly write the coding.&lt;/p&gt;
&lt;p&gt;Another reason is that these flags are standardized and have been used for a long time, so anyone building your software will expect you to use these flags. Using any other variable would force them to go through your &lt;code&gt;makefile&lt;/code&gt; in order to figure out which variable is being used. Instead, by sticking to the standard, you can save them time.&lt;/p&gt;
&lt;h2 id=&quot;how-to-use-make-flags&quot;&gt;How to Use &lt;code&gt;Make&lt;/code&gt; Flags&lt;/h2&gt;
&lt;p&gt;You can use &lt;code&gt;make&lt;/code&gt; flags just like any other &lt;code&gt;make&lt;/code&gt; variable. Define the flags with default values using the &lt;code&gt;=&lt;/code&gt; operator, and use the flags using the &lt;code&gt;$(...)&lt;/code&gt; syntax:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
CC = gcc # It is a recommended practice to define the C compiler with CC
CFLAGS = -Wall # Defines -Wall as default flag

main.o: main.c
    $(CC) $(CFLAGS) -c main.c&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can also override the flags when invoking main, as explained earlier:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;shell
make CFLAGS=&amp;quot;-g -Wall&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Since &lt;code&gt;make&lt;/code&gt; already defines these flags with default values (an empty string for most of them), you don’t have to define them in the &lt;code&gt;makefile&lt;/code&gt; explicitly if you don’t want to have a default value, and you can use them directly from the command line. For example, the following &lt;code&gt;makefile&lt;/code&gt; is valid, and &lt;code&gt;CFLAGS&lt;/code&gt; is set to the empty string, which means no options are passed to the compiler.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
CC = gcc # It is a recommended practice to define the C compiler with CC

main.o: main.c
    $(CC) $(CFLAGS) -c main.c&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can still define &lt;code&gt;CFLAGS&lt;/code&gt; from the command line:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;shell
make CFLAGS=&amp;quot;-Wall&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;some-commonly-used-flags&quot;&gt;Some Commonly Used Flags&lt;/h2&gt;
&lt;p&gt;Here are a few commonly used flags. For a full list of flags, check the &lt;a href=&quot;https://www.gnu.org/software/make/manual/make.html#index-ARFLAGS&quot;&gt;manual&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;cflags&quot;&gt;CFLAGS&lt;/h3&gt;
&lt;p&gt;This flag should contain the options to give to the C compiler. These options can include debug options, optimization level, warning levels, and any extra flags that you want to use.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
CC = gcc

CFLAGS = -g -Wall # Passes -g and -Wall to gcc

main.o: main.c
    $(CC) $(CFLAGS) -c main.c &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If you have options that are required for proper compilation, the &lt;a href=&quot;https://www.gnu.org/software/make/manual/html_node/Command-Variables.html#Command-Variables&quot;&gt;manual suggests&lt;/a&gt; putting the optional ones in &lt;code&gt;CFLAGS&lt;/code&gt; and adding the required options to &lt;code&gt;CFLAGS&lt;/code&gt; separately. This way the user can override &lt;code&gt;CFLAGS&lt;/code&gt; via the command line, but the required options will not be overridden.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
CFLAGS = -g # Optional. Not required for proper compilation
ALL_CFLAGS = -I. $(CFLAGS) # -I. is required for proper compilation
main.o: main.c
        $(CC) -c $(ALL_CFLAGS) main.c&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;cxxflags&quot;&gt;CXXFLAGS&lt;/h3&gt;
&lt;p&gt;This flag is similar to &lt;code&gt;CFLAGS&lt;/code&gt;, except that you should use &lt;code&gt;CXXFLAGS&lt;/code&gt; when invoking a &lt;a href=&quot;/blog/g++-makefile&quot;&gt;C++ compiler&lt;/a&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
CXX = g++

CXXFLAGS = -g -Wall # Passes -g and -Wall to g++

main.o: main.cpp
    $(CXX) $(CXXFLAGS) -o main.o main.cpp&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;cppflags&quot;&gt;CPPFLAGS&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;CPPFLAGS&lt;/code&gt; is used to pass extra flags to the C preprocessor. These flags are also used by any programs that use the C preprocessor, including the C, C++, and Fortran compilers. You do not need to explicitly call the C preprocessor. Pass &lt;code&gt;CPPFLAGS&lt;/code&gt; to the compiler, and these will be used when the compiler invokes the preprocessor. The most common use case of &lt;code&gt;CPPFLAGS&lt;/code&gt; is to include directories to the compiler search path using the &lt;code&gt;-I&lt;/code&gt; option.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
CC = gcc
CFLAGS = -g -Wall
CPPFLAGS = - I /usr/foo/bar # Search for header files in /usr/foo/bar

main.o: main.c
    $(CC) $(CPPFLAGS) $(CFLAGS) -c main.c &lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;ldflags&quot;&gt;LDFLAGS&lt;/h3&gt;
&lt;p&gt;You can use &lt;code&gt;LDFLAGS&lt;/code&gt; to pass extra flags to the linker &lt;code&gt;lD&lt;/code&gt;. Similar to &lt;code&gt;CPPFLAGS&lt;/code&gt;, these flags are automatically passed to the linker when the compiler invokes it. The most common use is to specify directories where the libraries can be found, using the &lt;code&gt;-L&lt;/code&gt; option. You should not include the names of the libraries in &lt;code&gt;LDFLAGS&lt;/code&gt;; instead they go into &lt;code&gt;LDLIBS&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
LDFLAGS = -L. \ # Search for libraries in the current directory
          -L/usr/foo # Search for libraries in /usr/foo

main.o: main.c
    gcc $(LDFLAGS) -c main.c &lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;ldlibs&quot;&gt;LDLIBS&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;LDLIBS&lt;/code&gt; flag should contain the space-separated list of libraries that are used by your programs. For this flag, the &lt;code&gt;-l&lt;/code&gt; option followed by the name of the library is used. For example, if your software uses &lt;code&gt;libm&lt;/code&gt;, the math library, then you need to include the &lt;code&gt;-lm&lt;/code&gt; option.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
LDFLAGS = -L. \ # Search for libraries in the current directory
          -L/usr/foo # Search for libraries in /usr/foo

LDLIBS = -lm -lfoo # Use libm and libfoo

main.o: main.c
    gcc $(LDFLAGS) -c main.c $(LDLIBS)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Keep in mind that &lt;code&gt;LDLIBS&lt;/code&gt; should be included &lt;em&gt;after&lt;/em&gt; you have listed all your source files. Otherwise the linker will not be able to link the symbols properly.&lt;/p&gt;
&lt;h3 id=&quot;lflags&quot;&gt;LFLAGS&lt;/h3&gt;
&lt;p&gt;This flag is used if you are working with &lt;code&gt;lex&lt;/code&gt;, a tool used to generate lexical analyzers. &lt;code&gt;Lex&lt;/code&gt; takes a list of token definitions in a &lt;code&gt;.l&lt;/code&gt; file and generates a C program that can take an input and tokenize it accordingly. You can find a basic introduction to &lt;code&gt;lex&lt;/code&gt; &lt;a href=&quot;https://www.ibm.com/docs/en/zos/2.4.0?topic=tools-generating-lexical-analyzer-using-lex#genlex&quot;&gt;on IBM’s documentation site&lt;/a&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
LEX = flex # Use flex as the lex program
LFLAGS = -d # enable debug

lexer.c: lexer.l
    $(LEX) $(LFLAGS) lexer.l&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;yflags&quot;&gt;YFLAGS&lt;/h3&gt;
&lt;p&gt;This flag is used to pass options to &lt;code&gt;yacc&lt;/code&gt;. This is a tool that is often used in conjunction with &lt;code&gt;lex&lt;/code&gt;. &lt;code&gt;Yacc&lt;/code&gt; is a parser generator; it converts a grammar definition in a &lt;code&gt;.y&lt;/code&gt; file into a C program, which can parse the tokenized output of &lt;code&gt;lex&lt;/code&gt; into a parse tree. &lt;a href=&quot;https://www.ibm.com/docs/en/zos/2.4.0?topic=tools-generating-parser-using-yacc#genyac&quot;&gt;IBM&lt;/a&gt; has a tutorial if you’d like to find out more about &lt;code&gt;yacc&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
YACC = bison # Use bison as the yacc program
YFLAGS = -v \ # Verbose mode
        -g # Generate graph

parser.c: parser.y
    $(YACC) $(YFLAGS) parser.y&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;makeflags&quot;&gt;MAKEFLAGS&lt;/h3&gt;
&lt;p&gt;This is an interesting flag that is used in recursive invocation of &lt;code&gt;make&lt;/code&gt;. If you have modules or subsystems in your project, it is likely that each subsystem will have its own &lt;code&gt;makefile&lt;/code&gt;. The top-level &lt;code&gt;makefile&lt;/code&gt; will then recursively call &lt;code&gt;make&lt;/code&gt; for each of the modules. The &lt;code&gt;MAKEFLAGS&lt;/code&gt; variable is automatically set up by &lt;code&gt;make&lt;/code&gt;, and it contains all the flags and command line variables that you passed to the top-level &lt;code&gt;make&lt;/code&gt;. The &lt;code&gt;MAKEFLAGS&lt;/code&gt; variables will pass these options and variables down to each sub-&lt;code&gt;make&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;To test this, create a directory called &lt;code&gt;subdir&lt;/code&gt; and create a &lt;code&gt;makefile&lt;/code&gt; in this &lt;code&gt;subdir&lt;/code&gt; with the following content:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
all:
 echo $(MAKEFLAGS)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This will print out the value of the &lt;code&gt;MAKEFLAGS&lt;/code&gt; variable.&lt;/p&gt;
&lt;p&gt;Then in your top-level &lt;code&gt;makefile&lt;/code&gt;, write the following:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
subsystem:
 cd subdir &amp;amp;&amp;amp; $(MAKE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This &lt;code&gt;makefile&lt;/code&gt; recursively calls &lt;code&gt;make&lt;/code&gt; in the &lt;code&gt;subdir&lt;/code&gt; subdirectory.&lt;/p&gt;
&lt;p&gt;Now you can run &lt;code&gt;make&lt;/code&gt; from your project root with options:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;shell
$  make -sk CFLAGS=&amp;quot;-g&amp;quot;
ks -- CFLAGS=-g&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As you can see, the options &lt;code&gt;-k&lt;/code&gt; and &lt;code&gt;-s&lt;/code&gt; were passed to the sub-&lt;code&gt;make&lt;/code&gt;, as well as the variables.&lt;/p&gt;
&lt;p&gt;Note that the options &lt;code&gt;-C&lt;/code&gt;, &lt;code&gt;-f&lt;/code&gt;, &lt;code&gt;-o&lt;/code&gt;, and &lt;code&gt;-W&lt;/code&gt; are not put into &lt;code&gt;MAKEFLAGS&lt;/code&gt; and not passed down. You can read more about &lt;code&gt;MAKEFLAGS&lt;/code&gt; &lt;a href=&quot;https://www.gnu.org/software/make/manual/html_node/Options_002fRecursion.html#Options_002fRecursion&quot;&gt;on GNU.org&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Using &lt;code&gt;make&lt;/code&gt; flags ensures your &lt;code&gt;makefile&lt;/code&gt; follows the standard and offers an easy and powerful way to customize the behaviors of the compilation tools by providing them options. However, &lt;code&gt;make&lt;/code&gt; flags are limited and require a deep understanding of the right tools to use.&lt;/p&gt;
&lt;p&gt;If you are looking for a powerful alternative to &lt;code&gt;make&lt;/code&gt;, &lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; may be the right choice for you. It is a modern take on the &lt;code&gt;make&lt;/code&gt; utility. Tailored for the container era, Earthly provides reproducible and understandable builds with minimal effort.&lt;/p&gt;</content><author><name>Aniket Bhattacharyea</name></author><category term="Tutorials" /><summary type="html">make is a commonplace utility in the development world. It automates the process of generating executables, documentations, and other non-source files from the source code by dividing the build process into separate interrelated steps. Using make eliminates the need for typing out long and complex commands to compile the source code. make also compiles only the modified files, thereby saving time and processing resources. Usually, the build process involves invoking various command-line tools, like the compiler or preprocessor. Often you need to pass options to these tools as per your requirements. However, hard-coding these options in your makefile can lead to difficulties. As an example, consider the following makefile snippet: Makefile main.o: main.c gcc -Wall -c main.c This snippet compiles main.c to main.o by invoking gcc with the -Wall option. But let’s say that you do not wish to pass the -Wall option; instead, you want to pass the -Werror option. The only way of doing that is to edit the makefile to change the options. There is no convenient way to override the options without modifying the makefile. This is where make flags come into play. Flags in make are just variables containing options that should be passed to the tools used in the compilation process. Although you can use any variable for this purpose, make defines some commonly used flags with default values for some common tools, including C and C++ compiler, C preprocessor, lex, and yacc. For example, CFLAGS is used to pass options to the C compiler, while CXXFLAGS is used in conjunction with the C++ compiler. Why Should You Use Flags? There are a few benefits to using flags over hard-coded options. First, just like any other makefile variable, these flags can be overridden when invoking make from the command line. This feature offers a way to use any flag the user desires, as well as provides a default. For example, consider the following makefile: Makefile CFLAGS = -g all: main.o gcc -o main $(CFLAGS) main.o When you run make, it executes gcc -o main -g main.o. The value of $(CFLAGS) is substituted when the command is executed. However, you can change the value of $(CFLAGS) by providing the new value when invoking make: shell make CFLAGS=&amp;quot;-Wall&amp;quot; This time, the command that will be executed is gcc -o main -Wall main.o. The value of $(CFLAGS) provided in the command line overrides the defined value in the makefile. Since any make variable can be overridden by providing its value in the command line, you may wonder why the manual recommends using special names for the variables. The reason is that by using the flags you can make use of the implicit rules provided by make. The implicit rules are a list of built-in rules that utilize the flags. For example, consider the following makefile: Makefile CC = gcc CFLAGS = -g # Flag to pass to gcc CPPFLAGS = -I. # Flag to pass to the C preprocessor all: main.o If you have a main.c file in the project directory, running make will automatically compile it to main.o, even though you did not explicitly add any coding to build main.o. This is because make uses a built-in rule of the form $(CC) $(CPPFLAGS) $(CFLAGS) -c -o x.o x.c to compile any C file x.c into x.o. Thus, using implicit rules, you don’t have to explicitly write the coding. Another reason is that these flags are standardized and have been used for a long time, so anyone building your software will expect you to use these flags. Using any other variable would force them to go through your makefile in order to figure out which variable is being used. Instead, by sticking to the standard, you can save them time. How to Use Make Flags You can use make flags just like any other make variable. Define the flags with default values using the = operator, and use the flags using the $(...) syntax: Makefile CC = gcc # It is a recommended practice to define the C compiler with CC CFLAGS = -Wall # Defines -Wall as default flag main.o: main.c $(CC) $(CFLAGS) -c main.c You can also override the flags when invoking main, as explained earlier: shell make CFLAGS=&amp;quot;-g -Wall&amp;quot; Since make already defines these flags with default values (an empty string for most of them), you don’t have to define them in the makefile explicitly if you don’t want to have a default value, and you can use them directly from the command line. For example, the following makefile is valid, and CFLAGS is set to the empty string, which means no options are passed to the compiler. Makefile CC = gcc # It is a recommended practice to define the C compiler with CC main.o: main.c $(CC) $(CFLAGS) -c main.c You can still define CFLAGS from the command line: shell make CFLAGS=&amp;quot;-Wall&amp;quot; Some Commonly Used Flags Here are a few commonly used flags. For a full list of flags, check the manual. CFLAGS This flag should contain the options to give to the C compiler. These options can include debug options, optimization level, warning levels, and any extra flags that you want to use. Makefile CC = gcc CFLAGS = -g -Wall # Passes -g and -Wall to gcc main.o: main.c $(CC) $(CFLAGS) -c main.c If you have options that are required for proper compilation, the manual suggests putting the optional ones in CFLAGS and adding the required options to CFLAGS separately. This way the user can override CFLAGS via the command line, but the required options will not be overridden. Makefile CFLAGS = -g # Optional. Not required for proper compilation ALL_CFLAGS = -I. $(CFLAGS) # -I. is required for proper compilation main.o: main.c $(CC) -c $(ALL_CFLAGS) main.c CXXFLAGS This flag is similar to CFLAGS, except that you should use CXXFLAGS when invoking a C++ compiler. Makefile CXX = g++ CXXFLAGS = -g -Wall # Passes -g and -Wall to g++ main.o: main.cpp $(CXX) $(CXXFLAGS) -o main.o main.cpp CPPFLAGS CPPFLAGS is used to pass extra flags to the C preprocessor. These flags are also used by any programs that use the C preprocessor, including the C, C++, and Fortran compilers. You do not need to explicitly call the C preprocessor. Pass CPPFLAGS to the compiler, and these will be used when the compiler invokes the preprocessor. The most common use case of CPPFLAGS is to include directories to the compiler search path using the -I option. Makefile CC = gcc CFLAGS = -g -Wall CPPFLAGS = - I /usr/foo/bar # Search for header files in /usr/foo/bar main.o: main.c $(CC) $(CPPFLAGS) $(CFLAGS) -c main.c LDFLAGS You can use LDFLAGS to pass extra flags to the linker lD. Similar to CPPFLAGS, these flags are automatically passed to the linker when the compiler invokes it. The most common use is to specify directories where the libraries can be found, using the -L option. You should not include the names of the libraries in LDFLAGS; instead they go into LDLIBS. Makefile LDFLAGS = -L. \ # Search for libraries in the current directory -L/usr/foo # Search for libraries in /usr/foo main.o: main.c gcc $(LDFLAGS) -c main.c LDLIBS The LDLIBS flag should contain the space-separated list of libraries that are used by your programs. For this flag, the -l option followed by the name of the library is used. For example, if your software uses libm, the math library, then you need to include the -lm option. Makefile LDFLAGS = -L. \ # Search for libraries in the current directory -L/usr/foo # Search for libraries in /usr/foo LDLIBS = -lm -lfoo # Use libm and libfoo main.o: main.c gcc $(LDFLAGS) -c main.c $(LDLIBS) Keep in mind that LDLIBS should be included after you have listed all your source files. Otherwise the linker will not be able to link the symbols properly. LFLAGS This flag is used if you are working with lex, a tool used to generate lexical analyzers. Lex takes a list of token definitions in a .l file and generates a C program that can take an input and tokenize it accordingly. You can find a basic introduction to lex on IBM’s documentation site. Makefile LEX = flex # Use flex as the lex program LFLAGS = -d # enable debug lexer.c: lexer.l $(LEX) $(LFLAGS) lexer.l YFLAGS This flag is used to pass options to yacc. This is a tool that is often used in conjunction with lex. Yacc is a parser generator; it converts a grammar definition in a .y file into a C program, which can parse the tokenized output of lex into a parse tree. IBM has a tutorial if you’d like to find out more about yacc. Makefile YACC = bison # Use bison as the yacc program YFLAGS = -v \ # Verbose mode -g # Generate graph parser.c: parser.y $(YACC) $(YFLAGS) parser.y MAKEFLAGS This is an interesting flag that is used in recursive invocation of make. If you have modules or subsystems in your project, it is likely that each subsystem will have its own makefile. The top-level makefile will then recursively call make for each of the modules. The MAKEFLAGS variable is automatically set up by make, and it contains all the flags and command line variables that you passed to the top-level make. The MAKEFLAGS variables will pass these options and variables down to each sub-make. To test this, create a directory called subdir and create a makefile in this subdir with the following content: Makefile all: echo $(MAKEFLAGS) This will print out the value of the MAKEFLAGS variable. Then in your top-level makefile, write the following: Makefile subsystem: cd subdir &amp;amp;&amp;amp; $(MAKE) This makefile recursively calls make in the subdir subdirectory. Now you can run make from your project root with options: shell $ make -sk CFLAGS=&amp;quot;-g&amp;quot; ks -- CFLAGS=-g As you can see, the options -k and -s were passed to the sub-make, as well as the variables. Note that the options -C, -f, -o, and -W are not put into MAKEFLAGS and not passed down. You can read more about MAKEFLAGS on GNU.org. Conclusion Using make flags ensures your makefile follows the standard and offers an easy and powerful way to customize the behaviors of the compilation tools by providing them options. However, make flags are limited and require a deep understanding of the right tools to use. If you are looking for a powerful alternative to make, Earthly may be the right choice for you. It is a modern take on the make utility. Tailored for the container era, Earthly provides reproducible and understandable builds with minimal effort.</summary></entry><entry><title type="html">Makefile Tutorials and Examples to Build From</title><link href="https://earthly.dev/blog/make-tutorial/" rel="alternate" type="text/html" title="Makefile Tutorials and Examples to Build From" /><published>2021-09-02T00:00:00-04:00</published><updated>2021-09-02T00:00:00-04:00</updated><id>https://earthly.dev/blog/make-tutorial</id><content type="html" xml:base="https://earthly.dev/blog/make-tutorial/">&lt;p&gt;Building software is a multi-step process—installing or updating dependencies, compiling the source code, testing, installing, and so on. In any moderately sized project, you might find it difficult to perform all these steps manually. This is where &lt;code&gt;make&lt;/code&gt; can help you.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;make&lt;/code&gt; tool automates compilation of the software from the source code. It won’t repeat a step if none of its prerequisites has changed, thus saving you time and resources.&lt;/p&gt;
&lt;p&gt;In this article, you will learn how to write a simple Makefile and learn about important components of &lt;code&gt;make&lt;/code&gt;, including variables, pattern rules, and virtual paths. You will also see some examples of using &lt;code&gt;make&lt;/code&gt; with different technologies.&lt;/p&gt;
&lt;h2 id=&quot;the-makefile&quot;&gt;The Makefile&lt;/h2&gt;
&lt;p&gt;When you run &lt;code&gt;make&lt;/code&gt;, it looks for a file named &lt;code&gt;Makefile&lt;/code&gt;, or &lt;code&gt;makefile&lt;/code&gt; in the same directory. The name &lt;code&gt;Makefile&lt;/code&gt; is suggested so that it appears near other important files such as &lt;code&gt;README&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;You can name your Makefile anything, but then you have to explicitly tell &lt;code&gt;make&lt;/code&gt; which file to read:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;shell
make -f some_other_makefile&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The Makefile should consist of one or more rules. Each rule describes a goal or a step in your build process, the prerequisites for that step, and recipes for how to execute it.&lt;/p&gt;
&lt;p&gt;The format for each rule is as follows:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
target1 [target2 ...]: [pre-req1 pre-req2 pre-req3 ...]
    [recipes
    ...]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The parts in &lt;code&gt;[]&lt;/code&gt; are optional. Each rule must have one or more targets, zero or more prerequisites, and zero or more recipes. The &lt;code&gt;target&lt;/code&gt; is the file you want to be created in that rule. The prerequisites can be the name of an existing rule, or the name of a file in the same directory. The recipes are shell commands that need to be run in order to generate the target.&lt;/p&gt;
&lt;p&gt;When &lt;code&gt;make&lt;/code&gt; executes a rule, it looks at the prerequisites. If all the prerequisites are older than the target file, it means that none of them has changed since the last time the rule was executed. So &lt;code&gt;make&lt;/code&gt; does not execute the rule. If, however, any prerequisite is newer than the target, the recipes are executed.&lt;/p&gt;
&lt;p&gt;Here’s an example. Create a file named &lt;code&gt;data.txt&lt;/code&gt; with the text &lt;code&gt;hello world.&lt;/code&gt; You’ll use the &lt;code&gt;wc&lt;/code&gt; command to calculate the number of characters, words, and lines and store it in a file named &lt;code&gt;count.txt&lt;/code&gt;. In this simple demonstration, you have a dependency and a target that needs to be built from the dependency.&lt;/p&gt;
&lt;p&gt;First, let’s do it manually.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;shell
wc -c data.txt &amp;gt; count.txt # Count characters
wc -w data.txt &amp;gt;&amp;gt; count.txt # Count words
wc -l data.txt &amp;gt;&amp;gt; count.txt # Count lines&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This should create a file named &lt;code&gt;count.txt&lt;/code&gt; with the following content:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;13 data.txt
2 data.txt
0 data.txt&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let’s write the Makefile to automate this:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
all: count.txt 

count.txt: data.txt
    wc -c data.txt &amp;gt; count.txt # Count characters
    wc -w data.txt &amp;gt;&amp;gt; count.txt # Count words
    wc -l data.txt &amp;gt;&amp;gt; count.txt # Count lines&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This Makefile has two targets. The first target is &lt;code&gt;all&lt;/code&gt;, which acts like an overall build target. It is not necessary to have such a target, especially when our build has only one step, but it is a recommended practice.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;all&lt;/code&gt; target depends on &lt;code&gt;count.txt&lt;/code&gt; and has no recipe. This means that &lt;code&gt;all&lt;/code&gt; will be prepared as soon as &lt;code&gt;count.txt&lt;/code&gt; is prepared.&lt;/p&gt;
&lt;p&gt;The target &lt;code&gt;count.txt&lt;/code&gt; depends on the file &lt;code&gt;data.txt&lt;/code&gt; and the recipes list contains the commands you ran previously.&lt;/p&gt;
&lt;p&gt;Now, run &lt;code&gt;make&lt;/code&gt; again from the terminal. You should see that &lt;code&gt;make&lt;/code&gt; executes the commands listed and creates &lt;code&gt;count.txt&lt;/code&gt;. If you run the &lt;code&gt;make&lt;/code&gt; command again, you should see the output:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make: Nothing to be done for &amp;#39;all&amp;#39;.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let’s break it down. When you run &lt;code&gt;make&lt;/code&gt; without any argument, it runs the first target, which is &lt;code&gt;all&lt;/code&gt; in this case. Since &lt;code&gt;all&lt;/code&gt; depends on &lt;code&gt;count.txt&lt;/code&gt;, that target is executed. The target &lt;code&gt;count.txt&lt;/code&gt; depends on &lt;code&gt;data.txt&lt;/code&gt;, so the commands are run and the file is generated.&lt;/p&gt;
&lt;p&gt;The next time you run &lt;code&gt;make&lt;/code&gt; following the same sequence, &lt;code&gt;make&lt;/code&gt; looks at &lt;code&gt;count.txt&lt;/code&gt; and notices that &lt;code&gt;count.txt&lt;/code&gt; is newer than &lt;code&gt;data.txt&lt;/code&gt;, meaning the dependency has not been changed since the last time &lt;code&gt;make&lt;/code&gt; was run, so it doesn’t do anything.&lt;/p&gt;
&lt;p&gt;Edit the &lt;code&gt;data.txt&lt;/code&gt; file and change the text to &lt;code&gt;hi world&lt;/code&gt;. Now when you run &lt;code&gt;make&lt;/code&gt;, it runs the commands and updates &lt;code&gt;count.txt&lt;/code&gt;. Since the dependency was changed, it rebuilt the target.&lt;/p&gt;
&lt;p&gt;You can also run a target directly by passing its name to the &lt;code&gt;make&lt;/code&gt; command. Running &lt;code&gt;make count.txt&lt;/code&gt; will run only the &lt;code&gt;count.txt&lt;/code&gt; rule.&lt;/p&gt;
&lt;p&gt;Let’s add a rule to clean the project files. It is a recommended practice to have a &lt;code&gt;clean&lt;/code&gt; rule to delete any generated files, effectively returning the project to the initial state. Add the following rule to your Makefile:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
clean:
    rm count.txt&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The &lt;code&gt;clean&lt;/code&gt; rule doesn’t have a prerequisite. The targets without a prerequisite are considered to be older than their dependencies, and so they’re always run.&lt;/p&gt;
&lt;h2 id=&quot;components-of-makefile&quot;&gt;Components of Makefile&lt;/h2&gt;
&lt;p&gt;Here are some important components that can help you write more concise and simpler Makefiles.&lt;/p&gt;
&lt;h3 id=&quot;comments&quot;&gt;Comments&lt;/h3&gt;
&lt;p&gt;You can have comments in Makefile that start with a &lt;code&gt;#&lt;/code&gt; and last till the end of the line.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
all: count.txt # This is a comment
...&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;variables&quot;&gt;Variables&lt;/h3&gt;
&lt;p&gt;Just like regular programming languages, &lt;code&gt;make&lt;/code&gt; supports using variables to avoid repetitions and keep the Makefile clean. Another advantage of variables is that the user can override them without needing to edit the Makefile manually.&lt;/p&gt;
&lt;p&gt;A variable in Makefile starts with a $ and is enclosed in parentheses () or braces {}, unless it’s a single character variable. To set a variable, write a line starting with a variable name followed by &lt;code&gt;=&lt;/code&gt;, &lt;code&gt;:=&lt;/code&gt; or &lt;code&gt;::=&lt;/code&gt;, followed by the value of the variable:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
TARGET = count.txt
SOURCE = data.txt&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The variables defined with &lt;code&gt;=&lt;/code&gt; are called “recursively expanded variables,” and those defined with &lt;code&gt;:=&lt;/code&gt; and &lt;code&gt;::=&lt;/code&gt; are called “simply expanded variables.” There is a subtle difference between these two, which you can read about in the &lt;a href=&quot;https://www.gnu.org/software/make/manual/make.html#Flavors&quot;&gt;manual&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;You can reference these values in any of the targets, prerequisites, or recipes:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
TARGET = count.txt
SOURCE = data.txt

all: $(TARGET) 

$(TARGET): $(SOURCE)
    wc -c $(SOURCE) &amp;gt;  $(TARGET) # Count characters
    wc -w $(SOURCE) &amp;gt;&amp;gt; $(TARGET) # Count words
    wc -l $(SOURCE) &amp;gt;&amp;gt; $(TARGET) # Count lines

clean:
   rm $(TARGET)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Here instead of hard-coding the target and source file names, we have used two variables, with default values of &lt;code&gt;count.txt&lt;/code&gt; and &lt;code&gt;data.txt&lt;/code&gt;. If you run the &lt;code&gt;make&lt;/code&gt; command, it should work just like before. However, if you want to change the name of the target to, for example, &lt;code&gt;newcount.txt&lt;/code&gt;, you can do so without changing the Makefile:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;shell
make TARGET=newcount.txt&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Passing &lt;code&gt;TARGET=newcount.txt&lt;/code&gt; overrides the default value of &lt;code&gt;$(TARGET)&lt;/code&gt; in the Makefile and so, instead of &lt;code&gt;count.txt&lt;/code&gt;, the file &lt;code&gt;newcount.txt&lt;/code&gt; is generated. Similarly, you can run &lt;code&gt;make TARGET=newcount.txt clean&lt;/code&gt; to clean this new file.&lt;/p&gt;
&lt;p&gt;When &lt;code&gt;make&lt;/code&gt; is run, it also converts all available environment variables into make variables. So you can freely use any environment variable.&lt;/p&gt;
&lt;h4 id=&quot;automatic-variables&quot;&gt;Automatic Variables&lt;/h4&gt;
&lt;p&gt;There are some special variables called automatic variables. Their values are computed each time for every rule and are based on the target and prerequisite file names. Here are some of the most important automatic variables:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;**$&lt;span class=&quot;citation&quot; data-cites=&quot;*&quot;&gt;@*&lt;/span&gt;*: This is the target file name. If there is more than one target, this is whichever target caused the recipe to run.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;$&lt;/strong&gt;*: This is the target file name without the extension.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;$&amp;lt;&lt;/strong&gt;: This is the name of the first prerequisite.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;$?&lt;/strong&gt;: The names of all the prerequisites that are newer than the target, with spaces between them. If the target does not exist, all prerequisites will be included.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;$^&lt;/strong&gt;: The names of all the prerequisites, with spaces between them and duplicates removed.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;$+&lt;/strong&gt;: Same as $^, except it includes duplicates.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;There are other automatic variables. For a full list, see &lt;a href=&quot;https://www.gnu.org/software/make/manual/make.html#Automatic-Variables&quot;&gt;the manual&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Using the automatic variables, we can simplify our Makefile a bit more:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
TARGET = count.txt
SOURCE = data.txt

all: $(TARGET) 

$(TARGET): $(SOURCE)
   wc -c $&amp;lt; &amp;gt;  $@ # $&amp;lt; matches the source file name, $@ matches the target file name 
   wc -w $&amp;lt; &amp;gt;&amp;gt; $@
   wc -l $&amp;lt; &amp;gt;&amp;gt; $@

clean:
   rm $(TARGET)&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;virtual-paths&quot;&gt;Virtual Paths&lt;/h3&gt;
&lt;p&gt;Often you have files organized into directories. It is not always possible to write the entire file name every time. You can use &lt;code&gt;VPATH&lt;/code&gt; to specify where &lt;code&gt;make&lt;/code&gt; should search for targets and prerequisites.&lt;/p&gt;
&lt;p&gt;For example:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
VPATH = src include

foo.o: foo.cpp&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Here &lt;code&gt;make&lt;/code&gt; will search for &lt;code&gt;foo.o&lt;/code&gt; and &lt;code&gt;foo.cpp&lt;/code&gt; first in the current directory, and if not found will look inside the directories listed in &lt;code&gt;VPATH&lt;/code&gt;. Thus if you have &lt;code&gt;src/foo.cpp&lt;/code&gt;, instead of writing the whole path every time, you can use &lt;code&gt;VPATH&lt;/code&gt; to tell &lt;code&gt;make&lt;/code&gt; where to search for it.&lt;/p&gt;
&lt;p&gt;However, there is a slight issue. Usually the &lt;code&gt;cpp&lt;/code&gt; files are stored under &lt;code&gt;src&lt;/code&gt;, while the header files are stored under &lt;code&gt;include&lt;/code&gt;. But in our previous example, &lt;code&gt;make&lt;/code&gt; searches for &lt;code&gt;foo.cpp&lt;/code&gt; in both of those directories. You can tell &lt;code&gt;make&lt;/code&gt; that &lt;code&gt;cpp&lt;/code&gt; files should be searched in &lt;code&gt;src&lt;/code&gt; and headers should be searched in &lt;code&gt;include&lt;/code&gt;. For that, &lt;code&gt;vpath&lt;/code&gt; (note: lowercase) is used:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
vpath %.cpp src
vpath %.h include&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The &lt;code&gt;%&lt;/code&gt; is like &lt;code&gt;*&lt;/code&gt; of regex. It matches anything. The previous rule tells &lt;code&gt;make&lt;/code&gt; to search for files ending in &lt;code&gt;.cpp&lt;/code&gt; in &lt;code&gt;src&lt;/code&gt; and files ending in &lt;code&gt;.h&lt;/code&gt; in &lt;code&gt;include&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&quot;pattern-rules&quot;&gt;Pattern Rules&lt;/h3&gt;
&lt;p&gt;A pattern rule contains the character &lt;code&gt;%&lt;/code&gt; exactly once. The &lt;code&gt;%&lt;/code&gt; matches any character. For example, &lt;code&gt;%.cpp&lt;/code&gt; matches any files ending in &lt;code&gt;.cpp&lt;/code&gt;, while &lt;code&gt;a%b&lt;/code&gt; matches any file starting in &lt;code&gt;a&lt;/code&gt; and ending in &lt;code&gt;b&lt;/code&gt; and having anything in between, like &lt;code&gt;axb&lt;/code&gt; or &lt;code&gt;axyzb&lt;/code&gt;, but not &lt;code&gt;ab&lt;/code&gt;. There should be at least one character to match &lt;code&gt;%&lt;/code&gt;. The part that matches the &lt;code&gt;%&lt;/code&gt; is called the stem.&lt;/p&gt;
&lt;p&gt;When used in a prerequisite, the &lt;code&gt;%&lt;/code&gt; stands for the same stem that was matched by the &lt;code&gt;%&lt;/code&gt; in the target. For example:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
%.o: %.cpp
    ...&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This tells how to make &lt;code&gt;x.o&lt;/code&gt; from &lt;code&gt;x.cpp&lt;/code&gt; where &lt;code&gt;x&lt;/code&gt; stands for anything, provided &lt;code&gt;x.cpp&lt;/code&gt; should exist or can be made. So if you have &lt;code&gt;a.cpp&lt;/code&gt; and &lt;code&gt;b.cpp&lt;/code&gt;, that single rule can make both &lt;code&gt;a.o&lt;/code&gt; and &lt;code&gt;b.o&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&quot;phony-target&quot;&gt;Phony Target&lt;/h3&gt;
&lt;p&gt;In our Makefile, there are two “special” targets—&lt;code&gt;all&lt;/code&gt; and &lt;code&gt;clean&lt;/code&gt;. Since they do not have any prerequisite, and there are no files named &lt;code&gt;all&lt;/code&gt; or &lt;code&gt;clean&lt;/code&gt; in the project, they are always considered to be older than their dependencies and always executed.&lt;/p&gt;
&lt;p&gt;But if you create a file called &lt;code&gt;all&lt;/code&gt; or &lt;code&gt;clean&lt;/code&gt; in the directory, &lt;code&gt;make&lt;/code&gt; will get confused. Since the &lt;code&gt;all&lt;/code&gt; or &lt;code&gt;clean&lt;/code&gt; file is there, and the targets have no prerequisites, they will be considered newer than their prerequisites. Therefore, the recipes will never be run. To fix this, you can declare the targets to be “phony”:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Makefile
.PHONY: all clean

...&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;For the full manual of &lt;code&gt;make&lt;/code&gt;, read the &lt;a href=&quot;https://www.gnu.org/software/make/manual/make.html&quot;&gt;&lt;code&gt;make&lt;/code&gt; documentation&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;examples-of-using-make&quot;&gt;Examples of Using &lt;code&gt;Make&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;Here are some tutorials and examples of using &lt;code&gt;make&lt;/code&gt; for various languages and frameworks.&lt;/p&gt;
&lt;h3 id=&quot;creating-a-g-makefile&quot;&gt;&lt;a href=&quot;https://earthly.dev/blog/g++-makefile/&quot;&gt;Creating a G++ Makefile&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;This tutorial shows how to use &lt;code&gt;make&lt;/code&gt; with &lt;code&gt;g++&lt;/code&gt; to compile C++. It also introduces variables and phony targets.&lt;/p&gt;
&lt;h3 id=&quot;creating-a-python-makefile&quot;&gt;&lt;a href=&quot;https://earthly.dev/blog/python-makefile/&quot;&gt;Creating a Python Makefile&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;This article explains how to use &lt;code&gt;make&lt;/code&gt; with Python. Even though Python does not require compilation, you can use &lt;code&gt;make&lt;/code&gt; to automate the installation of dependencies and for testing and managing virtual environments.&lt;/p&gt;
&lt;h3 id=&quot;creating-a-golang-makefile&quot;&gt;&lt;a href=&quot;https://earthly.dev/blog/golang-makefile/&quot;&gt;Creating a Golang Makefile&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;This tutorial explains using &lt;code&gt;make&lt;/code&gt; with Golang—including automation for installing dependencies, running tests, and building binaries for different platforms.&lt;/p&gt;
&lt;h3 id=&quot;makefile-support-in-visual-studio-code&quot;&gt;&lt;a href=&quot;https://earthly.dev/blog/vscode-make/&quot;&gt;Makefile Support in Visual Studio Code&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;This tutorial introduces official Makefile support for Visual Studio Code and explains how to install, activate, and configure the extension. The tutorial also demonstrates how to debug and build &lt;code&gt;make&lt;/code&gt; targets straight from VS Code.&lt;/p&gt;
&lt;h3 id=&quot;automation-with-makefiles&quot;&gt;&lt;a href=&quot;https://monashbioinformaticsplatform.github.io/2017-11-16-open-science-training/topics/automation.html&quot;&gt;Automation With Makefiles&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;This blog post demonstrates using &lt;a href=&quot;https://rmarkdown.rstudio.com/&quot;&gt;R Markdown&lt;/a&gt; to create web pages from Markdown files in an R project. The post explains how to set up the Makefile and use variables, pattern rules, and phony targets.&lt;/p&gt;
&lt;h3 id=&quot;using-make-with-node.js&quot;&gt;&lt;a href=&quot;https://lithic.tech/blog/2020-05/makefile-and-node&quot;&gt;Using Make With Node.JS&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In this tutorial, the author has explained the usage of &lt;code&gt;make&lt;/code&gt; to automate the building, serving, and testing of a Node.js project.&lt;/p&gt;
&lt;h3 id=&quot;using-make-with-typescript&quot;&gt;&lt;a href=&quot;https://blog.quenk.com/using-gnu-make-to-build-a-typescript-project/&quot;&gt;Using Make With TypeScript&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;This article explains the basic mechanisms of &lt;code&gt;make&lt;/code&gt; and shows how to write a Makefile to transpile TypeScript into JavaScript.&lt;/p&gt;
&lt;h3 id=&quot;makefiles-for-frontend&quot;&gt;&lt;a href=&quot;https://medium.com/finn-no/makefiles-for-frontend-1779be46461b&quot;&gt;Makefiles for Frontend&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;This is a tutorial on how to configure &lt;code&gt;make&lt;/code&gt; for a frontend project. The author explains how to use &lt;code&gt;make&lt;/code&gt; to automate the compilation of SCSS files and bundle JavaScript with Rollup.&lt;/p&gt;
&lt;h3 id=&quot;taming-large-makefiles&quot;&gt;&lt;a href=&quot;https://earthly.dev/blog/repeatable-builds-every-time/#tips-for-taming-makefiles-in-large-teams&quot;&gt;Taming Large Makefiles&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Makefiles are hard to scale to large files and large teams. This article has have tips for making this process easier.&lt;/p&gt;
&lt;h3 id=&quot;makefiles-for-java&quot;&gt;&lt;a href=&quot;https://dev.to/deciduously/quick-and-dirty-java-makefile-4njo&quot;&gt;Makefiles for Java&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The author demonstrates a simple Makefile that can be used in a Java project for compiling Java files to JAR files.&lt;/p&gt;
&lt;h3 id=&quot;using-autotools-to-configure-make-and-install-a-program&quot;&gt;&lt;a href=&quot;https://earthly.dev/blog/autoconf/&quot;&gt;Using Autotools to Configure, Make, and Install a Program&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;This tutorial shows how to automate the writing of Makefiles by using Autotools.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;The &lt;code&gt;make&lt;/code&gt; tool is a valuable one to master in software development. Using it can speed up your development and ensure an easier process overall. However, due to its feature-rich nature, &lt;code&gt;make&lt;/code&gt; can be hard to master.&lt;/p&gt;
&lt;p&gt;If you’re familiar with Docker, consider using &lt;a href=&quot;https://earthly.dev&quot;&gt;Earthly&lt;/a&gt;. Earthly combines the best aspects of &lt;code&gt;make&lt;/code&gt; and Docker to give you an easy-to-understand and reproducible build with minimal effort.&lt;/p&gt;</content><author><name>Aniket Bhattacharyea</name></author><category term="Tutorials" /><summary type="html">Building software is a multi-step process—installing or updating dependencies, compiling the source code, testing, installing, and so on. In any moderately sized project, you might find it difficult to perform all these steps manually. This is where make can help you. The make tool automates compilation of the software from the source code. It won’t repeat a step if none of its prerequisites has changed, thus saving you time and resources. In this article, you will learn how to write a simple Makefile and learn about important components of make, including variables, pattern rules, and virtual paths. You will also see some examples of using make with different technologies. The Makefile When you run make, it looks for a file named Makefile, or makefile in the same directory. The name Makefile is suggested so that it appears near other important files such as README. You can name your Makefile anything, but then you have to explicitly tell make which file to read: shell make -f some_other_makefile The Makefile should consist of one or more rules. Each rule describes a goal or a step in your build process, the prerequisites for that step, and recipes for how to execute it. The format for each rule is as follows: Makefile target1 [target2 ...]: [pre-req1 pre-req2 pre-req3 ...] [recipes ...] The parts in [] are optional. Each rule must have one or more targets, zero or more prerequisites, and zero or more recipes. The target is the file you want to be created in that rule. The prerequisites can be the name of an existing rule, or the name of a file in the same directory. The recipes are shell commands that need to be run in order to generate the target. When make executes a rule, it looks at the prerequisites. If all the prerequisites are older than the target file, it means that none of them has changed since the last time the rule was executed. So make does not execute the rule. If, however, any prerequisite is newer than the target, the recipes are executed. Here’s an example. Create a file named data.txt with the text hello world. You’ll use the wc command to calculate the number of characters, words, and lines and store it in a file named count.txt. In this simple demonstration, you have a dependency and a target that needs to be built from the dependency. First, let’s do it manually. shell wc -c data.txt &amp;gt; count.txt # Count characters wc -w data.txt &amp;gt;&amp;gt; count.txt # Count words wc -l data.txt &amp;gt;&amp;gt; count.txt # Count lines This should create a file named count.txt with the following content: 13 data.txt 2 data.txt 0 data.txt Let’s write the Makefile to automate this: Makefile all: count.txt count.txt: data.txt wc -c data.txt &amp;gt; count.txt # Count characters wc -w data.txt &amp;gt;&amp;gt; count.txt # Count words wc -l data.txt &amp;gt;&amp;gt; count.txt # Count lines This Makefile has two targets. The first target is all, which acts like an overall build target. It is not necessary to have such a target, especially when our build has only one step, but it is a recommended practice. The all target depends on count.txt and has no recipe. This means that all will be prepared as soon as count.txt is prepared. The target count.txt depends on the file data.txt and the recipes list contains the commands you ran previously. Now, run make again from the terminal. You should see that make executes the commands listed and creates count.txt. If you run the make command again, you should see the output: make: Nothing to be done for &amp;#39;all&amp;#39;. Let’s break it down. When you run make without any argument, it runs the first target, which is all in this case. Since all depends on count.txt, that target is executed. The target count.txt depends on data.txt, so the commands are run and the file is generated. The next time you run make following the same sequence, make looks at count.txt and notices that count.txt is newer than data.txt, meaning the dependency has not been changed since the last time make was run, so it doesn’t do anything. Edit the data.txt file and change the text to hi world. Now when you run make, it runs the commands and updates count.txt. Since the dependency was changed, it rebuilt the target. You can also run a target directly by passing its name to the make command. Running make count.txt will run only the count.txt rule. Let’s add a rule to clean the project files. It is a recommended practice to have a clean rule to delete any generated files, effectively returning the project to the initial state. Add the following rule to your Makefile: Makefile clean: rm count.txt The clean rule doesn’t have a prerequisite. The targets without a prerequisite are considered to be older than their dependencies, and so they’re always run. Components of Makefile Here are some important components that can help you write more concise and simpler Makefiles. Comments You can have comments in Makefile that start with a # and last till the end of the line. Makefile all: count.txt # This is a comment ... Variables Just like regular programming languages, make supports using variables to avoid repetitions and keep the Makefile clean. Another advantage of variables is that the user can override them without needing to edit the Makefile manually. A variable in Makefile starts with a $ and is enclosed in parentheses () or braces {}, unless it’s a single character variable. To set a variable, write a line starting with a variable name followed by =, := or ::=, followed by the value of the variable: Makefile TARGET = count.txt SOURCE = data.txt The variables defined with = are called “recursively expanded variables,” and those defined with := and ::= are called “simply expanded variables.” There is a subtle difference between these two, which you can read about in the manual. You can reference these values in any of the targets, prerequisites, or recipes: Makefile TARGET = count.txt SOURCE = data.txt all: $(TARGET) $(TARGET): $(SOURCE) wc -c $(SOURCE) &amp;gt; $(TARGET) # Count characters wc -w $(SOURCE) &amp;gt;&amp;gt; $(TARGET) # Count words wc -l $(SOURCE) &amp;gt;&amp;gt; $(TARGET) # Count lines clean: rm $(TARGET) Here instead of hard-coding the target and source file names, we have used two variables, with default values of count.txt and data.txt. If you run the make command, it should work just like before. However, if you want to change the name of the target to, for example, newcount.txt, you can do so without changing the Makefile: shell make TARGET=newcount.txt Passing TARGET=newcount.txt overrides the default value of $(TARGET) in the Makefile and so, instead of count.txt, the file newcount.txt is generated. Similarly, you can run make TARGET=newcount.txt clean to clean this new file. When make is run, it also converts all available environment variables into make variables. So you can freely use any environment variable. Automatic Variables There are some special variables called automatic variables. Their values are computed each time for every rule and are based on the target and prerequisite file names. Here are some of the most important automatic variables: **$@**: This is the target file name. If there is more than one target, this is whichever target caused the recipe to run. $*: This is the target file name without the extension. $&amp;lt;: This is the name of the first prerequisite. $?: The names of all the prerequisites that are newer than the target, with spaces between them. If the target does not exist, all prerequisites will be included. $^: The names of all the prerequisites, with spaces between them and duplicates removed. $+: Same as $^, except it includes duplicates. There are other automatic variables. For a full list, see the manual. Using the automatic variables, we can simplify our Makefile a bit more: Makefile TARGET = count.txt SOURCE = data.txt all: $(TARGET) $(TARGET): $(SOURCE) wc -c $&amp;lt; &amp;gt; $@ # $&amp;lt; matches the source file name, $@ matches the target file name wc -w $&amp;lt; &amp;gt;&amp;gt; $@ wc -l $&amp;lt; &amp;gt;&amp;gt; $@ clean: rm $(TARGET) Virtual Paths Often you have files organized into directories. It is not always possible to write the entire file name every time. You can use VPATH to specify where make should search for targets and prerequisites. For example: Makefile VPATH = src include foo.o: foo.cpp Here make will search for foo.o and foo.cpp first in the current directory, and if not found will look inside the directories listed in VPATH. Thus if you have src/foo.cpp, instead of writing the whole path every time, you can use VPATH to tell make where to search for it. However, there is a slight issue. Usually the cpp files are stored under src, while the header files are stored under include. But in our previous example, make searches for foo.cpp in both of those directories. You can tell make that cpp files should be searched in src and headers should be searched in include. For that, vpath (note: lowercase) is used: Makefile vpath %.cpp src vpath %.h include The % is like * of regex. It matches anything. The previous rule tells make to search for files ending in .cpp in src and files ending in .h in include. Pattern Rules A pattern rule contains the character % exactly once. The % matches any character. For example, %.cpp matches any files ending in .cpp, while a%b matches any file starting in a and ending in b and having anything in between, like axb or axyzb, but not ab. There should be at least one character to match %. The part that matches the % is called the stem. When used in a prerequisite, the % stands for the same stem that was matched by the % in the target. For example: Makefile %.o: %.cpp ... This tells how to make x.o from x.cpp where x stands for anything, provided x.cpp should exist or can be made. So if you have a.cpp and b.cpp, that single rule can make both a.o and b.o. Phony Target In our Makefile, there are two “special” targets—all and clean. Since they do not have any prerequisite, and there are no files named all or clean in the project, they are always considered to be older than their dependencies and always executed. But if you create a file called all or clean in the directory, make will get confused. Since the all or clean file is there, and the targets have no prerequisites, they will be considered newer than their prerequisites. Therefore, the recipes will never be run. To fix this, you can declare the targets to be “phony”: Makefile .PHONY: all clean ... For the full manual of make, read the make documentation. Examples of Using Make Here are some tutorials and examples of using make for various languages and frameworks. Creating a G++ Makefile This tutorial shows how to use make with g++ to compile C++. It also introduces variables and phony targets. Creating a Python Makefile This article explains how to use make with Python. Even though Python does not require compilation, you can use make to automate the installation of dependencies and for testing and managing virtual environments. Creating a Golang Makefile This tutorial explains using make with Golang—including automation for installing dependencies, running tests, and building binaries for different platforms. Makefile Support in Visual Studio Code This tutorial introduces official Makefile support for Visual Studio Code and explains how to install, activate, and configure the extension. The tutorial also demonstrates how to debug and build make targets straight from VS Code. Automation With Makefiles This blog post demonstrates using R Markdown to create web pages from Markdown files in an R project. The post explains how to set up the Makefile and use variables, pattern rules, and phony targets. Using Make With Node.JS In this tutorial, the author has explained the usage of make to automate the building, serving, and testing of a Node.js project. Using Make With TypeScript This article explains the basic mechanisms of make and shows how to write a Makefile to transpile TypeScript into JavaScript. Makefiles for Frontend This is a tutorial on how to configure make for a frontend project. The author explains how to use make to automate the compilation of SCSS files and bundle JavaScript with Rollup. Taming Large Makefiles Makefiles are hard to scale to large files and large teams. This article has have tips for making this process easier. Makefiles for Java The author demonstrates a simple Makefile that can be used in a Java project for compiling Java files to JAR files. Using Autotools to Configure, Make, and Install a Program This tutorial shows how to automate the writing of Makefiles by using Autotools. Conclusion The make tool is a valuable one to master in software development. Using it can speed up your development and ensure an easier process overall. However, due to its feature-rich nature, make can be hard to master. If you’re familiar with Docker, consider using Earthly. Earthly combines the best aspects of make and Docker to give you an easy-to-understand and reproducible build with minimal effort.</summary></entry><entry><title type="html">An Introduction to JQ</title><link href="https://earthly.dev/blog/jq-select/" rel="alternate" type="text/html" title="An Introduction to JQ" /><published>2021-08-24T00:00:00-04:00</published><updated>2021-08-24T00:00:00-04:00</updated><id>https://earthly.dev/blog/jq-select</id><content type="html" xml:base="https://earthly.dev/blog/jq-select/">&lt;!-- Code blocks have seperate results so need $ at beginning --&gt;
&lt;!-- markdownlint-disable MD014 --&gt;
&lt;h2 id=&quot;background-fingers-head-and-google&quot;&gt;Background: Fingers, Head, and Google&lt;/h2&gt;
&lt;p&gt;Whenever I reach a stopping point in my work, I use a bash alias called &lt;code&gt;gwip&lt;/code&gt;&lt;a href=&quot;#fn1&quot; class=&quot;footnote-ref&quot; id=&quot;fnref1&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; to create a ‘work in progress’ commit. It happens without conscious thinking on my part. The same way my fingers know the vim key bindings, they know &lt;code&gt;gwip&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Other actions, I know how they work, but I have to think about them every time. They are in my head, not my fingers.&lt;a href=&quot;#fn2&quot; class=&quot;footnote-ref&quot; id=&quot;fnref2&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;However, some things never stick in my head, nor my fingers, and I have to google them every time. &lt;strong&gt;&lt;code&gt;jq&lt;/code&gt; is one of these.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;I know it’s a powerful tool, but I always end up back at Google and then copying and pasting a solution from somewhere. So I solve my problem but never learn the tool.&lt;/p&gt;
&lt;p&gt;It’s time to fix that. &lt;strong&gt;In this article, I’m going to go over the basics building blocks of &lt;code&gt;jq&lt;/code&gt; in enough depth that you will be able to understand how jq works.&lt;/strong&gt; Of course, you still might occasionally need to head to google to find a function name or check your syntax, but at least you’ll have a firm grounding in the basics.&lt;/p&gt;
&lt;h2 id=&quot;what-is-jq&quot;&gt;What Is JQ&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;jq&lt;/code&gt; is a lightweight, command-line JSON processor. I install it with brew (&lt;code&gt;brew install jq&lt;/code&gt;), but it’s a single portable executable, so it’s easy to install on Linux, Windows, or macOS. To use it, you construct one or more filters, and it applies those filters to a JSON document.&lt;/p&gt;
&lt;p&gt;The simplest filter is the identity filter which returns all its input (&lt;code&gt;.&lt;/code&gt;):&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;{&amp;quot;key1&amp;quot;:{&amp;quot;key2&amp;quot;:&amp;quot;value1&amp;quot;}}&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-2&quot;&gt;&lt;a href=&quot;#cb2-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;key1&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-3&quot;&gt;&lt;a href=&quot;#cb2-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;key2&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;value1&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-4&quot;&gt;&lt;a href=&quot;#cb2-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-5&quot;&gt;&lt;a href=&quot;#cb2-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This filter is handy for just pretty-printing a JSON document.&lt;a href=&quot;#fn3&quot; class=&quot;footnote-ref&quot; id=&quot;fnref3&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt; I’m going to ignore the pretty-printing and jump right into using &lt;code&gt;jq&lt;/code&gt; to transform JSON documents.&lt;/p&gt;
&lt;h2 id=&quot;using-jq-to-select-elements&quot;&gt;Using JQ to Select Elements&lt;/h2&gt;
&lt;p&gt;I’m going to use &lt;code&gt;jq&lt;/code&gt; to filter the data returned by the GitHub repository API. The data I get back by default looks like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;5101141&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;node_id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;MDEwOlJlcG9zaXRvcnk1MTAxMTQx&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-4&quot;&gt;&lt;a href=&quot;#cb4-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;jq&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-5&quot;&gt;&lt;a href=&quot;#cb4-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;full_name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;stedolan/jq&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-6&quot;&gt;&lt;a href=&quot;#cb4-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;private&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-7&quot;&gt;&lt;a href=&quot;#cb4-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;owner&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-8&quot;&gt;&lt;a href=&quot;#cb4-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;login&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;stedolan&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-9&quot;&gt;&lt;a href=&quot;#cb4-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;79765&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-10&quot;&gt;&lt;a href=&quot;#cb4-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;},&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-11&quot;&gt;&lt;a href=&quot;#cb4-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;html_url&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;https://github.com/stedolan/jq&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-12&quot;&gt;&lt;a href=&quot;#cb4-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;description&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Command-line JSON processor&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-13&quot;&gt;&lt;a href=&quot;#cb4-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;stargazers_count&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;19967&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-14&quot;&gt;&lt;a href=&quot;#cb4-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;watchers_count&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;19967&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-15&quot;&gt;&lt;a href=&quot;#cb4-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;language&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;C&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-16&quot;&gt;&lt;a href=&quot;#cb4-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;license&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-17&quot;&gt;&lt;a href=&quot;#cb4-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;key&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;other&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-18&quot;&gt;&lt;a href=&quot;#cb4-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Other&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-19&quot;&gt;&lt;a href=&quot;#cb4-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;spdx_id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;NOASSERTION&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-20&quot;&gt;&lt;a href=&quot;#cb4-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;url&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-21&quot;&gt;&lt;a href=&quot;#cb4-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;node_id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;MDc6TGljZW5zZTA=&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-22&quot;&gt;&lt;a href=&quot;#cb4-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-23&quot;&gt;&lt;a href=&quot;#cb4-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!-- &lt;div class=&quot;notice--info&quot;&gt;
**Side Note: Omitting Details**

The JSON documents returned by the GitHub API are too large to show inline in a blog post. Therefore, for ease of explanation, I will omit non-relevant details.
&lt;/div&gt; --&gt;
&lt;p&gt;&lt;code&gt;jq&lt;/code&gt; lets us treat the JSON document as an object and select elements inside of it.&lt;/p&gt;
&lt;p&gt;Here is how I filter the JSON document to select the value of the &lt;code&gt;name&lt;/code&gt; key:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; .name&amp;#39;&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;jq&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;figcaption&gt;
&lt;/figcaption&gt;
&lt;p&gt;Similarly, for selecting the value of the &lt;code&gt;owner&lt;/code&gt; key:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb7&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb7-1&quot;&gt;&lt;a href=&quot;#cb7-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; .owner&amp;#39;&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb8&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb8-1&quot;&gt;&lt;a href=&quot;#cb8-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-2&quot;&gt;&lt;a href=&quot;#cb8-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;login&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;stedolan&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-3&quot;&gt;&lt;a href=&quot;#cb8-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;79765&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-4&quot;&gt;&lt;a href=&quot;#cb8-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can drill in as far as you want like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb9&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb9-1&quot;&gt;&lt;a href=&quot;#cb9-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; .owner.login&amp;#39;&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;stedolan&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;notice--big--primary&quot;&gt;
&lt;!-- markdownlint-disable MD036 --&gt;
&lt;p&gt;&lt;strong&gt;What I Learned: Object Identifier-Index&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;jq&lt;/code&gt; lets you select elements in a JSON document like it’s a JavaScript object. Just start with &lt;code&gt;.&lt;/code&gt; ( for the whole document) and drill down to the value you want. It ends up looking something like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.key.subkey.subsubkey&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;using-jq-to-select-arrays&quot;&gt;Using JQ to Select Arrays&lt;/h2&gt;
&lt;p&gt;If you &lt;code&gt;curl&lt;/code&gt; the GitHub Issues API, you will get back an array of issues:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb12&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb12-1&quot;&gt;&lt;a href=&quot;#cb12-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=5    &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb13&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb13-1&quot;&gt;&lt;a href=&quot;#cb13-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-2&quot;&gt;&lt;a href=&quot;#cb13-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-3&quot;&gt;&lt;a href=&quot;#cb13-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;966024429&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-4&quot;&gt;&lt;a href=&quot;#cb13-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2341&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-5&quot;&gt;&lt;a href=&quot;#cb13-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Question about license.&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-6&quot;&gt;&lt;a href=&quot;#cb13-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;body&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;I would like to create a [winget](https://github.com/microsoft/winget-cli) package for jq. 🙏🏻&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-7&quot;&gt;&lt;a href=&quot;#cb13-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-8&quot;&gt;&lt;a href=&quot;#cb13-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-9&quot;&gt;&lt;a href=&quot;#cb13-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;/span&gt;
&lt;span id=&quot;cb13-10&quot;&gt;&lt;a href=&quot;#cb13-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;962477084&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-11&quot;&gt;&lt;a href=&quot;#cb13-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2340&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-12&quot;&gt;&lt;a href=&quot;#cb13-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;visibility of wiki pages&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-13&quot;&gt;&lt;a href=&quot;#cb13-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;body&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;The visibility of wiki pages to search engines is generally limited; for example, the search result for &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\&amp;quot;&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;jq Cookbook&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\&amp;quot;&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; looks like this:&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-14&quot;&gt;&lt;a href=&quot;#cb13-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-15&quot;&gt;&lt;a href=&quot;#cb13-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-16&quot;&gt;&lt;a href=&quot;#cb13-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;   &lt;/span&gt;
&lt;span id=&quot;cb13-17&quot;&gt;&lt;a href=&quot;#cb13-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;955350543&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-18&quot;&gt;&lt;a href=&quot;#cb13-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2337&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-19&quot;&gt;&lt;a href=&quot;#cb13-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Release 1.6 does not have pre-autoreconf&amp;#39;ed configure script&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-20&quot;&gt;&lt;a href=&quot;#cb13-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;body&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;If you have a usage question, please ask us on either Stack Overflow (https://stackoverflow.com/questions/tagged/jq) or in the #jq channel (http://irc.lc/freenode/%23jq/) on Freenode (https://webchat.freenode.net/).&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-21&quot;&gt;&lt;a href=&quot;#cb13-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-22&quot;&gt;&lt;a href=&quot;#cb13-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-23&quot;&gt;&lt;a href=&quot;#cb13-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;954792209&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-24&quot;&gt;&lt;a href=&quot;#cb13-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2336&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-25&quot;&gt;&lt;a href=&quot;#cb13-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Fix typo&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-26&quot;&gt;&lt;a href=&quot;#cb13-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;body&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-27&quot;&gt;&lt;a href=&quot;#cb13-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-28&quot;&gt;&lt;a href=&quot;#cb13-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-29&quot;&gt;&lt;a href=&quot;#cb13-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;940627936&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-30&quot;&gt;&lt;a href=&quot;#cb13-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2334&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-31&quot;&gt;&lt;a href=&quot;#cb13-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-32&quot;&gt;&lt;a href=&quot;#cb13-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;body&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Compile errors in filter expressions don&amp;#39;t include the column number where the parser approximately or exactly locates the error. Most filter expressions are one-liners (are multiple lines even supported?), so the information that the error is on line 1 is not helpful.&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-33&quot;&gt;&lt;a href=&quot;#cb13-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-34&quot;&gt;&lt;a href=&quot;#cb13-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To get a specific element in the array, give &lt;code&gt;jq&lt;/code&gt; an index:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb14&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb14-1&quot;&gt;&lt;a href=&quot;#cb14-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=5 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[4]&amp;#39;&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb15&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb15-1&quot;&gt;&lt;a href=&quot;#cb15-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-2&quot;&gt;&lt;a href=&quot;#cb15-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;940627936&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-3&quot;&gt;&lt;a href=&quot;#cb15-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2334&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-4&quot;&gt;&lt;a href=&quot;#cb15-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-5&quot;&gt;&lt;a href=&quot;#cb15-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;body&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Compile errors in filter expressions don&amp;#39;t include the column number where the parser approximately or exactly locates the error. Most filter expressions are one-liners (are multiple lines even supported?), so the information that the error is on line 1 is not helpful.&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-6&quot;&gt;&lt;a href=&quot;#cb15-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;Side Note: Array Indexing in &lt;code&gt;jq&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Array indexing has some helpful convenience syntax.&lt;/p&gt;
&lt;p&gt;You can select ranges:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb16&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb16-1&quot;&gt;&lt;a href=&quot;#cb16-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;quot;[1,2,3,4,5]&amp;quot;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[2:4]&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb17&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb17-1&quot;&gt;&lt;a href=&quot;#cb17-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can select one sided ranges:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb18&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb18-1&quot;&gt;&lt;a href=&quot;#cb18-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;quot;[1,2,3,4,5]&amp;quot;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[2:]&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb19&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb19-1&quot;&gt;&lt;a href=&quot;#cb19-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Also, you can use negatives to select from the end:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb20&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb20-1&quot;&gt;&lt;a href=&quot;#cb20-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;quot;[1,2,3,4,5]&amp;quot;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[-2:]&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb21&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb21-1&quot;&gt;&lt;a href=&quot;#cb21-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;You can use the array index with the object index:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb22&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb22-1&quot;&gt;&lt;a href=&quot;#cb22-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=5 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[4].title&amp;#39;&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And you can use &lt;code&gt;[]&lt;/code&gt; to get all the elements in the array. For example, here is how I would get the titles of the issues returned by my API request:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb24&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb24-1&quot;&gt;&lt;a href=&quot;#cb24-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=5 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[].title&amp;#39;&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;Question about license.&amp;quot;
&amp;quot;visibility of wiki pages&amp;quot;
&amp;quot;Release 1.6 does not have pre-autoreconf&amp;#39;ed configure script&amp;quot;
&amp;quot;Fix typo&amp;quot;
&amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;notice--big--primary&quot;&gt;
&lt;p&gt;&lt;strong&gt;What I Learned: Array-Index&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;jq&lt;/code&gt; lets you select the whole array &lt;code&gt;[]&lt;/code&gt;, a specific element &lt;code&gt;[3]&lt;/code&gt;, or ranges &lt;code&gt;[2:5]&lt;/code&gt; and combine these with the object index if needed.&lt;/p&gt;
&lt;p&gt;It ends up looking something like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb26&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb26-1&quot;&gt;&lt;a href=&quot;#cb26-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.key[].subkey[2]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;Side Note: Removing Quotes From JQ Output&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;-r&lt;/code&gt; option in &lt;code&gt;jq&lt;/code&gt; gives you raw strings if you need that.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb27&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb27-1&quot;&gt;&lt;a href=&quot;#cb27-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;[&amp;quot;1&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;3&amp;quot;]&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[]&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb27-2&quot;&gt;&lt;a href=&quot;#cb27-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb27-3&quot;&gt;&lt;a href=&quot;#cb27-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb27-4&quot;&gt;&lt;a href=&quot;#cb27-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code&gt;-j&lt;/code&gt; option (for join) can combine together your output.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb28&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb28-1&quot;&gt;&lt;a href=&quot;#cb28-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;[&amp;quot;1&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;3&amp;quot;]&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-j&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[]&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb28-2&quot;&gt;&lt;a href=&quot;#cb28-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;123&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;putting-elements-in-an-array-using-jq&quot;&gt;Putting Elements in an Array using &lt;code&gt;jq&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;Once you start using the array index to select elements, you have a new problem. The data returned won’t be a valid JSON document. In the example above, the issue titles were new line delimited:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;Question about license.&amp;quot;
&amp;quot;visibility of wiki pages&amp;quot;
&amp;quot;Release 1.6 does not have pre-autoreconf&amp;#39;ed configure script&amp;quot;
&amp;quot;Fix typo&amp;quot;
&amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot;
...&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In fact, whenever you ask &lt;code&gt;jq&lt;/code&gt; to return an unwrapped collection of elements, it prints them each on a new line. You can see this by explicitly asking &lt;code&gt;jq&lt;/code&gt; to ignore its input and instead return two numbers:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb30&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb30-1&quot;&gt;&lt;a href=&quot;#cb30-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;&amp;quot;&amp;quot;&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;1,2&amp;#39;&lt;/span&gt; &lt;/span&gt;
&lt;span id=&quot;cb30-2&quot;&gt;&lt;a href=&quot;#cb30-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb30-3&quot;&gt;&lt;a href=&quot;#cb30-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can resolve this the same way you would turn the text &lt;code&gt;1,2&lt;/code&gt; into an array in JavaScript: By wrapping it in an array constructor &lt;code&gt;[ ... ]&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb31&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb31-1&quot;&gt;&lt;a href=&quot;#cb31-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;&amp;quot;&amp;quot;&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;[1,2]&amp;#39;&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb32&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb32-1&quot;&gt;&lt;a href=&quot;#cb32-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb32-2&quot;&gt;&lt;a href=&quot;#cb32-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb32-3&quot;&gt;&lt;a href=&quot;#cb32-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb32-4&quot;&gt;&lt;a href=&quot;#cb32-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Similarly, to put a generated collection of results into a JSON array, you wrap it in an array constructor &lt;code&gt;[ ... ]&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;My GitHub issue title filter (&lt;code&gt;.[].title&lt;/code&gt;) then becomes &lt;code&gt;[ .[].title ]&lt;/code&gt; like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb33&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb33-1&quot;&gt;&lt;a href=&quot;#cb33-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=5 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb33-2&quot;&gt;&lt;a href=&quot;#cb33-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;[ .[].title ] &amp;#39;&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb34&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb34-1&quot;&gt;&lt;a href=&quot;#cb34-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb34-2&quot;&gt;&lt;a href=&quot;#cb34-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;Question about license.&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb34-3&quot;&gt;&lt;a href=&quot;#cb34-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;visibility of wiki pages&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb34-4&quot;&gt;&lt;a href=&quot;#cb34-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;Release 1.6 does not have pre-autoreconf&amp;#39;ed configure script&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb34-5&quot;&gt;&lt;a href=&quot;#cb34-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;Fix typo&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb34-6&quot;&gt;&lt;a href=&quot;#cb34-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb34-7&quot;&gt;&lt;a href=&quot;#cb34-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now I have a valid JSON document.&lt;/p&gt;
&lt;div class=&quot;notice--big--primary&quot;&gt;
&lt;!-- markdownlint-disable MD036 --&gt;
&lt;p&gt;&lt;strong&gt;What I Learned: Array Constructors&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;If your &lt;code&gt;jq&lt;/code&gt; query returns more than one element, they will be returned newline delimited.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb35&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb35-1&quot;&gt;&lt;a href=&quot;#cb35-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;[{&amp;quot;a&amp;quot;:&amp;quot;b&amp;quot;},{&amp;quot;a&amp;quot;:&amp;quot;c&amp;quot;}]&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[].a&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb35-2&quot;&gt;&lt;a href=&quot;#cb35-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;b&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb35-3&quot;&gt;&lt;a href=&quot;#cb35-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;c&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To turn these values into a JSON array, what you do is similar to creating an array in JavaScript: You wrap the values in an array constructor (&lt;code&gt;[...]&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;It ends up looking something like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb36&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb36-1&quot;&gt;&lt;a href=&quot;#cb36-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;[{&amp;quot;a&amp;quot;:&amp;quot;b&amp;quot;},{&amp;quot;a&amp;quot;:&amp;quot;c&amp;quot;}]&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;[ .[].a ]&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb37&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb37-1&quot;&gt;&lt;a href=&quot;#cb37-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb37-2&quot;&gt;&lt;a href=&quot;#cb37-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;b&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb37-3&quot;&gt;&lt;a href=&quot;#cb37-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;c&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb37-4&quot;&gt;&lt;a href=&quot;#cb37-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;using-jq-to-select-multiple-fields&quot;&gt;Using &lt;code&gt;jq&lt;/code&gt; to Select Multiple Fields&lt;/h2&gt;
&lt;p&gt;The GitHub issues API has a lot of details I don’t care about. I want to select multiple fields from the returned JSON document and leave the rest behind.&lt;/p&gt;
&lt;p&gt;The easiest way to do this is using &lt;code&gt;,&lt;/code&gt; to specify multiple filters:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb38&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb38-1&quot;&gt;&lt;a href=&quot;#cb38-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=2 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;\ &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb38-2&quot;&gt;&lt;a href=&quot;#cb38-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; .[].title, .[].number&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;Question about license.&amp;quot;
&amp;quot;visibility of wiki pages&amp;quot;
2341
2340&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;But this is returning the results of one selection after the other. To change the ordering, I can factor out the array selector:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb40&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb40-1&quot;&gt;&lt;a href=&quot;#cb40-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=2 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb40-2&quot;&gt;&lt;a href=&quot;#cb40-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[] |  .title, .number&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;Question about license.&amp;quot;
2341
&amp;quot;visibility of wiki pages&amp;quot;
2340&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This refactoring uses a pipe (|), which I’ll talk about shortly, and runs my object selectors (&lt;code&gt;.title&lt;/code&gt; and &lt;code&gt;.number&lt;/code&gt;) on each array element.&lt;/p&gt;
&lt;p&gt;If you wrap the query in the array constructor you get this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb42&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb42-1&quot;&gt;&lt;a href=&quot;#cb42-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=2 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb42-2&quot;&gt;&lt;a href=&quot;#cb42-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;[ .[] |  .title, .number ]&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb43&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb43-1&quot;&gt;&lt;a href=&quot;#cb43-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb43-2&quot;&gt;&lt;a href=&quot;#cb43-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;Question about license.&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb43-3&quot;&gt;&lt;a href=&quot;#cb43-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dv&quot;&gt;2341&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb43-4&quot;&gt;&lt;a href=&quot;#cb43-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;visibility of wiki pages&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb43-5&quot;&gt;&lt;a href=&quot;#cb43-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dv&quot;&gt;2340&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb43-6&quot;&gt;&lt;a href=&quot;#cb43-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;But this still isn’t the JSON document I need. To get these values into a proper JSON object, I need an object constructor &lt;code&gt;{ ... }&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&quot;putting-elements-into-an-object-using-jq&quot;&gt;Putting Elements Into an Object Using &lt;code&gt;jq&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;Let’s look at some simple examples before showing how my GitHub query can use an object constructor.&lt;/p&gt;
&lt;h3 id=&quot;a-little-example&quot;&gt;A Little Example&lt;/h3&gt;
&lt;p&gt;I have an array that contains my name (&lt;code&gt;[&quot;Adam&quot;,&quot;Gordon&quot;,&quot;Bell&quot;]&lt;/code&gt;), and I want to turn it into a JSON object like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb44&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb44-1&quot;&gt;&lt;a href=&quot;#cb44-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb44-2&quot;&gt;&lt;a href=&quot;#cb44-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;first_name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;Adam&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb44-3&quot;&gt;&lt;a href=&quot;#cb44-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;last_name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;Bell&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb44-4&quot;&gt;&lt;a href=&quot;#cb44-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I can select the elements I need using array indexing like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb45&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb45-1&quot;&gt;&lt;a href=&quot;#cb45-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;[&amp;quot;Adam&amp;quot;,&amp;quot;Gordon&amp;quot;,&amp;quot;Bell&amp;quot;]&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[0], .[2]&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb45-2&quot;&gt;&lt;a href=&quot;#cb45-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;Adam&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb45-3&quot;&gt;&lt;a href=&quot;#cb45-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;Bell&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To wrap those values into the shape I need, I can replace the values with the array indexes that return them:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb46&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb46-1&quot;&gt;&lt;a href=&quot;#cb46-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb46-2&quot;&gt;&lt;a href=&quot;#cb46-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;first_name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;er&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb46-3&quot;&gt;&lt;a href=&quot;#cb46-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;last_name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;er&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb46-4&quot;&gt;&lt;a href=&quot;#cb46-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Or on a single line like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb47&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb47-1&quot;&gt;&lt;a href=&quot;#cb47-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;[&amp;quot;Adam&amp;quot;,&amp;quot;Gordon&amp;quot;,&amp;quot;Bell&amp;quot;]&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;{ &amp;quot;first_name&amp;quot;:.[0], &amp;quot;last_name&amp;quot;: .[2]}&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb48&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb48-1&quot;&gt;&lt;a href=&quot;#cb48-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb48-2&quot;&gt;&lt;a href=&quot;#cb48-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;first_name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Adam&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb48-3&quot;&gt;&lt;a href=&quot;#cb48-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;last_name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Bell&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb48-4&quot;&gt;&lt;a href=&quot;#cb48-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This syntax is the same syntax for creating an object in a JSON document. The only difference is you can use the object and array queries you’ve built up as the values.&lt;/p&gt;
&lt;h3 id=&quot;back-to-github&quot;&gt;Back to GitHub&lt;/h3&gt;
&lt;p&gt;Returning to my GitHub API problem, to wrap the number and the title up into an array I use the object constructor like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb49&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb49-1&quot;&gt;&lt;a href=&quot;#cb49-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=2 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb49-2&quot;&gt;&lt;a href=&quot;#cb49-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;[ .[] | { title: .title, number: .number} ]&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb50&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb50-1&quot;&gt;&lt;a href=&quot;#cb50-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb50-2&quot;&gt;&lt;a href=&quot;#cb50-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb50-3&quot;&gt;&lt;a href=&quot;#cb50-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Question about license.&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb50-4&quot;&gt;&lt;a href=&quot;#cb50-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2341&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb50-5&quot;&gt;&lt;a href=&quot;#cb50-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb50-6&quot;&gt;&lt;a href=&quot;#cb50-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb50-7&quot;&gt;&lt;a href=&quot;#cb50-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;visibility of wiki pages&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb50-8&quot;&gt;&lt;a href=&quot;#cb50-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2340&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb50-9&quot;&gt;&lt;a href=&quot;#cb50-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb50-10&quot;&gt;&lt;a href=&quot;#cb50-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;notice--big--primary&quot;&gt;
&lt;p&gt;&lt;strong&gt;What I Learned: Object Constructors&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;To put the elements you’ve selected back into a JSON document, you can wrap them in an object constructor &lt;code&gt;{ ... }&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;If you were building up a JSON object out of several selectors, it would end up looking something like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb51&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb51-1&quot;&gt;&lt;a href=&quot;#cb51-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;{ &amp;quot;key1&amp;quot;: &amp;lt;&amp;lt;jq filter&amp;gt;&amp;gt;, &amp;quot;key2&amp;quot;: &amp;lt;&amp;lt;jq filter&amp;gt;&amp;gt; }&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Which is the same syntax for an object in a JSON document, except with &lt;code&gt;jq&lt;/code&gt; you can use filters as values.&lt;a href=&quot;#fn4&quot; class=&quot;footnote-ref&quot; id=&quot;fnref4&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;4&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;sorting-and-counting-with-jq&quot;&gt;Sorting and Counting With JQ&lt;/h2&gt;
&lt;p&gt;The next problem I have is that I want to summarize some this JSON data. Each issue returned by GitHub has a collection of labels:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb52&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb52-1&quot;&gt;&lt;a href=&quot;#cb52-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues/2289 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;\ &lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb52-2&quot;&gt;&lt;a href=&quot;#cb52-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; { title: .title, number: .number, labels: .labels} &amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb53&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb53-1&quot;&gt;&lt;a href=&quot;#cb53-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb53-2&quot;&gt;&lt;a href=&quot;#cb53-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb53-3&quot;&gt;&lt;a href=&quot;#cb53-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2289&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb53-4&quot;&gt;&lt;a href=&quot;#cb53-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;labels&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb53-5&quot;&gt;&lt;a href=&quot;#cb53-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      &lt;span class=&quot;st&quot;&gt;&amp;quot;feature request&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb53-6&quot;&gt;&lt;a href=&quot;#cb53-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      &lt;span class=&quot;st&quot;&gt;&amp;quot;dependencies&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb53-7&quot;&gt;&lt;a href=&quot;#cb53-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb53-8&quot;&gt;&lt;a href=&quot;#cb53-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;jq-built-in-functions&quot;&gt;&lt;code&gt;jq&lt;/code&gt; Built-in Functions&lt;/h3&gt;
&lt;p&gt;If I want those labels in alphabetical order I can use the built in &lt;code&gt;sort&lt;/code&gt; function. It works like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb54&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb54-1&quot;&gt;&lt;a href=&quot;#cb54-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt;  echo &lt;span class=&quot;st&quot;&gt;&amp;#39;[&amp;quot;3&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;1&amp;quot;]&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;sort&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb54-2&quot;&gt;&lt;a href=&quot;#cb54-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;3&amp;quot;&lt;/span&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is similar to how I would sort an array in JavaScript:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb55&quot;&gt;&lt;pre class=&quot;sourceCode javascript&quot;&gt;&lt;code class=&quot;sourceCode javascript&quot;&gt;&lt;span id=&quot;cb55-1&quot;&gt;&lt;a href=&quot;#cb55-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;const&lt;/span&gt; l &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [&lt;span class=&quot;st&quot;&gt;&amp;quot;3&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;]&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb55-2&quot;&gt;&lt;a href=&quot;#cb55-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;l&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;sort&lt;/span&gt;()&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Other built-ins that mirror JavaScript functionality are available, like &lt;code&gt;length&lt;/code&gt;, &lt;code&gt;reverse&lt;/code&gt;, and &lt;code&gt;tostring&lt;/code&gt; and they can all be used in a similar way:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb56&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb56-1&quot;&gt;&lt;a href=&quot;#cb56-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt;  echo &lt;span class=&quot;st&quot;&gt;&amp;#39;[&amp;quot;3&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;1&amp;quot;]&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;reverse&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb56-2&quot;&gt;&lt;a href=&quot;#cb56-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;3&amp;quot;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb56-3&quot;&gt;&lt;a href=&quot;#cb56-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt;  echo &lt;span class=&quot;st&quot;&gt;&amp;#39;[&amp;quot;3&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;1&amp;quot;]&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;length&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb56-4&quot;&gt;&lt;a href=&quot;#cb56-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If I can combine these built-ins with the selectors I’ve built up so far, I’ll have solved my label sorting problem. So I’ll show that next.&lt;/p&gt;
&lt;div class=&quot;notice--big--primary&quot;&gt;
&lt;p&gt;&lt;strong&gt;What I Learned: &lt;code&gt;jq&lt;/code&gt; built-ins&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;jq&lt;/code&gt; has many built-in functions. There are probably too many to remember but the built-ins tend to mirror JavaScript functions, so give those a try before heading to &lt;a href=&quot;https://stedolan.github.io/jq/manual/#Builtinoperatorsandfunctions&quot;&gt;jq manual&lt;/a&gt; , and you might get lucky.&lt;a href=&quot;#fn5&quot; class=&quot;footnote-ref&quot; id=&quot;fnref5&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;5&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;pipes-and-filters&quot;&gt;Pipes and Filters&lt;/h3&gt;
&lt;p&gt;Before I can use &lt;code&gt;sort&lt;/code&gt; to sort the labels from my GitHub API request, I need to explain how pipes and filters work in &lt;code&gt;jq&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;jq&lt;/code&gt; is a filter in the UNIX command line sense. You pipe (&lt;code&gt;|&lt;/code&gt;) a JSON document to it, and it filters it and outputs it to standard out. I could easily use this feature to chain together jq invocations like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb57&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb57-1&quot;&gt;&lt;a href=&quot;#cb57-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;{&amp;quot;title&amp;quot;:&amp;quot;JQ Select&amp;quot;}&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.title&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;length&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb57-2&quot;&gt;&lt;a href=&quot;#cb57-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;9&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is a wordy, though simple, way to determine the length of a string in a JSON document. You can use this same idea to combine various &lt;code&gt;jq&lt;/code&gt; built-in functions with the features I’ve shown so far. But there is an easier way, though. You can use pipes inside of &lt;code&gt;jq&lt;/code&gt; and conceptually they work just like shell pipes:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb58&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb58-1&quot;&gt;&lt;a href=&quot;#cb58-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;{&amp;quot;title&amp;quot;:&amp;quot;JQ Select&amp;quot;}&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.title | length&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb58-2&quot;&gt;&lt;a href=&quot;#cb58-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;9&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Here are some more examples:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;.title | length&lt;/code&gt; will return the length of the title&lt;/li&gt;
&lt;li&gt;&lt;code&gt;.number | tostring&lt;/code&gt; will return the issue number as a string&lt;/li&gt;
&lt;li&gt;&lt;code&gt;.[] | .key&lt;/code&gt; will return the values of key &lt;code&gt;key&lt;/code&gt; in the array (this is equivalent to this &lt;code&gt;.[].key&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This means that sorting my labels array is simple. I can just change &lt;code&gt;.labels&lt;/code&gt; to &lt;code&gt;.labels | sort&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb59&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb59-1&quot;&gt;&lt;a href=&quot;#cb59-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues/2289 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb59-2&quot;&gt;&lt;a href=&quot;#cb59-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; { title: .title, number: .number, labels: .labels | sort } &amp;#39;&lt;/span&gt;    &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb60&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb60-1&quot;&gt;&lt;a href=&quot;#cb60-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb60-2&quot;&gt;&lt;a href=&quot;#cb60-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb60-3&quot;&gt;&lt;a href=&quot;#cb60-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2289&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb60-4&quot;&gt;&lt;a href=&quot;#cb60-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;labels&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb60-5&quot;&gt;&lt;a href=&quot;#cb60-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      &lt;span class=&quot;st&quot;&gt;&amp;quot;dependencies&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb60-6&quot;&gt;&lt;a href=&quot;#cb60-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      &lt;span class=&quot;st&quot;&gt;&amp;quot;feature request&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb60-7&quot;&gt;&lt;a href=&quot;#cb60-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb60-8&quot;&gt;&lt;a href=&quot;#cb60-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And if you want just a label count that is easy as well:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb61&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb61-1&quot;&gt;&lt;a href=&quot;#cb61-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues/2289 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb61-2&quot;&gt;&lt;a href=&quot;#cb61-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; { title: .title, number: .number, labels: .labels | length } &amp;#39;&lt;/span&gt;    &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb62&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb62-1&quot;&gt;&lt;a href=&quot;#cb62-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb62-2&quot;&gt;&lt;a href=&quot;#cb62-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb62-3&quot;&gt;&lt;a href=&quot;#cb62-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2289&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb62-4&quot;&gt;&lt;a href=&quot;#cb62-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;labels&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb62-5&quot;&gt;&lt;a href=&quot;#cb62-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;notice--big--primary&quot;&gt;
&lt;p&gt;&lt;strong&gt;What I Learned: Pipes and Filters&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Everything in &lt;code&gt;jq&lt;/code&gt; is a filter that you can combine with pipes (&lt;code&gt;|&lt;/code&gt;). This mimics the behavior of a UNIX shell.&lt;/p&gt;
&lt;p&gt;You can use the pipes and the &lt;code&gt;jq&lt;/code&gt; built-ins to build complicated transformations from simple operations.&lt;/p&gt;
&lt;p&gt;It ends up looking something like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb63&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb63-1&quot;&gt;&lt;a href=&quot;#cb63-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; .key1.subkey2[] | sort &amp;#39;&lt;/span&gt; &lt;span class=&quot;co&quot;&gt;# sorting&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb63-2&quot;&gt;&lt;a href=&quot;#cb63-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; .key2.subkey | length&amp;#39;&lt;/span&gt; &lt;span class=&quot;co&quot;&gt;# length of string or array&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb63-3&quot;&gt;&lt;a href=&quot;#cb63-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; .key3 | floor | tostring | length&amp;#39;&lt;/span&gt; &lt;span class=&quot;co&quot;&gt;# and so on&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;maps-and-selects-using-jq&quot;&gt;Maps and Selects Using JQ&lt;/h2&gt;
&lt;p&gt;The issues list I was looking at has many low-quality issues in it.&lt;a href=&quot;#fn6&quot; class=&quot;footnote-ref&quot; id=&quot;fnref6&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;6&lt;/sup&gt;&lt;/a&gt; Let’s say I want to grab all the items that are labeled. This would let me skip all the drive-by fix-my-problem issues.&lt;/p&gt;
&lt;p&gt;Unfortunately, it’s impossible to do this with the GitHub API unless you specify all the possible labels in your query. However, I can easily do this query on the command line by filtering our results with &lt;code&gt;jq&lt;/code&gt;. However, to do so, I’m going to need a couple more &lt;code&gt;jq&lt;/code&gt; functions.&lt;/p&gt;
&lt;p&gt;My query so far looks like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb64&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb64-1&quot;&gt;&lt;a href=&quot;#cb64-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;[ .[] | { title: .title, number: .number, labels: .labels | length } ]&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The first thing I can do is simplify it using &lt;code&gt;map&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb65&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb65-1&quot;&gt;&lt;a href=&quot;#cb65-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;map({ title: .title, number: .number, labels: .labels | length }) &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;map(...)&lt;/code&gt; let’s you unwrap an array, apply a filter and then rewrap the results back into an array. You can think of it as a shorthand for &lt;code&gt;[ .[] | ...  ]&lt;/code&gt; and it comes up quite a bit in my experience, so it’s worth it committing to memory.&lt;/p&gt;
&lt;p&gt;I can combine that with a select statement that looks like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb66&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb66-1&quot;&gt;&lt;a href=&quot;#cb66-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;er&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cf&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;.labels&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; 0&lt;span class=&quot;kw&quot;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;select&lt;/code&gt; is a built-in function that takes a boolean expression and only returns elements that match. It’s similar to the &lt;code&gt;WHERE&lt;/code&gt; clause in a SQL statement or array filter in JavaScript.&lt;/p&gt;
&lt;p&gt;Like &lt;code&gt;map&lt;/code&gt;, I find &lt;code&gt;select&lt;/code&gt; comes up quite a bit, so while you may have to come back to this article or google it the first few times you need it, with luck, it will start to stick to your memory after that.&lt;/p&gt;
&lt;p&gt;Putting this all together looks like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb67&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb67-1&quot;&gt;&lt;a href=&quot;#cb67-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;curl&lt;/span&gt; https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=100 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb67-2&quot;&gt;&lt;a href=&quot;#cb67-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;   &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;map({ title: .title, number: .number, labels: .labels | length }) | &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb67-3&quot;&gt;&lt;a href=&quot;#cb67-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;   map(select(.labels &amp;gt; 0))&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb68&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb68-1&quot;&gt;&lt;a href=&quot;#cb68-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-2&quot;&gt;&lt;a href=&quot;#cb68-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-3&quot;&gt;&lt;a href=&quot;#cb68-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Bump lxml from 4.3.1 to 4.6.3 in /docs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-4&quot;&gt;&lt;a href=&quot;#cb68-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2295&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-5&quot;&gt;&lt;a href=&quot;#cb68-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;labels&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-6&quot;&gt;&lt;a href=&quot;#cb68-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-7&quot;&gt;&lt;a href=&quot;#cb68-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-8&quot;&gt;&lt;a href=&quot;#cb68-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Bump pyyaml from 3.13 to 5.4 in /docs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-9&quot;&gt;&lt;a href=&quot;#cb68-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2291&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-10&quot;&gt;&lt;a href=&quot;#cb68-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;labels&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-11&quot;&gt;&lt;a href=&quot;#cb68-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-12&quot;&gt;&lt;a href=&quot;#cb68-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-13&quot;&gt;&lt;a href=&quot;#cb68-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-14&quot;&gt;&lt;a href=&quot;#cb68-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2289&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-15&quot;&gt;&lt;a href=&quot;#cb68-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;labels&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-16&quot;&gt;&lt;a href=&quot;#cb68-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-17&quot;&gt;&lt;a href=&quot;#cb68-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-18&quot;&gt;&lt;a href=&quot;#cb68-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Debugging help through showing pipeline intermediates. &amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-19&quot;&gt;&lt;a href=&quot;#cb68-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2206&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-20&quot;&gt;&lt;a href=&quot;#cb68-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;labels&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-21&quot;&gt;&lt;a href=&quot;#cb68-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-22&quot;&gt;&lt;a href=&quot;#cb68-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This uses three object indexes, two maps, two pipes, a &lt;code&gt;length&lt;/code&gt; function, and a &lt;code&gt;select&lt;/code&gt; predicate. But if you’ve followed along, this should all make sense. It’s all just composing together filters until you get the result you need.&lt;/p&gt;
&lt;p&gt;Now lets talk about how you can put this knowledge into practice.&lt;/p&gt;
&lt;h2 id=&quot;in-review&quot;&gt;In Review&lt;/h2&gt;
&lt;div class=&quot;notice--big--primary&quot;&gt;
&lt;p&gt;&lt;strong&gt;What I Learned&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Here is what I’ve learned so far:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;jq&lt;/code&gt; lets you select elements by starting with a &lt;code&gt;.&lt;/code&gt; and accessing keys and arrays like it’s a JavaScript Object (which is it is). This feature uses the Object and Array index &lt;code&gt;jq&lt;/code&gt; creates of a JSON document and look like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb69&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb69-1&quot;&gt;&lt;a href=&quot;#cb69-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.key[0].subkey[2:3].subsubkey&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;jq&lt;/code&gt; programs can contain object constructors &lt;code&gt;{ ... }&lt;/code&gt; and array constructors &lt;code&gt;[ ... ]&lt;/code&gt;. You use these when you want to wrap back up something you’ve pulled out of a JSON document using the above indexes:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb70&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb70-1&quot;&gt;&lt;a href=&quot;#cb70-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;[ { key1: .key1, key2: .key2 }  ]&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;jq&lt;/code&gt; contains built-in functions (&lt;code&gt;length&lt;/code&gt;,&lt;code&gt;sort&lt;/code&gt;,&lt;code&gt;select&lt;/code&gt;,&lt;code&gt;map&lt;/code&gt;) and pipes (&lt;code&gt;|&lt;/code&gt;), and you can compose these together just like you can combine pipes and filters at the command line:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb71&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb71-1&quot;&gt;&lt;a href=&quot;#cb71-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;map({ order-of-magitude: .items | length | tostring | length }) &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- markdownlint-enable MD036 --&gt;
&lt;h3 id=&quot;next-steps-for-mastering-jq&quot;&gt;Next Steps for Mastering &lt;code&gt;jq&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;Reading about (or writing about) a tool is not enough to master it. Action is needed. Here is my process for cementing this knowledge:&lt;/p&gt;
&lt;h4 id=&quot;complete-the-jq-tutorial&quot;&gt;1. Complete the &lt;code&gt;jq&lt;/code&gt; Tutorial&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/rjz/jq-tutorial&quot;&gt;jq-tutorial&lt;/a&gt; is not a tutorial at all, but a collection of around 20 interactive exercises that test you knowledge of &lt;code&gt;jq&lt;/code&gt;. I’ve found it extremely helpful.&lt;/p&gt;
&lt;h4 id=&quot;try-using-your-memory-first&quot;&gt;2. Try Using Your Memory First&lt;/h4&gt;
&lt;p&gt;Whenever I need to extract data or transform a JSON document, I try to do it first without looking anything up. If memory fails me, sometimes &lt;a href=&quot;https://jqterm.com/&quot;&gt;jqterm&lt;/a&gt;, which has auto-completion, is helpful. Often, I still need to look something up, but science has shown that &lt;a href=&quot;https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3983480/&quot;&gt;repeated retrieval yields retention&lt;/a&gt;. So over time, my retention should improve.&lt;/p&gt;
&lt;h4 id=&quot;use-it&quot;&gt;3. Use It&lt;/h4&gt;
&lt;p&gt;If you don’t use a tool, you will never master it. So when I have a task that can be solved using &lt;code&gt;jq&lt;/code&gt;, then it is what I use. At least for the next little while, even if there is an easier way to do it. Whether it’s exploring a REST API or looking at &lt;code&gt;docker inspect&lt;/code&gt; results, JSON is everywhere, so opportunities abound.&lt;/p&gt;
&lt;h4 id=&quot;learn-more&quot;&gt;4. Learn More&lt;/h4&gt;
&lt;p&gt;Lastly, to deepen my knowledge, I’m learning about recursive descent, declaring variables, and defining functions and advanced features found in the &lt;a href=&quot;https://stedolan.github.io/jq/manual/#Advancedfeatures&quot;&gt;manual&lt;/a&gt;. Of course, these things rarely come up, but after writing all this, I’m hooked on this tool.&lt;/p&gt;
&lt;p&gt;Doing all this isn’t necessary, but if you follow me in some of these steps, I think using &lt;code&gt;jq&lt;/code&gt; will become second nature.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;So far I’ve only covered the basics of &lt;code&gt;jq&lt;/code&gt;. The &lt;code&gt;jq&lt;/code&gt; query language is a full programming language and you can do lots of exciting things with it. You convert from &lt;a href=&quot;/blog/convert-to-from-json/#convert-json-to-csv-via-the-command-line-using-jq&quot;&gt;JSON to CSV&lt;/a&gt;. You can define you own functions and even &lt;a href=&quot;https://rosettacode.org/wiki/Sieve_of_Eratosthenes#jq&quot;&gt;find primes&lt;/a&gt; with &lt;code&gt;jq&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb72&quot;&gt;&lt;pre class=&quot;sourceCode haskell&quot;&gt;&lt;code class=&quot;sourceCode haskell&quot;&gt;&lt;span id=&quot;cb72-1&quot;&gt;&lt;a href=&quot;#cb72-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;# Denoting the input by $n, which is assumed to be a positive integer,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb72-2&quot;&gt;&lt;a href=&quot;#cb72-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;# eratosthenes/0 produces an array of primes less than or equal to $n:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb72-3&quot;&gt;&lt;a href=&quot;#cb72-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;def eratosthenes&lt;span class=&quot;op&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb72-4&quot;&gt;&lt;a href=&quot;#cb72-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  (&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;) as &lt;span class=&quot;op&quot;&gt;$&lt;/span&gt;n&lt;/span&gt;
&lt;span id=&quot;cb72-5&quot;&gt;&lt;a href=&quot;#cb72-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;op&quot;&gt;|&lt;/span&gt; ((&lt;span class=&quot;op&quot;&gt;$&lt;/span&gt;n&lt;span class=&quot;op&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;sqrt&lt;/span&gt;) &lt;span class=&quot;op&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;) as &lt;span class=&quot;op&quot;&gt;$&lt;/span&gt;s&lt;/span&gt;
&lt;span id=&quot;cb72-6&quot;&gt;&lt;a href=&quot;#cb72-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;op&quot;&gt;|&lt;/span&gt; [&lt;span class=&quot;fu&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;fu&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;fu&quot;&gt;range&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;; &lt;span class=&quot;op&quot;&gt;$&lt;/span&gt;n)]&lt;/span&gt;
&lt;span id=&quot;cb72-7&quot;&gt;&lt;a href=&quot;#cb72-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;op&quot;&gt;|&lt;/span&gt; reduce (&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; (&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;range&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;; &lt;span class=&quot;op&quot;&gt;$&lt;/span&gt;s))) as &lt;span class=&quot;op&quot;&gt;$&lt;/span&gt;i (&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;; erase(&lt;span class=&quot;op&quot;&gt;$&lt;/span&gt;i))&lt;/span&gt;
&lt;span id=&quot;cb72-8&quot;&gt;&lt;a href=&quot;#cb72-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;op&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;map&lt;/span&gt;(select(&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;));&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;However, simple stuff – like selecting elements, filtering by key, or value – is often all you need.&lt;/p&gt;
&lt;p&gt;I hope this helps make &lt;code&gt;jq&lt;/code&gt; more approachable and that you no longer have to go to google every time you want to query a JSON document&lt;a href=&quot;#fn7&quot; class=&quot;footnote-ref&quot; id=&quot;fnref7&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;7&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;notice--info notice--big&quot;&gt;
&lt;p&gt;
&lt;strong&gt;While you’re here:&lt;/strong&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today.
&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;feedback&quot;&gt;Feedback?&lt;/h2&gt;
&lt;p&gt;I’d love to hear your feedback, or if you have any tips of your own. Let me know on twitter:&lt;/p&gt;
&lt;blockquote class=&quot;twitter-tweet&quot;&gt;
&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;
jq is great for pretty-printing JSON but it does so much more. &lt;br&gt;&lt;br&gt;I never really mastered it and it was a challenge each time I tried to use it.&lt;br&gt;&lt;br&gt;So I took some time to learn the basics. Here is what you need to know: 🧵
&lt;/p&gt;
— Adam Gordon Bell 🤓 (&lt;span class=&quot;citation&quot; data-cites=&quot;adamgordonbell&quot;&gt;@adamgordonbell&lt;/span&gt;) &lt;a href=&quot;https://twitter.com/adamgordonbell/status/1430193359012851722?ref_src=twsrc%5Etfw&quot;&gt;August 24, 2021&lt;/a&gt;
&lt;/blockquote&gt;
&lt;script async src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;
&lt;!-- markdownlint-enable MD014 --&gt;
&lt;section class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&quot;fn1&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;&lt;code&gt;alias gwip='git commit -a -m &quot;work in progress - fixup&quot;'&lt;/code&gt; I use this alias all the time and it gives me confidence that I can always get back to my last good state. I almost never end up reverting though, and the commits all get &lt;code&gt;fixup&lt;/code&gt;ed away, so I think it’s more useful psychologically than anything else.&lt;a href=&quot;#fnref1&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn2&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;A note for the pedants: automated behavior is stored in your basal ganglia. It feels like it’s in my fingers, but really, these actions just fired at a level below my awareness.&lt;a href=&quot;#fnref2&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn3&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;By default, &lt;code&gt;jq&lt;/code&gt; pretty-prints all its output. This means that its output is not character-for-character identical to its input.&lt;a href=&quot;#fnref3&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn4&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;It’s possible to use jq filters as keys in the Object constructor as well, but that is outside the scope of this guide.&lt;a href=&quot;#fnref4&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn5&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;You also aren’t limited by the built-ins. You can write your &lt;a href=&quot;https://stedolan.github.io/jq/manual/#Advancedfeatures&quot;&gt;own functions&lt;/a&gt; as well.&lt;a href=&quot;#fnref5&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn6&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;People can’t figure out how to do something with &lt;code&gt;jq&lt;/code&gt; and open an issue. Please don’t do this. GitHub issues aren’t the place to post your random struggles with understanding a tool.&lt;a href=&quot;#fnref6&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn7&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;A lot of the credit for the strength of this &lt;code&gt;jq&lt;/code&gt; summary goes to &lt;a href=&quot;https://refactoringenglish.com/&quot;&gt;Michael Lynch&lt;/a&gt; who is writing a book about writing and provided me extensive feedback on an earlier draft of this article.&lt;a href=&quot;#fnref7&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;</content><author><name>Adam Gordon Bell</name></author><category term="Tutorials" /><summary type="html">Background: Fingers, Head, and Google Whenever I reach a stopping point in my work, I use a bash alias called gwip1 to create a ‘work in progress’ commit. It happens without conscious thinking on my part. The same way my fingers know the vim key bindings, they know gwip. Other actions, I know how they work, but I have to think about them every time. They are in my head, not my fingers.2 However, some things never stick in my head, nor my fingers, and I have to google them every time. jq is one of these. I know it’s a powerful tool, but I always end up back at Google and then copying and pasting a solution from somewhere. So I solve my problem but never learn the tool. It’s time to fix that. In this article, I’m going to go over the basics building blocks of jq in enough depth that you will be able to understand how jq works. Of course, you still might occasionally need to head to google to find a function name or check your syntax, but at least you’ll have a firm grounding in the basics. What Is JQ jq is a lightweight, command-line JSON processor. I install it with brew (brew install jq), but it’s a single portable executable, so it’s easy to install on Linux, Windows, or macOS. To use it, you construct one or more filters, and it applies those filters to a JSON document. The simplest filter is the identity filter which returns all its input (.): $ echo &amp;#39;{&amp;quot;key1&amp;quot;:{&amp;quot;key2&amp;quot;:&amp;quot;value1&amp;quot;}}&amp;#39; | jq &amp;#39;.&amp;#39; { &amp;quot;key1&amp;quot;: { &amp;quot;key2&amp;quot;: &amp;quot;value1&amp;quot; } } This filter is handy for just pretty-printing a JSON document.3 I’m going to ignore the pretty-printing and jump right into using jq to transform JSON documents. Using JQ to Select Elements I’m going to use jq to filter the data returned by the GitHub repository API. The data I get back by default looks like this: $ curl https://api.github.com/repos/stedolan/jq { &amp;quot;id&amp;quot;: 5101141, &amp;quot;node_id&amp;quot;: &amp;quot;MDEwOlJlcG9zaXRvcnk1MTAxMTQx&amp;quot;, &amp;quot;name&amp;quot;: &amp;quot;jq&amp;quot;, &amp;quot;full_name&amp;quot;: &amp;quot;stedolan/jq&amp;quot;, &amp;quot;private&amp;quot;: false, &amp;quot;owner&amp;quot;: { &amp;quot;login&amp;quot;: &amp;quot;stedolan&amp;quot;, &amp;quot;id&amp;quot;: 79765 }, &amp;quot;html_url&amp;quot;: &amp;quot;https://github.com/stedolan/jq&amp;quot;, &amp;quot;description&amp;quot;: &amp;quot;Command-line JSON processor&amp;quot;, &amp;quot;stargazers_count&amp;quot;: 19967, &amp;quot;watchers_count&amp;quot;: 19967, &amp;quot;language&amp;quot;: &amp;quot;C&amp;quot;, &amp;quot;license&amp;quot;: { &amp;quot;key&amp;quot;: &amp;quot;other&amp;quot;, &amp;quot;name&amp;quot;: &amp;quot;Other&amp;quot;, &amp;quot;spdx_id&amp;quot;: &amp;quot;NOASSERTION&amp;quot;, &amp;quot;url&amp;quot;: null, &amp;quot;node_id&amp;quot;: &amp;quot;MDc6TGljZW5zZTA=&amp;quot; } } jq lets us treat the JSON document as an object and select elements inside of it. Here is how I filter the JSON document to select the value of the name key: $ curl https://api.github.com/repos/stedolan/jq | jq &amp;#39; .name&amp;#39; &amp;quot;jq&amp;quot; Similarly, for selecting the value of the owner key: $ curl https://api.github.com/repos/stedolan/jq | jq &amp;#39; .owner&amp;#39; { &amp;quot;login&amp;quot;: &amp;quot;stedolan&amp;quot;, &amp;quot;id&amp;quot;: 79765 } You can drill in as far as you want like this: $ curl https://api.github.com/repos/stedolan/jq | jq &amp;#39; .owner.login&amp;#39; &amp;quot;stedolan&amp;quot; What I Learned: Object Identifier-Index jq lets you select elements in a JSON document like it’s a JavaScript object. Just start with . ( for the whole document) and drill down to the value you want. It ends up looking something like this: jq &amp;#39;.key.subkey.subsubkey&amp;#39; Using JQ to Select Arrays If you curl the GitHub Issues API, you will get back an array of issues: $ curl https://api.github.com/repos/stedolan/jq/issues?per_page=5 [ { &amp;quot;id&amp;quot;: 966024429, &amp;quot;number&amp;quot;: 2341, &amp;quot;title&amp;quot;: &amp;quot;Question about license.&amp;quot;, &amp;quot;body&amp;quot;: &amp;quot;I would like to create a [winget](https://github.com/microsoft/winget-cli) package for jq. 🙏🏻&amp;quot; }, { &amp;quot;id&amp;quot;: 962477084, &amp;quot;number&amp;quot;: 2340, &amp;quot;title&amp;quot;: &amp;quot;visibility of wiki pages&amp;quot;, &amp;quot;body&amp;quot;: &amp;quot;The visibility of wiki pages to search engines is generally limited; for example, the search result for \&amp;quot;jq Cookbook\&amp;quot; looks like this:&amp;quot; }, { &amp;quot;id&amp;quot;: 955350543, &amp;quot;number&amp;quot;: 2337, &amp;quot;title&amp;quot;: &amp;quot;Release 1.6 does not have pre-autoreconf&amp;#39;ed configure script&amp;quot;, &amp;quot;body&amp;quot;: &amp;quot;If you have a usage question, please ask us on either Stack Overflow (https://stackoverflow.com/questions/tagged/jq) or in the #jq channel (http://irc.lc/freenode/%23jq/) on Freenode (https://webchat.freenode.net/).&amp;quot; }, { &amp;quot;id&amp;quot;: 954792209, &amp;quot;number&amp;quot;: 2336, &amp;quot;title&amp;quot;: &amp;quot;Fix typo&amp;quot;, &amp;quot;body&amp;quot;: &amp;quot;&amp;quot; }, { &amp;quot;id&amp;quot;: 940627936, &amp;quot;number&amp;quot;: 2334, &amp;quot;title&amp;quot;: &amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot;, &amp;quot;body&amp;quot;: &amp;quot;Compile errors in filter expressions don&amp;#39;t include the column number where the parser approximately or exactly locates the error. Most filter expressions are one-liners (are multiple lines even supported?), so the information that the error is on line 1 is not helpful.&amp;quot; } ] To get a specific element in the array, give jq an index: $ curl https://api.github.com/repos/stedolan/jq/issues?per_page=5 | jq &amp;#39;.[4]&amp;#39; { &amp;quot;id&amp;quot;: 940627936, &amp;quot;number&amp;quot;: 2334, &amp;quot;title&amp;quot;: &amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot;, &amp;quot;body&amp;quot;: &amp;quot;Compile errors in filter expressions don&amp;#39;t include the column number where the parser approximately or exactly locates the error. Most filter expressions are one-liners (are multiple lines even supported?), so the information that the error is on line 1 is not helpful.&amp;quot; } Side Note: Array Indexing in jq Array indexing has some helpful convenience syntax. You can select ranges: $ echo &amp;quot;[1,2,3,4,5]&amp;quot; | jq &amp;#39;.[2:4]&amp;#39; [3,4] You can select one sided ranges: $ echo &amp;quot;[1,2,3,4,5]&amp;quot; | jq &amp;#39;.[2:]&amp;#39; [3,4,5] Also, you can use negatives to select from the end: $ echo &amp;quot;[1,2,3,4,5]&amp;quot; | jq &amp;#39;.[-2:]&amp;#39; [4,5] You can use the array index with the object index: $ curl https://api.github.com/repos/stedolan/jq/issues?per_page=5 | jq &amp;#39;.[4].title&amp;#39; &amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot; And you can use [] to get all the elements in the array. For example, here is how I would get the titles of the issues returned by my API request: $ curl https://api.github.com/repos/stedolan/jq/issues?per_page=5 | jq &amp;#39;.[].title&amp;#39; &amp;quot;Question about license.&amp;quot; &amp;quot;visibility of wiki pages&amp;quot; &amp;quot;Release 1.6 does not have pre-autoreconf&amp;#39;ed configure script&amp;quot; &amp;quot;Fix typo&amp;quot; &amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot; What I Learned: Array-Index jq lets you select the whole array [], a specific element [3], or ranges [2:5] and combine these with the object index if needed. It ends up looking something like this: jq &amp;#39;.key[].subkey[2] Side Note: Removing Quotes From JQ Output The -r option in jq gives you raw strings if you need that. $ echo &amp;#39;[&amp;quot;1&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;3&amp;quot;]&amp;#39; | jq -r &amp;#39;.[]&amp;#39; 1 2 3 The -j option (for join) can combine together your output. $ echo &amp;#39;[&amp;quot;1&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;3&amp;quot;]&amp;#39; | jq -j &amp;#39;.[]&amp;#39; 123 Putting Elements in an Array using jq Once you start using the array index to select elements, you have a new problem. The data returned won’t be a valid JSON document. In the example above, the issue titles were new line delimited: &amp;quot;Question about license.&amp;quot; &amp;quot;visibility of wiki pages&amp;quot; &amp;quot;Release 1.6 does not have pre-autoreconf&amp;#39;ed configure script&amp;quot; &amp;quot;Fix typo&amp;quot; &amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot; ... In fact, whenever you ask jq to return an unwrapped collection of elements, it prints them each on a new line. You can see this by explicitly asking jq to ignore its input and instead return two numbers: $ echo &amp;#39;&amp;quot;&amp;quot;&amp;#39; | jq &amp;#39;1,2&amp;#39; 1 2 You can resolve this the same way you would turn the text 1,2 into an array in JavaScript: By wrapping it in an array constructor [ ... ]. $ echo &amp;#39;&amp;quot;&amp;quot;&amp;#39; | jq &amp;#39;[1,2]&amp;#39; [ 1, 2 ] Similarly, to put a generated collection of results into a JSON array, you wrap it in an array constructor [ ... ]. My GitHub issue title filter (.[].title) then becomes [ .[].title ] like this: $ curl https://api.github.com/repos/stedolan/jq/issues?per_page=5 | \ jq &amp;#39;[ .[].title ] &amp;#39; [ &amp;quot;Question about license.&amp;quot;, &amp;quot;visibility of wiki pages&amp;quot;, &amp;quot;Release 1.6 does not have pre-autoreconf&amp;#39;ed configure script&amp;quot;, &amp;quot;Fix typo&amp;quot;, &amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot; ] Now I have a valid JSON document. What I Learned: Array Constructors If your jq query returns more than one element, they will be returned newline delimited. $ echo &amp;#39;[{&amp;quot;a&amp;quot;:&amp;quot;b&amp;quot;},{&amp;quot;a&amp;quot;:&amp;quot;c&amp;quot;}]&amp;#39; | jq -r &amp;#39;.[].a&amp;#39; &amp;quot;b&amp;quot; &amp;quot;c&amp;quot; To turn these values into a JSON array, what you do is similar to creating an array in JavaScript: You wrap the values in an array constructor ([...]). It ends up looking something like this: $ echo &amp;#39;[{&amp;quot;a&amp;quot;:&amp;quot;b&amp;quot;},{&amp;quot;a&amp;quot;:&amp;quot;c&amp;quot;}]&amp;#39; | jq -r &amp;#39;[ .[].a ]&amp;#39; [ &amp;quot;b&amp;quot;, &amp;quot;c&amp;quot; ] Using jq to Select Multiple Fields The GitHub issues API has a lot of details I don’t care about. I want to select multiple fields from the returned JSON document and leave the rest behind. The easiest way to do this is using , to specify multiple filters: $ curl https://api.github.com/repos/stedolan/jq/issues?per_page=2 | \ jq &amp;#39; .[].title, .[].number&amp;#39; &amp;quot;Question about license.&amp;quot; &amp;quot;visibility of wiki pages&amp;quot; 2341 2340 But this is returning the results of one selection after the other. To change the ordering, I can factor out the array selector: $ curl https://api.github.com/repos/stedolan/jq/issues?per_page=2 | \ jq &amp;#39;.[] | .title, .number&amp;#39; &amp;quot;Question about license.&amp;quot; 2341 &amp;quot;visibility of wiki pages&amp;quot; 2340 This refactoring uses a pipe (|), which I’ll talk about shortly, and runs my object selectors (.title and .number) on each array element. If you wrap the query in the array constructor you get this: $ curl https://api.github.com/repos/stedolan/jq/issues?per_page=2 | \ jq &amp;#39;[ .[] | .title, .number ]&amp;#39; [ &amp;quot;Question about license.&amp;quot;, 2341, &amp;quot;visibility of wiki pages&amp;quot;, 2340 ] But this still isn’t the JSON document I need. To get these values into a proper JSON object, I need an object constructor { ... }. Putting Elements Into an Object Using jq Let’s look at some simple examples before showing how my GitHub query can use an object constructor. A Little Example I have an array that contains my name ([&quot;Adam&quot;,&quot;Gordon&quot;,&quot;Bell&quot;]), and I want to turn it into a JSON object like this: { &amp;quot;first_name&amp;quot;:&amp;quot;Adam&amp;quot;, &amp;quot;last_name&amp;quot;:&amp;quot;Bell&amp;quot; } I can select the elements I need using array indexing like this: $ echo &amp;#39;[&amp;quot;Adam&amp;quot;,&amp;quot;Gordon&amp;quot;,&amp;quot;Bell&amp;quot;]&amp;#39; | jq -r &amp;#39;.[0], .[2]&amp;#39; Adam Bell To wrap those values into the shape I need, I can replace the values with the array indexes that return them: { &amp;quot;first_name&amp;quot;:.[0], &amp;quot;last_name&amp;quot;:.[2] } Or on a single line like this: $ echo &amp;#39;[&amp;quot;Adam&amp;quot;,&amp;quot;Gordon&amp;quot;,&amp;quot;Bell&amp;quot;]&amp;#39; | jq -r &amp;#39;{ &amp;quot;first_name&amp;quot;:.[0], &amp;quot;last_name&amp;quot;: .[2]}&amp;#39; { &amp;quot;first_name&amp;quot;: &amp;quot;Adam&amp;quot;, &amp;quot;last_name&amp;quot;: &amp;quot;Bell&amp;quot; } This syntax is the same syntax for creating an object in a JSON document. The only difference is you can use the object and array queries you’ve built up as the values. Back to GitHub Returning to my GitHub API problem, to wrap the number and the title up into an array I use the object constructor like this: $ curl https://api.github.com/repos/stedolan/jq/issues?per_page=2 | \ jq &amp;#39;[ .[] | { title: .title, number: .number} ]&amp;#39; [ { &amp;quot;title&amp;quot;: &amp;quot;Question about license.&amp;quot;, &amp;quot;number&amp;quot;: 2341 }, { &amp;quot;title&amp;quot;: &amp;quot;visibility of wiki pages&amp;quot;, &amp;quot;number&amp;quot;: 2340 } ] What I Learned: Object Constructors To put the elements you’ve selected back into a JSON document, you can wrap them in an object constructor { ... }. If you were building up a JSON object out of several selectors, it would end up looking something like this: jq &amp;#39;{ &amp;quot;key1&amp;quot;: &amp;lt;&amp;lt;jq filter&amp;gt;&amp;gt;, &amp;quot;key2&amp;quot;: &amp;lt;&amp;lt;jq filter&amp;gt;&amp;gt; }&amp;#39; Which is the same syntax for an object in a JSON document, except with jq you can use filters as values.4 Sorting and Counting With JQ The next problem I have is that I want to summarize some this JSON data. Each issue returned by GitHub has a collection of labels: $ curl https://api.github.com/repos/stedolan/jq/issues/2289 | \ jq &amp;#39; { title: .title, number: .number, labels: .labels} &amp;#39; { &amp;quot;title&amp;quot;: &amp;quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&amp;quot;, &amp;quot;number&amp;quot;: 2289, &amp;quot;labels&amp;quot;: [ &amp;quot;feature request&amp;quot;, &amp;quot;dependencies&amp;quot; ] } jq Built-in Functions If I want those labels in alphabetical order I can use the built in sort function. It works like this: $ echo &amp;#39;[&amp;quot;3&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;1&amp;quot;]&amp;#39; | jq &amp;#39;sort&amp;#39; [&amp;quot;1&amp;quot;, &amp;quot;2&amp;quot;, &amp;quot;3&amp;quot;] This is similar to how I would sort an array in JavaScript: const l = [&amp;quot;3&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;1&amp;quot;]; l.sort(); Other built-ins that mirror JavaScript functionality are available, like length, reverse, and tostring and they can all be used in a similar way: $ echo &amp;#39;[&amp;quot;3&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;1&amp;quot;]&amp;#39; | jq &amp;#39;reverse&amp;#39; [&amp;quot;1&amp;quot;, &amp;quot;2&amp;quot;, &amp;quot;3&amp;quot;] $ echo &amp;#39;[&amp;quot;3&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;1&amp;quot;]&amp;#39; | jq &amp;#39;length&amp;#39; 3 If I can combine these built-ins with the selectors I’ve built up so far, I’ll have solved my label sorting problem. So I’ll show that next. What I Learned: jq built-ins jq has many built-in functions. There are probably too many to remember but the built-ins tend to mirror JavaScript functions, so give those a try before heading to jq manual , and you might get lucky.5 Pipes and Filters Before I can use sort to sort the labels from my GitHub API request, I need to explain how pipes and filters work in jq. jq is a filter in the UNIX command line sense. You pipe (|) a JSON document to it, and it filters it and outputs it to standard out. I could easily use this feature to chain together jq invocations like this: echo &amp;#39;{&amp;quot;title&amp;quot;:&amp;quot;JQ Select&amp;quot;}&amp;#39; | jq &amp;#39;.title&amp;#39; | jq &amp;#39;length&amp;#39; 9 This is a wordy, though simple, way to determine the length of a string in a JSON document. You can use this same idea to combine various jq built-in functions with the features I’ve shown so far. But there is an easier way, though. You can use pipes inside of jq and conceptually they work just like shell pipes: echo &amp;#39;{&amp;quot;title&amp;quot;:&amp;quot;JQ Select&amp;quot;}&amp;#39; | jq &amp;#39;.title | length&amp;#39; 9 Here are some more examples: .title | length will return the length of the title .number | tostring will return the issue number as a string .[] | .key will return the values of key key in the array (this is equivalent to this .[].key) This means that sorting my labels array is simple. I can just change .labels to .labels | sort: $ curl https://api.github.com/repos/stedolan/jq/issues/2289 | \ jq &amp;#39; { title: .title, number: .number, labels: .labels | sort } &amp;#39; { &amp;quot;title&amp;quot;: &amp;quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&amp;quot;, &amp;quot;number&amp;quot;: 2289, &amp;quot;labels&amp;quot;: [ &amp;quot;dependencies&amp;quot;, &amp;quot;feature request&amp;quot; ] } And if you want just a label count that is easy as well: $ curl https://api.github.com/repos/stedolan/jq/issues/2289 | \ jq &amp;#39; { title: .title, number: .number, labels: .labels | length } &amp;#39; { &amp;quot;title&amp;quot;: &amp;quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&amp;quot;, &amp;quot;number&amp;quot;: 2289, &amp;quot;labels&amp;quot;: 2 } What I Learned: Pipes and Filters Everything in jq is a filter that you can combine with pipes (|). This mimics the behavior of a UNIX shell. You can use the pipes and the jq built-ins to build complicated transformations from simple operations. It ends up looking something like this: jq &amp;#39; .key1.subkey2[] | sort &amp;#39; # sorting jq &amp;#39; .key2.subkey | length&amp;#39; # length of string or array jq &amp;#39; .key3 | floor | tostring | length&amp;#39; # and so on Maps and Selects Using JQ The issues list I was looking at has many low-quality issues in it.6 Let’s say I want to grab all the items that are labeled. This would let me skip all the drive-by fix-my-problem issues. Unfortunately, it’s impossible to do this with the GitHub API unless you specify all the possible labels in your query. However, I can easily do this query on the command line by filtering our results with jq. However, to do so, I’m going to need a couple more jq functions. My query so far looks like this: jq &amp;#39;[ .[] | { title: .title, number: .number, labels: .labels | length } ]&amp;#39; The first thing I can do is simplify it using map. jq &amp;#39;map({ title: .title, number: .number, labels: .labels | length }) map(...) let’s you unwrap an array, apply a filter and then rewrap the results back into an array. You can think of it as a shorthand for [ .[] | ... ] and it comes up quite a bit in my experience, so it’s worth it committing to memory. I can combine that with a select statement that looks like this: map(select(.labels &amp;gt; 0)) select is a built-in function that takes a boolean expression and only returns elements that match. It’s similar to the WHERE clause in a SQL statement or array filter in JavaScript. Like map, I find select comes up quite a bit, so while you may have to come back to this article or google it the first few times you need it, with luck, it will start to stick to your memory after that. Putting this all together looks like this: curl https://api.github.com/repos/stedolan/jq/issues?per_page=100 | \ jq &amp;#39;map({ title: .title, number: .number, labels: .labels | length }) | map(select(.labels &amp;gt; 0))&amp;#39; [ { &amp;quot;title&amp;quot;: &amp;quot;Bump lxml from 4.3.1 to 4.6.3 in /docs&amp;quot;, &amp;quot;number&amp;quot;: 2295, &amp;quot;labels&amp;quot;: 1 }, { &amp;quot;title&amp;quot;: &amp;quot;Bump pyyaml from 3.13 to 5.4 in /docs&amp;quot;, &amp;quot;number&amp;quot;: 2291, &amp;quot;labels&amp;quot;: 1 }, { &amp;quot;title&amp;quot;: &amp;quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&amp;quot;, &amp;quot;number&amp;quot;: 2289, &amp;quot;labels&amp;quot;: 1 }, { &amp;quot;title&amp;quot;: &amp;quot;Debugging help through showing pipeline intermediates. &amp;quot;, &amp;quot;number&amp;quot;: 2206, &amp;quot;labels&amp;quot;: 1 } ] This uses three object indexes, two maps, two pipes, a length function, and a select predicate. But if you’ve followed along, this should all make sense. It’s all just composing together filters until you get the result you need. Now lets talk about how you can put this knowledge into practice. In Review What I Learned Here is what I’ve learned so far: jq lets you select elements by starting with a . and accessing keys and arrays like it’s a JavaScript Object (which is it is). This feature uses the Object and Array index jq creates of a JSON document and look like this: jq &amp;#39;.key[0].subkey[2:3].subsubkey&amp;#39; jq programs can contain object constructors { ... } and array constructors [ ... ]. You use these when you want to wrap back up something you’ve pulled out of a JSON document using the above indexes: jq &amp;#39;[ { key1: .key1, key2: .key2 } ]&amp;#39; jq contains built-in functions (length,sort,select,map) and pipes (|), and you can compose these together just like you can combine pipes and filters at the command line: jq &amp;#39;map({ order-of-magitude: .items | length | tostring | length }) Next Steps for Mastering jq Reading about (or writing about) a tool is not enough to master it. Action is needed. Here is my process for cementing this knowledge: 1. Complete the jq Tutorial jq-tutorial is not a tutorial at all, but a collection of around 20 interactive exercises that test you knowledge of jq. I’ve found it extremely helpful. 2. Try Using Your Memory First Whenever I need to extract data or transform a JSON document, I try to do it first without looking anything up. If memory fails me, sometimes jqterm, which has auto-completion, is helpful. Often, I still need to look something up, but science has shown that repeated retrieval yields retention. So over time, my retention should improve. 3. Use It If you don’t use a tool, you will never master it. So when I have a task that can be solved using jq, then it is what I use. At least for the next little while, even if there is an easier way to do it. Whether it’s exploring a REST API or looking at docker inspect results, JSON is everywhere, so opportunities abound. 4. Learn More Lastly, to deepen my knowledge, I’m learning about recursive descent, declaring variables, and defining functions and advanced features found in the manual. Of course, these things rarely come up, but after writing all this, I’m hooked on this tool. Doing all this isn’t necessary, but if you follow me in some of these steps, I think using jq will become second nature. Conclusion So far I’ve only covered the basics of jq. The jq query language is a full programming language and you can do lots of exciting things with it. You convert from JSON to CSV. You can define you own functions and even find primes with jq: # Denoting the input by $n, which is assumed to be a positive integer, # eratosthenes/0 produces an array of primes less than or equal to $n: def eratosthenes: (. + 1) as $n | (($n|sqrt) / 2) as $s | [null, null, range(2; $n)] | reduce (2, 1 + (2 * range(1; $s))) as $i (.; erase($i)) | map(select(.)); However, simple stuff – like selecting elements, filtering by key, or value – is often all you need. I hope this helps make jq more approachable and that you no longer have to go to google every time you want to query a JSON document7. While you’re here: Earthly is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today. Feedback? I’d love to hear your feedback, or if you have any tips of your own. Let me know on twitter: jq is great for pretty-printing JSON but it does so much more. I never really mastered it and it was a challenge each time I tried to use it.So I took some time to learn the basics. Here is what you need to know: 🧵 alias gwip='git commit -a -m &quot;work in progress - fixup&quot;'↩︎ A note for the pedants: automated behavior is stored in your basal ganglia. It feels like it’s in my fingers, but really, these actions just fired at a level below my awareness.↩︎ By default, jq pretty-prints all its output. This means that its output is not character-for-character identical to its input.↩︎ It’s possible to use jq filters as keys in the Object constructor as well, but that is outside the scope of this guide.↩︎ You also aren’t limited by the built-ins. You can write your own functions as well.↩︎ People can’t figure out how to do something with jq and open an issue. Please don’t do this. GitHub issues aren’t the place to post your random struggles with understanding a tool.↩︎ A lot of the credit for the strength of this jq summary goes to Michael Lynch who is writing a book about writing and provided me extensive feedback on an earlier draft of this article.↩︎</summary></entry><entry><title type="html">Plotting Precipitation with Python, Pandas and Matplotlib</title><link href="https://earthly.dev/blog/plotting-rainfall-data-with-python-and-matplotlib/" rel="alternate" type="text/html" title="Plotting Precipitation with Python, Pandas and Matplotlib" /><published>2021-08-18T00:00:00-04:00</published><updated>2021-08-18T00:00:00-04:00</updated><id>https://earthly.dev/blog/plotting-rainfall-data-with-python-and-matplotlib</id><content type="html" xml:base="https://earthly.dev/blog/plotting-rainfall-data-with-python-and-matplotlib/">&lt;h2 id=&quot;where-did-all-the-rain-go&quot;&gt;Where Did All The Rain Go?&lt;/h2&gt;
&lt;p&gt;It’s been a really dry summer here in Victoria BC (and the rest of the province). I couldn’t remember the last time it had rained, which got me looking at historical weather data. Before I knew it, rather than simply look up how many days it’s been since it last rained (42 and counting!), I was plotting cumulative annual rainfall.&lt;/p&gt;
&lt;h2 id=&quot;get-some-data&quot;&gt;Get Some Data&lt;/h2&gt;
&lt;p&gt;I ended up on Environment Canada’s &lt;a href=&quot;https://climate.weather.gc.ca/historical_data/search_historic_data_e.html&quot;&gt;historic data search page&lt;/a&gt;, and ended up with a table of daily weather recorded at Victoria International Airport, climate ID 1018621 (which is closer to Sidney BC, but I digress). On the right hand side of that page, there was an option to download the data as CSV. Upon clicking the &lt;code&gt;Download Data&lt;/code&gt; button, my web browser was redirected to:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://climate.weather.gc.ca/climate_data/bulk_data_e.html?format=csv&amp;amp;stationID=51337&amp;amp;Year=2021&amp;amp;Month=7&amp;amp;Day=1&amp;amp;time=&amp;amp;timeframe=2&amp;amp;submit=Download+Data&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The website gave me an option to change the range of data to download; however if you squint enough, the above URL looks like an API. Furthermore, the month and day values didn’t seem to affect anything – since this was annual data, only the year was used.&lt;/p&gt;
&lt;p&gt;It’s also interesting to note that the &lt;code&gt;station ID&lt;/code&gt; is different from the &lt;code&gt;Climate ID&lt;/code&gt; even though Environment Canada defines “the climate ID is a 7 digit number assigned by the Meteorological Service of Canada to a site where official weather observations are taken, and serves as a permanent, unique identifier.” Perhaps there was a &lt;a href=&quot;/blog/thought-leaders/&quot;&gt;thought leader&lt;/a&gt; who was suffering from past trauma where a client’s definition of a “permanent unique identifier” didn’t match up with a relational databases’ definition of a unique identifier, and insisted on creating a lookup table for these different IDs. Again, I digress, back to downloading data.&lt;/p&gt;
&lt;p&gt;I wrote a &lt;a href=&quot;/blog/understanding-bash&quot;&gt;bash&lt;/a&gt; while loop to download this data:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#!/bin/sh&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-2&quot;&gt;&lt;a href=&quot;#cb2-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-e&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-3&quot;&gt;&lt;a href=&quot;#cb2-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; year &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;seq&lt;/span&gt; 2013 2021&lt;span class=&quot;va&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cf&quot;&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-4&quot;&gt;&lt;a href=&quot;#cb2-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ex&quot;&gt;curl&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;https://climate.weather.gc.ca/climate_data/bulk_data_e.html?format=csv&amp;amp;stationID=51337&amp;amp;Year=&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;${year}&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;amp;timeframe=2&amp;quot;&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; victoria-weather-&lt;span class=&quot;va&quot;&gt;$year&lt;/span&gt;.csv&lt;/span&gt;
&lt;span id=&quot;cb2-5&quot;&gt;&lt;a href=&quot;#cb2-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;done&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;parsing-the-data&quot;&gt;Parsing the Data&lt;/h2&gt;
&lt;h3 id=&quot;using-the-standard-csv.reader-parser&quot;&gt;Using the Standard &lt;code&gt;csv.reader&lt;/code&gt; Parser&lt;/h3&gt;
&lt;p&gt;Python offers a standard library for parsing &lt;code&gt;.csv&lt;/code&gt; files, aptly named &lt;code&gt;csv&lt;/code&gt;. The &lt;code&gt;csv&lt;/code&gt; library is fairly low-level and provides a &lt;code&gt;csv.reader&lt;/code&gt; which can be used to iterate over rows:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; csv&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;open&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;#39;data/victoria-weather-2020.csv&amp;#39;&lt;/span&gt;) &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; fp:&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    reader &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; csv.reader(fp)&lt;/span&gt;
&lt;span id=&quot;cb3-4&quot;&gt;&lt;a href=&quot;#cb3-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; row &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; reader:&lt;/span&gt;
&lt;span id=&quot;cb3-5&quot;&gt;&lt;a href=&quot;#cb3-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;bu&quot;&gt;print&lt;/span&gt;(row)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will output something such as&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[&amp;#39;\ufeff&amp;quot;Longitude (x)&amp;quot;&amp;#39;, &amp;#39;Latitude (y)&amp;#39;, &amp;#39;Station Name&amp;#39;, &amp;#39;Climate ID&amp;#39;, &amp;#39;Date/Time&amp;#39;, &amp;#39;Year&amp;#39;, &amp;#39;Month&amp;#39;, &amp;#39;Day&amp;#39;, &amp;#39;Data Quality&amp;#39;, &amp;#39;Max Temp (°C)&amp;#39;, &amp;#39;Max Temp Flag&amp;#39;, &amp;#39;Min Temp (°C)&amp;#39;, &amp;#39;Min Temp Flag&amp;#39;, &amp;#39;Mean Temp (°C)&amp;#39;, &amp;#39;Mean Temp Flag&amp;#39;, &amp;#39;Heat Deg Days (°C)&amp;#39;, &amp;#39;Heat Deg Days Flag&amp;#39;, &amp;#39;Cool Deg Days (°C)&amp;#39;, &amp;#39;Cool Deg Days Flag&amp;#39;, &amp;#39;Total Rain (mm)&amp;#39;, &amp;#39;Total Rain Flag&amp;#39;, &amp;#39;Total Snow (cm)&amp;#39;, &amp;#39;Total Snow Flag&amp;#39;, &amp;#39;Total Precip (mm)&amp;#39;, &amp;#39;Total Precip Flag&amp;#39;, &amp;#39;Snow on Grnd (cm)&amp;#39;, &amp;#39;Snow on Grnd Flag&amp;#39;, &amp;#39;Dir of Max Gust (10s deg)&amp;#39;, &amp;#39;Dir of Max Gust Flag&amp;#39;, &amp;#39;Spd of Max Gust (km/h)&amp;#39;, &amp;#39;Spd of Max Gust Flag&amp;#39;]
[&amp;#39;-123.43&amp;#39;, &amp;#39;48.65&amp;#39;, &amp;#39;VICTORIA INTL A&amp;#39;, &amp;#39;1018621&amp;#39;, &amp;#39;2020-01-01&amp;#39;, &amp;#39;2020&amp;#39;, &amp;#39;01&amp;#39;, &amp;#39;01&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;12.9&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;5.5&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;9.2&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;8.8&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;T&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;T&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;26&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;59&amp;#39;, &amp;#39;&amp;#39;]
[&amp;#39;-123.43&amp;#39;, &amp;#39;48.65&amp;#39;, &amp;#39;VICTORIA INTL A&amp;#39;, &amp;#39;1018621&amp;#39;, &amp;#39;2020-01-02&amp;#39;, &amp;#39;2020&amp;#39;, &amp;#39;01&amp;#39;, &amp;#39;02&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;6.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.9&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;3.5&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14.5&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14.6&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14.6&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;45&amp;#39;, &amp;#39;&amp;#39;]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The downside of using the standard python &lt;code&gt;csv.reader&lt;/code&gt; parser, is it simply returns all cells as strings, and doesn’t differentiate between cell headers and cell contents. Furthermore, the underlying data seems to have some sort of unicode character that’s not being correctly handled.&lt;/p&gt;
&lt;h3 id=&quot;using-the-standard-csv.dictreader-parser&quot;&gt;Using the Standard &lt;code&gt;csv.DictReader&lt;/code&gt; Parser&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;csv&lt;/code&gt; library provides a &lt;code&gt;csv.DictReader&lt;/code&gt; class which will use the first row as cell headers, and rather than returning the row as a list; instead it will return it as a dictionary:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{&amp;#39;\ufeff&amp;quot;Longitude (x)&amp;quot;&amp;#39;: &amp;#39;-123.43&amp;#39;, &amp;#39;Latitude (y)&amp;#39;: &amp;#39;48.65&amp;#39;, &amp;#39;Station Name&amp;#39;: &amp;#39;VICTORIA INTL A&amp;#39;, &amp;#39;Climate ID&amp;#39;: &amp;#39;1018621&amp;#39;, &amp;#39;Date/Time&amp;#39;: &amp;#39;2020-01-01&amp;#39;, &amp;#39;Year&amp;#39;: &amp;#39;2020&amp;#39;, &amp;#39;Month&amp;#39;: &amp;#39;01&amp;#39;, &amp;#39;Day&amp;#39;: &amp;#39;01&amp;#39;, &amp;#39;Data Quality&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Max Temp (°C)&amp;#39;: &amp;#39;12.9&amp;#39;, &amp;#39;Max Temp Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Min Temp (°C)&amp;#39;: &amp;#39;5.5&amp;#39;, &amp;#39;Min Temp Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Mean Temp (°C)&amp;#39;: &amp;#39;9.2&amp;#39;, &amp;#39;Mean Temp Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Heat Deg Days (°C)&amp;#39;: &amp;#39;8.8&amp;#39;, &amp;#39;Heat Deg Days Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Cool Deg Days (°C)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Cool Deg Days Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Total Rain (mm)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Total Rain Flag&amp;#39;: &amp;#39;T&amp;#39;, &amp;#39;Total Snow (cm)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Total Snow Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Total Precip (mm)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Total Precip Flag&amp;#39;: &amp;#39;T&amp;#39;, &amp;#39;Snow on Grnd (cm)&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Snow on Grnd Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Dir of Max Gust (10s deg)&amp;#39;: &amp;#39;26&amp;#39;, &amp;#39;Dir of Max Gust Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Spd of Max Gust (km/h)&amp;#39;: &amp;#39;59&amp;#39;, &amp;#39;Spd of Max Gust Flag&amp;#39;: &amp;#39;&amp;#39;}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;However, the &lt;code&gt;DictReader&lt;/code&gt; doesn’t parse the cell contents and returns everything simply as strings – leaving all type parsing to the user. Again we see the incorrectly handled unicode character appear – this time within the key of every row.&lt;/p&gt;
&lt;h3 id=&quot;using-the-pandas-library&quot;&gt;Using the Pandas Library&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;pandas&lt;/code&gt; library is a third-party python library which provides tools for data analysis and manipulation. We will be using the &lt;code&gt;pandas.read_csv&lt;/code&gt; function to parse our data:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; pandas&lt;/span&gt;
&lt;span id=&quot;cb6-2&quot;&gt;&lt;a href=&quot;#cb6-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-3&quot;&gt;&lt;a href=&quot;#cb6-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;weather &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; pandas.read_csv(&lt;span class=&quot;st&quot;&gt;&amp;#39;data/victoria-weather-2020.csv&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb6-4&quot;&gt;&lt;a href=&quot;#cb6-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;print&lt;/span&gt;(weather)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will produce output such as:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;     Longitude (x)  Latitude (y)     Station Name  Climate ID   Date/Time  Year  Month  Day  ... Total Precip (mm)  Total Precip Flag Snow on Grnd (cm)  Snow on Grnd Flag Dir of Max Gust (10s deg)  Dir of Max Gust Flag Spd of Max Gust (km/h)  Spd of Max Gust Flag
0          -123.43         48.65  VICTORIA INTL A     1018621  2020-01-01  2020      1    1  ...                0.0                  T               NaN                NaN                      26.0                   NaN                   59.0                   NaN
1          -123.43         48.65  VICTORIA INTL A     1018621  2020-01-02  2020      1    2  ...               14.6                NaN               NaN                NaN                      14.0                   NaN                   45.0                   NaN
2          -123.43         48.65  VICTORIA INTL A     1018621  2020-01-03  2020      1    3  ...               11.2                NaN               NaN                NaN                      15.0                   NaN                   39.0                   NaN
..             ...           ...              ...         ...         ...   ...    ...  ...  ...                ...                ...               ...                ...                       ...                   ...                    ...                   ...
363        -123.43         48.65  VICTORIA INTL A     1018621  2020-12-29  2020     12   29  ...                8.7                NaN               NaN                NaN                       NaN                     M                    NaN                     M
364        -123.43         48.65  VICTORIA INTL A     1018621  2020-12-30  2020     12   30  ...               20.4                NaN               NaN                NaN                      14.0                   NaN                   61.0                   NaN
365        -123.43         48.65  VICTORIA INTL A     1018621  2020-12-31  2020     12   31  ...                7.2                NaN               NaN                NaN                      14.0                   NaN                   33.0                   NaN

[366 rows x 31 columns]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Notice how the columns have been automatically parsed to an appropriate data type, as well as the column headers are detected. Row numbers are additionally displayed, as well as the data is displayed as a table. This is possible due to the fact that the &lt;code&gt;read_csv&lt;/code&gt; function returns a &lt;code&gt;pandas.core.frame.DataFrame&lt;/code&gt; data type which among other things, implements the &lt;code&gt;__str__&lt;/code&gt; method which is used to render the string which is passed to the &lt;code&gt;print&lt;/code&gt; function.&lt;/p&gt;
&lt;h2 id=&quot;merging-multiple-datasets&quot;&gt;Merging Multiple Datasets&lt;/h2&gt;
&lt;p&gt;My dataset is split across multiple &lt;code&gt;csv&lt;/code&gt; files, with each file containing a dataset for a specific year. My first task is to merge them together. All the datasets are located under the &lt;code&gt;data&lt;/code&gt; directory, and are named &lt;code&gt;victoria-weather-YYYY.csv&lt;/code&gt; (where &lt;code&gt;YYYY&lt;/code&gt; is the year).&lt;/p&gt;
&lt;p&gt;Let’s write a function to parse all the data:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb8&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb8-1&quot;&gt;&lt;a href=&quot;#cb8-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; re&lt;/span&gt;
&lt;span id=&quot;cb8-2&quot;&gt;&lt;a href=&quot;#cb8-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; os&lt;/span&gt;
&lt;span id=&quot;cb8-3&quot;&gt;&lt;a href=&quot;#cb8-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; pandas&lt;/span&gt;
&lt;span id=&quot;cb8-4&quot;&gt;&lt;a href=&quot;#cb8-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-5&quot;&gt;&lt;a href=&quot;#cb8-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; get_data(weather_dir):&lt;/span&gt;
&lt;span id=&quot;cb8-6&quot;&gt;&lt;a href=&quot;#cb8-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    p &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; re.&lt;span class=&quot;bu&quot;&gt;compile&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;#39;victoria-weather-[0-9]+.csv&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb8-7&quot;&gt;&lt;a href=&quot;#cb8-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    data &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb8-8&quot;&gt;&lt;a href=&quot;#cb8-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; filename &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;sorted&lt;/span&gt;(os.listdir(weather_dir)):&lt;/span&gt;
&lt;span id=&quot;cb8-9&quot;&gt;&lt;a href=&quot;#cb8-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; p.match(filename):&lt;/span&gt;
&lt;span id=&quot;cb8-10&quot;&gt;&lt;a href=&quot;#cb8-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            path &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; os.path.join(weather_dir, filename)&lt;/span&gt;
&lt;span id=&quot;cb8-11&quot;&gt;&lt;a href=&quot;#cb8-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            yearly_data &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; pandas.read_csv(path)&lt;/span&gt;
&lt;span id=&quot;cb8-12&quot;&gt;&lt;a href=&quot;#cb8-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            data.append(yearly_data)&lt;/span&gt;
&lt;span id=&quot;cb8-13&quot;&gt;&lt;a href=&quot;#cb8-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; pandas.concat(data)&lt;/span&gt;
&lt;span id=&quot;cb8-14&quot;&gt;&lt;a href=&quot;#cb8-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-15&quot;&gt;&lt;a href=&quot;#cb8-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;weather &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; get_data(&lt;span class=&quot;st&quot;&gt;&amp;#39;data&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb8-16&quot;&gt;&lt;a href=&quot;#cb8-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;print&lt;/span&gt;(weather)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This function 1) uses a regular expression to ensure we only parse files which match the expected form, which prevents our program from crashing if any other files existed in the directory, 2) parses each file separately using the &lt;code&gt;read_csv&lt;/code&gt; function, 3) saves the returned data frame into the &lt;code&gt;data&lt;/code&gt; list, then finally 4) concatenates the data using the &lt;code&gt;concat&lt;/code&gt; function. This code should output a single data frame containing all the data spanning a decade:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;     Longitude (x)  Latitude (y)     Station Name  Climate ID   Date/Time  Year  Month  Day  Data Quality  ... Total Snow Flag Total Precip (mm)  Total Precip Flag Snow on Grnd (cm)  Snow on Grnd Flag Dir of Max Gust (10s deg)  Dir of Max Gust Flag Spd of Max Gust (km/h)  Spd of Max Gust Flag
0          -123.43         48.65  VICTORIA INTL A     1018621  2014-01-01  2014      1    1           NaN  ...              NaN               1.6                NaN               NaN                NaN                       NaN                   NaN                    &amp;lt;31                   NaN
1          -123.43         48.65  VICTORIA INTL A     1018621  2014-01-02  2014      1    2           NaN  ...              NaN               6.6                NaN               NaN                NaN                      21.0                   NaN                     37                   NaN
2          -123.43         48.65  VICTORIA INTL A     1018621  2014-01-03  2014      1    3           NaN  ...              NaN               0.0                NaN               NaN                NaN                      31.0                   NaN                     41                   NaN
3          -123.43         48.65  VICTORIA INTL A     1018621  2014-01-04  2014      1    4           NaN  ...              NaN               0.0                NaN               NaN                NaN                       NaN                   NaN                    &amp;lt;31                   NaN
4          -123.43         48.65  VICTORIA INTL A     1018621  2014-01-05  2014      1    5           NaN  ...              NaN               0.0                NaN               NaN                NaN                       NaN                   NaN                    &amp;lt;31                   NaN
..             ...           ...              ...         ...         ...   ...    ...  ...           ...  ...              ...               ...                ...               ...                ...                       ...                   ...                    ...                   ...
198        -123.43         48.65  VICTORIA INTL A     1018621  2021-07-18  2021      7   18           NaN  ...              NaN               0.0                NaN               NaN                NaN                       NaN                   NaN                    NaN                     M
199        -123.43         48.65  VICTORIA INTL A     1018621  2021-07-19  2021      7   19           NaN  ...              NaN               0.0                NaN               NaN                NaN                      25.0                   NaN                   37.0                   NaN
200        -123.43         48.65  VICTORIA INTL A     1018621  2021-07-20  2021      7   20           NaN  ...              NaN               0.0                NaN               NaN                NaN                      29.0                   NaN                   36.0                   NaN
201        -123.43         48.65  VICTORIA INTL A     1018621  2021-07-21  2021      7   21           NaN  ...              NaN               0.0                NaN               NaN                NaN                      28.0                   NaN                   33.0                   NaN
202        -123.43         48.65  VICTORIA INTL A     1018621  2021-07-22  2021      7   22           NaN  ...              NaN               0.0                NaN               NaN                NaN                       NaN                     M                    NaN                     M

[2760 rows x 31 columns]&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;raindrops-keep-falling-on-my-plots&quot;&gt;Raindrops Keep Falling on my Plots&lt;/h2&gt;
&lt;p&gt;Let’s plot the rainfall! We will use the &lt;code&gt;matplotlib&lt;/code&gt; library for visualizing this data.&lt;/p&gt;
&lt;p&gt;We can extract a single column of the data frame using the column name, e.g. &lt;code&gt;weather['Total Precip (mm)']&lt;/code&gt;. This will return a &lt;code&gt;pandas.core.series.Series&lt;/code&gt; data type, which is similar to a list; however requires each element in the series to be the same data type. This allows pandas to keep all elements in contiguous memory, which allows faster SIMD-based operations.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;For another example of comparing generic data types against specific native types, checkout out our post on the &lt;a href=&quot;/blog/python-timsort-merge&quot;&gt;various tricks&lt;/a&gt; that python’s timsort uses to achieve better performance.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;A pandas series can be converted into a &lt;a href=&quot;/blog/python-concatenate-lists&quot;&gt;python list&lt;/a&gt; using the &lt;code&gt;.to_list()&lt;/code&gt; method; e.g. &lt;code&gt;weather['Total Precip (mm)'].to_list()&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;plotting-the-data-interactively&quot;&gt;Plotting the Data Interactively&lt;/h3&gt;
&lt;p&gt;Here’s a quick example of plotting this data interactively:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb10-2&quot;&gt;&lt;a href=&quot;#cb10-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-3&quot;&gt;&lt;a href=&quot;#cb10-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Precip (mm)&amp;#39;&lt;/span&gt;].to_list()&lt;/span&gt;
&lt;span id=&quot;cb10-4&quot;&gt;&lt;a href=&quot;#cb10-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;plt.plot(rainfall)&lt;/span&gt;
&lt;span id=&quot;cb10-5&quot;&gt;&lt;a href=&quot;#cb10-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;plt.show()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will display a new window, containing a plot of the data:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-interactive-660-bb671d45d.webp 660w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-interactive-660-7bc7f4e71.png 660w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-interactive-660-7bc7f4e71.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC daily precipitation interactive plot
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;It &lt;em&gt;should&lt;/em&gt; be possible to omit the &lt;code&gt;.to_list()&lt;/code&gt; call, which would then pass the pandas series data type directly to the matplotlib &lt;code&gt;plot&lt;/code&gt; function rather than passing a standard python list; however, there’s a bug in matplotlib (or pandas), which produces the following erroneous plot:&lt;/p&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-interactive-bug-660-3a2b6a8f5.webp 660w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-interactive-bug-660-5252d6866.png 660w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-interactive-bug-660-5252d6866.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;p&gt;Notice how this plot has some bizarre lines that criss-cross the plot, and that the data points stop at roughly 350 rather than past 2500? At a quick glance, this might be an instance of &lt;a href=&quot;https://github.com/matplotlib/matplotlib/issues/16266&quot;&gt;this bug&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;saving-the-plot-programmatically&quot;&gt;Saving the Plot Programmatically&lt;/h3&gt;
&lt;p&gt;Lets revise the previous code to render the plot as a png instead of using an interactive window:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb11-2&quot;&gt;&lt;a href=&quot;#cb11-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-3&quot;&gt;&lt;a href=&quot;#cb11-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# create a new figure that is 10x7 inches&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-4&quot;&gt;&lt;a href=&quot;#cb11-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# which is rendered as 100 pixels per inch&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-5&quot;&gt;&lt;a href=&quot;#cb11-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# (matplotlib incorrectly refers to this as dots-per-inch, which is a printer term)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-6&quot;&gt;&lt;a href=&quot;#cb11-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; plt.figure(figsize&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;(&lt;span class=&quot;fl&quot;&gt;10.0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;7.0&lt;/span&gt;), dpi&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb11-7&quot;&gt;&lt;a href=&quot;#cb11-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-8&quot;&gt;&lt;a href=&quot;#cb11-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# define axes on the figure to take up the entire figure canvas&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-9&quot;&gt;&lt;a href=&quot;#cb11-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; fig.add_axes([&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;
&lt;span id=&quot;cb11-10&quot;&gt;&lt;a href=&quot;#cb11-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-11&quot;&gt;&lt;a href=&quot;#cb11-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# plot the rainfall amounts against the axes&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-12&quot;&gt;&lt;a href=&quot;#cb11-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.plot(rainfall)&lt;/span&gt;
&lt;span id=&quot;cb11-13&quot;&gt;&lt;a href=&quot;#cb11-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-14&quot;&gt;&lt;a href=&quot;#cb11-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# label the axes and title the plot&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-15&quot;&gt;&lt;a href=&quot;#cb11-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_xlabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;days since start of dataset&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb11-16&quot;&gt;&lt;a href=&quot;#cb11-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_ylabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;precipitation (mm)&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb11-17&quot;&gt;&lt;a href=&quot;#cb11-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_title(&lt;span class=&quot;st&quot;&gt;&amp;#39;Victoria BC daily precipitation&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb11-18&quot;&gt;&lt;a href=&quot;#cb11-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-19&quot;&gt;&lt;a href=&quot;#cb11-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# save the plot to disk&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-20&quot;&gt;&lt;a href=&quot;#cb11-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig.savefig(&lt;span class=&quot;st&quot;&gt;&amp;#39;daily-precipitation.png&amp;#39;&lt;/span&gt;, bbox_inches&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Which will produce:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-800-12093d32c.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-800-16e97b528.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-800-16e97b528.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC daily precipitation
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;h3 id=&quot;fixing-the-x-axis-label-to-display-the-date&quot;&gt;Fixing the X Axis Label to Display the Date&lt;/h3&gt;
&lt;p&gt;The previous plots didn’t make use of the &lt;code&gt;Date/Time&lt;/code&gt; column from our weather data &lt;code&gt;csv&lt;/code&gt; files; instead it was simply displaying the index of the list element. We need to instruct pandas to parse those columns as dates using the &lt;code&gt;parse_dates&lt;/code&gt; field. We will additionally define a date parsing function &lt;code&gt;yyyymmdd_parser&lt;/code&gt; which will be used to parse the date; without this function, pandas will attempt to guess the format of the date, which is a best-effort strategy and may not always work.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb12&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb12-1&quot;&gt;&lt;a href=&quot;#cb12-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; re&lt;/span&gt;
&lt;span id=&quot;cb12-2&quot;&gt;&lt;a href=&quot;#cb12-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; os&lt;/span&gt;
&lt;span id=&quot;cb12-3&quot;&gt;&lt;a href=&quot;#cb12-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; pandas&lt;/span&gt;
&lt;span id=&quot;cb12-4&quot;&gt;&lt;a href=&quot;#cb12-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; datetime&lt;/span&gt;
&lt;span id=&quot;cb12-5&quot;&gt;&lt;a href=&quot;#cb12-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb12-6&quot;&gt;&lt;a href=&quot;#cb12-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-7&quot;&gt;&lt;a href=&quot;#cb12-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# Our new date parser&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-8&quot;&gt;&lt;a href=&quot;#cb12-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; yyyymmdd_parser(s):&lt;/span&gt;
&lt;span id=&quot;cb12-9&quot;&gt;&lt;a href=&quot;#cb12-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; datetime.datetime.strptime(s, &lt;span class=&quot;st&quot;&gt;&amp;#39;%Y-%m-&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb12-10&quot;&gt;&lt;a href=&quot;#cb12-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-11&quot;&gt;&lt;a href=&quot;#cb12-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; get_data(weather_dir):&lt;/span&gt;
&lt;span id=&quot;cb12-12&quot;&gt;&lt;a href=&quot;#cb12-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    p &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; re.&lt;span class=&quot;bu&quot;&gt;compile&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;#39;victoria-weather-[0-9]+.csv&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb12-13&quot;&gt;&lt;a href=&quot;#cb12-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    data &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb12-14&quot;&gt;&lt;a href=&quot;#cb12-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; filename &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;sorted&lt;/span&gt;(os.listdir(weather_dir)):&lt;/span&gt;
&lt;span id=&quot;cb12-15&quot;&gt;&lt;a href=&quot;#cb12-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; p.match(filename):&lt;/span&gt;
&lt;span id=&quot;cb12-16&quot;&gt;&lt;a href=&quot;#cb12-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            path &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; os.path.join(weather_dir, filename)&lt;/span&gt;
&lt;span id=&quot;cb12-17&quot;&gt;&lt;a href=&quot;#cb12-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            &lt;span class=&quot;co&quot;&gt;# We identify which column contains the date, along with the date parser to use.&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-18&quot;&gt;&lt;a href=&quot;#cb12-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            yearly_data &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; pandas.read_csv(path, parse_dates&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;[&lt;span class=&quot;st&quot;&gt;&amp;#39;Date/Time&amp;#39;&lt;/span&gt;], date_parser&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;yyyymmdd_parser)&lt;/span&gt;
&lt;span id=&quot;cb12-19&quot;&gt;&lt;a href=&quot;#cb12-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            data.append(yearly_data)&lt;/span&gt;
&lt;span id=&quot;cb12-20&quot;&gt;&lt;a href=&quot;#cb12-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; pandas.concat(data)&lt;/span&gt;
&lt;span id=&quot;cb12-21&quot;&gt;&lt;a href=&quot;#cb12-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-22&quot;&gt;&lt;a href=&quot;#cb12-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;weather &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; get_data(&lt;span class=&quot;st&quot;&gt;&amp;#39;data&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb12-23&quot;&gt;&lt;a href=&quot;#cb12-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-24&quot;&gt;&lt;a href=&quot;#cb12-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Precip (mm)&amp;#39;&lt;/span&gt;].to_list()&lt;/span&gt;
&lt;span id=&quot;cb12-25&quot;&gt;&lt;a href=&quot;#cb12-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-26&quot;&gt;&lt;a href=&quot;#cb12-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# We will convert all dates into the native python datetime format, which works&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-27&quot;&gt;&lt;a href=&quot;#cb12-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# better with matplotlib.&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-28&quot;&gt;&lt;a href=&quot;#cb12-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;date &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [x.to_pydatetime() &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; x &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Date/Time&amp;#39;&lt;/span&gt;]]&lt;/span&gt;
&lt;span id=&quot;cb12-29&quot;&gt;&lt;a href=&quot;#cb12-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-30&quot;&gt;&lt;a href=&quot;#cb12-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; plt.figure(figsize&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;(&lt;span class=&quot;fl&quot;&gt;10.0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;7.0&lt;/span&gt;))&lt;/span&gt;
&lt;span id=&quot;cb12-31&quot;&gt;&lt;a href=&quot;#cb12-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; fig.add_axes([&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;
&lt;span id=&quot;cb12-32&quot;&gt;&lt;a href=&quot;#cb12-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-33&quot;&gt;&lt;a href=&quot;#cb12-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# We will pass in both the date and rainfall amounts which contain the x and y values respectively&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-34&quot;&gt;&lt;a href=&quot;#cb12-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.plot(date, rainfall)&lt;/span&gt;
&lt;span id=&quot;cb12-35&quot;&gt;&lt;a href=&quot;#cb12-35&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-36&quot;&gt;&lt;a href=&quot;#cb12-36&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_xlabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;date&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb12-37&quot;&gt;&lt;a href=&quot;#cb12-37&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_ylabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;precipitation (mm)&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb12-38&quot;&gt;&lt;a href=&quot;#cb12-38&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_title(&lt;span class=&quot;st&quot;&gt;&amp;#39;Victoria BC daily precipitation&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb12-39&quot;&gt;&lt;a href=&quot;#cb12-39&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig.savefig(&lt;span class=&quot;st&quot;&gt;&amp;#39;daily-precipitation-with-dates.png&amp;#39;&lt;/span&gt;, bbox_inches&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-with-dates-800-8e46ac732.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-with-dates-800-d8ad2d229.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-with-dates-800-d8ad2d229.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC daily precipitation with dates
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;While it’s interesting to get this data plotted, it’s not obviously easy to compare one years data against another.&lt;/p&gt;
&lt;h2 id=&quot;comparing-annual-data&quot;&gt;Comparing Annual Data&lt;/h2&gt;
&lt;p&gt;Let’s slice up the data and plot it against different years.&lt;/p&gt;
&lt;h3 id=&quot;splitting-up-the-data-by-year&quot;&gt;Splitting up the Data by Year&lt;/h3&gt;
&lt;p&gt;We will create a new function that splits up the data by year, and calculates a new field that is days since January 1st of the current year:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb13&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb13-1&quot;&gt;&lt;a href=&quot;#cb13-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; get_days_since_jan1(date):&lt;/span&gt;
&lt;span id=&quot;cb13-2&quot;&gt;&lt;a href=&quot;#cb13-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; date.timetuple().tm_yday &lt;span class=&quot;op&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-3&quot;&gt;&lt;a href=&quot;#cb13-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-4&quot;&gt;&lt;a href=&quot;#cb13-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; split_data_by_year(weather):&lt;/span&gt;
&lt;span id=&quot;cb13-5&quot;&gt;&lt;a href=&quot;#cb13-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    yearly_rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb13-6&quot;&gt;&lt;a href=&quot;#cb13-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    yearly_days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb13-7&quot;&gt;&lt;a href=&quot;#cb13-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    current_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-8&quot;&gt;&lt;a href=&quot;#cb13-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    by_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb13-9&quot;&gt;&lt;a href=&quot;#cb13-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; i, row &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; weather.iterrows():&lt;/span&gt;
&lt;span id=&quot;cb13-10&quot;&gt;&lt;a href=&quot;#cb13-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        date &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; row[&lt;span class=&quot;st&quot;&gt;&amp;#39;Date/Time&amp;#39;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb13-11&quot;&gt;&lt;a href=&quot;#cb13-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; row[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Precip (mm)&amp;#39;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb13-12&quot;&gt;&lt;a href=&quot;#cb13-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-13&quot;&gt;&lt;a href=&quot;#cb13-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; current_year &lt;span class=&quot;kw&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id=&quot;cb13-14&quot;&gt;&lt;a href=&quot;#cb13-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            current_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; date.year&lt;/span&gt;
&lt;span id=&quot;cb13-15&quot;&gt;&lt;a href=&quot;#cb13-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;elif&lt;/span&gt; current_year &lt;span class=&quot;op&quot;&gt;!=&lt;/span&gt; date.year:&lt;/span&gt;
&lt;span id=&quot;cb13-16&quot;&gt;&lt;a href=&quot;#cb13-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            by_year.append((current_year, pandas.DataFrame({&lt;/span&gt;
&lt;span id=&quot;cb13-17&quot;&gt;&lt;a href=&quot;#cb13-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                &lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;: yearly_days_since_jan1,&lt;/span&gt;
&lt;span id=&quot;cb13-18&quot;&gt;&lt;a href=&quot;#cb13-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                &lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;: yearly_rainfall,&lt;/span&gt;
&lt;span id=&quot;cb13-19&quot;&gt;&lt;a href=&quot;#cb13-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                })))&lt;/span&gt;
&lt;span id=&quot;cb13-20&quot;&gt;&lt;a href=&quot;#cb13-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            yearly_days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb13-21&quot;&gt;&lt;a href=&quot;#cb13-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            yearly_rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb13-22&quot;&gt;&lt;a href=&quot;#cb13-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            current_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; date.year&lt;/span&gt;
&lt;span id=&quot;cb13-23&quot;&gt;&lt;a href=&quot;#cb13-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-24&quot;&gt;&lt;a href=&quot;#cb13-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        yearly_rainfall.append(rainfall)&lt;/span&gt;
&lt;span id=&quot;cb13-25&quot;&gt;&lt;a href=&quot;#cb13-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        yearly_days_since_jan1.append(get_days_since_jan1(date))&lt;/span&gt;
&lt;span id=&quot;cb13-26&quot;&gt;&lt;a href=&quot;#cb13-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-27&quot;&gt;&lt;a href=&quot;#cb13-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; current_year &lt;span class=&quot;kw&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id=&quot;cb13-28&quot;&gt;&lt;a href=&quot;#cb13-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        by_year.append((current_year, pandas.DataFrame({&lt;/span&gt;
&lt;span id=&quot;cb13-29&quot;&gt;&lt;a href=&quot;#cb13-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            &lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;: yearly_days_since_jan1,&lt;/span&gt;
&lt;span id=&quot;cb13-30&quot;&gt;&lt;a href=&quot;#cb13-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            &lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;: yearly_rainfall,&lt;/span&gt;
&lt;span id=&quot;cb13-31&quot;&gt;&lt;a href=&quot;#cb13-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            })))&lt;/span&gt;
&lt;span id=&quot;cb13-32&quot;&gt;&lt;a href=&quot;#cb13-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-33&quot;&gt;&lt;a href=&quot;#cb13-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; by_year&lt;/span&gt;
&lt;span id=&quot;cb13-34&quot;&gt;&lt;a href=&quot;#cb13-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-35&quot;&gt;&lt;a href=&quot;#cb13-35&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;rainfall_by_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; slice_data_by_year(weather)&lt;/span&gt;
&lt;span id=&quot;cb13-36&quot;&gt;&lt;a href=&quot;#cb13-36&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;print&lt;/span&gt;(rainfall_by_year)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will then output something similar to:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[(2014,      days_since_jan1  rainfall
0                 0       1.6
1                 1       6.6
..              ...       ...
363             363       0.0
364             364       0.0
[365 rows x 2 columns]),

(2015,      days_since_jan1  rainfall
0                 0       0.0
1                 1       4.8
..              ...       ...
363             363       0.0
364             364       0.0
[366 rows x 2 columns]),

...&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;plotting-the-data-by-year&quot;&gt;Plotting the Data by Year&lt;/h3&gt;
&lt;p&gt;Rather than call &lt;code&gt;ax.plot&lt;/code&gt; a single time; in this example we will call it from inside a for loop once for each year in our data set. We pass the year as a label value, which will then be displayed on the legend.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb15&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb15-1&quot;&gt;&lt;a href=&quot;#cb15-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb15-2&quot;&gt;&lt;a href=&quot;#cb15-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-3&quot;&gt;&lt;a href=&quot;#cb15-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; plt.figure(figsize&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;(&lt;span class=&quot;fl&quot;&gt;10.0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;7.0&lt;/span&gt;), dpi&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb15-4&quot;&gt;&lt;a href=&quot;#cb15-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; fig.add_axes([&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;
&lt;span id=&quot;cb15-5&quot;&gt;&lt;a href=&quot;#cb15-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-6&quot;&gt;&lt;a href=&quot;#cb15-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; year, annual_data &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; rainfall_by_year:&lt;/span&gt;
&lt;span id=&quot;cb15-7&quot;&gt;&lt;a href=&quot;#cb15-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;].to_list()&lt;/span&gt;
&lt;span id=&quot;cb15-8&quot;&gt;&lt;a href=&quot;#cb15-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;].to_list()&lt;/span&gt;
&lt;span id=&quot;cb15-9&quot;&gt;&lt;a href=&quot;#cb15-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    ax.plot(days_since_jan1, rainfall, label&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;year)&lt;/span&gt;
&lt;span id=&quot;cb15-10&quot;&gt;&lt;a href=&quot;#cb15-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-11&quot;&gt;&lt;a href=&quot;#cb15-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# label the axes and title the plot&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-12&quot;&gt;&lt;a href=&quot;#cb15-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_xlabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;days since jan 1st&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb15-13&quot;&gt;&lt;a href=&quot;#cb15-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_ylabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;precipitation (mm)&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb15-14&quot;&gt;&lt;a href=&quot;#cb15-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_title(&lt;span class=&quot;st&quot;&gt;&amp;#39;Victoria BC daily precipitation since Jan 1st&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb15-15&quot;&gt;&lt;a href=&quot;#cb15-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-16&quot;&gt;&lt;a href=&quot;#cb15-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.legend()&lt;/span&gt;
&lt;span id=&quot;cb15-17&quot;&gt;&lt;a href=&quot;#cb15-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-18&quot;&gt;&lt;a href=&quot;#cb15-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# save the plot to disk&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-19&quot;&gt;&lt;a href=&quot;#cb15-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig.savefig(&lt;span class=&quot;st&quot;&gt;&amp;#39;daily-precipitation-by-year.png&amp;#39;&lt;/span&gt;, bbox_inches&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will produce the following plot:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-by-year-800-6e1e40fd1.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-by-year-800-d2636209c.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-by-year-800-d2636209c.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC daily precipitation with dates
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;Well that’s interesting, but still rather hard to compare one year against another. We can fix that by plotting the yearly cumulative sum.&lt;/p&gt;
&lt;h3 id=&quot;plotting-cumulative-annual-rainfall-by-year&quot;&gt;Plotting Cumulative Annual Rainfall by Year&lt;/h3&gt;
&lt;p&gt;One potential way to plot the cumulative annual rainfall would be to modify the &lt;code&gt;split_data_by_year&lt;/code&gt; function to keep a yearly running total for the rainfall; however, pandas implements a &lt;code&gt;cumsum&lt;/code&gt; function which can perform the calculation for us:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb16&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb16-1&quot;&gt;&lt;a href=&quot;#cb16-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb16-2&quot;&gt;&lt;a href=&quot;#cb16-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-3&quot;&gt;&lt;a href=&quot;#cb16-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; plt.figure(figsize&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;(&lt;span class=&quot;fl&quot;&gt;10.0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;7.0&lt;/span&gt;), dpi&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb16-4&quot;&gt;&lt;a href=&quot;#cb16-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; fig.add_axes([&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;
&lt;span id=&quot;cb16-5&quot;&gt;&lt;a href=&quot;#cb16-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-6&quot;&gt;&lt;a href=&quot;#cb16-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; year, annual_data &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; rainfall_by_year:&lt;/span&gt;
&lt;span id=&quot;cb16-7&quot;&gt;&lt;a href=&quot;#cb16-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;].to_list()&lt;/span&gt;
&lt;span id=&quot;cb16-8&quot;&gt;&lt;a href=&quot;#cb16-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;].cumsum().to_list()&lt;/span&gt;
&lt;span id=&quot;cb16-9&quot;&gt;&lt;a href=&quot;#cb16-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    ax.plot(days_since_jan1, rainfall, label&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;year)&lt;/span&gt;
&lt;span id=&quot;cb16-10&quot;&gt;&lt;a href=&quot;#cb16-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-11&quot;&gt;&lt;a href=&quot;#cb16-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# label the axes and title the plot&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-12&quot;&gt;&lt;a href=&quot;#cb16-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_xlabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;days since jan 1st&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb16-13&quot;&gt;&lt;a href=&quot;#cb16-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_ylabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;precipitation (mm)&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb16-14&quot;&gt;&lt;a href=&quot;#cb16-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_title(&lt;span class=&quot;st&quot;&gt;&amp;#39;Victoria BC cumulative annual precipitation&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb16-15&quot;&gt;&lt;a href=&quot;#cb16-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-16&quot;&gt;&lt;a href=&quot;#cb16-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.legend()&lt;/span&gt;
&lt;span id=&quot;cb16-17&quot;&gt;&lt;a href=&quot;#cb16-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-18&quot;&gt;&lt;a href=&quot;#cb16-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# save the plot to disk&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-19&quot;&gt;&lt;a href=&quot;#cb16-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig.savefig(&lt;span class=&quot;st&quot;&gt;&amp;#39;cumulative-annual-precipitation.png&amp;#39;&lt;/span&gt;, bbox_inches&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Finally, a clear image starts to appear:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-800-10424472a.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-800-42450ace6.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-800-42450ace6.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC cumulative annual precipitation
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;h3 id=&quot;accounting-for-missing-data&quot;&gt;Accounting for Missing Data&lt;/h3&gt;
&lt;p&gt;If you look closely at the previous plot, there’s a few gaps in the data. This occurred due to the fact that the initial data set contains an empty string &lt;code&gt;&quot;&quot;&lt;/code&gt; in places where either no data is available, or where the data is zero. Since it’s not obvious which case applies, pandas will parse this empty string as &lt;code&gt;nan&lt;/code&gt; (not-a-number).&lt;/p&gt;
&lt;p&gt;In our case, the Environment Canada data encodes no snow as &lt;code&gt;&quot;&quot;&lt;/code&gt; rather than &lt;code&gt;0&lt;/code&gt; cm. We will instruct pandas to fill in these gaps with a default value of &lt;code&gt;0&lt;/code&gt;, using the &lt;code&gt;fillna()&lt;/code&gt; method:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb17&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb17-1&quot;&gt;&lt;a href=&quot;#cb17-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Precip (mm)&amp;#39;&lt;/span&gt;] &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Precip (mm)&amp;#39;&lt;/span&gt;].fillna(&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb17-2&quot;&gt;&lt;a href=&quot;#cb17-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Snow (cm)&amp;#39;&lt;/span&gt;] &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Snow (cm)&amp;#39;&lt;/span&gt;].fillna(&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will produce a plot without gaps:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-no-gaps-800-60cdfabc8.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-no-gaps-800-d82f716e2.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-no-gaps-800-d82f716e2.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC cumulative annual precipitation
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;h3 id=&quot;reordering-the-legend-and-fixing-the-x-axis&quot;&gt;Reordering the Legend and Fixing the X Axis&lt;/h3&gt;
&lt;p&gt;The previous plot is difficult to see which colours correspond to which years (especially hard if you are colour blind). We will re-order the legend from wettest to driest years, with 2021 being dead-last.&lt;/p&gt;
&lt;p&gt;To sort the data, we will create a new function &lt;code&gt;get_total_rainfall&lt;/code&gt;, which returns a new value for python’s &lt;code&gt;sorted&lt;/code&gt; function to use when sorting values. We return a tuple so that the year can be used to differentiate between cases where the annual precipitation is identical.&lt;/p&gt;
&lt;p&gt;Additionally, let’s fix the x-axis to display the name of the month, rather than an integer value.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb18&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb18-1&quot;&gt;&lt;a href=&quot;#cb18-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib&lt;/span&gt;
&lt;span id=&quot;cb18-2&quot;&gt;&lt;a href=&quot;#cb18-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb18-3&quot;&gt;&lt;a href=&quot;#cb18-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-4&quot;&gt;&lt;a href=&quot;#cb18-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; plt.figure(figsize&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;(&lt;span class=&quot;fl&quot;&gt;10.0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;7.0&lt;/span&gt;), dpi&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb18-5&quot;&gt;&lt;a href=&quot;#cb18-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; fig.add_axes([&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;
&lt;span id=&quot;cb18-6&quot;&gt;&lt;a href=&quot;#cb18-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-7&quot;&gt;&lt;a href=&quot;#cb18-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; get_total_rainfall(val):&lt;/span&gt;
&lt;span id=&quot;cb18-8&quot;&gt;&lt;a href=&quot;#cb18-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    year, annual_data &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; val&lt;/span&gt;
&lt;span id=&quot;cb18-9&quot;&gt;&lt;a href=&quot;#cb18-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    total_rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;].cumsum().to_list()[&lt;span class=&quot;op&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb18-10&quot;&gt;&lt;a href=&quot;#cb18-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; (total_rainfall, year)&lt;/span&gt;
&lt;span id=&quot;cb18-11&quot;&gt;&lt;a href=&quot;#cb18-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-12&quot;&gt;&lt;a href=&quot;#cb18-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; year, annual_data &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;sorted&lt;/span&gt;(rainfall_by_year, key&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;get_total_rainfall, reverse&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;True&lt;/span&gt;):&lt;/span&gt;
&lt;span id=&quot;cb18-13&quot;&gt;&lt;a href=&quot;#cb18-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;].to_list()&lt;/span&gt;
&lt;span id=&quot;cb18-14&quot;&gt;&lt;a href=&quot;#cb18-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;].cumsum().to_list()&lt;/span&gt;
&lt;span id=&quot;cb18-15&quot;&gt;&lt;a href=&quot;#cb18-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    ax.plot(days_since_jan1, rainfall, label&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;year)&lt;/span&gt;
&lt;span id=&quot;cb18-16&quot;&gt;&lt;a href=&quot;#cb18-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-17&quot;&gt;&lt;a href=&quot;#cb18-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# format x axis values as month names rather than days since jan 1st&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-18&quot;&gt;&lt;a href=&quot;#cb18-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; format_days_since_jan1(days, pos&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;):&lt;/span&gt;
&lt;span id=&quot;cb18-19&quot;&gt;&lt;a href=&quot;#cb18-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    date &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; datetime.date(&lt;span class=&quot;dv&quot;&gt;2020&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; datetime.timedelta(days)&lt;/span&gt;
&lt;span id=&quot;cb18-20&quot;&gt;&lt;a href=&quot;#cb18-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; date.strftime(&lt;span class=&quot;st&quot;&gt;&amp;#39;%b&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb18-21&quot;&gt;&lt;a href=&quot;#cb18-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.xaxis.set_major_formatter(matplotlib.ticker.FuncFormatter(format_days_since_jan1))&lt;/span&gt;
&lt;span id=&quot;cb18-22&quot;&gt;&lt;a href=&quot;#cb18-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-23&quot;&gt;&lt;a href=&quot;#cb18-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# label the axes and title the plot&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-24&quot;&gt;&lt;a href=&quot;#cb18-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_xlabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;calendar date&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb18-25&quot;&gt;&lt;a href=&quot;#cb18-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_ylabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;precipitation (mm)&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb18-26&quot;&gt;&lt;a href=&quot;#cb18-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_title(&lt;span class=&quot;st&quot;&gt;&amp;#39;Victoria BC cumulative annual precipitation&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb18-27&quot;&gt;&lt;a href=&quot;#cb18-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-28&quot;&gt;&lt;a href=&quot;#cb18-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.legend()&lt;/span&gt;
&lt;span id=&quot;cb18-29&quot;&gt;&lt;a href=&quot;#cb18-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-30&quot;&gt;&lt;a href=&quot;#cb18-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# save the plot to disk&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-31&quot;&gt;&lt;a href=&quot;#cb18-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig.savefig(&lt;span class=&quot;st&quot;&gt;&amp;#39;cumulative-annual-precipitation-sorted-legend.png&amp;#39;&lt;/span&gt;, bbox_inches&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And here we have it, 2021 has been a really dry year here in Victoria:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-sorted-legend-800-2250e68fc.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-sorted-legend-800-4f2dc358d.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-sorted-legend-800-4f2dc358d.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC cumulative annual precipitation v2
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;h2 id=&quot;accounting-for-snow&quot;&gt;Accounting for Snow&lt;/h2&gt;
&lt;p&gt;The previous plots have an error – they were only plotting rainfall, and not accounting for snowfall. It’s difficult to directly convert snowfall into an equivalent amount of precipitation due to the variety of snow crystal sizes – some snow is wet, while other snow is fairly dry. On the west-coast (wet-coast as some call it); when we do get snow, it tends to be fairly wet. We will assume that 13mm of snow is equivalent to 1mm of rain &lt;a href=&quot;#fn1&quot; class=&quot;footnote-ref&quot; id=&quot;fnref1&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Let’s revise our &lt;code&gt;split_data_by_year&lt;/code&gt; function to calculate this.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb19&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb19-1&quot;&gt;&lt;a href=&quot;#cb19-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; split_data_by_year(weather):&lt;/span&gt;
&lt;span id=&quot;cb19-2&quot;&gt;&lt;a href=&quot;#cb19-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    yearly_rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb19-3&quot;&gt;&lt;a href=&quot;#cb19-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    yearly_days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb19-4&quot;&gt;&lt;a href=&quot;#cb19-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    current_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-5&quot;&gt;&lt;a href=&quot;#cb19-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    by_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb19-6&quot;&gt;&lt;a href=&quot;#cb19-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; i, row &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; weather.iterrows():&lt;/span&gt;
&lt;span id=&quot;cb19-7&quot;&gt;&lt;a href=&quot;#cb19-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        date &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; row[&lt;span class=&quot;st&quot;&gt;&amp;#39;Date/Time&amp;#39;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb19-8&quot;&gt;&lt;a href=&quot;#cb19-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; row[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Precip (mm)&amp;#39;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb19-9&quot;&gt;&lt;a href=&quot;#cb19-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-10&quot;&gt;&lt;a href=&quot;#cb19-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;co&quot;&gt;# 1cm snow = 10mm snow; 13mm of snow = 1mm of rain&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-11&quot;&gt;&lt;a href=&quot;#cb19-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        snowfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; row[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Snow (cm)&amp;#39;&lt;/span&gt;] &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;fl&quot;&gt;10.0&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;fl&quot;&gt;13.0&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-12&quot;&gt;&lt;a href=&quot;#cb19-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        rainfall &lt;span class=&quot;op&quot;&gt;+=&lt;/span&gt; snowfall&lt;/span&gt;
&lt;span id=&quot;cb19-13&quot;&gt;&lt;a href=&quot;#cb19-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-14&quot;&gt;&lt;a href=&quot;#cb19-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; current_year &lt;span class=&quot;kw&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id=&quot;cb19-15&quot;&gt;&lt;a href=&quot;#cb19-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            current_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; date.year&lt;/span&gt;
&lt;span id=&quot;cb19-16&quot;&gt;&lt;a href=&quot;#cb19-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;elif&lt;/span&gt; current_year &lt;span class=&quot;op&quot;&gt;!=&lt;/span&gt; date.year:&lt;/span&gt;
&lt;span id=&quot;cb19-17&quot;&gt;&lt;a href=&quot;#cb19-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            by_year.append((current_year, pandas.DataFrame({&lt;/span&gt;
&lt;span id=&quot;cb19-18&quot;&gt;&lt;a href=&quot;#cb19-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                &lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;: yearly_days_since_jan1,&lt;/span&gt;
&lt;span id=&quot;cb19-19&quot;&gt;&lt;a href=&quot;#cb19-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                &lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;: yearly_rainfall,&lt;/span&gt;
&lt;span id=&quot;cb19-20&quot;&gt;&lt;a href=&quot;#cb19-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                })))&lt;/span&gt;
&lt;span id=&quot;cb19-21&quot;&gt;&lt;a href=&quot;#cb19-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            yearly_days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb19-22&quot;&gt;&lt;a href=&quot;#cb19-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            yearly_rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb19-23&quot;&gt;&lt;a href=&quot;#cb19-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            current_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; date.year&lt;/span&gt;
&lt;span id=&quot;cb19-24&quot;&gt;&lt;a href=&quot;#cb19-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-25&quot;&gt;&lt;a href=&quot;#cb19-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        yearly_rainfall.append(rainfall)&lt;/span&gt;
&lt;span id=&quot;cb19-26&quot;&gt;&lt;a href=&quot;#cb19-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        yearly_days_since_jan1.append(get_days_since_jan1(date))&lt;/span&gt;
&lt;span id=&quot;cb19-27&quot;&gt;&lt;a href=&quot;#cb19-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-28&quot;&gt;&lt;a href=&quot;#cb19-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; current_year &lt;span class=&quot;kw&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id=&quot;cb19-29&quot;&gt;&lt;a href=&quot;#cb19-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        by_year.append((current_year, pandas.DataFrame({&lt;/span&gt;
&lt;span id=&quot;cb19-30&quot;&gt;&lt;a href=&quot;#cb19-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            &lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;: yearly_days_since_jan1,&lt;/span&gt;
&lt;span id=&quot;cb19-31&quot;&gt;&lt;a href=&quot;#cb19-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            &lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;: yearly_rainfall,&lt;/span&gt;
&lt;span id=&quot;cb19-32&quot;&gt;&lt;a href=&quot;#cb19-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            })))&lt;/span&gt;
&lt;span id=&quot;cb19-33&quot;&gt;&lt;a href=&quot;#cb19-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-34&quot;&gt;&lt;a href=&quot;#cb19-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; by_year&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you look closely, once we adjust for snow, it turned out that 2017 was a wetter year compared to 2014:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-with-snow-800-e85637744.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-with-snow-800-bc4754e2f.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-with-snow-800-bc4754e2f.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC cumulative annual precipitation including snow
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;None of that however changes the fact that it’s been a very dry year, and my garden is browner than ever. On the other hand, my tomatoes have been loving the heat.&lt;/p&gt;
&lt;p&gt;If you would like to try generating the above graphs, all the code (and data) can be found under &lt;a href=&quot;https://github.com/earthly/example-plotting-precipitation&quot;&gt;github.com/earthly/example-plotting-precipitation&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;notice--info notice--big&quot;&gt;
&lt;p&gt;
&lt;strong&gt;While you’re here:&lt;/strong&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today.
&lt;/p&gt;
&lt;/div&gt;
&lt;section class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&quot;fn1&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;https://www.nssl.noaa.gov/education/svrwx101/winter/faq/&lt;a href=&quot;#fnref1&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;</content><author><name>Alex Couture-Beil</name></author><category term="Tutorials" /><summary type="html">Where Did All The Rain Go? It’s been a really dry summer here in Victoria BC (and the rest of the province). I couldn’t remember the last time it had rained, which got me looking at historical weather data. Before I knew it, rather than simply look up how many days it’s been since it last rained (42 and counting!), I was plotting cumulative annual rainfall. Get Some Data I ended up on Environment Canada’s historic data search page, and ended up with a table of daily weather recorded at Victoria International Airport, climate ID 1018621 (which is closer to Sidney BC, but I digress). On the right hand side of that page, there was an option to download the data as CSV. Upon clicking the Download Data button, my web browser was redirected to: https://climate.weather.gc.ca/climate_data/bulk_data_e.html?format=csv&amp;amp;stationID=51337&amp;amp;Year=2021&amp;amp;Month=7&amp;amp;Day=1&amp;amp;time=&amp;amp;timeframe=2&amp;amp;submit=Download+Data The website gave me an option to change the range of data to download; however if you squint enough, the above URL looks like an API. Furthermore, the month and day values didn’t seem to affect anything – since this was annual data, only the year was used. It’s also interesting to note that the station ID is different from the Climate ID even though Environment Canada defines “the climate ID is a 7 digit number assigned by the Meteorological Service of Canada to a site where official weather observations are taken, and serves as a permanent, unique identifier.” Perhaps there was a thought leader who was suffering from past trauma where a client’s definition of a “permanent unique identifier” didn’t match up with a relational databases’ definition of a unique identifier, and insisted on creating a lookup table for these different IDs. Again, I digress, back to downloading data. I wrote a bash while loop to download this data: #!/bin/sh set -e for year in $(seq 2013 2021); do curl &amp;quot;https://climate.weather.gc.ca/climate_data/bulk_data_e.html?format=csv&amp;amp;stationID=51337&amp;amp;Year=${year}&amp;amp;timeframe=2&amp;quot; &amp;gt; victoria-weather-$year.csv done Parsing the Data Using the Standard csv.reader Parser Python offers a standard library for parsing .csv files, aptly named csv. The csv library is fairly low-level and provides a csv.reader which can be used to iterate over rows: import csv with open(&amp;#39;data/victoria-weather-2020.csv&amp;#39;) as fp: reader = csv.reader(fp) for row in reader: print(row) This will output something such as [&amp;#39;\ufeff&amp;quot;Longitude (x)&amp;quot;&amp;#39;, &amp;#39;Latitude (y)&amp;#39;, &amp;#39;Station Name&amp;#39;, &amp;#39;Climate ID&amp;#39;, &amp;#39;Date/Time&amp;#39;, &amp;#39;Year&amp;#39;, &amp;#39;Month&amp;#39;, &amp;#39;Day&amp;#39;, &amp;#39;Data Quality&amp;#39;, &amp;#39;Max Temp (°C)&amp;#39;, &amp;#39;Max Temp Flag&amp;#39;, &amp;#39;Min Temp (°C)&amp;#39;, &amp;#39;Min Temp Flag&amp;#39;, &amp;#39;Mean Temp (°C)&amp;#39;, &amp;#39;Mean Temp Flag&amp;#39;, &amp;#39;Heat Deg Days (°C)&amp;#39;, &amp;#39;Heat Deg Days Flag&amp;#39;, &amp;#39;Cool Deg Days (°C)&amp;#39;, &amp;#39;Cool Deg Days Flag&amp;#39;, &amp;#39;Total Rain (mm)&amp;#39;, &amp;#39;Total Rain Flag&amp;#39;, &amp;#39;Total Snow (cm)&amp;#39;, &amp;#39;Total Snow Flag&amp;#39;, &amp;#39;Total Precip (mm)&amp;#39;, &amp;#39;Total Precip Flag&amp;#39;, &amp;#39;Snow on Grnd (cm)&amp;#39;, &amp;#39;Snow on Grnd Flag&amp;#39;, &amp;#39;Dir of Max Gust (10s deg)&amp;#39;, &amp;#39;Dir of Max Gust Flag&amp;#39;, &amp;#39;Spd of Max Gust (km/h)&amp;#39;, &amp;#39;Spd of Max Gust Flag&amp;#39;] [&amp;#39;-123.43&amp;#39;, &amp;#39;48.65&amp;#39;, &amp;#39;VICTORIA INTL A&amp;#39;, &amp;#39;1018621&amp;#39;, &amp;#39;2020-01-01&amp;#39;, &amp;#39;2020&amp;#39;, &amp;#39;01&amp;#39;, &amp;#39;01&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;12.9&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;5.5&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;9.2&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;8.8&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;T&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;T&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;26&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;59&amp;#39;, &amp;#39;&amp;#39;] [&amp;#39;-123.43&amp;#39;, &amp;#39;48.65&amp;#39;, &amp;#39;VICTORIA INTL A&amp;#39;, &amp;#39;1018621&amp;#39;, &amp;#39;2020-01-02&amp;#39;, &amp;#39;2020&amp;#39;, &amp;#39;01&amp;#39;, &amp;#39;02&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;6.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.9&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;3.5&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14.5&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14.6&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14.6&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;45&amp;#39;, &amp;#39;&amp;#39;] The downside of using the standard python csv.reader parser, is it simply returns all cells as strings, and doesn’t differentiate between cell headers and cell contents. Furthermore, the underlying data seems to have some sort of unicode character that’s not being correctly handled. Using the Standard csv.DictReader Parser The csv library provides a csv.DictReader class which will use the first row as cell headers, and rather than returning the row as a list; instead it will return it as a dictionary: {&amp;#39;\ufeff&amp;quot;Longitude (x)&amp;quot;&amp;#39;: &amp;#39;-123.43&amp;#39;, &amp;#39;Latitude (y)&amp;#39;: &amp;#39;48.65&amp;#39;, &amp;#39;Station Name&amp;#39;: &amp;#39;VICTORIA INTL A&amp;#39;, &amp;#39;Climate ID&amp;#39;: &amp;#39;1018621&amp;#39;, &amp;#39;Date/Time&amp;#39;: &amp;#39;2020-01-01&amp;#39;, &amp;#39;Year&amp;#39;: &amp;#39;2020&amp;#39;, &amp;#39;Month&amp;#39;: &amp;#39;01&amp;#39;, &amp;#39;Day&amp;#39;: &amp;#39;01&amp;#39;, &amp;#39;Data Quality&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Max Temp (°C)&amp;#39;: &amp;#39;12.9&amp;#39;, &amp;#39;Max Temp Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Min Temp (°C)&amp;#39;: &amp;#39;5.5&amp;#39;, &amp;#39;Min Temp Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Mean Temp (°C)&amp;#39;: &amp;#39;9.2&amp;#39;, &amp;#39;Mean Temp Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Heat Deg Days (°C)&amp;#39;: &amp;#39;8.8&amp;#39;, &amp;#39;Heat Deg Days Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Cool Deg Days (°C)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Cool Deg Days Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Total Rain (mm)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Total Rain Flag&amp;#39;: &amp;#39;T&amp;#39;, &amp;#39;Total Snow (cm)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Total Snow Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Total Precip (mm)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Total Precip Flag&amp;#39;: &amp;#39;T&amp;#39;, &amp;#39;Snow on Grnd (cm)&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Snow on Grnd Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Dir of Max Gust (10s deg)&amp;#39;: &amp;#39;26&amp;#39;, &amp;#39;Dir of Max Gust Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Spd of Max Gust (km/h)&amp;#39;: &amp;#39;59&amp;#39;, &amp;#39;Spd of Max Gust Flag&amp;#39;: &amp;#39;&amp;#39;} However, the DictReader doesn’t parse the cell contents and returns everything simply as strings – leaving all type parsing to the user. Again we see the incorrectly handled unicode character appear – this time within the key of every row. Using the Pandas Library The pandas library is a third-party python library which provides tools for data analysis and manipulation. We will be using the pandas.read_csv function to parse our data: import pandas weather = pandas.read_csv(&amp;#39;data/victoria-weather-2020.csv&amp;#39;) print(weather) This will produce output such as: Longitude (x) Latitude (y) Station Name Climate ID Date/Time Year Month Day ... Total Precip (mm) Total Precip Flag Snow on Grnd (cm) Snow on Grnd Flag Dir of Max Gust (10s deg) Dir of Max Gust Flag Spd of Max Gust (km/h) Spd of Max Gust Flag 0 -123.43 48.65 VICTORIA INTL A 1018621 2020-01-01 2020 1 1 ... 0.0 T NaN NaN 26.0 NaN 59.0 NaN 1 -123.43 48.65 VICTORIA INTL A 1018621 2020-01-02 2020 1 2 ... 14.6 NaN NaN NaN 14.0 NaN 45.0 NaN 2 -123.43 48.65 VICTORIA INTL A 1018621 2020-01-03 2020 1 3 ... 11.2 NaN NaN NaN 15.0 NaN 39.0 NaN .. ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... 363 -123.43 48.65 VICTORIA INTL A 1018621 2020-12-29 2020 12 29 ... 8.7 NaN NaN NaN NaN M NaN M 364 -123.43 48.65 VICTORIA INTL A 1018621 2020-12-30 2020 12 30 ... 20.4 NaN NaN NaN 14.0 NaN 61.0 NaN 365 -123.43 48.65 VICTORIA INTL A 1018621 2020-12-31 2020 12 31 ... 7.2 NaN NaN NaN 14.0 NaN 33.0 NaN [366 rows x 31 columns] Notice how the columns have been automatically parsed to an appropriate data type, as well as the column headers are detected. Row numbers are additionally displayed, as well as the data is displayed as a table. This is possible due to the fact that the read_csv function returns a pandas.core.frame.DataFrame data type which among other things, implements the __str__ method which is used to render the string which is passed to the print function. Merging Multiple Datasets My dataset is split across multiple csv files, with each file containing a dataset for a specific year. My first task is to merge them together. All the datasets are located under the data directory, and are named victoria-weather-YYYY.csv (where YYYY is the year). Let’s write a function to parse all the data: import re import os import pandas def get_data(weather_dir): p = re.compile(&amp;#39;victoria-weather-[0-9]+.csv&amp;#39;) data = [] for filename in sorted(os.listdir(weather_dir)): if p.match(filename): path = os.path.join(weather_dir, filename) yearly_data = pandas.read_csv(path) data.append(yearly_data) return pandas.concat(data) weather = get_data(&amp;#39;data&amp;#39;) print(weather) This function 1) uses a regular expression to ensure we only parse files which match the expected form, which prevents our program from crashing if any other files existed in the directory, 2) parses each file separately using the read_csv function, 3) saves the returned data frame into the data list, then finally 4) concatenates the data using the concat function. This code should output a single data frame containing all the data spanning a decade: Longitude (x) Latitude (y) Station Name Climate ID Date/Time Year Month Day Data Quality ... Total Snow Flag Total Precip (mm) Total Precip Flag Snow on Grnd (cm) Snow on Grnd Flag Dir of Max Gust (10s deg) Dir of Max Gust Flag Spd of Max Gust (km/h) Spd of Max Gust Flag 0 -123.43 48.65 VICTORIA INTL A 1018621 2014-01-01 2014 1 1 NaN ... NaN 1.6 NaN NaN NaN NaN NaN &amp;lt;31 NaN 1 -123.43 48.65 VICTORIA INTL A 1018621 2014-01-02 2014 1 2 NaN ... NaN 6.6 NaN NaN NaN 21.0 NaN 37 NaN 2 -123.43 48.65 VICTORIA INTL A 1018621 2014-01-03 2014 1 3 NaN ... NaN 0.0 NaN NaN NaN 31.0 NaN 41 NaN 3 -123.43 48.65 VICTORIA INTL A 1018621 2014-01-04 2014 1 4 NaN ... NaN 0.0 NaN NaN NaN NaN NaN &amp;lt;31 NaN 4 -123.43 48.65 VICTORIA INTL A 1018621 2014-01-05 2014 1 5 NaN ... NaN 0.0 NaN NaN NaN NaN NaN &amp;lt;31 NaN .. ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... 198 -123.43 48.65 VICTORIA INTL A 1018621 2021-07-18 2021 7 18 NaN ... NaN 0.0 NaN NaN NaN NaN NaN NaN M 199 -123.43 48.65 VICTORIA INTL A 1018621 2021-07-19 2021 7 19 NaN ... NaN 0.0 NaN NaN NaN 25.0 NaN 37.0 NaN 200 -123.43 48.65 VICTORIA INTL A 1018621 2021-07-20 2021 7 20 NaN ... NaN 0.0 NaN NaN NaN 29.0 NaN 36.0 NaN 201 -123.43 48.65 VICTORIA INTL A 1018621 2021-07-21 2021 7 21 NaN ... NaN 0.0 NaN NaN NaN 28.0 NaN 33.0 NaN 202 -123.43 48.65 VICTORIA INTL A 1018621 2021-07-22 2021 7 22 NaN ... NaN 0.0 NaN NaN NaN NaN M NaN M [2760 rows x 31 columns] Raindrops Keep Falling on my Plots Let’s plot the rainfall! We will use the matplotlib library for visualizing this data. We can extract a single column of the data frame using the column name, e.g. weather['Total Precip (mm)']. This will return a pandas.core.series.Series data type, which is similar to a list; however requires each element in the series to be the same data type. This allows pandas to keep all elements in contiguous memory, which allows faster SIMD-based operations. For another example of comparing generic data types against specific native types, checkout out our post on the various tricks that python’s timsort uses to achieve better performance. A pandas series can be converted into a python list using the .to_list() method; e.g. weather['Total Precip (mm)'].to_list() Plotting the Data Interactively Here’s a quick example of plotting this data interactively: import matplotlib.pyplot as plt rainfall = weather[&amp;#39;Total Precip (mm)&amp;#39;].to_list() plt.plot(rainfall) plt.show() This will display a new window, containing a plot of the data: Victoria BC daily precipitation interactive plot It should be possible to omit the .to_list() call, which would then pass the pandas series data type directly to the matplotlib plot function rather than passing a standard python list; however, there’s a bug in matplotlib (or pandas), which produces the following erroneous plot: Notice how this plot has some bizarre lines that criss-cross the plot, and that the data points stop at roughly 350 rather than past 2500? At a quick glance, this might be an instance of this bug. Saving the Plot Programmatically Lets revise the previous code to render the plot as a png instead of using an interactive window: import matplotlib.pyplot as plt # create a new figure that is 10x7 inches # which is rendered as 100 pixels per inch # (matplotlib incorrectly refers to this as dots-per-inch, which is a printer term) fig = plt.figure(figsize=(10.0, 7.0), dpi=100) # define axes on the figure to take up the entire figure canvas ax = fig.add_axes([0, 0, 1, 1]) # plot the rainfall amounts against the axes ax.plot(rainfall) # label the axes and title the plot ax.set_xlabel(&amp;#39;days since start of dataset&amp;#39;) ax.set_ylabel(&amp;#39;precipitation (mm)&amp;#39;) ax.set_title(&amp;#39;Victoria BC daily precipitation&amp;#39;) # save the plot to disk fig.savefig(&amp;#39;daily-precipitation.png&amp;#39;, bbox_inches=&amp;#39;tight&amp;#39;) Which will produce: Victoria BC daily precipitation Fixing the X Axis Label to Display the Date The previous plots didn’t make use of the Date/Time column from our weather data csv files; instead it was simply displaying the index of the list element. We need to instruct pandas to parse those columns as dates using the parse_dates field. We will additionally define a date parsing function yyyymmdd_parser which will be used to parse the date; without this function, pandas will attempt to guess the format of the date, which is a best-effort strategy and may not always work. import re import os import pandas import datetime import matplotlib.pyplot as plt # Our new date parser def yyyymmdd_parser(s): return datetime.datetime.strptime(s, &amp;#39;%Y-%m-%d&amp;#39;) def get_data(weather_dir): p = re.compile(&amp;#39;victoria-weather-[0-9]+.csv&amp;#39;) data = [] for filename in sorted(os.listdir(weather_dir)): if p.match(filename): path = os.path.join(weather_dir, filename) # We identify which column contains the date, along with the date parser to use. yearly_data = pandas.read_csv(path, parse_dates=[&amp;#39;Date/Time&amp;#39;], date_parser=yyyymmdd_parser) data.append(yearly_data) return pandas.concat(data) weather = get_data(&amp;#39;data&amp;#39;) rainfall = weather[&amp;#39;Total Precip (mm)&amp;#39;].to_list() # We will convert all dates into the native python datetime format, which works # better with matplotlib. date = [x.to_pydatetime() for x in weather[&amp;#39;Date/Time&amp;#39;]] fig = plt.figure(figsize=(10.0, 7.0)) ax = fig.add_axes([0,0,1,1]) # We will pass in both the date and rainfall amounts which contain the x and y values respectively ax.plot(date, rainfall) ax.set_xlabel(&amp;#39;date&amp;#39;) ax.set_ylabel(&amp;#39;precipitation (mm)&amp;#39;) ax.set_title(&amp;#39;Victoria BC daily precipitation&amp;#39;) fig.savefig(&amp;#39;daily-precipitation-with-dates.png&amp;#39;, bbox_inches=&amp;#39;tight&amp;#39;) Victoria BC daily precipitation with dates While it’s interesting to get this data plotted, it’s not obviously easy to compare one years data against another. Comparing Annual Data Let’s slice up the data and plot it against different years. Splitting up the Data by Year We will create a new function that splits up the data by year, and calculates a new field that is days since January 1st of the current year: def get_days_since_jan1(date): return date.timetuple().tm_yday - 1 def split_data_by_year(weather): yearly_rainfall = [] yearly_days_since_jan1 = [] current_year = None by_year = [] for i, row in weather.iterrows(): date = row[&amp;#39;Date/Time&amp;#39;] rainfall = row[&amp;#39;Total Precip (mm)&amp;#39;] if current_year is None: current_year = date.year elif current_year != date.year: by_year.append((current_year, pandas.DataFrame({ &amp;#39;days_since_jan1&amp;#39;: yearly_days_since_jan1, &amp;#39;rainfall&amp;#39;: yearly_rainfall, }))) yearly_days_since_jan1 = [] yearly_rainfall = [] current_year = date.year yearly_rainfall.append(rainfall) yearly_days_since_jan1.append(get_days_since_jan1(date)) if current_year is not None: by_year.append((current_year, pandas.DataFrame({ &amp;#39;days_since_jan1&amp;#39;: yearly_days_since_jan1, &amp;#39;rainfall&amp;#39;: yearly_rainfall, }))) return by_year rainfall_by_year = slice_data_by_year(weather) print(rainfall_by_year) This will then output something similar to: [(2014, days_since_jan1 rainfall 0 0 1.6 1 1 6.6 .. ... ... 363 363 0.0 364 364 0.0 [365 rows x 2 columns]), (2015, days_since_jan1 rainfall 0 0 0.0 1 1 4.8 .. ... ... 363 363 0.0 364 364 0.0 [366 rows x 2 columns]), ... Plotting the Data by Year Rather than call ax.plot a single time; in this example we will call it from inside a for loop once for each year in our data set. We pass the year as a label value, which will then be displayed on the legend. import matplotlib.pyplot as plt fig = plt.figure(figsize=(10.0, 7.0), dpi=100) ax = fig.add_axes([0, 0, 1, 1]) for year, annual_data in rainfall_by_year: days_since_jan1 = annual_data[&amp;#39;days_since_jan1&amp;#39;].to_list() rainfall = annual_data[&amp;#39;rainfall&amp;#39;].to_list() ax.plot(days_since_jan1, rainfall, label=year) # label the axes and title the plot ax.set_xlabel(&amp;#39;days since jan 1st&amp;#39;) ax.set_ylabel(&amp;#39;precipitation (mm)&amp;#39;) ax.set_title(&amp;#39;Victoria BC daily precipitation since Jan 1st&amp;#39;) ax.legend() # save the plot to disk fig.savefig(&amp;#39;daily-precipitation-by-year.png&amp;#39;, bbox_inches=&amp;#39;tight&amp;#39;) This will produce the following plot: Victoria BC daily precipitation with dates Well that’s interesting, but still rather hard to compare one year against another. We can fix that by plotting the yearly cumulative sum. Plotting Cumulative Annual Rainfall by Year One potential way to plot the cumulative annual rainfall would be to modify the split_data_by_year function to keep a yearly running total for the rainfall; however, pandas implements a cumsum function which can perform the calculation for us: import matplotlib.pyplot as plt fig = plt.figure(figsize=(10.0, 7.0), dpi=100) ax = fig.add_axes([0, 0, 1, 1]) for year, annual_data in rainfall_by_year: days_since_jan1 = annual_data[&amp;#39;days_since_jan1&amp;#39;].to_list() rainfall = annual_data[&amp;#39;rainfall&amp;#39;].cumsum().to_list() ax.plot(days_since_jan1, rainfall, label=year) # label the axes and title the plot ax.set_xlabel(&amp;#39;days since jan 1st&amp;#39;) ax.set_ylabel(&amp;#39;precipitation (mm)&amp;#39;) ax.set_title(&amp;#39;Victoria BC cumulative annual precipitation&amp;#39;) ax.legend() # save the plot to disk fig.savefig(&amp;#39;cumulative-annual-precipitation.png&amp;#39;, bbox_inches=&amp;#39;tight&amp;#39;) Finally, a clear image starts to appear: Victoria BC cumulative annual precipitation Accounting for Missing Data If you look closely at the previous plot, there’s a few gaps in the data. This occurred due to the fact that the initial data set contains an empty string &quot;&quot; in places where either no data is available, or where the data is zero. Since it’s not obvious which case applies, pandas will parse this empty string as nan (not-a-number). In our case, the Environment Canada data encodes no snow as &quot;&quot; rather than 0 cm. We will instruct pandas to fill in these gaps with a default value of 0, using the fillna() method: weather[&amp;#39;Total Precip (mm)&amp;#39;] = weather[&amp;#39;Total Precip (mm)&amp;#39;].fillna(0) weather[&amp;#39;Total Snow (cm)&amp;#39;] = weather[&amp;#39;Total Snow (cm)&amp;#39;].fillna(0) This will produce a plot without gaps: Victoria BC cumulative annual precipitation Reordering the Legend and Fixing the X Axis The previous plot is difficult to see which colours correspond to which years (especially hard if you are colour blind). We will re-order the legend from wettest to driest years, with 2021 being dead-last. To sort the data, we will create a new function get_total_rainfall, which returns a new value for python’s sorted function to use when sorting values. We return a tuple so that the year can be used to differentiate between cases where the annual precipitation is identical. Additionally, let’s fix the x-axis to display the name of the month, rather than an integer value. import matplotlib import matplotlib.pyplot as plt fig = plt.figure(figsize=(10.0, 7.0), dpi=100) ax = fig.add_axes([0, 0, 1, 1]) def get_total_rainfall(val): year, annual_data = val total_rainfall = annual_data[&amp;#39;rainfall&amp;#39;].cumsum().to_list()[-1] return (total_rainfall, year) for year, annual_data in sorted(rainfall_by_year, key=get_total_rainfall, reverse=True): days_since_jan1 = annual_data[&amp;#39;days_since_jan1&amp;#39;].to_list() rainfall = annual_data[&amp;#39;rainfall&amp;#39;].cumsum().to_list() ax.plot(days_since_jan1, rainfall, label=year) # format x axis values as month names rather than days since jan 1st def format_days_since_jan1(days, pos=None): date = datetime.date(2020, 1, 1) + datetime.timedelta(days) return date.strftime(&amp;#39;%b&amp;#39;) ax.xaxis.set_major_formatter(matplotlib.ticker.FuncFormatter(format_days_since_jan1)) # label the axes and title the plot ax.set_xlabel(&amp;#39;calendar date&amp;#39;) ax.set_ylabel(&amp;#39;precipitation (mm)&amp;#39;) ax.set_title(&amp;#39;Victoria BC cumulative annual precipitation&amp;#39;) ax.legend() # save the plot to disk fig.savefig(&amp;#39;cumulative-annual-precipitation-sorted-legend.png&amp;#39;, bbox_inches=&amp;#39;tight&amp;#39;) And here we have it, 2021 has been a really dry year here in Victoria: Victoria BC cumulative annual precipitation v2 Accounting for Snow The previous plots have an error – they were only plotting rainfall, and not accounting for snowfall. It’s difficult to directly convert snowfall into an equivalent amount of precipitation due to the variety of snow crystal sizes – some snow is wet, while other snow is fairly dry. On the west-coast (wet-coast as some call it); when we do get snow, it tends to be fairly wet. We will assume that 13mm of snow is equivalent to 1mm of rain 1. Let’s revise our split_data_by_year function to calculate this. def split_data_by_year(weather): yearly_rainfall = [] yearly_days_since_jan1 = [] current_year = None by_year = [] for i, row in weather.iterrows(): date = row[&amp;#39;Date/Time&amp;#39;] rainfall = row[&amp;#39;Total Precip (mm)&amp;#39;] # 1cm snow = 10mm snow; 13mm of snow = 1mm of rain snowfall = row[&amp;#39;Total Snow (cm)&amp;#39;] * 10.0 / 13.0 rainfall += snowfall if current_year is None: current_year = date.year elif current_year != date.year: by_year.append((current_year, pandas.DataFrame({ &amp;#39;days_since_jan1&amp;#39;: yearly_days_since_jan1, &amp;#39;rainfall&amp;#39;: yearly_rainfall, }))) yearly_days_since_jan1 = [] yearly_rainfall = [] current_year = date.year yearly_rainfall.append(rainfall) yearly_days_since_jan1.append(get_days_since_jan1(date)) if current_year is not None: by_year.append((current_year, pandas.DataFrame({ &amp;#39;days_since_jan1&amp;#39;: yearly_days_since_jan1, &amp;#39;rainfall&amp;#39;: yearly_rainfall, }))) return by_year If you look closely, once we adjust for snow, it turned out that 2017 was a wetter year compared to 2014: Victoria BC cumulative annual precipitation including snow None of that however changes the fact that it’s been a very dry year, and my garden is browner than ever. On the other hand, my tomatoes have been loving the heat. If you would like to try generating the above graphs, all the code (and data) can be found under github.com/earthly/example-plotting-precipitation. While you’re here: Earthly is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today. https://www.nssl.noaa.gov/education/svrwx101/winter/faq/↩︎</summary></entry><entry><title type="html">How to Convert from JSON to CSV at The Command Line</title><link href="https://earthly.dev/blog/convert-to-from-json/" rel="alternate" type="text/html" title="How to Convert from JSON to CSV at The Command Line" /><published>2021-08-12T00:00:00-04:00</published><updated>2021-08-12T00:00:00-04:00</updated><id>https://earthly.dev/blog/convert-to-from-json</id><content type="html" xml:base="https://earthly.dev/blog/convert-to-from-json/">&lt;p&gt;How do you convert JSON values to CSV and back at the command line? I’ve done this task on many occasions and been stung by the edge cases frequently enough that &lt;strong&gt;it’s time for me to share my favorite tools for this conversion process.&lt;/strong&gt; But first, some background.&lt;/p&gt;
&lt;h2 id=&quot;background-you-probably-want-a-csv-conversion-tool&quot;&gt;Background: You Probably Want a CSV Conversion Tool&lt;/h2&gt;
&lt;p&gt;The CSV format seems simple at first glance: You have a fixed number of fields per row and each field is separated by a comma.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1997,Ford,E350\n&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;However, if you need to use commas in the value, then the fields must be delimited with &lt;code&gt;&quot;&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1997,Ford,E350,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;Super, luxurious truck&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;\n&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can use this same trick to delimit a line break, and use double double-quotes if you need to include &lt;code&gt;&quot;&lt;/code&gt; in your values or headings.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1997,Ford,E350,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;Go get one &amp;quot;&amp;quot;now&amp;quot;&amp;quot;\n&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;they are going fast&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;\n&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Things get more complex from there, and even the &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc4180&quot;&gt;CSV standard&lt;/a&gt; does not specify how to handle all the edge cases and some formatting options are non-compatible. Wikipedia puts it this way:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The CSV file format is not fully standardized. Separating fields with commas is the foundation, but commas in the data or embedded line breaks have to be handled specially. Some implementations disallow such content while others surround the field with quotation marks, which yet again creates the need for escaping these if they are present in the data.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So although it seems like CSV conversion can be done by hand in python, or your language of choice, using an existing tool that is known to handle the edges cases well it the way to go.&lt;/p&gt;
&lt;p&gt;With that in mind, let’s review some tools for converting from JSON to CSV at the command line.&lt;/p&gt;
&lt;h2 id=&quot;convert-json-to-csv-via-the-command-line&quot;&gt;Convert JSON to CSV via the Command Line&lt;/h2&gt;
&lt;p&gt;The simplest way to do this JSON to CSV conversion is with &lt;code&gt;dasel&lt;/code&gt;. &lt;code&gt;dasel&lt;/code&gt; is a tool for DAta SELection. Think of it as a &lt;code&gt;jq&lt;/code&gt; that supports selection on formats besides just JSON.&lt;/p&gt;
&lt;p&gt;It’s easy to install (&lt;code&gt;brew install dasel&lt;/code&gt;), and it works great as a format converter.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;   &lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;    &lt;/span&gt;
&lt;span id=&quot;cb4-4&quot;&gt;&lt;a href=&quot;#cb4-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-5&quot;&gt;&lt;a href=&quot;#cb4-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;#f00&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-6&quot;&gt;&lt;a href=&quot;#cb4-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-7&quot;&gt;&lt;a href=&quot;#cb4-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-8&quot;&gt;&lt;a href=&quot;#cb4-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;   &lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb4-9&quot;&gt;&lt;a href=&quot;#cb4-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-10&quot;&gt;&lt;a href=&quot;#cb4-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;#0f0&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-11&quot;&gt;&lt;a href=&quot;#cb4-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-12&quot;&gt;&lt;a href=&quot;#cb4-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-13&quot;&gt;&lt;a href=&quot;#cb4-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;   &lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb4-14&quot;&gt;&lt;a href=&quot;#cb4-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-15&quot;&gt;&lt;a href=&quot;#cb4-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;#00f&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-16&quot;&gt;&lt;a href=&quot;#cb4-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-17&quot;&gt;&lt;a href=&quot;#cb4-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-18&quot;&gt;&lt;a href=&quot;#cb4-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figcaption&gt;
simple.json
&lt;/figcaption&gt;
&lt;p&gt;The conversion is easy:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; dasel &lt;span class=&quot;at&quot;&gt;-r&lt;/span&gt; json &lt;span class=&quot;at&quot;&gt;-w&lt;/span&gt; csv &lt;span class=&quot;op&quot;&gt;&amp;lt;&lt;/span&gt; sample.json &lt;/span&gt;
&lt;span id=&quot;cb5-2&quot;&gt;&lt;a href=&quot;#cb5-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;color,id,value&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-3&quot;&gt;&lt;a href=&quot;#cb5-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;red&lt;/span&gt;,1,#f00&lt;/span&gt;
&lt;span id=&quot;cb5-4&quot;&gt;&lt;a href=&quot;#cb5-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;green,2,#0f0&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-5&quot;&gt;&lt;a href=&quot;#cb5-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;blue,3,#00f&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figcaption&gt;
converting with &lt;code&gt;dasel&lt;/code&gt;
&lt;/figcaption&gt;
&lt;p&gt;&lt;code&gt;dasel&lt;/code&gt; handles newlines and values containing commas as well.&lt;/p&gt;
&lt;h2 id=&quot;convert-json-to-csv-via-the-command-line-using-jq&quot;&gt;Convert JSON to CSV via the Command Line using JQ&lt;/h2&gt;
&lt;p&gt;If you don’t want to install &lt;code&gt;dasel&lt;/code&gt; or if you just love &lt;code&gt;jq&lt;/code&gt; (&lt;code&gt;brew install jq&lt;/code&gt;) then this solution may work well for you. Before I discovered &lt;code&gt;dasel&lt;/code&gt; this was the main approach I used:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; cat simple.json&lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;(map(keys) | add | unique) as $cols | map(. as $row | $cols | map($row[.])) as $rows | $cols, $rows[] | @csv&amp;#39;&lt;/span&gt; &lt;/span&gt;
&lt;span id=&quot;cb6-2&quot;&gt;&lt;a href=&quot;#cb6-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-3&quot;&gt;&lt;a href=&quot;#cb6-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,1,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#f00&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-4&quot;&gt;&lt;a href=&quot;#cb6-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,2,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#0f0&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-5&quot;&gt;&lt;a href=&quot;#cb6-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,3,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#00f&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figcaption&gt;
Convert any JSON to CSV with JQ
&lt;/figcaption&gt;
&lt;p&gt;A full explanation for how this works is beyond the scope of this article, but the idea is to use &lt;code&gt;(map(keys) | add | unique)&lt;/code&gt; to get the column names and then gather the values for those columns into &lt;code&gt;$row&lt;/code&gt; and use the &lt;code&gt;@csv&lt;/code&gt; filter to convert the array of rows in a CSV format.&lt;/p&gt;
&lt;h2 id=&quot;convert-json-to-csv-via-the-command-line-and-choose-ordering-column&quot;&gt;Convert JSON to CSV via the Command Line and Choose Ordering Column&lt;/h2&gt;
&lt;p&gt;The downside to the previous two approaches is that you can’t specify which columns to exclude nor their order. Both &lt;code&gt;jq&lt;/code&gt; and &lt;code&gt;dazel&lt;/code&gt; support a query language for customizing the output, but if you don’t want to dive into CSS selectors, the &lt;code&gt;jsonv&lt;/code&gt; tool is a great alternative.&lt;/p&gt;
&lt;p&gt;To convert, we will use &lt;code&gt;jsonv&lt;/code&gt; and pipe it our JSON file. Then, we will specify the columns to include, and we redirect its output to a file.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb7&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb7-1&quot;&gt;&lt;a href=&quot;#cb7-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;cat&lt;/span&gt; simple.json &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jsonv&lt;/span&gt; id,color,value &lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; simple.csv&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This gives us a simple CSV file:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb8&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb8-1&quot;&gt;&lt;a href=&quot;#cb8-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; cat simple.csv&lt;/span&gt;
&lt;span id=&quot;cb8-2&quot;&gt;&lt;a href=&quot;#cb8-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#f00&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-3&quot;&gt;&lt;a href=&quot;#cb8-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;2,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#0f0&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-4&quot;&gt;&lt;a href=&quot;#cb8-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;3,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#00f&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-5&quot;&gt;&lt;a href=&quot;#cb8-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;4,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;cyan&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#0ff&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-6&quot;&gt;&lt;a href=&quot;#cb8-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;5,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;magenta&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#f0f&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-7&quot;&gt;&lt;a href=&quot;#cb8-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;6,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;yellow&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#ff0&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-8&quot;&gt;&lt;a href=&quot;#cb8-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;7,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;black&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#000&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;jsonv&lt;/code&gt; handles more complex examples as well. Under the hood, it uses &lt;code&gt;gnuawk&lt;/code&gt; (&lt;code&gt;gawk&lt;/code&gt;). You can install it using curl:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl -Ls https://raw.github.com/archan937/jsonv.sh/master/install.sh | bash&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can install &lt;code&gt;gawk&lt;/code&gt; using brew (&lt;code&gt;brew install gawk&lt;/code&gt;) or your package manager of choice.&lt;/p&gt;
&lt;h2 id=&quot;convert-csv-to-json-at-the-command-line&quot;&gt;Convert CSV to JSON at The Command Line&lt;/h2&gt;
&lt;p&gt;For converting CSV to JSON, we can use &lt;code&gt;dasel&lt;/code&gt; again. The read (&lt;code&gt;-r&lt;/code&gt;) and write (&lt;code&gt;-w&lt;/code&gt;) options mean that it’s easy to convert from any of its supported file formats (JSON, YAML, TOML, XML, and CSV).&lt;/p&gt;
&lt;p&gt;We can get our original JSON document back from CSV like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; cat sample.csv&lt;/span&gt;
&lt;span id=&quot;cb10-2&quot;&gt;&lt;a href=&quot;#cb10-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;ID,&lt;/span&gt; color, value&lt;/span&gt;
&lt;span id=&quot;cb10-3&quot;&gt;&lt;a href=&quot;#cb10-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#f00&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-4&quot;&gt;&lt;a href=&quot;#cb10-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;2,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#0f0&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-5&quot;&gt;&lt;a href=&quot;#cb10-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;3,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#00f&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;er&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;dasel&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;csv&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;-w&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;json&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;sample.csv&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-2&quot;&gt;&lt;a href=&quot;#cb11-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-3&quot;&gt;&lt;a href=&quot;#cb11-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;ID&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-4&quot;&gt;&lt;a href=&quot;#cb11-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-5&quot;&gt;&lt;a href=&quot;#cb11-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;#f00&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-6&quot;&gt;&lt;a href=&quot;#cb11-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-7&quot;&gt;&lt;a href=&quot;#cb11-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-8&quot;&gt;&lt;a href=&quot;#cb11-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;ID&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-9&quot;&gt;&lt;a href=&quot;#cb11-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-10&quot;&gt;&lt;a href=&quot;#cb11-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;#0f0&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-11&quot;&gt;&lt;a href=&quot;#cb11-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-12&quot;&gt;&lt;a href=&quot;#cb11-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-13&quot;&gt;&lt;a href=&quot;#cb11-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;ID&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;3&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-14&quot;&gt;&lt;a href=&quot;#cb11-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-15&quot;&gt;&lt;a href=&quot;#cb11-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;#00f&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-16&quot;&gt;&lt;a href=&quot;#cb11-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;convert-csv-to-json-command-line-with-csvtojson&quot;&gt;Convert CSV to JSON Command Line with &lt;code&gt;csvtojson&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;Another option is to grab the npm tool &lt;code&gt;csvtojson&lt;/code&gt; (&lt;code&gt;npm i --save csvtojson&lt;/code&gt;). If you don’t already have npm and Node.js installed then installing &lt;code&gt;dasel&lt;/code&gt; is a simple solution. Once installed, you can convert to CSV by sending input to &lt;code&gt;csvtojson&lt;/code&gt; over standard in:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb12&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb12-1&quot;&gt;&lt;a href=&quot;#cb12-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;csvtojson&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;lt;&lt;/span&gt; sample.csv&lt;/span&gt;
&lt;span id=&quot;cb12-2&quot;&gt;&lt;a href=&quot;#cb12-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-3&quot;&gt;&lt;a href=&quot;#cb12-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;ID&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#f00&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;}&lt;/span&gt;,&lt;/span&gt;
&lt;span id=&quot;cb12-4&quot;&gt;&lt;a href=&quot;#cb12-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;ID&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#0f0&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;}&lt;/span&gt;,&lt;/span&gt;
&lt;span id=&quot;cb12-5&quot;&gt;&lt;a href=&quot;#cb12-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;ID&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;3&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#00f&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-6&quot;&gt;&lt;a href=&quot;#cb12-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;You now have the knowledge and the tools you need to convert JSON to CSV and CSV to JSON. &lt;a href=&quot;https://stedolan.github.io/jq/&quot;&gt;&lt;code&gt;jq&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://github.com/TomWright/dasel&quot;&gt;&lt;code&gt;dasel&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://www.npmjs.com/package/csvtojson&quot;&gt;&lt;code&gt;csvtojson&lt;/code&gt;&lt;/a&gt; and &lt;a href=&quot;https://github.com/archan937/jsonv.sh&quot;&gt;&lt;code&gt;jsonv&lt;/code&gt;&lt;/a&gt; are handy command line tools that can be used on Linux, MacOS and Windows under WSL 2.&lt;/p&gt;
&lt;div class=&quot;notice--info notice--big&quot;&gt;
&lt;p&gt;
&lt;strong&gt;While you’re here:&lt;/strong&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today.
&lt;/p&gt;
&lt;/div&gt;</content><author><name>Adam Gordon Bell</name></author><category term="Tutorials" /><summary type="html">How do you convert JSON values to CSV and back at the command line? I’ve done this task on many occasions and been stung by the edge cases frequently enough that it’s time for me to share my favorite tools for this conversion process. But first, some background. Background: You Probably Want a CSV Conversion Tool The CSV format seems simple at first glance: You have a fixed number of fields per row and each field is separated by a comma. 1997,Ford,E350\n However, if you need to use commas in the value, then the fields must be delimited with &quot;: 1997,Ford,E350,&amp;quot;Super, luxurious truck&amp;quot;\n You can use this same trick to delimit a line break, and use double double-quotes if you need to include &quot; in your values or headings. 1997,Ford,E350,&amp;quot;Go get one &amp;quot;&amp;quot;now&amp;quot;&amp;quot;\n they are going fast&amp;quot;\n Things get more complex from there, and even the CSV standard does not specify how to handle all the edge cases and some formatting options are non-compatible. Wikipedia puts it this way: The CSV file format is not fully standardized. Separating fields with commas is the foundation, but commas in the data or embedded line breaks have to be handled specially. Some implementations disallow such content while others surround the field with quotation marks, which yet again creates the need for escaping these if they are present in the data. So although it seems like CSV conversion can be done by hand in python, or your language of choice, using an existing tool that is known to handle the edges cases well it the way to go. With that in mind, let’s review some tools for converting from JSON to CSV at the command line. Convert JSON to CSV via the Command Line The simplest way to do this JSON to CSV conversion is with dasel. dasel is a tool for DAta SELection. Think of it as a jq that supports selection on formats besides just JSON. It’s easy to install (brew install dasel), and it works great as a format converter. [ { &amp;quot;id&amp;quot; : 1, &amp;quot;color&amp;quot;: &amp;quot;red&amp;quot;, &amp;quot;value&amp;quot;: &amp;quot;#f00&amp;quot; }, { &amp;quot;id&amp;quot; : 2, &amp;quot;color&amp;quot;: &amp;quot;green&amp;quot;, &amp;quot;value&amp;quot;: &amp;quot;#0f0&amp;quot; }, { &amp;quot;id&amp;quot; : 3, &amp;quot;color&amp;quot;: &amp;quot;blue&amp;quot;, &amp;quot;value&amp;quot;: &amp;quot;#00f&amp;quot; } ] simple.json The conversion is easy: $ dasel -r json -w csv &amp;lt; sample.json color,id,value red,1,#f00 green,2,#0f0 blue,3,#00f converting with dasel dasel handles newlines and values containing commas as well. Convert JSON to CSV via the Command Line using JQ If you don’t want to install dasel or if you just love jq (brew install jq) then this solution may work well for you. Before I discovered dasel this was the main approach I used: $ cat simple.json| jq -r &amp;#39;(map(keys) | add | unique) as $cols | map(. as $row | $cols | map($row[.])) as $rows | $cols, $rows[] | @csv&amp;#39; &amp;quot;color&amp;quot;,&amp;quot;id&amp;quot;,&amp;quot;value&amp;quot; &amp;quot;red&amp;quot;,1,&amp;quot;#f00&amp;quot; &amp;quot;green&amp;quot;,2,&amp;quot;#0f0&amp;quot; &amp;quot;blue&amp;quot;,3,&amp;quot;#00f&amp;quot; Convert any JSON to CSV with JQ A full explanation for how this works is beyond the scope of this article, but the idea is to use (map(keys) | add | unique) to get the column names and then gather the values for those columns into $row and use the @csv filter to convert the array of rows in a CSV format. Convert JSON to CSV via the Command Line and Choose Ordering Column The downside to the previous two approaches is that you can’t specify which columns to exclude nor their order. Both jq and dazel support a query language for customizing the output, but if you don’t want to dive into CSS selectors, the jsonv tool is a great alternative. To convert, we will use jsonv and pipe it our JSON file. Then, we will specify the columns to include, and we redirect its output to a file. cat simple.json | jsonv id,color,value &amp;gt; simple.csv This gives us a simple CSV file: $ cat simple.csv 1,&amp;quot;red&amp;quot;,&amp;quot;#f00&amp;quot; 2,&amp;quot;green&amp;quot;,&amp;quot;#0f0&amp;quot; 3,&amp;quot;blue&amp;quot;,&amp;quot;#00f&amp;quot; 4,&amp;quot;cyan&amp;quot;,&amp;quot;#0ff&amp;quot; 5,&amp;quot;magenta&amp;quot;,&amp;quot;#f0f&amp;quot; 6,&amp;quot;yellow&amp;quot;,&amp;quot;#ff0&amp;quot; 7,&amp;quot;black&amp;quot;,&amp;quot;#000&amp;quot; jsonv handles more complex examples as well. Under the hood, it uses gnuawk (gawk). You can install it using curl: curl -Ls https://raw.github.com/archan937/jsonv.sh/master/install.sh | bash You can install gawk using brew (brew install gawk) or your package manager of choice. Convert CSV to JSON at The Command Line For converting CSV to JSON, we can use dasel again. The read (-r) and write (-w) options mean that it’s easy to convert from any of its supported file formats (JSON, YAML, TOML, XML, and CSV). We can get our original JSON document back from CSV like this: $ cat sample.csv ID, color, value 1,&amp;quot;red&amp;quot;,&amp;quot;#f00&amp;quot; 2,&amp;quot;green&amp;quot;,&amp;quot;#0f0&amp;quot; 3,&amp;quot;blue&amp;quot;,&amp;quot;#00f&amp;quot; $ dasel -r csv -w json &amp;lt; sample.csv { &amp;quot;ID&amp;quot;: &amp;quot;1&amp;quot;, &amp;quot;color&amp;quot;: &amp;quot;red&amp;quot;, &amp;quot;value&amp;quot;: &amp;quot;#f00&amp;quot; } { &amp;quot;ID&amp;quot;: &amp;quot;2&amp;quot;, &amp;quot;color&amp;quot;: &amp;quot;green&amp;quot;, &amp;quot;value&amp;quot;: &amp;quot;#0f0&amp;quot; } { &amp;quot;ID&amp;quot;: &amp;quot;3&amp;quot;, &amp;quot;color&amp;quot;: &amp;quot;blue&amp;quot;, &amp;quot;value&amp;quot;: &amp;quot;#00f&amp;quot; } Convert CSV to JSON Command Line with csvtojson Another option is to grab the npm tool csvtojson (npm i --save csvtojson). If you don’t already have npm and Node.js installed then installing dasel is a simple solution. Once installed, you can convert to CSV by sending input to csvtojson over standard in: csvtojson &amp;lt; sample.csv [ {&amp;quot;ID&amp;quot;:&amp;quot;1&amp;quot;,&amp;quot;color&amp;quot;:&amp;quot;red&amp;quot;,&amp;quot;value&amp;quot;:&amp;quot;#f00&amp;quot;}, {&amp;quot;ID&amp;quot;:&amp;quot;2&amp;quot;,&amp;quot;color&amp;quot;:&amp;quot;green&amp;quot;,&amp;quot;value&amp;quot;:&amp;quot;#0f0&amp;quot;}, {&amp;quot;ID&amp;quot;:&amp;quot;3&amp;quot;,&amp;quot;color&amp;quot;:&amp;quot;blue&amp;quot;,&amp;quot;value&amp;quot;:&amp;quot;#00f&amp;quot;} ] Conclusion You now have the knowledge and the tools you need to convert JSON to CSV and CSV to JSON. jq, dasel, csvtojson and jsonv are handy command line tools that can be used on Linux, MacOS and Windows under WSL 2. While you’re here: Earthly is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today.</summary></entry><entry><title type="html">Idiots And Maniacs</title><link href="https://earthly.dev/blog/idiots-and-maniacs/" rel="alternate" type="text/html" title="Idiots And Maniacs" /><published>2021-07-30T00:00:00-04:00</published><updated>2021-07-30T00:00:00-04:00</updated><id>https://earthly.dev/blog/idiots-and-maniacs</id><content type="html" xml:base="https://earthly.dev/blog/idiots-and-maniacs/">&lt;h2 id=&quot;observability&quot;&gt;Observability&lt;/h2&gt;
&lt;p&gt;If you do software-as-a-service development and you have paying customers, you at some point learn about the need for operational monitoring and observability. Personally, I went through a process something like this:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Service has some basic &lt;a href=&quot;/blog/understanding-docker-logging-and-log-files&quot;&gt;logging&lt;/a&gt; and an uptime alert.&lt;/li&gt;
&lt;li&gt;Service has a health-check endpoint, is deployed in triplicate behind a load balancer.&lt;/li&gt;
&lt;li&gt;Logs are real-time shipped to Splunk / ELK Stack.&lt;/li&gt;
&lt;li&gt;Metrics set up in Datadog / Prometheus with paging.&lt;/li&gt;
&lt;li&gt;Distributed Tracing set up for debugging across services.&lt;/li&gt;
&lt;li&gt;And so on.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Each step requires more work to set up and has some additional benefits. I moved through each step by necessity as my service handled more requests and became more important to customers.&lt;/p&gt;
&lt;p&gt;If you had shown step-1-me what a simple REST service looks like in step 5, I would have been shocked. The metrics counters and distributed tracing spans, and various operational concerns make the service more complex. I would have thought that whoever wrote the service was obsessed with operational issues, to the detriment of solving the problems at hand. I would have thought the service author was an observability maniac.&lt;/p&gt;
&lt;p&gt;On the other hand, if step-5-me were to get paged because a service written by step-1-me was down, he would not be happy. He would have a hard time figuring out what was wrong, and he’d be pretty sure the service author was an idiot who had never been paged in the middle of the night.&lt;/p&gt;
&lt;p&gt;It reminds me a lot of driving when it first snows here in Peterborough.&lt;/p&gt;
&lt;h2 id=&quot;driving&quot;&gt;Driving&lt;/h2&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/idiots-and-maniacs/9580-800-b155e3159.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/idiots-and-maniacs/9580-800-0cb86c200.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img width=&quot;1200px&quot; src=&quot;/blog/generated/assets/images/idiots-and-maniacs/9580-800-0cb86c200.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;p&gt;In the winter, in Peterborough, we get snow. It’s just a fact of life, and people learn how to drive in snowy conditions. But on the first substantial snowfall of the year, people struggle to remember how to drive.&lt;/p&gt;
&lt;p&gt;Some will drive way below the speed limit and slow down traffic for everyone. They are idiots in the snow. Others get frustrated by the slow drivers and go too fast for the road conditions. Don’t they know there is snow on the road?&lt;/p&gt;
&lt;p&gt;Everyone driving slower than me is an idiot, but everyone going faster than me is a maniac.&lt;/p&gt;
&lt;p&gt;So it is with software development. Everyone who takes an idea further than I have is a maniac, and people who haven’t taken it as far as me are idiots.&lt;/p&gt;
&lt;h2 id=&quot;testing&quot;&gt;Testing&lt;/h2&gt;
&lt;p&gt;There was a time when I thought all code should have 80% unit test code coverage as a minimum. Anything less was practically unethical, and if you didn’t think so, then you hadn’t read Clean Code™️ enough times.&lt;/p&gt;
&lt;div class=&quot;align-right&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/idiots-and-maniacs/9770-400-5e5247841.webp 400w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/idiots-and-maniacs/9770-400-1cc7b22be.png 400w&quot; type=&quot;image/png&quot;&gt;&lt;img width=&quot;300px&quot; src=&quot;/blog/generated/assets/images/idiots-and-maniacs/9770-400-1cc7b22be.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;On the other hand, Richard Hipp – who tests to 100% code coverage at the machine code level, covering every branch by running billions of tests each release&lt;a href=&quot;#fn1&quot; class=&quot;footnote-ref&quot; id=&quot;fnref1&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; – is a testing maniac.&lt;/p&gt;
&lt;p&gt;I hope you see where I’m going. This idiot to maniac gradient feels right, but it makes no sense&lt;a href=&quot;#fn2&quot; class=&quot;footnote-ref&quot; id=&quot;fnref2&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;. How can I be the only the person driving the right speed? Wherever you find yourself along the spectrum is more a reflection of the context in which you work than anything else.&lt;/p&gt;
&lt;h2 id=&quot;more-examples&quot;&gt;More Examples&lt;/h2&gt;
&lt;p&gt;Here are some made-up and exaggerated examples:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Typescript Developer:&lt;/strong&gt; JavaScript developers are &lt;strong&gt;idiots&lt;/strong&gt;. Don’t they know how many bugs the type system could have caught for them.&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Typescript Developer:&lt;/strong&gt; Elm developers are obsessed with types. They are &lt;strong&gt;maniacs&lt;/strong&gt; about using types to catch things at compile time.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Go Developer:&lt;/strong&gt; The JVM is such a heavyweight runtime and uses so much memory.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Go Developer:&lt;/strong&gt; Rust is so complex! Who wants to manage memory manually. Use a GC, you &lt;strong&gt;maniacs&lt;/strong&gt;!&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kotlin Developer:&lt;/strong&gt; Java is so verbose and ugly. Welcome to 2021. Kotlin has a lot of sugar and type improvements that make writing correct code simpler.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kotlin Developer:&lt;/strong&gt; Scala is for &lt;strong&gt;maniacs&lt;/strong&gt;. There is so much syntactic sugar and type stuff that it’s not worth learning about.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I’m not trying to pick on any of these languages - Typescript, Go, and Kotlin are exceptionally well suited to their niche. But contexts vary&lt;a href=&quot;#fn3&quot; class=&quot;footnote-ref&quot; id=&quot;fnref3&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt;, and it takes mental effort to see that people making other trade-offs sometimes have good reasons for it.&lt;/p&gt;
&lt;p&gt;That doesn’t mean that other people are never wrong, though. People choose the wrong tool for the job all the time. For example, if I were doing SQLite’s level of testing for a low-reliability, low-traffic, state-less web service when a couple of integration tests would do, then that’d be a mistake, but you’d have to know the context to make that call.&lt;/p&gt;
&lt;div class=&quot;notice--info notice--big&quot;&gt;
&lt;p&gt;
&lt;strong&gt;While you’re here:&lt;/strong&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today.
&lt;/p&gt;
&lt;/div&gt;
&lt;section class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&quot;fn1&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;Richard is the creator of SQLite. See my &lt;a href=&quot;https://corecursive.com/066-sqlite-with-richard-hipp/#billions-of-tests&quot;&gt;interview&lt;/a&gt; with him for a discussion of his testing approach.&lt;a href=&quot;#fnref1&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn2&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;&lt;strong&gt;Article Update:&lt;/strong&gt; Apparently I’ve unintentionally stolen this idiot to maniac spectrum idea from &lt;a href=&quot;https://www.youtube.com/watch?v=XWPCE2tTLZQ&quot;&gt;George Carlin&lt;/a&gt;. Thanks to tjones21xx on Reddit for pointing this out. All credit for this idea goes to Carlin.&lt;a href=&quot;#fnref2&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn3&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;Personal and team familiarity can also be part of the context. PHP may not seem to be the best choice for building a command-line tool, but if it’s a small tool used by a team of PHP developers, then it might be the best choice.&lt;a href=&quot;#fnref3&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;</content><author><name>Adam Gordon Bell</name></author><category term="Articles" /><summary type="html">Observability If you do software-as-a-service development and you have paying customers, you at some point learn about the need for operational monitoring and observability. Personally, I went through a process something like this: Service has some basic logging and an uptime alert. Service has a health-check endpoint, is deployed in triplicate behind a load balancer. Logs are real-time shipped to Splunk / ELK Stack. Metrics set up in Datadog / Prometheus with paging. Distributed Tracing set up for debugging across services. And so on. Each step requires more work to set up and has some additional benefits. I moved through each step by necessity as my service handled more requests and became more important to customers. If you had shown step-1-me what a simple REST service looks like in step 5, I would have been shocked. The metrics counters and distributed tracing spans, and various operational concerns make the service more complex. I would have thought that whoever wrote the service was obsessed with operational issues, to the detriment of solving the problems at hand. I would have thought the service author was an observability maniac. On the other hand, if step-5-me were to get paged because a service written by step-1-me was down, he would not be happy. He would have a hard time figuring out what was wrong, and he’d be pretty sure the service author was an idiot who had never been paged in the middle of the night. It reminds me a lot of driving when it first snows here in Peterborough. Driving In the winter, in Peterborough, we get snow. It’s just a fact of life, and people learn how to drive in snowy conditions. But on the first substantial snowfall of the year, people struggle to remember how to drive. Some will drive way below the speed limit and slow down traffic for everyone. They are idiots in the snow. Others get frustrated by the slow drivers and go too fast for the road conditions. Don’t they know there is snow on the road? Everyone driving slower than me is an idiot, but everyone going faster than me is a maniac. So it is with software development. Everyone who takes an idea further than I have is a maniac, and people who haven’t taken it as far as me are idiots. Testing There was a time when I thought all code should have 80% unit test code coverage as a minimum. Anything less was practically unethical, and if you didn’t think so, then you hadn’t read Clean Code™️ enough times. On the other hand, Richard Hipp – who tests to 100% code coverage at the machine code level, covering every branch by running billions of tests each release1 – is a testing maniac. I hope you see where I’m going. This idiot to maniac gradient feels right, but it makes no sense2. How can I be the only the person driving the right speed? Wherever you find yourself along the spectrum is more a reflection of the context in which you work than anything else. More Examples Here are some made-up and exaggerated examples: Typescript Developer: JavaScript developers are idiots. Don’t they know how many bugs the type system could have caught for them. Typescript Developer: Elm developers are obsessed with types. They are maniacs about using types to catch things at compile time. Go Developer: The JVM is such a heavyweight runtime and uses so much memory. Go Developer: Rust is so complex! Who wants to manage memory manually. Use a GC, you maniacs! Kotlin Developer: Java is so verbose and ugly. Welcome to 2021. Kotlin has a lot of sugar and type improvements that make writing correct code simpler. Kotlin Developer: Scala is for maniacs. There is so much syntactic sugar and type stuff that it’s not worth learning about. I’m not trying to pick on any of these languages - Typescript, Go, and Kotlin are exceptionally well suited to their niche. But contexts vary3, and it takes mental effort to see that people making other trade-offs sometimes have good reasons for it. That doesn’t mean that other people are never wrong, though. People choose the wrong tool for the job all the time. For example, if I were doing SQLite’s level of testing for a low-reliability, low-traffic, state-less web service when a couple of integration tests would do, then that’d be a mistake, but you’d have to know the context to make that call. While you’re here: Earthly is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today. Richard is the creator of SQLite. See my interview with him for a discussion of his testing approach.↩︎ Article Update: Apparently I’ve unintentionally stolen this idiot to maniac spectrum idea from George Carlin. Thanks to tjones21xx on Reddit for pointing this out. All credit for this idea goes to Carlin.↩︎ Personal and team familiarity can also be part of the context. PHP may not seem to be the best choice for building a command-line tool, but if it’s a small tool used by a team of PHP developers, then it might be the best choice.↩︎</summary></entry><entry><title type="html">Building in Visual Studio Code with a Makefile</title><link href="https://earthly.dev/blog/vscode-make/" rel="alternate" type="text/html" title="Building in Visual Studio Code with a Makefile" /><published>2021-07-28T00:00:00-04:00</published><updated>2021-07-28T00:00:00-04:00</updated><id>https://earthly.dev/blog/vscode-make</id><content type="html" xml:base="https://earthly.dev/blog/vscode-make/">&lt;p&gt;Microsoft announced &lt;a href=&quot;https://devblogs.microsoft.com/cppblog/now-announcing-makefile-support-in-visual-studio-code/&quot;&gt;recently&lt;/a&gt; a new Visual Studio Code extension to handle Makefiles. This extension provides a set of commands to the editor that will facilitate working with projects that rely on a Makefile to speed up the build.&lt;/p&gt;
&lt;p&gt;In this tutorial, you’ll set up a simple C++ project that depends on a well-known Python library to produce some sample charts. This is not a deep tutorial about &lt;a href=&quot;/blog/g++-makefile/&quot;&gt;make and Makefiles&lt;/a&gt;, but to get the most out of the extension you will need to have some concepts clear.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Make&lt;/em&gt; is one of the most used tools to build software projects, for good reason:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;You can get an implementation for almost any major operating system (POSIX/Windows/MacOS)&lt;/li&gt;
&lt;li&gt;It’s technology agnostic. You can use it to build projects on any programming language (here’s an example for &lt;a href=&quot;https://medium.com/lithictech/makefile-javascript-26731fb26867&quot;&gt;JavaScript&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Its task runner capabilities provide a multipurpose tool for almost any task.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A &lt;em&gt;Makefile&lt;/em&gt; is a simple text file that defines rules to be executed. The usual purpose for Makefile in C++ projects is to recompile and link necessary files based on the modifications done to dependencies. However, Makefile and make are far more useful than that. The rules defined in a Makefile combine concepts like:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Shell scripting&lt;/li&gt;
&lt;li&gt;Regular expressions&lt;/li&gt;
&lt;li&gt;Target notation&lt;/li&gt;
&lt;li&gt;Project structure&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To illustrate this power, the &lt;a href=&quot;https://github.com/nickmancol/vscode_makefile&quot;&gt;sample project&lt;/a&gt; contains a single C++ source code file. The source code for the example is pretty simple —- it flips a coin as many times as the &lt;code&gt;iters&lt;/code&gt; argument is passed, and then prints the number of heads and tails counted from each flip.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode cpp&quot;&gt;&lt;code class=&quot;sourceCode cpp&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;cstdlib&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;assert.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-6&quot;&gt;&lt;a href=&quot;#cb1-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;time.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;pp&quot;&gt;  &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-7&quot;&gt;&lt;a href=&quot;#cb1-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-8&quot;&gt;&lt;a href=&quot;#cb1-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; flip_coins&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; iters&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-9&quot;&gt;&lt;a href=&quot;#cb1-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  srand &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;time&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;NULL&lt;span class=&quot;op&quot;&gt;));&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-10&quot;&gt;&lt;a href=&quot;#cb1-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; heads&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; tails &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-11&quot;&gt;&lt;a href=&quot;#cb1-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-12&quot;&gt;&lt;a href=&quot;#cb1-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; i&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;i &lt;span class=&quot;op&quot;&gt;&amp;lt;&lt;/span&gt; iters&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;i&lt;span class=&quot;op&quot;&gt;++){&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-13&quot;&gt;&lt;a href=&quot;#cb1-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;   &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;rand&lt;span class=&quot;op&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;?&lt;/span&gt; heads&lt;span class=&quot;op&quot;&gt;++&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;:&lt;/span&gt; tails&lt;span class=&quot;op&quot;&gt;++;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-14&quot;&gt;&lt;a href=&quot;#cb1-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-15&quot;&gt;&lt;a href=&quot;#cb1-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  printf&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; Heads, &lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; Tails&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;heads&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; tails&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-16&quot;&gt;&lt;a href=&quot;#cb1-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; abs&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;tails&lt;span class=&quot;op&quot;&gt;-&lt;/span&gt;heads&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-17&quot;&gt;&lt;a href=&quot;#cb1-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-18&quot;&gt;&lt;a href=&quot;#cb1-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-19&quot;&gt;&lt;a href=&quot;#cb1-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; main&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; argc&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; argv&lt;span class=&quot;op&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-20&quot;&gt;&lt;a href=&quot;#cb1-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;ot&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;argc &lt;span class=&quot;op&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-21&quot;&gt;&lt;a href=&quot;#cb1-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; iters &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; atoi&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;argv&lt;span class=&quot;op&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;]);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-22&quot;&gt;&lt;a href=&quot;#cb1-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; diff &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; flip_coins&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;iters&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-23&quot;&gt;&lt;a href=&quot;#cb1-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;lt;&lt;/span&gt; iters&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-24&quot;&gt;&lt;a href=&quot;#cb1-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      printf&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;With enough trials Heads should be equal to Tails&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-25&quot;&gt;&lt;a href=&quot;#cb1-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-26&quot;&gt;&lt;a href=&quot;#cb1-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This code will be compiled and linked with a simple Makefile that also will provide a couple of other standard rules for cleaning the compiled code and run a simple test.&lt;/p&gt;
&lt;h2 id=&quot;creating-c-projects-with-vs-code&quot;&gt;Creating C++ Projects with VS Code&lt;/h2&gt;
&lt;p&gt;The &lt;a href=&quot;https://marketplace.visualstudio.com/items?itemName=ms-vscode.makefile-tools&quot;&gt;VS Code extension &lt;strong&gt;Makefile Tools&lt;/strong&gt;&lt;/a&gt; is still in preview but is actively developed. The installation process is similar to any other extension in VS Code:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9360.png&quot; alt=&quot;Makefile VSCode extension&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Makefile VSCode extension&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;After installing the extension, verify the availability of the &lt;code&gt;make&lt;/code&gt; command in the system.&lt;/p&gt;
&lt;p&gt;The most common implementation is &lt;a href=&quot;https://www.gnu.org/software/make/&quot;&gt;GNU Make&lt;/a&gt;, which includes some non-standard extensions. If your installation of &lt;code&gt;make&lt;/code&gt; is not available in the default path, you can configure it in VS Code at &lt;strong&gt;File &amp;gt; Preferences &amp;gt; Settings &amp;gt; Extensions makefile&lt;/strong&gt;.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9380.png&quot; alt=&quot;Make path&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Make path&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;To compile and link the project, you can add a Makefile to the root of the project folder. It will be detected automatically by the extension. If you have a different structure, with a Makefile in another location, you can configure it at &lt;strong&gt;File &amp;gt; Preferences &amp;gt; Settings &amp;gt; Extensions &amp;gt; makefile&lt;/strong&gt;.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9450.png&quot; alt=&quot;Makefile path&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Makefile path&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;This sample Makefile defines five simple rules:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;all&lt;/code&gt;: Cleans the compiled files from the target folder, then compiles and run the test code.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;default&lt;/code&gt;: Delegates to &lt;code&gt;CoinFlipper.cpp&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CoinFlipper.cpp&lt;/code&gt;: Compiles the single source file.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;test&lt;/code&gt;: Delegates to &lt;code&gt;CoinFlipper.cpp&lt;/code&gt;, then runs the output main function passing an argument.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;clean&lt;/code&gt;: Deletes compiled files.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-2&quot;&gt;&lt;a href=&quot;#cb2-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# A simple makefile for compiling a c++ project&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-3&quot;&gt;&lt;a href=&quot;#cb2-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-4&quot;&gt;&lt;a href=&quot;#cb2-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;SRC&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;./src&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-5&quot;&gt;&lt;a href=&quot;#cb2-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;TARGET&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;./target&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-6&quot;&gt;&lt;a href=&quot;#cb2-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;GCC &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; g++&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-7&quot;&gt;&lt;a href=&quot;#cb2-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;CFLAGS &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; -o &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;TARGET&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;/CoinFlipper.out&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-8&quot;&gt;&lt;a href=&quot;#cb2-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;ARGS &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; 101&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-9&quot;&gt;&lt;a href=&quot;#cb2-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;RM &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; rm -rf&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-10&quot;&gt;&lt;a href=&quot;#cb2-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-11&quot;&gt;&lt;a href=&quot;#cb2-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;all:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; clean default test&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-12&quot;&gt;&lt;a href=&quot;#cb2-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-13&quot;&gt;&lt;a href=&quot;#cb2-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;default:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; CoinFlipper.cpp&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-14&quot;&gt;&lt;a href=&quot;#cb2-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-15&quot;&gt;&lt;a href=&quot;#cb2-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;CoinFlipper.cpp:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-16&quot;&gt;&lt;a href=&quot;#cb2-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;GCC&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;CFLAGS&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;SRC&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;/main/CoinFlipper.cpp&lt;/span&gt;
&lt;span id=&quot;cb2-17&quot;&gt;&lt;a href=&quot;#cb2-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-18&quot;&gt;&lt;a href=&quot;#cb2-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;test:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; CoinFlipper.cpp&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-19&quot;&gt;&lt;a href=&quot;#cb2-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;TARGET&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;/CoinFlipper.out &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;ARGS&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-20&quot;&gt;&lt;a href=&quot;#cb2-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-21&quot;&gt;&lt;a href=&quot;#cb2-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;clean:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-22&quot;&gt;&lt;a href=&quot;#cb2-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;RM&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;TARGET&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;/*.out&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The Makefile Tools Extension provides a new “perspective” to the Visual Studio Code IDE. This contains three different commands and three different project configurations to run the Makefile:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9480.png&quot; alt=&quot;Makefile tools perspective&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Makefile tools perspective&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The &lt;code&gt;Configuration:[Default]&lt;/code&gt; refers to the make command configurations defined in the &lt;code&gt;.vscode/settings.json&lt;/code&gt; file. This configuration is used to pass arguments to the make utility.&lt;/p&gt;
&lt;p&gt;In the following example, two configurations are defined:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Default&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Print make version&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;Print make versions&lt;/code&gt; adds the &lt;code&gt;--version&lt;/code&gt; argument to the make utility every time the project is built using the Makefile extension. This argument is not especially useful but you can explore different arguments to fit your case.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;dt&quot;&gt;&amp;quot;makefile.configurations&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;     &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-4&quot;&gt;&lt;a href=&quot;#cb3-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;         &lt;span class=&quot;dt&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Default&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-5&quot;&gt;&lt;a href=&quot;#cb3-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;         &lt;span class=&quot;dt&quot;&gt;&amp;quot;makeArgs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;[]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-6&quot;&gt;&lt;a href=&quot;#cb3-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;     &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-7&quot;&gt;&lt;a href=&quot;#cb3-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;     &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-8&quot;&gt;&lt;a href=&quot;#cb3-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;         &lt;span class=&quot;dt&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Print make version&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-9&quot;&gt;&lt;a href=&quot;#cb3-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;         &lt;span class=&quot;dt&quot;&gt;&amp;quot;makeArgs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;--version&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-10&quot;&gt;&lt;a href=&quot;#cb3-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;     &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-11&quot;&gt;&lt;a href=&quot;#cb3-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-12&quot;&gt;&lt;a href=&quot;#cb3-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The second configuration is the default build target rule for the make utility, which is equivalent to running &lt;code&gt;make [target]&lt;/code&gt; directly. The IDE will let show you a list of target rules defined in the Makefile configured for the project:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9540.png&quot; alt=&quot;config build target&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;config build target&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Finally, the third configuration available in the perspective is the &lt;code&gt;Launch target&lt;/code&gt;. This shows you a list of compiled files that can be run from the perspective using the commands &lt;code&gt;Debug&lt;/code&gt; and &lt;code&gt;Run&lt;/code&gt;. This is useful if you want to debug your source code with GDB or LLDB debuggers.&lt;/p&gt;
&lt;p&gt;In this example, the only file runnable is &lt;code&gt;CoinFlipper.out&lt;/code&gt;, compiled from the source code.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9560.png&quot; alt=&quot;make launch target&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;make launch target&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The commands in the Makefile are self-explanatory:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Build&lt;/code&gt; runs make with the target configured previously.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;all&lt;/code&gt; instead of &lt;code&gt;default&lt;/code&gt; passes no arguments to the make utility.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Debug&lt;/code&gt; and &lt;code&gt;Run in terminal&lt;/code&gt; commands launch the target (&lt;code&gt;CoinFlipper.out&lt;/code&gt; in the example) with/without the debug support.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Once you build the project, the terminal view shows the result of the execution:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Building target &amp;quot;all&amp;quot; with command: &amp;quot;make all&amp;quot;
rm -rf ./target/*.out
g++ -o ./target/CoinFlipper.out ./src/main/CoinFlipper.cpp
./target/CoinFlipper.out 101
50 Heads, 51 Tails
With enough trials Heads should be equal to Tails
Target all built successfully.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As you can see from the previous image, the target was built successfully after cleaning, compiling, and running the compiled program. The extension also provides commands to run other targets easily without changing the configurations in the perspective.&lt;/p&gt;
&lt;p&gt;The following image shows the commands available for the Makefile in the sample project:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9630.png&quot; alt=&quot;The makefile commands palette.&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;The makefile commands palette.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;building-complex-projects&quot;&gt;Building Complex Projects&lt;/h2&gt;
&lt;p&gt;Makefiles are more complex than this. Many projects have several levels of dependencies, configurations, and quirks that make supports easily. For example, the &lt;a href=&quot;https://github.com/FFmpeg/FFmpeg&quot;&gt;FFmpeg&lt;/a&gt; project is a collection of libraries to work with audio, video, and subtitles among other utilities. To build it, you can download the source from GitHub and examine the Makefile:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9680.png&quot; alt=&quot;The makefile for FFmpeg.&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;The makefile for FFmpeg.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The &lt;a href=&quot;https://trac.ffmpeg.org/wiki/CompilationGuide/Generic&quot;&gt;developer documentation&lt;/a&gt; for the project states that before building the source code with the provided Makefile, you need to run the &lt;a href=&quot;/blog/autoconf/&quot;&gt;&lt;code&gt;configure&lt;/code&gt;&lt;/a&gt; script located at the root of the project’s source code. Fortunately, the Makefile Tools Extension provides a setting to define the preconfiguration files required to run before executing the make commands, again in &lt;strong&gt;File &amp;gt; Preferences &amp;gt; Settings&lt;/strong&gt;.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9730.png&quot; alt=&quot;The makefile preconfiguration.&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;The makefile preconfiguration.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;In the &lt;strong&gt;Commands&lt;/strong&gt; section of the Makefile Tools Extension perspective, you can run the preconfigure command. This will run the configure script, and then you’re ready to experiment with the Makefile through the extension.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Large codebase projects need a build system to keep them under the development team’s control, and Makefiles are one the most ubiquitous and flexible ways to define building these complex software projects.&lt;/p&gt;
&lt;p&gt;With the new &lt;a href=&quot;https://marketplace.visualstudio.com/items?itemName=ms-vscode.makefile-tools&quot;&gt;Makefile Tools Extension&lt;/a&gt;, Visual Studio Code greatly simplifies access for new developers. Though it is still tagged as in preview, this extension has been thoroughly tested by the Microsoft Team, building over seventy open-source projects written in different languages (including C, C++, and Python) successfully.&lt;/p&gt;
&lt;p&gt;If you want to learn about the power of make and Makefile, consider checking out the &lt;a href=&quot;https://makefiletutorial.com/#include-makefiles&quot;&gt;Makefile Tutorial&lt;/a&gt;, and if you want the simplicity of a Makefile with the isolation of containers take a look at &lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt;.&lt;/p&gt;</content><author><name>Nicolas Bohorquez</name></author><category term="Tutorials" /><summary type="html">Microsoft announced recently a new Visual Studio Code extension to handle Makefiles. This extension provides a set of commands to the editor that will facilitate working with projects that rely on a Makefile to speed up the build. In this tutorial, you’ll set up a simple C++ project that depends on a well-known Python library to produce some sample charts. This is not a deep tutorial about make and Makefiles, but to get the most out of the extension you will need to have some concepts clear. Make is one of the most used tools to build software projects, for good reason: You can get an implementation for almost any major operating system (POSIX/Windows/MacOS) It’s technology agnostic. You can use it to build projects on any programming language (here’s an example for JavaScript. Its task runner capabilities provide a multipurpose tool for almost any task. A Makefile is a simple text file that defines rules to be executed. The usual purpose for Makefile in C++ projects is to recompile and link necessary files based on the modifications done to dependencies. However, Makefile and make are far more useful than that. The rules defined in a Makefile combine concepts like: Shell scripting Regular expressions Target notation Project structure To illustrate this power, the sample project contains a single C++ source code file. The source code for the example is pretty simple —- it flips a coin as many times as the iters argument is passed, and then prints the number of heads and tails counted from each flip. #include &amp;lt;cstdio&amp;gt; #include &amp;lt;cstdlib&amp;gt; #include &amp;lt;stdlib.h&amp;gt; #include &amp;lt;assert.h&amp;gt; #include &amp;lt;time.h&amp;gt; int flip_coins(int iters) { srand (time(NULL)); int heads, tails = 0; for(int i=0;i &amp;lt; iters;i++){ (rand() % 10 + 1) &amp;lt;= 5 ? heads++ : tails++; } printf(&amp;quot;%d Heads, %d Tails\n&amp;quot;,heads, tails); return abs(tails-heads); } int main(int argc,char* argv[]) { assert (argc == 2); int iters = atoi(argv[1]); int diff = flip_coins(iters); if(100 &amp;lt; iters) { printf(&amp;quot;With enough trials Heads should be equal to Tails\n&amp;quot;); } } This code will be compiled and linked with a simple Makefile that also will provide a couple of other standard rules for cleaning the compiled code and run a simple test. Creating C++ Projects with VS Code The VS Code extension Makefile Tools is still in preview but is actively developed. The installation process is similar to any other extension in VS Code: Makefile VSCode extension After installing the extension, verify the availability of the make command in the system. The most common implementation is GNU Make, which includes some non-standard extensions. If your installation of make is not available in the default path, you can configure it in VS Code at File &amp;gt; Preferences &amp;gt; Settings &amp;gt; Extensions makefile. Make path To compile and link the project, you can add a Makefile to the root of the project folder. It will be detected automatically by the extension. If you have a different structure, with a Makefile in another location, you can configure it at File &amp;gt; Preferences &amp;gt; Settings &amp;gt; Extensions &amp;gt; makefile. Makefile path This sample Makefile defines five simple rules: all: Cleans the compiled files from the target folder, then compiles and run the test code. default: Delegates to CoinFlipper.cpp. CoinFlipper.cpp: Compiles the single source file. test: Delegates to CoinFlipper.cpp, then runs the output main function passing an argument. clean: Deletes compiled files. # # A simple makefile for compiling a c++ project # SRC=./src TARGET=./target GCC = g++ CFLAGS = -o $(TARGET)/CoinFlipper.out ARGS = 101 RM = rm -rf all: clean default test default: CoinFlipper.cpp CoinFlipper.cpp: $(GCC) $(CFLAGS) $(SRC)/main/CoinFlipper.cpp test: CoinFlipper.cpp $(TARGET)/CoinFlipper.out $(ARGS) clean: $(RM) $(TARGET)/*.out The Makefile Tools Extension provides a new “perspective” to the Visual Studio Code IDE. This contains three different commands and three different project configurations to run the Makefile: Makefile tools perspective The Configuration:[Default] refers to the make command configurations defined in the .vscode/settings.json file. This configuration is used to pass arguments to the make utility. In the following example, two configurations are defined: Default Print make version Print make versions adds the --version argument to the make utility every time the project is built using the Makefile extension. This argument is not especially useful but you can explore different arguments to fit your case. { &amp;quot;makefile.configurations&amp;quot;: [ { &amp;quot;name&amp;quot;: &amp;quot;Default&amp;quot;, &amp;quot;makeArgs&amp;quot;: [] }, { &amp;quot;name&amp;quot;: &amp;quot;Print make version&amp;quot;, &amp;quot;makeArgs&amp;quot;: [&amp;quot;--version&amp;quot;] } ] } The second configuration is the default build target rule for the make utility, which is equivalent to running make [target] directly. The IDE will let show you a list of target rules defined in the Makefile configured for the project: config build target Finally, the third configuration available in the perspective is the Launch target. This shows you a list of compiled files that can be run from the perspective using the commands Debug and Run. This is useful if you want to debug your source code with GDB or LLDB debuggers. In this example, the only file runnable is CoinFlipper.out, compiled from the source code. make launch target The commands in the Makefile are self-explanatory: Build runs make with the target configured previously. all instead of default passes no arguments to the make utility. Debug and Run in terminal commands launch the target (CoinFlipper.out in the example) with/without the debug support. Once you build the project, the terminal view shows the result of the execution: Building target &amp;quot;all&amp;quot; with command: &amp;quot;make all&amp;quot; rm -rf ./target/*.out g++ -o ./target/CoinFlipper.out ./src/main/CoinFlipper.cpp ./target/CoinFlipper.out 101 50 Heads, 51 Tails With enough trials Heads should be equal to Tails Target all built successfully. As you can see from the previous image, the target was built successfully after cleaning, compiling, and running the compiled program. The extension also provides commands to run other targets easily without changing the configurations in the perspective. The following image shows the commands available for the Makefile in the sample project: The makefile commands palette. Building Complex Projects Makefiles are more complex than this. Many projects have several levels of dependencies, configurations, and quirks that make supports easily. For example, the FFmpeg project is a collection of libraries to work with audio, video, and subtitles among other utilities. To build it, you can download the source from GitHub and examine the Makefile: The makefile for FFmpeg. The developer documentation for the project states that before building the source code with the provided Makefile, you need to run the configure script located at the root of the project’s source code. Fortunately, the Makefile Tools Extension provides a setting to define the preconfiguration files required to run before executing the make commands, again in File &amp;gt; Preferences &amp;gt; Settings. The makefile preconfiguration. In the Commands section of the Makefile Tools Extension perspective, you can run the preconfigure command. This will run the configure script, and then you’re ready to experiment with the Makefile through the extension. Conclusion Large codebase projects need a build system to keep them under the development team’s control, and Makefiles are one the most ubiquitous and flexible ways to define building these complex software projects. With the new Makefile Tools Extension, Visual Studio Code greatly simplifies access for new developers. Though it is still tagged as in preview, this extension has been thoroughly tested by the Microsoft Team, building over seventy open-source projects written in different languages (including C, C++, and Python) successfully. If you want to learn about the power of make and Makefile, consider checking out the Makefile Tutorial, and if you want the simplicity of a Makefile with the isolation of containers take a look at Earthly.</summary></entry><entry><title type="html">Using Continuous Testing in DevOps Workflows</title><link href="https://earthly.dev/blog/continuous-testing-in-devops/" rel="alternate" type="text/html" title="Using Continuous Testing in DevOps Workflows" /><published>2021-07-27T00:00:00-04:00</published><updated>2021-07-27T00:00:00-04:00</updated><id>https://earthly.dev/blog/continuous-testing-in-devops</id><content type="html" xml:base="https://earthly.dev/blog/continuous-testing-in-devops/">&lt;p&gt;Automation testing is a crucial element to speed up your delivery process. It aims to flush out any potential regressions. The more you automate, the more confidence you gain in the quality of your software because the quality of each release of your application or library is measurable. Additionally, you reduce costs and save time and effort by reducing manual testing.&lt;/p&gt;
&lt;p&gt;The caveat is that automated tests have no value if they are not executed regularly alongside your continuous integration (CI) pipeline. CI refers to frequently merging developer code changes and building and creating an artifact that can later be tested and deployed.&lt;/p&gt;
&lt;p&gt;Extending the CI process by adding automated tests is referred to as continuous testing (CT). CT enables you to apply the fail-fast principle. You test each code change, build, and deployment against several layers of automated tests. Thus, it results in rapid feedback on the quality of your product and the state of the development process.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/actions&quot;&gt;GitHub Actions&lt;/a&gt; is a great first step for implementing CT. It’s flexible and powerful enough to bring every step of the CI/CT process into a single place. Your application, tests, and workflow configuration lives with your code in your repository. Furthermore, the learning curve for GitHub Actions is relatively smooth thanks to the &lt;a href=&quot;https://github.com/marketplace?type=actions&quot;&gt;Marketplace&lt;/a&gt; that provides thousands of Actions ready to use out of the box.&lt;/p&gt;
&lt;h2 id=&quot;what-does-it-take-to-implement-continuous-testing&quot;&gt;What Does It Take to Implement Continuous Testing?&lt;/h2&gt;
&lt;p&gt;A good CI/CT process always contains at least the following steps:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Build&lt;/li&gt;
&lt;li&gt;Deployment&lt;/li&gt;
&lt;li&gt;Integration tests&lt;/li&gt;
&lt;li&gt;End-to-end tests&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In this tutorial, you will implement these four steps using GitHub Actions, as well as add performance tests.&lt;/p&gt;
&lt;p&gt;The Build steps include code compilation and unit tests. Also, note that it’s convenient to deploy your application in a &lt;code&gt;dev&lt;/code&gt; environment before running complex tests such as integration and end-to-end. However, you may also run your application in GitHub Actions for test purposes.&lt;/p&gt;
&lt;p&gt;In this article, I assume you’ll deploy to a &lt;code&gt;dev&lt;/code&gt; environment and focus on implementing different types of tests. Here is a visual of the final workflow for this tutorial:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/40nOj1F.png&quot; alt=&quot;Final GitHub Action Workflow&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Final GitHub Action Workflow&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Implementing continuous testing can be challenging. If you are on a team that is new to this fail-fast approach, it may be a frustrating transition. In addition, seeing builds or pipelines failing can be overwhelming at the beginning. I suggest prioritizing fixing tests over focusing on new features. This may also be a significant change.&lt;/p&gt;
&lt;p&gt;To remediate those challenges, you should rely on the five DevOps principles described by &lt;a href=&quot;https://twitter.com/jezhumble&quot;&gt;Jez Humble&lt;/a&gt; in &lt;em&gt;The DevOps Handbook&lt;/em&gt;:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Culture&lt;/li&gt;
&lt;li&gt;Automate&lt;/li&gt;
&lt;li&gt;Lean&lt;/li&gt;
&lt;li&gt;Measure&lt;/li&gt;
&lt;li&gt;Sharing&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Implementing continuous testing is first a change in &lt;strong&gt;culture&lt;/strong&gt;. Selecting the right tools for CI/CT can greatly improve collaboration.&lt;/p&gt;
&lt;p&gt;Keep your process &lt;strong&gt;lean&lt;/strong&gt;. Testing should not slow down your process. Instead, select the right amount of tests at the right time in the process. Monitor your &lt;a href=&quot;https://docs.github.com/en/actions/managing-workflow-runs/viewing-job-execution-time&quot;&gt;job execution time&lt;/a&gt;, prefer small tasks that can fail fast, and provide rapid feedback instead of long-running ones.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Automate&lt;/strong&gt; as much and as early as possible because it helps validate that the integration is successful. Delaying test implementation is counterproductive.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Measure&lt;/strong&gt; your improvement and build a baseline for the quality of your software. For example, collect your code coverage, number of successful vs. failed tests, and performance metric.&lt;/p&gt;
&lt;p&gt;Don’t forget to encourage knowledge &lt;strong&gt;sharing&lt;/strong&gt;. Test automation is not a single person’s job: everyone on the team should know how the test suites work and learn how to fix simple errors when the workflows fail.&lt;/p&gt;
&lt;h2 id=&quot;implementing-cict-with-github-actions&quot;&gt;Implementing CI/CT With GitHub Actions&lt;/h2&gt;
&lt;p&gt;Now that you know the basics of CT, it’s time to see how to implement the first step by creating a GitHub Actions workflow that builds and runs your unit tests.&lt;/p&gt;
&lt;h3 id=&quot;build-a-github-actions-workflow-with-unit-tests&quot;&gt;Build a GitHub Actions Workflow with Unit Tests&lt;/h3&gt;
&lt;p&gt;The first thing you need to get started is an initial workflow. If you already committed your application to a GitHub repository, click &lt;strong&gt;Actions&lt;/strong&gt;. GitHub will automatically select and recommend a simple workflow that best suits your language.&lt;/p&gt;
&lt;p&gt;Select one of them by clicking &lt;strong&gt;Set up this workflow&lt;/strong&gt;, review the workflow steps, and commit.&lt;/p&gt;
&lt;p&gt;Right away, you should see your workflow starting to build and test your application. Many starting workflows also include linting that validates the formatting and detects potential errors.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/043P3GAA.png&quot; alt=&quot;Get Started with GitHub Action Workflow&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Get Started with GitHub Action Workflow&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;A GitHub Actions workflow contains three elements:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Triggers&lt;/strong&gt; (&lt;code&gt;on&lt;/code&gt;) specify when the workflow must be executed. The most common use case is to run a workflow on &lt;a href=&quot;https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions#on&quot;&gt;push and pull-request on the &lt;code&gt;main&lt;/code&gt; branch&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Jobs&lt;/strong&gt; determine sets of actions composing your pipeline and are executed in parallel unless dependencies between jobs are specified.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Steps&lt;/strong&gt; are the individual components of a job and can be of two types: &lt;code&gt;Scripts&lt;/code&gt; or &lt;code&gt;Actions&lt;/code&gt;. Steps defining a &lt;code&gt;run&lt;/code&gt; attribute execute a command on the host defined by &lt;code&gt;runs-on&lt;/code&gt; at the beginning of a job. Steps containing &lt;code&gt;uses&lt;/code&gt; execute an &lt;a href=&quot;https://docs.github.com/en/actions/creating-actions&quot;&gt;Action&lt;/a&gt;, a reusable automation script.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It’s straightforward to extend a workflow once you understand those three concepts. Here’s a sample workflow for a Python application:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode yaml&quot;&gt;&lt;code class=&quot;sourceCode yaml&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Python application&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;pull_request&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; main &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-6&quot;&gt;&lt;a href=&quot;#cb1-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-7&quot;&gt;&lt;a href=&quot;#cb1-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-8&quot;&gt;&lt;a href=&quot;#cb1-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-9&quot;&gt;&lt;a href=&quot;#cb1-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-10&quot;&gt;&lt;a href=&quot;#cb1-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ubuntu-latest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-11&quot;&gt;&lt;a href=&quot;#cb1-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-12&quot;&gt;&lt;a href=&quot;#cb1-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-13&quot;&gt;&lt;a href=&quot;#cb1-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/checkout@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-14&quot;&gt;&lt;a href=&quot;#cb1-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Set up Python 3.9&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-15&quot;&gt;&lt;a href=&quot;#cb1-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/setup-python@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-16&quot;&gt;&lt;a href=&quot;#cb1-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-17&quot;&gt;&lt;a href=&quot;#cb1-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;python-version&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fl&quot;&gt;3.9&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-18&quot;&gt;&lt;a href=&quot;#cb1-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Install dependencies&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-19&quot;&gt;&lt;a href=&quot;#cb1-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;      run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;|&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-20&quot;&gt;&lt;a href=&quot;#cb1-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        python -m pip install --upgrade pip&lt;/span&gt;
&lt;span id=&quot;cb1-21&quot;&gt;&lt;a href=&quot;#cb1-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        pip install flake8 pytest&lt;/span&gt;
&lt;span id=&quot;cb1-22&quot;&gt;&lt;a href=&quot;#cb1-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        if [ -f requirements.txt ]; then pip install -r requirements.txt; fi&lt;/span&gt;
&lt;span id=&quot;cb1-23&quot;&gt;&lt;a href=&quot;#cb1-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Lint with flake8&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-24&quot;&gt;&lt;a href=&quot;#cb1-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;      run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;|&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-25&quot;&gt;&lt;a href=&quot;#cb1-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        # stop the build if there are Python syntax errors or undefined names&lt;/span&gt;
&lt;span id=&quot;cb1-26&quot;&gt;&lt;a href=&quot;#cb1-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics&lt;/span&gt;
&lt;span id=&quot;cb1-27&quot;&gt;&lt;a href=&quot;#cb1-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        # exit-zero treats all errors as warnings. The GitHub editor is 127 chars wide&lt;/span&gt;
&lt;span id=&quot;cb1-28&quot;&gt;&lt;a href=&quot;#cb1-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        flake8 . --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics&lt;/span&gt;
&lt;span id=&quot;cb1-29&quot;&gt;&lt;a href=&quot;#cb1-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Test with pytest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-30&quot;&gt;&lt;a href=&quot;#cb1-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;      run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;|&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-31&quot;&gt;&lt;a href=&quot;#cb1-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        pytest&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This what a basic workflow looks like:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/KVnFfF4.png&quot; alt=&quot;Most basic GitHub Actions workflow&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Most basic GitHub Actions workflow&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;add-code-coverage-reports&quot;&gt;Add Code Coverage Reports&lt;/h3&gt;
&lt;p&gt;On GitHub, most users rely on third parties to get coverage reports (such as &lt;a href=&quot;https://www.sonarqube.org/&quot;&gt;SonarQube&lt;/a&gt; or &lt;a href=&quot;https://about.codecov.io/&quot;&gt;Codecov&lt;/a&gt;). Integrating those SaaS into your workflow is simple, thanks to the GitHub Actions Marketplace. Most third parties providing code coverage reports have created an Action to make the integration seamless.&lt;/p&gt;
&lt;p&gt;But let’s not rely on a third party yet. Instead, generate a badge to display in your &lt;code&gt;Readme.md&lt;/code&gt;. You’re putting in place the first step toward tracking code quality.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Edit your existing &lt;code&gt;Test with xxx&lt;/code&gt; step to generate a coverage report.&lt;/li&gt;
&lt;li&gt;Save the coverage report as an artifact. &lt;a href=&quot;https://docs.github.com/en/actions/guides/storing-workflow-data-as-artifacts&quot;&gt;Storing workflow data as artifacts&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Create a new job called &lt;code&gt;gating&lt;/code&gt; and download the coverage report. This job must be executed after &lt;code&gt;build&lt;/code&gt;; therefore, you must declare &lt;code&gt;needs: build&lt;/code&gt; in your configuration.&lt;/li&gt;
&lt;li&gt;Parse the coverage report to extract the coverage value. I provided a small script that does just that.&lt;/li&gt;
&lt;li&gt;Generate the badge and add it to your README. Follow the setup step in the documentation of &lt;a href=&quot;https://github.com/Schneegans/dynamic-badges-action&quot;&gt;schneegans/dynamic-badges-action@v1.1.0&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode yml&quot;&gt;&lt;code class=&quot;sourceCode yaml&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# This workflow will install Python dependencies, run tests, and lint with a single version of Python&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-2&quot;&gt;&lt;a href=&quot;#cb2-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# For more information see: https://help.github.com/actions/language-and-framework-guides/using-python-with-github-actions&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-3&quot;&gt;&lt;a href=&quot;#cb2-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-4&quot;&gt;&lt;a href=&quot;#cb2-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Python application&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-5&quot;&gt;&lt;a href=&quot;#cb2-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-6&quot;&gt;&lt;a href=&quot;#cb2-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-7&quot;&gt;&lt;a href=&quot;#cb2-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-8&quot;&gt;&lt;a href=&quot;#cb2-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; main &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-9&quot;&gt;&lt;a href=&quot;#cb2-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;pull_request&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-10&quot;&gt;&lt;a href=&quot;#cb2-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; main &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-11&quot;&gt;&lt;a href=&quot;#cb2-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-12&quot;&gt;&lt;a href=&quot;#cb2-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-13&quot;&gt;&lt;a href=&quot;#cb2-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-14&quot;&gt;&lt;a href=&quot;#cb2-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ubuntu-latest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-15&quot;&gt;&lt;a href=&quot;#cb2-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-16&quot;&gt;&lt;a href=&quot;#cb2-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/checkout@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-17&quot;&gt;&lt;a href=&quot;#cb2-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Set up Python 3.9&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-18&quot;&gt;&lt;a href=&quot;#cb2-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/setup-python@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-19&quot;&gt;&lt;a href=&quot;#cb2-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-20&quot;&gt;&lt;a href=&quot;#cb2-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;python-version&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fl&quot;&gt;3.9&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-21&quot;&gt;&lt;a href=&quot;#cb2-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Install dependencies&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-22&quot;&gt;&lt;a href=&quot;#cb2-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-23&quot;&gt;&lt;a href=&quot;#cb2-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Lint with flake8&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-24&quot;&gt;&lt;a href=&quot;#cb2-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-25&quot;&gt;&lt;a href=&quot;#cb2-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Test with pytest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-26&quot;&gt;&lt;a href=&quot;#cb2-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;      # Update the command to generate coverage report&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-27&quot;&gt;&lt;a href=&quot;#cb2-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; pytest --cov-report xml --cov=phonebook tests/&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-28&quot;&gt;&lt;a href=&quot;#cb2-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Upload pytest test coverage&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-29&quot;&gt;&lt;a href=&quot;#cb2-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;      # Upload the coverage result as an artifact&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-30&quot;&gt;&lt;a href=&quot;#cb2-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/upload-artifact@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-31&quot;&gt;&lt;a href=&quot;#cb2-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-32&quot;&gt;&lt;a href=&quot;#cb2-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; coverage-results&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-33&quot;&gt;&lt;a href=&quot;#cb2-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; coverage.xml&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-34&quot;&gt;&lt;a href=&quot;#cb2-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;      # Use always() to always run this step to publish test results when there are test failures&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-35&quot;&gt;&lt;a href=&quot;#cb2-35&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ${{ always() }}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-36&quot;&gt;&lt;a href=&quot;#cb2-36&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-37&quot;&gt;&lt;a href=&quot;#cb2-37&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;gating&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-38&quot;&gt;&lt;a href=&quot;#cb2-38&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ubuntu-latest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-39&quot;&gt;&lt;a href=&quot;#cb2-39&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; build&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-40&quot;&gt;&lt;a href=&quot;#cb2-40&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-41&quot;&gt;&lt;a href=&quot;#cb2-41&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-42&quot;&gt;&lt;a href=&quot;#cb2-42&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Download coverage report&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-43&quot;&gt;&lt;a href=&quot;#cb2-43&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/download-artifact@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-44&quot;&gt;&lt;a href=&quot;#cb2-44&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-45&quot;&gt;&lt;a href=&quot;#cb2-45&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; coverage-results&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-46&quot;&gt;&lt;a href=&quot;#cb2-46&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Get the Coverage&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-47&quot;&gt;&lt;a href=&quot;#cb2-47&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; bash&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-48&quot;&gt;&lt;a href=&quot;#cb2-48&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;      run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;|&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-49&quot;&gt;&lt;a href=&quot;#cb2-49&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        regex=&amp;#39;&amp;lt;coverage.+line-rate=&amp;quot;([0-9).[0-9]+)&amp;quot;.+&amp;gt;&amp;#39;&lt;/span&gt;
&lt;span id=&quot;cb2-50&quot;&gt;&lt;a href=&quot;#cb2-50&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        line=$(grep -oP $regex coverage.xml)&lt;/span&gt;
&lt;span id=&quot;cb2-51&quot;&gt;&lt;a href=&quot;#cb2-51&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        [[ $line =~ $regex ]]&lt;/span&gt;
&lt;span id=&quot;cb2-52&quot;&gt;&lt;a href=&quot;#cb2-52&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        coverage=$( bc &amp;lt;&amp;lt;&amp;lt; ${BASH_REMATCH[1]}*100 )&lt;/span&gt;
&lt;span id=&quot;cb2-53&quot;&gt;&lt;a href=&quot;#cb2-53&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        if (( $(echo &amp;quot;$coverage &amp;gt; 80&amp;quot; |bc -l) )); then&lt;/span&gt;
&lt;span id=&quot;cb2-54&quot;&gt;&lt;a href=&quot;#cb2-54&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          COLOR=green&lt;/span&gt;
&lt;span id=&quot;cb2-55&quot;&gt;&lt;a href=&quot;#cb2-55&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        else&lt;/span&gt;
&lt;span id=&quot;cb2-56&quot;&gt;&lt;a href=&quot;#cb2-56&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          COLOR=red&lt;/span&gt;
&lt;span id=&quot;cb2-57&quot;&gt;&lt;a href=&quot;#cb2-57&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        fi&lt;/span&gt;
&lt;span id=&quot;cb2-58&quot;&gt;&lt;a href=&quot;#cb2-58&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        echo &amp;quot;COVERAGE=${coverage%.*}%&amp;quot; &amp;gt;&amp;gt; $GITHUB_ENV&lt;/span&gt;
&lt;span id=&quot;cb2-59&quot;&gt;&lt;a href=&quot;#cb2-59&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        echo &amp;quot;COLOR=$COLOR&amp;quot; &amp;gt;&amp;gt; $GITHUB_ENV&lt;/span&gt;
&lt;span id=&quot;cb2-60&quot;&gt;&lt;a href=&quot;#cb2-60&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Create the Badge&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-61&quot;&gt;&lt;a href=&quot;#cb2-61&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;      # save the badge configuration in a Gist&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-62&quot;&gt;&lt;a href=&quot;#cb2-62&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; schneegans/dynamic-badges-action@v1.1.0&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-63&quot;&gt;&lt;a href=&quot;#cb2-63&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-64&quot;&gt;&lt;a href=&quot;#cb2-64&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;auth&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ${{ secrets.GIST_SECRET }}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-65&quot;&gt;&lt;a href=&quot;#cb2-65&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;gistID&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ab3bde9504060bd1feb361555e79f51d&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-66&quot;&gt;&lt;a href=&quot;#cb2-66&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; coverage.json&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-67&quot;&gt;&lt;a href=&quot;#cb2-67&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; coverage&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-68&quot;&gt;&lt;a href=&quot;#cb2-68&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ${{ env.COVERAGE }}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-69&quot;&gt;&lt;a href=&quot;#cb2-69&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ${{ env.COLOR }}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is what your updated workflow looks like:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/1626877878.png&quot; alt=&quot;GitHub Action workflow including code coverage badge&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;GitHub Action workflow including code coverage badge&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;And you got a badge to decorate your &lt;code&gt;readme.md&lt;/code&gt;.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/1626878146.png&quot; alt=&quot;GitHub code coverage badge&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;GitHub code coverage badge&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;extending-ct-with-other-types-of-testing&quot;&gt;Extending CT with Other Types of Testing&lt;/h2&gt;
&lt;p&gt;You have a basic CI workflow that includes unit tests and coverage reports. Now to obtain an excellent CT workflow, you need to expand with more layers of tests. You will add three new jobs:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;For API testing,&lt;/li&gt;
&lt;li&gt;For end-to-end testing&lt;/li&gt;
&lt;li&gt;For performance testing&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;add-api-testing&quot;&gt;Add API Testing&lt;/h3&gt;
&lt;p&gt;API testing is part of &lt;a href=&quot;/blog/unit-vs-integration&quot;&gt;integration testing&lt;/a&gt;. Integration testing aims to determine whether individual units meet your requirement when combined together. When performing integration testing, you target the boundary (or interfaces) of your system. In this specific case, you are aiming your test at a RESTful API. Having API tests ensures that sets of functionality meet your requirement and validates that your web server and connection to a database works properly.&lt;/p&gt;
&lt;p&gt;While you could write an API test in the same language as your application, you should also consider a tool like &lt;a href=&quot;https://blog.scottlogic.com/2020/02/04/GraduateGuideToAPITesting.html&quot;&gt;Postman/Newman&lt;/a&gt;. Postman lets you define a sequence of HTTPS calls and validate each of them using their JavaScript test framework. This makes it easy to share integration test suites. Other developers can use them to facilitate their development process, for instance, mobile developers working with a different stack than backend developers. Newman is the command-line interface that lets you run the Postman tests.&lt;/p&gt;
&lt;p&gt;Now that you have selected an API testing framework go to GitHub &lt;a href=&quot;https://github.com/marketplace?type=actions&quot;&gt;Actions Marketplace&lt;/a&gt; and look for an Action that meets your demands. For instance, &lt;a href=&quot;https://github.com/marketplace/actions/newman-action&quot;&gt;Newman Action&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Now edit your workflow configuration:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Add a new job that must be executed after the deployment using &lt;code&gt;needs: deploy&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Define the steps of your job:
&lt;ul&gt;
&lt;li&gt;Check out your repository using the Action &lt;code&gt;actions/checkout@master&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Run Newman using the Action you just found in the Marketplace.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Move the gating job at the end of the workflow by changing the &lt;code&gt;needs&lt;/code&gt; property.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode yaml&quot;&gt;&lt;code class=&quot;sourceCode yaml&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Python application&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-4&quot;&gt;&lt;a href=&quot;#cb3-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-5&quot;&gt;&lt;a href=&quot;#cb3-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; main &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-6&quot;&gt;&lt;a href=&quot;#cb3-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-7&quot;&gt;&lt;a href=&quot;#cb3-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-8&quot;&gt;&lt;a href=&quot;#cb3-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-9&quot;&gt;&lt;a href=&quot;#cb3-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-10&quot;&gt;&lt;a href=&quot;#cb3-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;deploy&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-11&quot;&gt;&lt;a href=&quot;#cb3-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;co&quot;&gt; # our deployment steps&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-12&quot;&gt;&lt;a href=&quot;#cb3-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;tests_api&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-13&quot;&gt;&lt;a href=&quot;#cb3-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; deploy&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-14&quot;&gt;&lt;a href=&quot;#cb3-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ubuntu-latest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-15&quot;&gt;&lt;a href=&quot;#cb3-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-16&quot;&gt;&lt;a href=&quot;#cb3-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/checkout@master&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-17&quot;&gt;&lt;a href=&quot;#cb3-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; matt-ball/newman-action@master&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-18&quot;&gt;&lt;a href=&quot;#cb3-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-19&quot;&gt;&lt;a href=&quot;#cb3-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;collection&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; tests_integration/postman_collection.json&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-20&quot;&gt;&lt;a href=&quot;#cb3-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;environment&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; tests_integration/postman_environment.json&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-21&quot;&gt;&lt;a href=&quot;#cb3-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;gating&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-22&quot;&gt;&lt;a href=&quot;#cb3-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; tests_api&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-23&quot;&gt;&lt;a href=&quot;#cb3-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;co&quot;&gt; # we move the gating at the end of the workflow&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now your workflow should contain four sequential jobs:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/1626878353.png&quot; alt=&quot;GitHub Actions workflow including API tests&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;GitHub Actions workflow including API tests&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;add-end-to-end-testing&quot;&gt;Add End-to-End Testing&lt;/h3&gt;
&lt;p&gt;End-to-end testing (e2e) aims to test complete use cases from the user perspective. Think of e2e as replacing a human with a robot.&lt;/p&gt;
&lt;p&gt;When it comes to selecting an e2e framework, I recommend prioritizing one that supports the Gherkin language. Gherkin promotes writing tests in natural language (aka, plain English). With this approach, more people can understand test cases, including product owners and business analysts. As a result, you foster better collaboration within the team.&lt;/p&gt;
&lt;p&gt;Verbalizing tests also ensure that you are writing them from the user’s perspective and not making the mistake of testing the functions you just coded.&lt;/p&gt;
&lt;p&gt;I selected &lt;a href=&quot;https://robotframework.org/&quot;&gt;Robot Framework&lt;/a&gt; for this example. Robot Framework uses &lt;a href=&quot;https://www.selenium.dev/&quot;&gt;Selenium&lt;/a&gt; to control a web browser and thus replace a human by simulating clicks and text entries.&lt;/p&gt;
&lt;p&gt;Once again, you can go to &lt;a href=&quot;https://github.com/marketplace?type=actions&quot;&gt;GitHub Actions Marketplace&lt;/a&gt; and look for an Action meeting your needs. For instance, &lt;a href=&quot;https://github.com/marketplace/actions/robot-framework&quot;&gt;Robot Framework Docker Action&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Add a new job called &lt;code&gt;test_e2e&lt;/code&gt; to the workflow configuration. This job must be executed after deploy using &lt;code&gt;needs: deploy&lt;/code&gt;. You will notice that since &lt;code&gt;tests_api&lt;/code&gt; and &lt;code&gt;test_e2e&lt;/code&gt; both need &lt;code&gt;deploy&lt;/code&gt;, they will be executed in parallel after the deployment.&lt;/p&gt;
&lt;p&gt;Have a look at the result:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/1626878240.png&quot; alt=&quot;GitHub Actions workflow including end-to-end tests&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;GitHub Actions workflow including end-to-end tests&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Your configuration should look along those lines to achieve this workflow:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode yaml&quot;&gt;&lt;code class=&quot;sourceCode yaml&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Python application&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-4&quot;&gt;&lt;a href=&quot;#cb4-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-5&quot;&gt;&lt;a href=&quot;#cb4-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; main &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-6&quot;&gt;&lt;a href=&quot;#cb4-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-7&quot;&gt;&lt;a href=&quot;#cb4-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-8&quot;&gt;&lt;a href=&quot;#cb4-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-9&quot;&gt;&lt;a href=&quot;#cb4-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;deploy&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-10&quot;&gt;&lt;a href=&quot;#cb4-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;tests_api&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-11&quot;&gt;&lt;a href=&quot;#cb4-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;test_e2e&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-12&quot;&gt;&lt;a href=&quot;#cb4-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ubuntu-latest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-13&quot;&gt;&lt;a href=&quot;#cb4-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; deploy&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-14&quot;&gt;&lt;a href=&quot;#cb4-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Run Robot Framework Tests&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-15&quot;&gt;&lt;a href=&quot;#cb4-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-16&quot;&gt;&lt;a href=&quot;#cb4-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Checkout&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-17&quot;&gt;&lt;a href=&quot;#cb4-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/checkout@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-18&quot;&gt;&lt;a href=&quot;#cb4-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Create folder for reports&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-19&quot;&gt;&lt;a href=&quot;#cb4-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; mkdir reports&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-20&quot;&gt;&lt;a href=&quot;#cb4-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Robot Framework Test&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-21&quot;&gt;&lt;a href=&quot;#cb4-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;        # &lt;/span&gt;&lt;span class=&quot;al&quot;&gt;NOTE&lt;/span&gt;&lt;span class=&quot;co&quot;&gt;: joonvena/robotframework-docker-action@v0.1 had permissions issue&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-22&quot;&gt;&lt;a href=&quot;#cb4-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;        # This action is based on a Docker image. I had to fall back to that image&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-23&quot;&gt;&lt;a href=&quot;#cb4-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;        # and use --user flag&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-24&quot;&gt;&lt;a href=&quot;#cb4-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;        run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;|&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-25&quot;&gt;&lt;a href=&quot;#cb4-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          docker run \&lt;/span&gt;
&lt;span id=&quot;cb4-26&quot;&gt;&lt;a href=&quot;#cb4-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            -v ${PWD}/reports:/opt/robotframework/reports:Z \&lt;/span&gt;
&lt;span id=&quot;cb4-27&quot;&gt;&lt;a href=&quot;#cb4-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            -v $/tests_e2e:/opt/robotframework/tests:Z \&lt;/span&gt;
&lt;span id=&quot;cb4-28&quot;&gt;&lt;a href=&quot;#cb4-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            --user $(id -u):$(id -g) \&lt;/span&gt;
&lt;span id=&quot;cb4-29&quot;&gt;&lt;a href=&quot;#cb4-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            -e BROWSER=chrome \&lt;/span&gt;
&lt;span id=&quot;cb4-30&quot;&gt;&lt;a href=&quot;#cb4-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            ppodgorsek/robot-framework:latest&lt;/span&gt;
&lt;span id=&quot;cb4-31&quot;&gt;&lt;a href=&quot;#cb4-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Upload test results&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-32&quot;&gt;&lt;a href=&quot;#cb4-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/upload-artifact@v1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-33&quot;&gt;&lt;a href=&quot;#cb4-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; always()&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-34&quot;&gt;&lt;a href=&quot;#cb4-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-35&quot;&gt;&lt;a href=&quot;#cb4-35&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; robotframework report&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-36&quot;&gt;&lt;a href=&quot;#cb4-36&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; reports&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-37&quot;&gt;&lt;a href=&quot;#cb4-37&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;gating&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-38&quot;&gt;&lt;a href=&quot;#cb4-38&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;tests_api&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; test_e2e&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-39&quot;&gt;&lt;a href=&quot;#cb4-39&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;co&quot;&gt; # move the gating at the end of the workflow&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;add-performance-testing&quot;&gt;Add Performance Testing&lt;/h3&gt;
&lt;p&gt;Performance testing is a broad topic because there are multiple types of performance testing. Most online sources agree on six types:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Load testing&lt;/li&gt;
&lt;li&gt;Stress testing&lt;/li&gt;
&lt;li&gt;Soak testing&lt;/li&gt;
&lt;li&gt;Spike testing&lt;/li&gt;
&lt;li&gt;Scalability testing&lt;/li&gt;
&lt;li&gt;Capacity testing.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;However, I don’t recommend you try to include each of them. Instead, consider one of two ways to tackle performance testing:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;strong&gt;Identify bottlenecks.&lt;/strong&gt; Design an experiment that identifies bottlenecks and measures the limit of your system.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Benchmarking.&lt;/strong&gt; Identify critical elements of your application and measure its speed. The goal is to improve one performance metric over time; conversely, you want to be alerted in case of metric degradation and address the problem as soon as possible.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;As before, create a new job (called &lt;code&gt;test_performance&lt;/code&gt;). This time I did not find an Action on the Marketplace that fit my requirement. But I recommend &lt;a href=&quot;https://medium.com/nerd-for-tech/ci-build-performance-testing-with-github-action-e6b227097c83&quot;&gt;this Medium article&lt;/a&gt; to help you select your framework and implement the steps of the job yourself.&lt;/p&gt;
&lt;p&gt;Here is the workflow I came up with for my Python application:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode yml&quot;&gt;&lt;code class=&quot;sourceCode yaml&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Python application&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-2&quot;&gt;&lt;a href=&quot;#cb5-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-3&quot;&gt;&lt;a href=&quot;#cb5-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-4&quot;&gt;&lt;a href=&quot;#cb5-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-5&quot;&gt;&lt;a href=&quot;#cb5-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; main &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-6&quot;&gt;&lt;a href=&quot;#cb5-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-7&quot;&gt;&lt;a href=&quot;#cb5-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-8&quot;&gt;&lt;a href=&quot;#cb5-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-9&quot;&gt;&lt;a href=&quot;#cb5-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;deploy&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-10&quot;&gt;&lt;a href=&quot;#cb5-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;tests_api&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-11&quot;&gt;&lt;a href=&quot;#cb5-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;test_e2e&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-12&quot;&gt;&lt;a href=&quot;#cb5-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;test_performances&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-13&quot;&gt;&lt;a href=&quot;#cb5-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Check performance regression.&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-14&quot;&gt;&lt;a href=&quot;#cb5-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ubuntu-latest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-15&quot;&gt;&lt;a href=&quot;#cb5-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; deploy&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-16&quot;&gt;&lt;a href=&quot;#cb5-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-17&quot;&gt;&lt;a href=&quot;#cb5-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/checkout@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-18&quot;&gt;&lt;a href=&quot;#cb5-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Set up Python 3.9&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-19&quot;&gt;&lt;a href=&quot;#cb5-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/setup-python@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-20&quot;&gt;&lt;a href=&quot;#cb5-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-21&quot;&gt;&lt;a href=&quot;#cb5-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;python-version&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fl&quot;&gt;3.9&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-22&quot;&gt;&lt;a href=&quot;#cb5-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Install dependencies&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-23&quot;&gt;&lt;a href=&quot;#cb5-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;        run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;|&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-24&quot;&gt;&lt;a href=&quot;#cb5-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          python -m pip install --upgrade pip&lt;/span&gt;
&lt;span id=&quot;cb5-25&quot;&gt;&lt;a href=&quot;#cb5-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          pip install flake8 pytest&lt;/span&gt;
&lt;span id=&quot;cb5-26&quot;&gt;&lt;a href=&quot;#cb5-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi&lt;/span&gt;
&lt;span id=&quot;cb5-27&quot;&gt;&lt;a href=&quot;#cb5-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          if [ -f test-requirements.txt ]; then pip install -r test-requirements.txt; fi&lt;/span&gt;
&lt;span id=&quot;cb5-28&quot;&gt;&lt;a href=&quot;#cb5-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Run benchmark&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-29&quot;&gt;&lt;a href=&quot;#cb5-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; pytest tests_performances --benchmark-json output.json&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-30&quot;&gt;&lt;a href=&quot;#cb5-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Store benchmark result&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-31&quot;&gt;&lt;a href=&quot;#cb5-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; rhysd/github-action-benchmark@v1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-32&quot;&gt;&lt;a href=&quot;#cb5-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;        # &lt;/span&gt;&lt;span class=&quot;al&quot;&gt;NOTE&lt;/span&gt;&lt;span class=&quot;co&quot;&gt;: this action only works for public repository&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-33&quot;&gt;&lt;a href=&quot;#cb5-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;        # A pull-request is open with a fix&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-34&quot;&gt;&lt;a href=&quot;#cb5-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-35&quot;&gt;&lt;a href=&quot;#cb5-35&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;tool&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;pytest&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-36&quot;&gt;&lt;a href=&quot;#cb5-36&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;output-file-path&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; output.json&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-37&quot;&gt;&lt;a href=&quot;#cb5-37&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;          # Personal access token to deploy GitHub Pages branch&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-38&quot;&gt;&lt;a href=&quot;#cb5-38&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;github-token&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; $&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-39&quot;&gt;&lt;a href=&quot;#cb5-39&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;          # Push and deploy GitHub pages branch automatically&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-40&quot;&gt;&lt;a href=&quot;#cb5-40&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;auto-push&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-41&quot;&gt;&lt;a href=&quot;#cb5-41&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;          # Show alert with commit comment on detecting possible performance regression&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-42&quot;&gt;&lt;a href=&quot;#cb5-42&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;alert-threshold&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;200%&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-43&quot;&gt;&lt;a href=&quot;#cb5-43&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;comment-on-alert&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-44&quot;&gt;&lt;a href=&quot;#cb5-44&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;fail-on-alert&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-45&quot;&gt;&lt;a href=&quot;#cb5-45&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;alert-comment-cc-users&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;@xNok&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Your final workflow must look like this:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/1626878379.png&quot; alt=&quot;GitHub Actions workflow including performances tests&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;GitHub Actions workflow including performances tests&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Continuous testing is the next step after you successfully implement &lt;a href=&quot;/blog/continuous-integration&quot;&gt;continuous integration&lt;/a&gt;. It further improves the speed of your application development process and adds a quality control layer to it.&lt;/p&gt;
&lt;p&gt;Remember, there are three essential stages in a continuous testing workflow, each testing your system from a different perspective:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Unit tests validate the internal logic.&lt;/li&gt;
&lt;li&gt;Integration tests validate the response of the system from its boundary.&lt;/li&gt;
&lt;li&gt;End-to-end tests validate the system from the user’s perspective.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Adding performance tests can help you track important metrics and ensure that changes do not negatively impact your users.&lt;/p&gt;
&lt;p&gt;Finally, to succeed in implementing CT, remember that testing should become part of your team’s DNA and share the same five pillars as DevOps: culture, automation, lean, measurement, and sharing.&lt;/p&gt;
&lt;p&gt;As your CT process grows and becomes more ingrained in how you work, take a look at &lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly’s&lt;/a&gt; ability to produce a repeatable build process. It can help make testing in GitHub Actions a more straightforward process.&lt;/p&gt;</content><author><name>Alexandre Couëdelo</name></author><category term="Tutorials" /><summary type="html">Automation testing is a crucial element to speed up your delivery process. It aims to flush out any potential regressions. The more you automate, the more confidence you gain in the quality of your software because the quality of each release of your application or library is measurable. Additionally, you reduce costs and save time and effort by reducing manual testing. The caveat is that automated tests have no value if they are not executed regularly alongside your continuous integration (CI) pipeline. CI refers to frequently merging developer code changes and building and creating an artifact that can later be tested and deployed. Extending the CI process by adding automated tests is referred to as continuous testing (CT). CT enables you to apply the fail-fast principle. You test each code change, build, and deployment against several layers of automated tests. Thus, it results in rapid feedback on the quality of your product and the state of the development process. GitHub Actions is a great first step for implementing CT. It’s flexible and powerful enough to bring every step of the CI/CT process into a single place. Your application, tests, and workflow configuration lives with your code in your repository. Furthermore, the learning curve for GitHub Actions is relatively smooth thanks to the Marketplace that provides thousands of Actions ready to use out of the box. What Does It Take to Implement Continuous Testing? A good CI/CT process always contains at least the following steps: Build Deployment Integration tests End-to-end tests In this tutorial, you will implement these four steps using GitHub Actions, as well as add performance tests. The Build steps include code compilation and unit tests. Also, note that it’s convenient to deploy your application in a dev environment before running complex tests such as integration and end-to-end. However, you may also run your application in GitHub Actions for test purposes. In this article, I assume you’ll deploy to a dev environment and focus on implementing different types of tests. Here is a visual of the final workflow for this tutorial: Final GitHub Action Workflow Implementing continuous testing can be challenging. If you are on a team that is new to this fail-fast approach, it may be a frustrating transition. In addition, seeing builds or pipelines failing can be overwhelming at the beginning. I suggest prioritizing fixing tests over focusing on new features. This may also be a significant change. To remediate those challenges, you should rely on the five DevOps principles described by Jez Humble in The DevOps Handbook: Culture Automate Lean Measure Sharing Implementing continuous testing is first a change in culture. Selecting the right tools for CI/CT can greatly improve collaboration. Keep your process lean. Testing should not slow down your process. Instead, select the right amount of tests at the right time in the process. Monitor your job execution time, prefer small tasks that can fail fast, and provide rapid feedback instead of long-running ones. Automate as much and as early as possible because it helps validate that the integration is successful. Delaying test implementation is counterproductive. Measure your improvement and build a baseline for the quality of your software. For example, collect your code coverage, number of successful vs. failed tests, and performance metric. Don’t forget to encourage knowledge sharing. Test automation is not a single person’s job: everyone on the team should know how the test suites work and learn how to fix simple errors when the workflows fail. Implementing CI/CT With GitHub Actions Now that you know the basics of CT, it’s time to see how to implement the first step by creating a GitHub Actions workflow that builds and runs your unit tests. Build a GitHub Actions Workflow with Unit Tests The first thing you need to get started is an initial workflow. If you already committed your application to a GitHub repository, click Actions. GitHub will automatically select and recommend a simple workflow that best suits your language. Select one of them by clicking Set up this workflow, review the workflow steps, and commit. Right away, you should see your workflow starting to build and test your application. Many starting workflows also include linting that validates the formatting and detects potential errors. Get Started with GitHub Action Workflow A GitHub Actions workflow contains three elements: Triggers (on) specify when the workflow must be executed. The most common use case is to run a workflow on push and pull-request on the main branch. Jobs determine sets of actions composing your pipeline and are executed in parallel unless dependencies between jobs are specified. Steps are the individual components of a job and can be of two types: Scripts or Actions. Steps defining a run attribute execute a command on the host defined by runs-on at the beginning of a job. Steps containing uses execute an Action, a reusable automation script. It’s straightforward to extend a workflow once you understand those three concepts. Here’s a sample workflow for a Python application: name: Python application on: pull_request: branches: [ main ] jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v2 - name: Set up Python 3.9 uses: actions/setup-python@v2 with: python-version: 3.9 - name: Install dependencies run: | python -m pip install --upgrade pip pip install flake8 pytest if [ -f requirements.txt ]; then pip install -r requirements.txt; fi - name: Lint with flake8 run: | # stop the build if there are Python syntax errors or undefined names flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics # exit-zero treats all errors as warnings. The GitHub editor is 127 chars wide flake8 . --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics - name: Test with pytest run: | pytest This what a basic workflow looks like: Most basic GitHub Actions workflow Add Code Coverage Reports On GitHub, most users rely on third parties to get coverage reports (such as SonarQube or Codecov). Integrating those SaaS into your workflow is simple, thanks to the GitHub Actions Marketplace. Most third parties providing code coverage reports have created an Action to make the integration seamless. But let’s not rely on a third party yet. Instead, generate a badge to display in your Readme.md. You’re putting in place the first step toward tracking code quality. Edit your existing Test with xxx step to generate a coverage report. Save the coverage report as an artifact. Storing workflow data as artifacts. Create a new job called gating and download the coverage report. This job must be executed after build; therefore, you must declare needs: build in your configuration. Parse the coverage report to extract the coverage value. I provided a small script that does just that. Generate the badge and add it to your README. Follow the setup step in the documentation of schneegans/dynamic-badges-action@v1.1.0. # This workflow will install Python dependencies, run tests, and lint with a single version of Python # For more information see: https://help.github.com/actions/language-and-framework-guides/using-python-with-github-actions name: Python application on: push: branches: [ main ] pull_request: branches: [ main ] jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v2 - name: Set up Python 3.9 uses: actions/setup-python@v2 with: python-version: 3.9 - name: Install dependencies [...] - name: Lint with flake8 [...] - name: Test with pytest # Update the command to generate coverage report run: pytest --cov-report xml --cov=phonebook tests/ - name: Upload pytest test coverage # Upload the coverage result as an artifact uses: actions/upload-artifact@v2 with: name: coverage-results path: coverage.xml # Use always() to always run this step to publish test results when there are test failures if: ${{ always() }} gating: runs-on: ubuntu-latest needs: build steps: - name: Download coverage report uses: actions/download-artifact@v2 with: name: coverage-results - name: Get the Coverage shell: bash run: | regex=&amp;#39;&amp;lt;coverage.+line-rate=&amp;quot;([0-9).[0-9]+)&amp;quot;.+&amp;gt;&amp;#39; line=$(grep -oP $regex coverage.xml) [[ $line =~ $regex ]] coverage=$( bc &amp;lt;&amp;lt;&amp;lt; ${BASH_REMATCH[1]}*100 ) if (( $(echo &amp;quot;$coverage &amp;gt; 80&amp;quot; |bc -l) )); then COLOR=green else COLOR=red fi echo &amp;quot;COVERAGE=${coverage%.*}%&amp;quot; &amp;gt;&amp;gt; $GITHUB_ENV echo &amp;quot;COLOR=$COLOR&amp;quot; &amp;gt;&amp;gt; $GITHUB_ENV - name: Create the Badge # save the badge configuration in a Gist uses: schneegans/dynamic-badges-action@v1.1.0 with: auth: ${{ secrets.GIST_SECRET }} gistID: ab3bde9504060bd1feb361555e79f51d filename: coverage.json label: coverage message: ${{ env.COVERAGE }} color: ${{ env.COLOR }} This is what your updated workflow looks like: GitHub Action workflow including code coverage badge And you got a badge to decorate your readme.md. GitHub code coverage badge Extending CT with Other Types of Testing You have a basic CI workflow that includes unit tests and coverage reports. Now to obtain an excellent CT workflow, you need to expand with more layers of tests. You will add three new jobs: For API testing, For end-to-end testing For performance testing Add API Testing API testing is part of integration testing. Integration testing aims to determine whether individual units meet your requirement when combined together. When performing integration testing, you target the boundary (or interfaces) of your system. In this specific case, you are aiming your test at a RESTful API. Having API tests ensures that sets of functionality meet your requirement and validates that your web server and connection to a database works properly. While you could write an API test in the same language as your application, you should also consider a tool like Postman/Newman. Postman lets you define a sequence of HTTPS calls and validate each of them using their JavaScript test framework. This makes it easy to share integration test suites. Other developers can use them to facilitate their development process, for instance, mobile developers working with a different stack than backend developers. Newman is the command-line interface that lets you run the Postman tests. Now that you have selected an API testing framework go to GitHub Actions Marketplace and look for an Action that meets your demands. For instance, Newman Action. Now edit your workflow configuration: Add a new job that must be executed after the deployment using needs: deploy. Define the steps of your job: Check out your repository using the Action actions/checkout@master. Run Newman using the Action you just found in the Marketplace. Move the gating job at the end of the workflow by changing the needs property. name: Python application on: push: branches: [ main ] jobs: build: [...] deploy: [...] # our deployment steps tests_api: needs: deploy runs-on: ubuntu-latest steps: - uses: actions/checkout@master - uses: matt-ball/newman-action@master with: collection: tests_integration/postman_collection.json environment: tests_integration/postman_environment.json gating: needs: tests_api [...] # we move the gating at the end of the workflow Now your workflow should contain four sequential jobs: GitHub Actions workflow including API tests Add End-to-End Testing End-to-end testing (e2e) aims to test complete use cases from the user perspective. Think of e2e as replacing a human with a robot. When it comes to selecting an e2e framework, I recommend prioritizing one that supports the Gherkin language. Gherkin promotes writing tests in natural language (aka, plain English). With this approach, more people can understand test cases, including product owners and business analysts. As a result, you foster better collaboration within the team. Verbalizing tests also ensure that you are writing them from the user’s perspective and not making the mistake of testing the functions you just coded. I selected Robot Framework for this example. Robot Framework uses Selenium to control a web browser and thus replace a human by simulating clicks and text entries. Once again, you can go to GitHub Actions Marketplace and look for an Action meeting your needs. For instance, Robot Framework Docker Action. Add a new job called test_e2e to the workflow configuration. This job must be executed after deploy using needs: deploy. You will notice that since tests_api and test_e2e both need deploy, they will be executed in parallel after the deployment. Have a look at the result: GitHub Actions workflow including end-to-end tests Your configuration should look along those lines to achieve this workflow: name: Python application on: push: branches: [ main ] jobs: build: [...] deploy: [...] tests_api: [...] test_e2e: runs-on: ubuntu-latest needs: deploy name: Run Robot Framework Tests steps: - name: Checkout uses: actions/checkout@v2 - name: Create folder for reports run: mkdir reports - name: Robot Framework Test # NOTE: joonvena/robotframework-docker-action@v0.1 had permissions issue # This action is based on a Docker image. I had to fall back to that image # and use --user flag run: | docker run \ -v ${PWD}/reports:/opt/robotframework/reports:Z \ -v $/tests_e2e:/opt/robotframework/tests:Z \ --user $(id -u):$(id -g) \ -e BROWSER=chrome \ ppodgorsek/robot-framework:latest - name: Upload test results uses: actions/upload-artifact@v1 if: always() with: name: robotframework report path: reports gating: needs: [tests_api, test_e2e] [...] # move the gating at the end of the workflow Add Performance Testing Performance testing is a broad topic because there are multiple types of performance testing. Most online sources agree on six types: Load testing Stress testing Soak testing Spike testing Scalability testing Capacity testing. However, I don’t recommend you try to include each of them. Instead, consider one of two ways to tackle performance testing: Identify bottlenecks. Design an experiment that identifies bottlenecks and measures the limit of your system. Benchmarking. Identify critical elements of your application and measure its speed. The goal is to improve one performance metric over time; conversely, you want to be alerted in case of metric degradation and address the problem as soon as possible. As before, create a new job (called test_performance). This time I did not find an Action on the Marketplace that fit my requirement. But I recommend this Medium article to help you select your framework and implement the steps of the job yourself. Here is the workflow I came up with for my Python application: name: Python application on: push: branches: [ main ] jobs: build: [...] deploy: [...] tests_api: [...] test_e2e: [...] test_performances: name: Check performance regression. runs-on: ubuntu-latest needs: deploy steps: - uses: actions/checkout@v2 - name: Set up Python 3.9 uses: actions/setup-python@v2 with: python-version: 3.9 - name: Install dependencies run: | python -m pip install --upgrade pip pip install flake8 pytest if [ -f requirements.txt ]; then pip install -r requirements.txt; fi if [ -f test-requirements.txt ]; then pip install -r test-requirements.txt; fi - name: Run benchmark run: pytest tests_performances --benchmark-json output.json - name: Store benchmark result uses: rhysd/github-action-benchmark@v1 # NOTE: this action only works for public repository # A pull-request is open with a fix with: tool: &amp;#39;pytest&amp;#39; output-file-path: output.json # Personal access token to deploy GitHub Pages branch github-token: $ # Push and deploy GitHub pages branch automatically auto-push: true # Show alert with commit comment on detecting possible performance regression alert-threshold: &amp;#39;200%&amp;#39; comment-on-alert: true fail-on-alert: true alert-comment-cc-users: &amp;#39;@xNok&amp;#39; Your final workflow must look like this: GitHub Actions workflow including performances tests Conclusion Continuous testing is the next step after you successfully implement continuous integration. It further improves the speed of your application development process and adds a quality control layer to it. Remember, there are three essential stages in a continuous testing workflow, each testing your system from a different perspective: Unit tests validate the internal logic. Integration tests validate the response of the system from its boundary. End-to-end tests validate the system from the user’s perspective. Adding performance tests can help you track important metrics and ensure that changes do not negatively impact your users. Finally, to succeed in implementing CT, remember that testing should become part of your team’s DNA and share the same five pillars as DevOps: culture, automation, lean, measurement, and sharing. As your CT process grows and becomes more ingrained in how you work, take a look at Earthly’s ability to produce a repeatable build process. It can help make testing in GitHub Actions a more straightforward process.</summary></entry></feed>
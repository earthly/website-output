<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.1.1">Jekyll</generator><link href="https://earthly.dev/blog/feed.xml" rel="self" type="application/atom+xml" /><link href="https://earthly.dev/blog/" rel="alternate" type="text/html" /><updated>2021-08-24T11:07:14-04:00</updated><id>https://earthly.dev/blog/feed.xml</id><title type="html">Earthly Blog</title><subtitle>Build automation for the container era.</subtitle><entry><title type="html">An Introduction to JQ</title><link href="https://earthly.dev/blog/jq-select/" rel="alternate" type="text/html" title="An Introduction to JQ" /><published>2021-08-24T00:00:00-04:00</published><updated>2021-08-24T00:00:00-04:00</updated><id>https://earthly.dev/blog/jq-select</id><content type="html" xml:base="https://earthly.dev/blog/jq-select/">&lt;!-- Code blocks have seperate results so need $ at beginning --&gt;
&lt;!-- markdownlint-disable MD014 --&gt;
&lt;h2 id=&quot;background-fingers-head-and-google&quot;&gt;Background: Fingers, Head, and Google&lt;/h2&gt;
&lt;p&gt;Whenever I reach a stopping point in my work, I use a bash alias called &lt;code&gt;gwip&lt;/code&gt;&lt;a href=&quot;#fn1&quot; class=&quot;footnote-ref&quot; id=&quot;fnref1&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; to create a ‚Äòwork in progress‚Äô commit. It happens without conscious thinking on my part. The same way my fingers know the vim key bindings, they know &lt;code&gt;gwip&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Other actions, I know how they work, but I have to think about them every time. They are in my head, not my fingers.&lt;a href=&quot;#fn2&quot; class=&quot;footnote-ref&quot; id=&quot;fnref2&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;However, some things never stick in my head, nor my fingers, and I have to google them every time. &lt;strong&gt;&lt;code&gt;jq&lt;/code&gt; is one of these.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;I know it‚Äôs a powerful tool, but I always end up back at Google and then coping and pasting a solution from somewhere. So I solve my problem but never learn the tool.&lt;/p&gt;
&lt;p&gt;It‚Äôs time to fix that. &lt;strong&gt;In this article, I‚Äôm going to go over the basics building blocks of &lt;code&gt;jq&lt;/code&gt; in enough depth that you will be able to understand how jq works.&lt;/strong&gt; Of course, you still might occasionally need to head to google to find a function name or check your syntax, but at least you‚Äôll have a firm grounding in the basics.&lt;/p&gt;
&lt;h2 id=&quot;what-is-jq&quot;&gt;What Is JQ&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;jq&lt;/code&gt; is a lightweight, command-line JSON processor. I install it with brew (&lt;code&gt;brew install jq&lt;/code&gt;), but it‚Äôs a single portable executable, so it‚Äôs easy to install on Linux, Windows, or macOS. To use it, you construct one or more filters, and it applies those filters to a JSON document.&lt;/p&gt;
&lt;p&gt;The simplest filter is the identity filter which returns all its input (&lt;code&gt;.&lt;/code&gt;):&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;{&amp;quot;key1&amp;quot;:{&amp;quot;key2&amp;quot;:&amp;quot;value1&amp;quot;}}&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-2&quot;&gt;&lt;a href=&quot;#cb2-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;key1&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-3&quot;&gt;&lt;a href=&quot;#cb2-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;key2&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;value1&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-4&quot;&gt;&lt;a href=&quot;#cb2-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-5&quot;&gt;&lt;a href=&quot;#cb2-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This filter is handy for just pretty-printing a JSON document.&lt;a href=&quot;#fn3&quot; class=&quot;footnote-ref&quot; id=&quot;fnref3&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt; I‚Äôm going to ignore the pretty-printing and jump right into using &lt;code&gt;jq&lt;/code&gt; to transform JSON documents.&lt;/p&gt;
&lt;h2 id=&quot;using-jq-to-select-elements&quot;&gt;Using JQ to Select Elements&lt;/h2&gt;
&lt;p&gt;I‚Äôm going to use &lt;code&gt;jq&lt;/code&gt; to filter the data returned by the GitHub repository API. The data I get back by default looks like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;5101141&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;node_id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;MDEwOlJlcG9zaXRvcnk1MTAxMTQx&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-4&quot;&gt;&lt;a href=&quot;#cb4-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;jq&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-5&quot;&gt;&lt;a href=&quot;#cb4-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;full_name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;stedolan/jq&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-6&quot;&gt;&lt;a href=&quot;#cb4-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;private&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-7&quot;&gt;&lt;a href=&quot;#cb4-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;owner&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-8&quot;&gt;&lt;a href=&quot;#cb4-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;login&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;stedolan&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-9&quot;&gt;&lt;a href=&quot;#cb4-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;79765&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-10&quot;&gt;&lt;a href=&quot;#cb4-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;},&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-11&quot;&gt;&lt;a href=&quot;#cb4-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;html_url&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;https://github.com/stedolan/jq&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-12&quot;&gt;&lt;a href=&quot;#cb4-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;description&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Command-line JSON processor&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-13&quot;&gt;&lt;a href=&quot;#cb4-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;stargazers_count&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;19967&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-14&quot;&gt;&lt;a href=&quot;#cb4-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;watchers_count&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;19967&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-15&quot;&gt;&lt;a href=&quot;#cb4-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;language&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;C&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-16&quot;&gt;&lt;a href=&quot;#cb4-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;license&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-17&quot;&gt;&lt;a href=&quot;#cb4-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;key&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;other&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-18&quot;&gt;&lt;a href=&quot;#cb4-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Other&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-19&quot;&gt;&lt;a href=&quot;#cb4-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;spdx_id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;NOASSERTION&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-20&quot;&gt;&lt;a href=&quot;#cb4-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;url&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-21&quot;&gt;&lt;a href=&quot;#cb4-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;node_id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;MDc6TGljZW5zZTA=&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-22&quot;&gt;&lt;a href=&quot;#cb4-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-23&quot;&gt;&lt;a href=&quot;#cb4-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!-- &lt;div class=&quot;notice--info&quot;&gt;
**Side Note: Omitting Details**

The JSON documents returned by the GitHub API are too large to show inline in a blog post. Therefore, for ease of explanation, I will omit non-relevant details.
&lt;/div&gt; --&gt;
&lt;p&gt;&lt;code&gt;jq&lt;/code&gt; lets us treat the JSON document as an object and select elements inside of it.&lt;/p&gt;
&lt;p&gt;Here is how I filter the JSON document to select the value of the &lt;code&gt;name&lt;/code&gt; key:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; .name&amp;#39;&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;jq&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;figcaption&gt;
&lt;/figcaption&gt;
&lt;p&gt;Similarly, for selecting the value of the &lt;code&gt;owner&lt;/code&gt; key:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb7&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb7-1&quot;&gt;&lt;a href=&quot;#cb7-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; .owner&amp;#39;&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb8&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb8-1&quot;&gt;&lt;a href=&quot;#cb8-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-2&quot;&gt;&lt;a href=&quot;#cb8-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;login&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;stedolan&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-3&quot;&gt;&lt;a href=&quot;#cb8-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;79765&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-4&quot;&gt;&lt;a href=&quot;#cb8-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can drill in as far as you want like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb9&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb9-1&quot;&gt;&lt;a href=&quot;#cb9-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; .owner.login&amp;#39;&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;stedolan&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;notice--big--primary&quot;&gt;
&lt;!-- markdownlint-disable MD036 --&gt;
&lt;p&gt;&lt;strong&gt;What I Learned: Object Identifier-Index&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;jq&lt;/code&gt; lets you select elements in a JSON document like it‚Äôs a JavaScript object. Just start with &lt;code&gt;.&lt;/code&gt; ( for the whole document) and drill down to the value you want. It ends up looking something like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.key.subkey.subsubkey&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;using-jq-to-select-arrays&quot;&gt;Using JQ to Select Arrays&lt;/h2&gt;
&lt;p&gt;If you &lt;code&gt;curl&lt;/code&gt; the GitHub Issues API, you will get back an array of issues:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb12&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb12-1&quot;&gt;&lt;a href=&quot;#cb12-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=5    &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb13&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb13-1&quot;&gt;&lt;a href=&quot;#cb13-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-2&quot;&gt;&lt;a href=&quot;#cb13-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-3&quot;&gt;&lt;a href=&quot;#cb13-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;966024429&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-4&quot;&gt;&lt;a href=&quot;#cb13-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2341&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-5&quot;&gt;&lt;a href=&quot;#cb13-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Question about license.&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-6&quot;&gt;&lt;a href=&quot;#cb13-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;body&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;I would like to create a [winget](https://github.com/microsoft/winget-cli) package for jq. üôèüèª&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-7&quot;&gt;&lt;a href=&quot;#cb13-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-8&quot;&gt;&lt;a href=&quot;#cb13-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-9&quot;&gt;&lt;a href=&quot;#cb13-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;/span&gt;
&lt;span id=&quot;cb13-10&quot;&gt;&lt;a href=&quot;#cb13-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;962477084&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-11&quot;&gt;&lt;a href=&quot;#cb13-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2340&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-12&quot;&gt;&lt;a href=&quot;#cb13-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;visibility of wiki pages&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-13&quot;&gt;&lt;a href=&quot;#cb13-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;body&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;The visibility of wiki pages to search engines is generally limited; for example, the search result for &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\&amp;quot;&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;jq Cookbook&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\&amp;quot;&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; looks like this:&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-14&quot;&gt;&lt;a href=&quot;#cb13-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-15&quot;&gt;&lt;a href=&quot;#cb13-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-16&quot;&gt;&lt;a href=&quot;#cb13-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;   &lt;/span&gt;
&lt;span id=&quot;cb13-17&quot;&gt;&lt;a href=&quot;#cb13-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;955350543&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-18&quot;&gt;&lt;a href=&quot;#cb13-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2337&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-19&quot;&gt;&lt;a href=&quot;#cb13-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Release 1.6 does not have pre-autoreconf&amp;#39;ed configure script&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-20&quot;&gt;&lt;a href=&quot;#cb13-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;body&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;If you have a usage question, please ask us on either Stack Overflow (https://stackoverflow.com/questions/tagged/jq) or in the #jq channel (http://irc.lc/freenode/%23jq/) on Freenode (https://webchat.freenode.net/).&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-21&quot;&gt;&lt;a href=&quot;#cb13-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-22&quot;&gt;&lt;a href=&quot;#cb13-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-23&quot;&gt;&lt;a href=&quot;#cb13-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;954792209&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-24&quot;&gt;&lt;a href=&quot;#cb13-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2336&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-25&quot;&gt;&lt;a href=&quot;#cb13-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Fix typo&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-26&quot;&gt;&lt;a href=&quot;#cb13-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;body&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-27&quot;&gt;&lt;a href=&quot;#cb13-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-28&quot;&gt;&lt;a href=&quot;#cb13-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-29&quot;&gt;&lt;a href=&quot;#cb13-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;940627936&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-30&quot;&gt;&lt;a href=&quot;#cb13-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2334&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-31&quot;&gt;&lt;a href=&quot;#cb13-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-32&quot;&gt;&lt;a href=&quot;#cb13-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;body&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Compile errors in filter expressions don&amp;#39;t include the column number where the parser approximately or exactly locates the error. Most filter expressions are one-liners (are multiple lines even supported?), so the information that the error is on line 1 is not helpful.&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-33&quot;&gt;&lt;a href=&quot;#cb13-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-34&quot;&gt;&lt;a href=&quot;#cb13-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To get a specific element in the array, give &lt;code&gt;jq&lt;/code&gt; an index:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb14&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb14-1&quot;&gt;&lt;a href=&quot;#cb14-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=5 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[4]&amp;#39;&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb15&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb15-1&quot;&gt;&lt;a href=&quot;#cb15-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-2&quot;&gt;&lt;a href=&quot;#cb15-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;940627936&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-3&quot;&gt;&lt;a href=&quot;#cb15-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2334&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-4&quot;&gt;&lt;a href=&quot;#cb15-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-5&quot;&gt;&lt;a href=&quot;#cb15-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;body&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Compile errors in filter expressions don&amp;#39;t include the column number where the parser approximately or exactly locates the error. Most filter expressions are one-liners (are multiple lines even supported?), so the information that the error is on line 1 is not helpful.&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-6&quot;&gt;&lt;a href=&quot;#cb15-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;Side Note: Array Indexing in &lt;code&gt;jq&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Array indexing has some helpful convenience syntax.&lt;/p&gt;
&lt;p&gt;You can select ranges:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb16&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb16-1&quot;&gt;&lt;a href=&quot;#cb16-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;quot;[1,2,3,4,5]&amp;quot;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[2:4]&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb17&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb17-1&quot;&gt;&lt;a href=&quot;#cb17-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can select one sided ranges:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb18&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb18-1&quot;&gt;&lt;a href=&quot;#cb18-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;quot;[1,2,3,4,5]&amp;quot;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[2:]&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb19&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb19-1&quot;&gt;&lt;a href=&quot;#cb19-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Also, you can use negatives to select from the end:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb20&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb20-1&quot;&gt;&lt;a href=&quot;#cb20-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;quot;[1,2,3,4,5]&amp;quot;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[-2:]&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb21&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb21-1&quot;&gt;&lt;a href=&quot;#cb21-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;You can use the array index with the object index:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb22&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb22-1&quot;&gt;&lt;a href=&quot;#cb22-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=5 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[4].title&amp;#39;&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And you can use &lt;code&gt;[]&lt;/code&gt; to get all the elements in the array. For example, here is how I would get the titles of the issues returned by my API request:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb24&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb24-1&quot;&gt;&lt;a href=&quot;#cb24-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=5 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[].title&amp;#39;&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;Question about license.&amp;quot;
&amp;quot;visibility of wiki pages&amp;quot;
&amp;quot;Release 1.6 does not have pre-autoreconf&amp;#39;ed configure script&amp;quot;
&amp;quot;Fix typo&amp;quot;
&amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;notice--big--primary&quot;&gt;
&lt;p&gt;&lt;strong&gt;What I Learned: Array-Index&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;jq&lt;/code&gt; lets you select the whole array &lt;code&gt;[]&lt;/code&gt;, a specific element &lt;code&gt;[3]&lt;/code&gt;, or ranges &lt;code&gt;[2:5]&lt;/code&gt; and combine these with the object index if needed.&lt;/p&gt;
&lt;p&gt;It ends up looking something like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb26&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb26-1&quot;&gt;&lt;a href=&quot;#cb26-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.key[].subkey[2]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;Side Note: Removing Quotes From JQ Output&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;-r&lt;/code&gt; option in &lt;code&gt;jq&lt;/code&gt; gives you raw strings if you need that.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb27&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb27-1&quot;&gt;&lt;a href=&quot;#cb27-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;[&amp;quot;1&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;3&amp;quot;]&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[]&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb27-2&quot;&gt;&lt;a href=&quot;#cb27-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb27-3&quot;&gt;&lt;a href=&quot;#cb27-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb27-4&quot;&gt;&lt;a href=&quot;#cb27-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code&gt;-j&lt;/code&gt; option (for join) can combine together your output.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb28&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb28-1&quot;&gt;&lt;a href=&quot;#cb28-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;[&amp;quot;1&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;3&amp;quot;]&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-j&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[]&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb28-2&quot;&gt;&lt;a href=&quot;#cb28-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;123&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;putting-elements-in-an-array-using-jq&quot;&gt;Putting Elements in an Array using &lt;code&gt;jq&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;Once you start using the array index to select elements, you have a new problem. The data returned won‚Äôt be a valid JSON document. In the example above, the issue titles were new line delimited:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;Question about license.&amp;quot;
&amp;quot;visibility of wiki pages&amp;quot;
&amp;quot;Release 1.6 does not have pre-autoreconf&amp;#39;ed configure script&amp;quot;
&amp;quot;Fix typo&amp;quot;
&amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot;
...&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In fact, whenever you ask &lt;code&gt;jq&lt;/code&gt; to return an unwrapped collection of elements, it prints them each on a new line. You can see this by explicitly asking &lt;code&gt;jq&lt;/code&gt; to ignore its input and instead return two numbers:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb30&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb30-1&quot;&gt;&lt;a href=&quot;#cb30-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;&amp;quot;&amp;quot;&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;1,2&amp;#39;&lt;/span&gt; &lt;/span&gt;
&lt;span id=&quot;cb30-2&quot;&gt;&lt;a href=&quot;#cb30-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb30-3&quot;&gt;&lt;a href=&quot;#cb30-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can resolve this the same way you would turn the text &lt;code&gt;1,2&lt;/code&gt; into an array in JavaScript: By wrapping it in an array constructor &lt;code&gt;[ ... ]&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb31&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb31-1&quot;&gt;&lt;a href=&quot;#cb31-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;&amp;quot;&amp;quot;&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;[1,2]&amp;#39;&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb32&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb32-1&quot;&gt;&lt;a href=&quot;#cb32-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb32-2&quot;&gt;&lt;a href=&quot;#cb32-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb32-3&quot;&gt;&lt;a href=&quot;#cb32-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb32-4&quot;&gt;&lt;a href=&quot;#cb32-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Similarly, to put a generated collection of results into a JSON array, you wrap it in an array constructor &lt;code&gt;[ ... ]&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;My GitHub issue title filter (&lt;code&gt;.[].title&lt;/code&gt;) then becomes &lt;code&gt;[ .[].title ]&lt;/code&gt; like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb33&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb33-1&quot;&gt;&lt;a href=&quot;#cb33-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=5 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb33-2&quot;&gt;&lt;a href=&quot;#cb33-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;[ .[].title ] &amp;#39;&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb34&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb34-1&quot;&gt;&lt;a href=&quot;#cb34-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb34-2&quot;&gt;&lt;a href=&quot;#cb34-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;Question about license.&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb34-3&quot;&gt;&lt;a href=&quot;#cb34-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;visibility of wiki pages&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb34-4&quot;&gt;&lt;a href=&quot;#cb34-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;Release 1.6 does not have pre-autoreconf&amp;#39;ed configure script&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb34-5&quot;&gt;&lt;a href=&quot;#cb34-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;Fix typo&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb34-6&quot;&gt;&lt;a href=&quot;#cb34-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb34-7&quot;&gt;&lt;a href=&quot;#cb34-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now I have a valid JSON document.&lt;/p&gt;
&lt;div class=&quot;notice--big--primary&quot;&gt;
&lt;!-- markdownlint-disable MD036 --&gt;
&lt;p&gt;&lt;strong&gt;What I Learned: Array Constructors&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;If your &lt;code&gt;jq&lt;/code&gt; query returns more than one element, they will be returned newline delimited.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb35&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb35-1&quot;&gt;&lt;a href=&quot;#cb35-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;[{&amp;quot;a&amp;quot;:&amp;quot;b&amp;quot;},{&amp;quot;a&amp;quot;:&amp;quot;c&amp;quot;}]&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[].a&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb35-2&quot;&gt;&lt;a href=&quot;#cb35-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;b&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb35-3&quot;&gt;&lt;a href=&quot;#cb35-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;c&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To turn these values into a JSON array, what you do is similar to creating an array in JavaScript: You wrap the values in an array constructor (&lt;code&gt;[...]&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;It ends up looking something like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb36&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb36-1&quot;&gt;&lt;a href=&quot;#cb36-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;[{&amp;quot;a&amp;quot;:&amp;quot;b&amp;quot;},{&amp;quot;a&amp;quot;:&amp;quot;c&amp;quot;}]&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;[ .[].a ]&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb37&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb37-1&quot;&gt;&lt;a href=&quot;#cb37-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb37-2&quot;&gt;&lt;a href=&quot;#cb37-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;b&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb37-3&quot;&gt;&lt;a href=&quot;#cb37-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;c&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb37-4&quot;&gt;&lt;a href=&quot;#cb37-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;using-jq-to-select-multiple-fields&quot;&gt;Using &lt;code&gt;jq&lt;/code&gt; to Select Multiple Fields&lt;/h2&gt;
&lt;p&gt;The GitHub issues API has a lot of details I don‚Äôt care about. I want to select multiple fields from the returned JSON document and leave the rest behind.&lt;/p&gt;
&lt;p&gt;The easiest way to do this is using &lt;code&gt;,&lt;/code&gt; to specify multiple filters:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb38&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb38-1&quot;&gt;&lt;a href=&quot;#cb38-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=2 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;\ &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb38-2&quot;&gt;&lt;a href=&quot;#cb38-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; .[].title, .[].number&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;Question about license.&amp;quot;
&amp;quot;visibility of wiki pages&amp;quot;
2341
2340&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;But this is returning the results of one selection after the other. To change the ordering, I can factor out the array selector:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb40&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb40-1&quot;&gt;&lt;a href=&quot;#cb40-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=2 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb40-2&quot;&gt;&lt;a href=&quot;#cb40-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[] |  .title, .number&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;Question about license.&amp;quot;
2341
&amp;quot;visibility of wiki pages&amp;quot;
2340&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This refactoring uses a pipe (|), which I‚Äôll talk about shortly, and runs my object selectors (&lt;code&gt;.title&lt;/code&gt; and &lt;code&gt;.number&lt;/code&gt;) on each array element.&lt;/p&gt;
&lt;p&gt;If you wrap the query in the array constructor you get this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb42&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb42-1&quot;&gt;&lt;a href=&quot;#cb42-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=2 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb42-2&quot;&gt;&lt;a href=&quot;#cb42-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;[ .[] |  .title, .number ]&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb43&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb43-1&quot;&gt;&lt;a href=&quot;#cb43-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb43-2&quot;&gt;&lt;a href=&quot;#cb43-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;Question about license.&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb43-3&quot;&gt;&lt;a href=&quot;#cb43-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dv&quot;&gt;2341&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb43-4&quot;&gt;&lt;a href=&quot;#cb43-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;visibility of wiki pages&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb43-5&quot;&gt;&lt;a href=&quot;#cb43-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dv&quot;&gt;2340&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb43-6&quot;&gt;&lt;a href=&quot;#cb43-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;But this still isn‚Äôt the JSON document I need. To get these values into a proper JSON object, I need an object constructor &lt;code&gt;{ ... }&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&quot;putting-elements-into-an-object-using-jq&quot;&gt;Putting Elements Into an Object Using &lt;code&gt;jq&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;Let‚Äôs look at some simple examples before showing how my GitHub query can use an object constructor.&lt;/p&gt;
&lt;h3 id=&quot;a-little-example&quot;&gt;A Little Example&lt;/h3&gt;
&lt;p&gt;I have an array that contains my name (&lt;code&gt;[&quot;Adam&quot;,&quot;Gordon&quot;,&quot;Bell&quot;]&lt;/code&gt;), and I want to turn it into a JSON object like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb44&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb44-1&quot;&gt;&lt;a href=&quot;#cb44-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb44-2&quot;&gt;&lt;a href=&quot;#cb44-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;first_name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;Adam&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb44-3&quot;&gt;&lt;a href=&quot;#cb44-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;last_name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;Bell&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb44-4&quot;&gt;&lt;a href=&quot;#cb44-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I can select the elements I need using array indexing like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb45&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb45-1&quot;&gt;&lt;a href=&quot;#cb45-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;[&amp;quot;Adam&amp;quot;,&amp;quot;Gordon&amp;quot;,&amp;quot;Bell&amp;quot;]&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.[0], .[2]&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb45-2&quot;&gt;&lt;a href=&quot;#cb45-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;Adam&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb45-3&quot;&gt;&lt;a href=&quot;#cb45-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;Bell&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To wrap those values into the shape I need, I can replace the values with the array indexes that return them:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb46&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb46-1&quot;&gt;&lt;a href=&quot;#cb46-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb46-2&quot;&gt;&lt;a href=&quot;#cb46-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;first_name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;er&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb46-3&quot;&gt;&lt;a href=&quot;#cb46-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;last_name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;er&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb46-4&quot;&gt;&lt;a href=&quot;#cb46-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Or on a single line like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb47&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb47-1&quot;&gt;&lt;a href=&quot;#cb47-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;[&amp;quot;Adam&amp;quot;,&amp;quot;Gordon&amp;quot;,&amp;quot;Bell&amp;quot;]&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;{ &amp;quot;first_name&amp;quot;:.[0], &amp;quot;last_name&amp;quot;: .[2]}&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb48&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb48-1&quot;&gt;&lt;a href=&quot;#cb48-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb48-2&quot;&gt;&lt;a href=&quot;#cb48-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;first_name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Adam&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb48-3&quot;&gt;&lt;a href=&quot;#cb48-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;last_name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Bell&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb48-4&quot;&gt;&lt;a href=&quot;#cb48-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This syntax is the same syntax for creating an object in a JSON document. The only difference is you can use the object and array queries you‚Äôve built up as the values.&lt;/p&gt;
&lt;h3 id=&quot;back-to-github&quot;&gt;Back to GitHub&lt;/h3&gt;
&lt;p&gt;Returning to my GitHub API problem, to wrap the number and the title up into an array I use the object constructor like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb49&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb49-1&quot;&gt;&lt;a href=&quot;#cb49-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=2 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb49-2&quot;&gt;&lt;a href=&quot;#cb49-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;[ .[] | { title: .title, number: .number} ]&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb50&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb50-1&quot;&gt;&lt;a href=&quot;#cb50-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb50-2&quot;&gt;&lt;a href=&quot;#cb50-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb50-3&quot;&gt;&lt;a href=&quot;#cb50-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Question about license.&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb50-4&quot;&gt;&lt;a href=&quot;#cb50-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2341&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb50-5&quot;&gt;&lt;a href=&quot;#cb50-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb50-6&quot;&gt;&lt;a href=&quot;#cb50-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb50-7&quot;&gt;&lt;a href=&quot;#cb50-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;visibility of wiki pages&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb50-8&quot;&gt;&lt;a href=&quot;#cb50-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2340&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb50-9&quot;&gt;&lt;a href=&quot;#cb50-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb50-10&quot;&gt;&lt;a href=&quot;#cb50-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;notice--big--primary&quot;&gt;
&lt;p&gt;&lt;strong&gt;What I Learned: Object Constructors&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;To put the elements you‚Äôve selected back into a JSON document, you can wrap them in an object constructor &lt;code&gt;{ ... }&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;If you were building up a JSON object out of several selectors, it would end up looking something like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb51&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb51-1&quot;&gt;&lt;a href=&quot;#cb51-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;{ &amp;quot;key1&amp;quot;: &amp;lt;&amp;lt;jq filter&amp;gt;&amp;gt;, &amp;quot;key2&amp;quot;: &amp;lt;&amp;lt;jq filter&amp;gt;&amp;gt; }&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Which is the same syntax for an object in a JSON document, except with &lt;code&gt;jq&lt;/code&gt; you can use filters as values.&lt;a href=&quot;#fn4&quot; class=&quot;footnote-ref&quot; id=&quot;fnref4&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;4&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;sorting-and-counting-with-jq&quot;&gt;Sorting and Counting With JQ&lt;/h2&gt;
&lt;p&gt;The next problem I have is that I want to summarize some this JSON data. Each issue returned by GitHub has a collection of labels:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb52&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb52-1&quot;&gt;&lt;a href=&quot;#cb52-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues/2289 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;\ &lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb52-2&quot;&gt;&lt;a href=&quot;#cb52-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; { title: .title, number: .number, labels: .labels} &amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb53&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb53-1&quot;&gt;&lt;a href=&quot;#cb53-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb53-2&quot;&gt;&lt;a href=&quot;#cb53-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb53-3&quot;&gt;&lt;a href=&quot;#cb53-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2289&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb53-4&quot;&gt;&lt;a href=&quot;#cb53-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;labels&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb53-5&quot;&gt;&lt;a href=&quot;#cb53-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      &lt;span class=&quot;st&quot;&gt;&amp;quot;feature request&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb53-6&quot;&gt;&lt;a href=&quot;#cb53-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      &lt;span class=&quot;st&quot;&gt;&amp;quot;dependencies&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb53-7&quot;&gt;&lt;a href=&quot;#cb53-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb53-8&quot;&gt;&lt;a href=&quot;#cb53-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;jq-built-in-functions&quot;&gt;&lt;code&gt;jq&lt;/code&gt; Built-in Functions&lt;/h3&gt;
&lt;p&gt;If I want those labels in alphabetical order I can use the built in &lt;code&gt;sort&lt;/code&gt; function. It works like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb54&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb54-1&quot;&gt;&lt;a href=&quot;#cb54-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt;  echo &lt;span class=&quot;st&quot;&gt;&amp;#39;[&amp;quot;3&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;1&amp;quot;]&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;sort&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb54-2&quot;&gt;&lt;a href=&quot;#cb54-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;3&amp;quot;&lt;/span&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is similar to how I would sort an array in JavaScript:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb55&quot;&gt;&lt;pre class=&quot;sourceCode javascript&quot;&gt;&lt;code class=&quot;sourceCode javascript&quot;&gt;&lt;span id=&quot;cb55-1&quot;&gt;&lt;a href=&quot;#cb55-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;const&lt;/span&gt; l &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [&lt;span class=&quot;st&quot;&gt;&amp;quot;3&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;]&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb55-2&quot;&gt;&lt;a href=&quot;#cb55-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;l&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;sort&lt;/span&gt;()&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Other built-ins that mirror JavaScript functionality are available, like &lt;code&gt;length&lt;/code&gt;, &lt;code&gt;reverse&lt;/code&gt;, and &lt;code&gt;tostring&lt;/code&gt; and they can all be used in a similar way:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb56&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb56-1&quot;&gt;&lt;a href=&quot;#cb56-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt;  echo &lt;span class=&quot;st&quot;&gt;&amp;#39;[&amp;quot;3&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;1&amp;quot;]&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;reverse&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb56-2&quot;&gt;&lt;a href=&quot;#cb56-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;3&amp;quot;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb56-3&quot;&gt;&lt;a href=&quot;#cb56-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt;  echo &lt;span class=&quot;st&quot;&gt;&amp;#39;[&amp;quot;3&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;1&amp;quot;]&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;length&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb56-4&quot;&gt;&lt;a href=&quot;#cb56-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If I can combine these built-ins with the selectors I‚Äôve built up so far, I‚Äôll have solved my label sorting problem. So I‚Äôll show that next.&lt;/p&gt;
&lt;div class=&quot;notice--big--primary&quot;&gt;
&lt;p&gt;&lt;strong&gt;What I Learned: &lt;code&gt;jq&lt;/code&gt; built-ins&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;jq&lt;/code&gt; has many built-in functions. There are probably too many to remember but the built-ins tend to mirror JavaScript functions, so give those a try before heading to &lt;a href=&quot;https://stedolan.github.io/jq/manual/#Builtinoperatorsandfunctions&quot;&gt;jq manual&lt;/a&gt; , and you might get lucky.&lt;a href=&quot;#fn5&quot; class=&quot;footnote-ref&quot; id=&quot;fnref5&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;5&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;pipes-and-filters&quot;&gt;Pipes and Filters&lt;/h3&gt;
&lt;p&gt;Before I can use &lt;code&gt;sort&lt;/code&gt; to sort the labels from my GitHub API request, I need to explain how pipes and filters work in &lt;code&gt;jq&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;jq&lt;/code&gt; is a filter in the UNIX command line sense. You pipe (&lt;code&gt;|&lt;/code&gt;) a JSON document to it, and it filters it and outputs it to standard out. I could easily use this feature to chain together jq invocations like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb57&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb57-1&quot;&gt;&lt;a href=&quot;#cb57-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;{&amp;quot;title&amp;quot;:&amp;quot;JQ Select&amp;quot;}&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.title&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;length&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb57-2&quot;&gt;&lt;a href=&quot;#cb57-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;9&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is a wordy, though simple, way to determine the length of a string in a JSON document. You can use this same idea to combine various &lt;code&gt;jq&lt;/code&gt; built-in functions with the features I‚Äôve shown so far. But there is an easier way, though. You can use pipes inside of &lt;code&gt;jq&lt;/code&gt; and conceptually they work just like shell pipes:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb58&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb58-1&quot;&gt;&lt;a href=&quot;#cb58-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;{&amp;quot;title&amp;quot;:&amp;quot;JQ Select&amp;quot;}&amp;#39;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.title | length&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb58-2&quot;&gt;&lt;a href=&quot;#cb58-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;9&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Here are some more examples:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;.title | length&lt;/code&gt; will return the length of the title&lt;/li&gt;
&lt;li&gt;&lt;code&gt;.number | tostring&lt;/code&gt; will return the issue number as a string&lt;/li&gt;
&lt;li&gt;&lt;code&gt;.[] | .key&lt;/code&gt; will return the values of key &lt;code&gt;key&lt;/code&gt; in the array (this is equivalent to this &lt;code&gt;.[].key&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This means that sorting my labels array is simple. I can just change &lt;code&gt;.labels&lt;/code&gt; to &lt;code&gt;.labels | sort&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb59&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb59-1&quot;&gt;&lt;a href=&quot;#cb59-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues/2289 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb59-2&quot;&gt;&lt;a href=&quot;#cb59-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; { title: .title, number: .number, labels: .labels | sort } &amp;#39;&lt;/span&gt;    &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb60&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb60-1&quot;&gt;&lt;a href=&quot;#cb60-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb60-2&quot;&gt;&lt;a href=&quot;#cb60-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb60-3&quot;&gt;&lt;a href=&quot;#cb60-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2289&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb60-4&quot;&gt;&lt;a href=&quot;#cb60-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;labels&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb60-5&quot;&gt;&lt;a href=&quot;#cb60-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      &lt;span class=&quot;st&quot;&gt;&amp;quot;dependencies&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb60-6&quot;&gt;&lt;a href=&quot;#cb60-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      &lt;span class=&quot;st&quot;&gt;&amp;quot;feature request&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb60-7&quot;&gt;&lt;a href=&quot;#cb60-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb60-8&quot;&gt;&lt;a href=&quot;#cb60-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And if you want just a label count that is easy as well:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb61&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb61-1&quot;&gt;&lt;a href=&quot;#cb61-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; curl https://api.github.com/repos/stedolan/jq/issues/2289 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb61-2&quot;&gt;&lt;a href=&quot;#cb61-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; { title: .title, number: .number, labels: .labels | length } &amp;#39;&lt;/span&gt;    &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb62&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb62-1&quot;&gt;&lt;a href=&quot;#cb62-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb62-2&quot;&gt;&lt;a href=&quot;#cb62-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb62-3&quot;&gt;&lt;a href=&quot;#cb62-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2289&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb62-4&quot;&gt;&lt;a href=&quot;#cb62-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;labels&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb62-5&quot;&gt;&lt;a href=&quot;#cb62-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;notice--big--primary&quot;&gt;
&lt;p&gt;&lt;strong&gt;What I Learned: Pipes and Filters&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Everything in &lt;code&gt;jq&lt;/code&gt; is a filter that you can combine with pipes (&lt;code&gt;|&lt;/code&gt;). This mimics the behavior of a UNIX shell.&lt;/p&gt;
&lt;p&gt;You can use the pipes and the &lt;code&gt;jq&lt;/code&gt; built-ins to build complicated transformations from simple operations.&lt;/p&gt;
&lt;p&gt;It ends up looking something like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb63&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb63-1&quot;&gt;&lt;a href=&quot;#cb63-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; .key1.subkey2[] | sort &amp;#39;&lt;/span&gt; &lt;span class=&quot;co&quot;&gt;# sorting&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb63-2&quot;&gt;&lt;a href=&quot;#cb63-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; .key2.subkey | length&amp;#39;&lt;/span&gt; &lt;span class=&quot;co&quot;&gt;# length of string or array&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb63-3&quot;&gt;&lt;a href=&quot;#cb63-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39; .key3 | floor | tostring | length&amp;#39;&lt;/span&gt; &lt;span class=&quot;co&quot;&gt;# and so on&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;maps-and-selects-using-jq&quot;&gt;Maps and Selects Using JQ&lt;/h2&gt;
&lt;p&gt;The issues list I was looking at has many low-quality issues in it.&lt;a href=&quot;#fn6&quot; class=&quot;footnote-ref&quot; id=&quot;fnref6&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;6&lt;/sup&gt;&lt;/a&gt; Let‚Äôs say I want to grab all the items that are labeled. This would let me skip all the drive-by fix-my-problem issues.&lt;/p&gt;
&lt;p&gt;Unfortunately, it‚Äôs impossible to do this with the GitHub API unless you specify all the possible labels in your query. However, I can easily do this query on the command line by filtering our results with &lt;code&gt;jq&lt;/code&gt;. However, to do so, I‚Äôm going to need a couple more &lt;code&gt;jq&lt;/code&gt; functions.&lt;/p&gt;
&lt;p&gt;My query so far looks like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb64&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb64-1&quot;&gt;&lt;a href=&quot;#cb64-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;[ .[] | { title: .title, number: .number, labels: .labels | length } ]&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The first thing I can do is simplify it using &lt;code&gt;map&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb65&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb65-1&quot;&gt;&lt;a href=&quot;#cb65-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;map({ title: .title, number: .number, labels: .labels | length }) &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;map(...)&lt;/code&gt; let‚Äôs you unwrap an array, apply a filter and then rewrap the results back into an array. You can think of it as a shorthand for &lt;code&gt;[ .[] | ...  ]&lt;/code&gt; and it comes up quite a bit in my experience, so it‚Äôs worth it committing to memory.&lt;/p&gt;
&lt;p&gt;I can combine that with a select statement that looks like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb66&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb66-1&quot;&gt;&lt;a href=&quot;#cb66-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;er&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cf&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;.labels&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; 0&lt;span class=&quot;kw&quot;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;select&lt;/code&gt; is a built-in function that takes a boolean expression and only returns elements that match. It‚Äôs similar to the &lt;code&gt;WHERE&lt;/code&gt; clause in a SQL statement or array filter in JavaScript.&lt;/p&gt;
&lt;p&gt;Like &lt;code&gt;map&lt;/code&gt;, I find &lt;code&gt;select&lt;/code&gt; comes up quite a bit, so while you may have to come back to this article or google it the first few times you need it, with luck, it will start to stick to your memory after that.&lt;/p&gt;
&lt;p&gt;Putting this all together looks like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb67&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb67-1&quot;&gt;&lt;a href=&quot;#cb67-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;curl&lt;/span&gt; https://api.github.com/repos/stedolan/jq/issues&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt;per_page=100 &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb67-2&quot;&gt;&lt;a href=&quot;#cb67-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;   &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;map({ title: .title, number: .number, labels: .labels | length }) | &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb67-3&quot;&gt;&lt;a href=&quot;#cb67-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;   map(select(.labels &amp;gt; 0))&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb68&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb68-1&quot;&gt;&lt;a href=&quot;#cb68-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-2&quot;&gt;&lt;a href=&quot;#cb68-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-3&quot;&gt;&lt;a href=&quot;#cb68-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Bump lxml from 4.3.1 to 4.6.3 in /docs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-4&quot;&gt;&lt;a href=&quot;#cb68-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2295&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-5&quot;&gt;&lt;a href=&quot;#cb68-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;labels&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-6&quot;&gt;&lt;a href=&quot;#cb68-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-7&quot;&gt;&lt;a href=&quot;#cb68-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-8&quot;&gt;&lt;a href=&quot;#cb68-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Bump pyyaml from 3.13 to 5.4 in /docs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-9&quot;&gt;&lt;a href=&quot;#cb68-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2291&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-10&quot;&gt;&lt;a href=&quot;#cb68-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;labels&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-11&quot;&gt;&lt;a href=&quot;#cb68-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-12&quot;&gt;&lt;a href=&quot;#cb68-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-13&quot;&gt;&lt;a href=&quot;#cb68-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-14&quot;&gt;&lt;a href=&quot;#cb68-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2289&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-15&quot;&gt;&lt;a href=&quot;#cb68-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;labels&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-16&quot;&gt;&lt;a href=&quot;#cb68-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-17&quot;&gt;&lt;a href=&quot;#cb68-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-18&quot;&gt;&lt;a href=&quot;#cb68-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Debugging help through showing pipeline intermediates. &amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-19&quot;&gt;&lt;a href=&quot;#cb68-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2206&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-20&quot;&gt;&lt;a href=&quot;#cb68-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;labels&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-21&quot;&gt;&lt;a href=&quot;#cb68-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb68-22&quot;&gt;&lt;a href=&quot;#cb68-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This uses three object indexes, two maps, two pipes, a &lt;code&gt;length&lt;/code&gt; function, and a &lt;code&gt;select&lt;/code&gt; predicate. But if you‚Äôve followed along, this should all make sense. It‚Äôs all just composing together filters until you get the result you need.&lt;/p&gt;
&lt;p&gt;Now lets talk about how you can put this knowledge into practice.&lt;/p&gt;
&lt;h2 id=&quot;in-review&quot;&gt;In Review&lt;/h2&gt;
&lt;div class=&quot;notice--big--primary&quot;&gt;
&lt;p&gt;&lt;strong&gt;What I Learned&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Here is what I‚Äôve learned so far:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;jq&lt;/code&gt; lets you select elements by starting with a &lt;code&gt;.&lt;/code&gt; and accessing keys and arrays like it‚Äôs a JavaScript Object (which is it is). This feature uses the Object and Array index &lt;code&gt;jq&lt;/code&gt; creates of a JSON document and look like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb69&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb69-1&quot;&gt;&lt;a href=&quot;#cb69-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;.key[0].subkey[2:3].subsubkey&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;jq&lt;/code&gt; programs can contain object constructors &lt;code&gt;{ ... }&lt;/code&gt; and array constructors &lt;code&gt;[ ... ]&lt;/code&gt;. You use these when you want to wrap back up something you‚Äôve pulled out of a JSON document using the above indexes:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb70&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb70-1&quot;&gt;&lt;a href=&quot;#cb70-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;[ { key1: .key1, key2: .key2 }  ]&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;jq&lt;/code&gt; contains built-in functions (&lt;code&gt;length&lt;/code&gt;,&lt;code&gt;sort&lt;/code&gt;,&lt;code&gt;select&lt;/code&gt;,&lt;code&gt;map&lt;/code&gt;) and pipes (&lt;code&gt;|&lt;/code&gt;), and you can compose these together just like you can combine pipes and filters at the command line:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb71&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb71-1&quot;&gt;&lt;a href=&quot;#cb71-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;map({ order-of-magitude: .items | length | tostring | length }) &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- markdownlint-enable MD036 --&gt;
&lt;h3 id=&quot;next-steps-for-mastering-jq&quot;&gt;Next Steps for Mastering &lt;code&gt;jq&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;Reading about (or writing about) a tool is not enough to master it. Action is needed. Here is my process for cementing this knowledge:&lt;/p&gt;
&lt;h4 id=&quot;complete-the-jq-tutorial&quot;&gt;1. Complete the &lt;code&gt;jq&lt;/code&gt; Tutorial&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/rjz/jq-tutorial&quot;&gt;jq-tutorial&lt;/a&gt; is not a tutorial at all, but a collection of around 20 interactive exercises that test you knowledge of &lt;code&gt;jq&lt;/code&gt;. I‚Äôve found it extremely helpful.&lt;/p&gt;
&lt;h4 id=&quot;try-using-your-memory-first&quot;&gt;2. Try Using Your Memory First&lt;/h4&gt;
&lt;p&gt;Whenever I need to extract data or transform a JSON document, I try to do it first without looking anything up. If memory fails me, sometimes &lt;a href=&quot;https://jqterm.com/&quot;&gt;jqterm&lt;/a&gt;, which has auto-completion, is helpful. Often, I still need to look something up, but science has shown that &lt;a href=&quot;https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3983480/&quot;&gt;repeated retrieval yields retention&lt;/a&gt;. So over time, my retention should improve.&lt;/p&gt;
&lt;h4 id=&quot;use-it&quot;&gt;3. Use It&lt;/h4&gt;
&lt;p&gt;If you don‚Äôt use a tool, you will never master it. So when I have a task that can be solved using &lt;code&gt;jq&lt;/code&gt;, then it is what I use. At least for the next little while, even if there is an easier way to do it. Whether it‚Äôs exploring a REST API or looking at &lt;code&gt;docker inspect&lt;/code&gt; results, JSON is everywhere, so opportunities abound.&lt;/p&gt;
&lt;h4 id=&quot;learn-more&quot;&gt;4. Learn More&lt;/h4&gt;
&lt;p&gt;Lastly, to deepen my knowledge, I‚Äôm learning about recursive descent, declaring variables, and defining functions and advanced features found in the &lt;a href=&quot;https://stedolan.github.io/jq/manual/#Advancedfeatures&quot;&gt;manual&lt;/a&gt;. Of course, these things rarely come up, but after writing all this, I‚Äôm hooked on this tool.&lt;/p&gt;
&lt;p&gt;Doing all this isn‚Äôt necessary, but if you follow me in some of these steps, I think using &lt;code&gt;jq&lt;/code&gt; will become second nature.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;So far I‚Äôve only covered the basics of &lt;code&gt;jq&lt;/code&gt;. The &lt;code&gt;jq&lt;/code&gt; query language is a full programming language and you can do lots of exciting things with it. You convert from &lt;a href=&quot;/blog/convert-to-from-json/#convert-json-to-csv-via-the-command-line-using-jq&quot;&gt;JSON to CSV&lt;/a&gt;. You can define you own functions and even &lt;a href=&quot;https://rosettacode.org/wiki/Sieve_of_Eratosthenes#jq&quot;&gt;find primes&lt;/a&gt; with &lt;code&gt;jq&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb72&quot;&gt;&lt;pre class=&quot;sourceCode haskell&quot;&gt;&lt;code class=&quot;sourceCode haskell&quot;&gt;&lt;span id=&quot;cb72-1&quot;&gt;&lt;a href=&quot;#cb72-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;# Denoting the input by $n, which is assumed to be a positive integer,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb72-2&quot;&gt;&lt;a href=&quot;#cb72-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;# eratosthenes/0 produces an array of primes less than or equal to $n:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb72-3&quot;&gt;&lt;a href=&quot;#cb72-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;def eratosthenes&lt;span class=&quot;op&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb72-4&quot;&gt;&lt;a href=&quot;#cb72-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  (&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;) as &lt;span class=&quot;op&quot;&gt;$&lt;/span&gt;n&lt;/span&gt;
&lt;span id=&quot;cb72-5&quot;&gt;&lt;a href=&quot;#cb72-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;op&quot;&gt;|&lt;/span&gt; ((&lt;span class=&quot;op&quot;&gt;$&lt;/span&gt;n&lt;span class=&quot;op&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;sqrt&lt;/span&gt;) &lt;span class=&quot;op&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;) as &lt;span class=&quot;op&quot;&gt;$&lt;/span&gt;s&lt;/span&gt;
&lt;span id=&quot;cb72-6&quot;&gt;&lt;a href=&quot;#cb72-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;op&quot;&gt;|&lt;/span&gt; [&lt;span class=&quot;fu&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;fu&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;fu&quot;&gt;range&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;; &lt;span class=&quot;op&quot;&gt;$&lt;/span&gt;n)]&lt;/span&gt;
&lt;span id=&quot;cb72-7&quot;&gt;&lt;a href=&quot;#cb72-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;op&quot;&gt;|&lt;/span&gt; reduce (&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; (&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;range&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;; &lt;span class=&quot;op&quot;&gt;$&lt;/span&gt;s))) as &lt;span class=&quot;op&quot;&gt;$&lt;/span&gt;i (&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;; erase(&lt;span class=&quot;op&quot;&gt;$&lt;/span&gt;i))&lt;/span&gt;
&lt;span id=&quot;cb72-8&quot;&gt;&lt;a href=&quot;#cb72-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;op&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;map&lt;/span&gt;(select(&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;));&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;However, simple stuff ‚Äì like selecting elements, filtering by key, or value ‚Äì is often all you need.&lt;/p&gt;
&lt;p&gt;I hope this helps make &lt;code&gt;jq&lt;/code&gt; more approachable and that you no longer have to go to google every time you want to query a JSON document&lt;a href=&quot;#fn7&quot; class=&quot;footnote-ref&quot; id=&quot;fnref7&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;7&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;notice--info notice--big&quot;&gt;
&lt;p&gt;
&lt;strong&gt;While you‚Äôre here:&lt;/strong&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today.
&lt;/p&gt;
&lt;/div&gt;
&lt;!-- markdownlint-enable MD014 --&gt;
&lt;section class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&quot;fn1&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;&lt;code&gt;alias gwip='git commit -a -m &quot;work in progress - fixup&quot;'&lt;/code&gt; I use this alias all the time and it gives me confidence that I can always get back to my last good state. I almost never end up reverting though, and the commits all get &lt;code&gt;fixup&lt;/code&gt;ed away, so I think it‚Äôs more useful psychologically than anything else.&lt;a href=&quot;#fnref1&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;‚Ü©Ô∏é&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn2&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;A note for the pedants: automated behavior is stored in your basal ganglia. It feels like it‚Äôs in my fingers, but really, these actions just fired at a level below my awareness.&lt;a href=&quot;#fnref2&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;‚Ü©Ô∏é&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn3&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;By default, &lt;code&gt;jq&lt;/code&gt; pretty-prints all its output. This means that its output is not character-for-character identical to its input.&lt;a href=&quot;#fnref3&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;‚Ü©Ô∏é&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn4&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;It‚Äôs possible to use jq filters as keys in the Object constructor as well, but that is outside the scope of this guide.&lt;a href=&quot;#fnref4&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;‚Ü©Ô∏é&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn5&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;You also aren‚Äôt limited by the built-ins. You can write your &lt;a href=&quot;https://stedolan.github.io/jq/manual/#Advancedfeatures&quot;&gt;own functions&lt;/a&gt; as well.&lt;a href=&quot;#fnref5&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;‚Ü©Ô∏é&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn6&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;People can‚Äôt figure out how to do something with &lt;code&gt;jq&lt;/code&gt; and open an issue. Please don‚Äôt do this. GitHub issues aren‚Äôt the place to post your random struggles with understanding a tool.&lt;a href=&quot;#fnref6&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;‚Ü©Ô∏é&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn7&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;A lot of the credit for the strength of this &lt;code&gt;jq&lt;/code&gt; summary goes to &lt;a href=&quot;https://refactoringenglish.com/&quot;&gt;Michael Lynch&lt;/a&gt; who is writing a book about writing and provided me extensive feedback on an earlier draft of this article.&lt;a href=&quot;#fnref7&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;‚Ü©Ô∏é&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;</content><author><name>Adam Gordon Bell</name></author><category term="Tutorials" /><summary type="html">Background: Fingers, Head, and Google Whenever I reach a stopping point in my work, I use a bash alias called gwip1 to create a ‚Äòwork in progress‚Äô commit. It happens without conscious thinking on my part. The same way my fingers know the vim key bindings, they know gwip. Other actions, I know how they work, but I have to think about them every time. They are in my head, not my fingers.2 However, some things never stick in my head, nor my fingers, and I have to google them every time. jq is one of these. I know it‚Äôs a powerful tool, but I always end up back at Google and then coping and pasting a solution from somewhere. So I solve my problem but never learn the tool. It‚Äôs time to fix that. In this article, I‚Äôm going to go over the basics building blocks of jq in enough depth that you will be able to understand how jq works. Of course, you still might occasionally need to head to google to find a function name or check your syntax, but at least you‚Äôll have a firm grounding in the basics. What Is JQ jq is a lightweight, command-line JSON processor. I install it with brew (brew install jq), but it‚Äôs a single portable executable, so it‚Äôs easy to install on Linux, Windows, or macOS. To use it, you construct one or more filters, and it applies those filters to a JSON document. The simplest filter is the identity filter which returns all its input (.): $ echo &amp;#39;{&amp;quot;key1&amp;quot;:{&amp;quot;key2&amp;quot;:&amp;quot;value1&amp;quot;}}&amp;#39; | jq &amp;#39;.&amp;#39; { &amp;quot;key1&amp;quot;: { &amp;quot;key2&amp;quot;: &amp;quot;value1&amp;quot; } } This filter is handy for just pretty-printing a JSON document.3 I‚Äôm going to ignore the pretty-printing and jump right into using jq to transform JSON documents. Using JQ to Select Elements I‚Äôm going to use jq to filter the data returned by the GitHub repository API. The data I get back by default looks like this: $ curl https://api.github.com/repos/stedolan/jq { &amp;quot;id&amp;quot;: 5101141, &amp;quot;node_id&amp;quot;: &amp;quot;MDEwOlJlcG9zaXRvcnk1MTAxMTQx&amp;quot;, &amp;quot;name&amp;quot;: &amp;quot;jq&amp;quot;, &amp;quot;full_name&amp;quot;: &amp;quot;stedolan/jq&amp;quot;, &amp;quot;private&amp;quot;: false, &amp;quot;owner&amp;quot;: { &amp;quot;login&amp;quot;: &amp;quot;stedolan&amp;quot;, &amp;quot;id&amp;quot;: 79765 }, &amp;quot;html_url&amp;quot;: &amp;quot;https://github.com/stedolan/jq&amp;quot;, &amp;quot;description&amp;quot;: &amp;quot;Command-line JSON processor&amp;quot;, &amp;quot;stargazers_count&amp;quot;: 19967, &amp;quot;watchers_count&amp;quot;: 19967, &amp;quot;language&amp;quot;: &amp;quot;C&amp;quot;, &amp;quot;license&amp;quot;: { &amp;quot;key&amp;quot;: &amp;quot;other&amp;quot;, &amp;quot;name&amp;quot;: &amp;quot;Other&amp;quot;, &amp;quot;spdx_id&amp;quot;: &amp;quot;NOASSERTION&amp;quot;, &amp;quot;url&amp;quot;: null, &amp;quot;node_id&amp;quot;: &amp;quot;MDc6TGljZW5zZTA=&amp;quot; } } jq lets us treat the JSON document as an object and select elements inside of it. Here is how I filter the JSON document to select the value of the name key: $ curl https://api.github.com/repos/stedolan/jq | jq &amp;#39; .name&amp;#39; &amp;quot;jq&amp;quot; Similarly, for selecting the value of the owner key: $ curl https://api.github.com/repos/stedolan/jq | jq &amp;#39; .owner&amp;#39; { &amp;quot;login&amp;quot;: &amp;quot;stedolan&amp;quot;, &amp;quot;id&amp;quot;: 79765 } You can drill in as far as you want like this: $ curl https://api.github.com/repos/stedolan/jq | jq &amp;#39; .owner.login&amp;#39; &amp;quot;stedolan&amp;quot; What I Learned: Object Identifier-Index jq lets you select elements in a JSON document like it‚Äôs a JavaScript object. Just start with . ( for the whole document) and drill down to the value you want. It ends up looking something like this: jq &amp;#39;.key.subkey.subsubkey&amp;#39; Using JQ to Select Arrays If you curl the GitHub Issues API, you will get back an array of issues: $ curl https://api.github.com/repos/stedolan/jq/issues?per_page=5 [ { &amp;quot;id&amp;quot;: 966024429, &amp;quot;number&amp;quot;: 2341, &amp;quot;title&amp;quot;: &amp;quot;Question about license.&amp;quot;, &amp;quot;body&amp;quot;: &amp;quot;I would like to create a [winget](https://github.com/microsoft/winget-cli) package for jq. üôèüèª&amp;quot; }, { &amp;quot;id&amp;quot;: 962477084, &amp;quot;number&amp;quot;: 2340, &amp;quot;title&amp;quot;: &amp;quot;visibility of wiki pages&amp;quot;, &amp;quot;body&amp;quot;: &amp;quot;The visibility of wiki pages to search engines is generally limited; for example, the search result for \&amp;quot;jq Cookbook\&amp;quot; looks like this:&amp;quot; }, { &amp;quot;id&amp;quot;: 955350543, &amp;quot;number&amp;quot;: 2337, &amp;quot;title&amp;quot;: &amp;quot;Release 1.6 does not have pre-autoreconf&amp;#39;ed configure script&amp;quot;, &amp;quot;body&amp;quot;: &amp;quot;If you have a usage question, please ask us on either Stack Overflow (https://stackoverflow.com/questions/tagged/jq) or in the #jq channel (http://irc.lc/freenode/%23jq/) on Freenode (https://webchat.freenode.net/).&amp;quot; }, { &amp;quot;id&amp;quot;: 954792209, &amp;quot;number&amp;quot;: 2336, &amp;quot;title&amp;quot;: &amp;quot;Fix typo&amp;quot;, &amp;quot;body&amp;quot;: &amp;quot;&amp;quot; }, { &amp;quot;id&amp;quot;: 940627936, &amp;quot;number&amp;quot;: 2334, &amp;quot;title&amp;quot;: &amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot;, &amp;quot;body&amp;quot;: &amp;quot;Compile errors in filter expressions don&amp;#39;t include the column number where the parser approximately or exactly locates the error. Most filter expressions are one-liners (are multiple lines even supported?), so the information that the error is on line 1 is not helpful.&amp;quot; } ] To get a specific element in the array, give jq an index: $ curl https://api.github.com/repos/stedolan/jq/issues?per_page=5 | jq &amp;#39;.[4]&amp;#39; { &amp;quot;id&amp;quot;: 940627936, &amp;quot;number&amp;quot;: 2334, &amp;quot;title&amp;quot;: &amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot;, &amp;quot;body&amp;quot;: &amp;quot;Compile errors in filter expressions don&amp;#39;t include the column number where the parser approximately or exactly locates the error. Most filter expressions are one-liners (are multiple lines even supported?), so the information that the error is on line 1 is not helpful.&amp;quot; } Side Note: Array Indexing in jq Array indexing has some helpful convenience syntax. You can select ranges: $ echo &amp;quot;[1,2,3,4,5]&amp;quot; | jq &amp;#39;.[2:4]&amp;#39; [3,4] You can select one sided ranges: $ echo &amp;quot;[1,2,3,4,5]&amp;quot; | jq &amp;#39;.[2:]&amp;#39; [3,4,5] Also, you can use negatives to select from the end: $ echo &amp;quot;[1,2,3,4,5]&amp;quot; | jq &amp;#39;.[-2:]&amp;#39; [4,5] You can use the array index with the object index: $ curl https://api.github.com/repos/stedolan/jq/issues?per_page=5 | jq &amp;#39;.[4].title&amp;#39; &amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot; And you can use [] to get all the elements in the array. For example, here is how I would get the titles of the issues returned by my API request: $ curl https://api.github.com/repos/stedolan/jq/issues?per_page=5 | jq &amp;#39;.[].title&amp;#39; &amp;quot;Question about license.&amp;quot; &amp;quot;visibility of wiki pages&amp;quot; &amp;quot;Release 1.6 does not have pre-autoreconf&amp;#39;ed configure script&amp;quot; &amp;quot;Fix typo&amp;quot; &amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot; What I Learned: Array-Index jq lets you select the whole array [], a specific element [3], or ranges [2:5] and combine these with the object index if needed. It ends up looking something like this: jq &amp;#39;.key[].subkey[2] Side Note: Removing Quotes From JQ Output The -r option in jq gives you raw strings if you need that. $ echo &amp;#39;[&amp;quot;1&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;3&amp;quot;]&amp;#39; | jq -r &amp;#39;.[]&amp;#39; 1 2 3 The -j option (for join) can combine together your output. $ echo &amp;#39;[&amp;quot;1&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;3&amp;quot;]&amp;#39; | jq -j &amp;#39;.[]&amp;#39; 123 Putting Elements in an Array using jq Once you start using the array index to select elements, you have a new problem. The data returned won‚Äôt be a valid JSON document. In the example above, the issue titles were new line delimited: &amp;quot;Question about license.&amp;quot; &amp;quot;visibility of wiki pages&amp;quot; &amp;quot;Release 1.6 does not have pre-autoreconf&amp;#39;ed configure script&amp;quot; &amp;quot;Fix typo&amp;quot; &amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot; ... In fact, whenever you ask jq to return an unwrapped collection of elements, it prints them each on a new line. You can see this by explicitly asking jq to ignore its input and instead return two numbers: $ echo &amp;#39;&amp;quot;&amp;quot;&amp;#39; | jq &amp;#39;1,2&amp;#39; 1 2 You can resolve this the same way you would turn the text 1,2 into an array in JavaScript: By wrapping it in an array constructor [ ... ]. $ echo &amp;#39;&amp;quot;&amp;quot;&amp;#39; | jq &amp;#39;[1,2]&amp;#39; [ 1, 2 ] Similarly, to put a generated collection of results into a JSON array, you wrap it in an array constructor [ ... ]. My GitHub issue title filter (.[].title) then becomes [ .[].title ] like this: $ curl https://api.github.com/repos/stedolan/jq/issues?per_page=5 | \ jq &amp;#39;[ .[].title ] &amp;#39; [ &amp;quot;Question about license.&amp;quot;, &amp;quot;visibility of wiki pages&amp;quot;, &amp;quot;Release 1.6 does not have pre-autoreconf&amp;#39;ed configure script&amp;quot;, &amp;quot;Fix typo&amp;quot;, &amp;quot;Compile error messages don&amp;#39;t provide column only line number&amp;quot; ] Now I have a valid JSON document. What I Learned: Array Constructors If your jq query returns more than one element, they will be returned newline delimited. $ echo &amp;#39;[{&amp;quot;a&amp;quot;:&amp;quot;b&amp;quot;},{&amp;quot;a&amp;quot;:&amp;quot;c&amp;quot;}]&amp;#39; | jq -r &amp;#39;.[].a&amp;#39; &amp;quot;b&amp;quot; &amp;quot;c&amp;quot; To turn these values into a JSON array, what you do is similar to creating an array in JavaScript: You wrap the values in an array constructor ([...]). It ends up looking something like this: $ echo &amp;#39;[{&amp;quot;a&amp;quot;:&amp;quot;b&amp;quot;},{&amp;quot;a&amp;quot;:&amp;quot;c&amp;quot;}]&amp;#39; | jq -r &amp;#39;[ .[].a ]&amp;#39; [ &amp;quot;b&amp;quot;, &amp;quot;c&amp;quot; ] Using jq to Select Multiple Fields The GitHub issues API has a lot of details I don‚Äôt care about. I want to select multiple fields from the returned JSON document and leave the rest behind. The easiest way to do this is using , to specify multiple filters: $ curl https://api.github.com/repos/stedolan/jq/issues?per_page=2 | \ jq &amp;#39; .[].title, .[].number&amp;#39; &amp;quot;Question about license.&amp;quot; &amp;quot;visibility of wiki pages&amp;quot; 2341 2340 But this is returning the results of one selection after the other. To change the ordering, I can factor out the array selector: $ curl https://api.github.com/repos/stedolan/jq/issues?per_page=2 | \ jq &amp;#39;.[] | .title, .number&amp;#39; &amp;quot;Question about license.&amp;quot; 2341 &amp;quot;visibility of wiki pages&amp;quot; 2340 This refactoring uses a pipe (|), which I‚Äôll talk about shortly, and runs my object selectors (.title and .number) on each array element. If you wrap the query in the array constructor you get this: $ curl https://api.github.com/repos/stedolan/jq/issues?per_page=2 | \ jq &amp;#39;[ .[] | .title, .number ]&amp;#39; [ &amp;quot;Question about license.&amp;quot;, 2341, &amp;quot;visibility of wiki pages&amp;quot;, 2340 ] But this still isn‚Äôt the JSON document I need. To get these values into a proper JSON object, I need an object constructor { ... }. Putting Elements Into an Object Using jq Let‚Äôs look at some simple examples before showing how my GitHub query can use an object constructor. A Little Example I have an array that contains my name ([&quot;Adam&quot;,&quot;Gordon&quot;,&quot;Bell&quot;]), and I want to turn it into a JSON object like this: { &amp;quot;first_name&amp;quot;:&amp;quot;Adam&amp;quot;, &amp;quot;last_name&amp;quot;:&amp;quot;Bell&amp;quot; } I can select the elements I need using array indexing like this: $ echo &amp;#39;[&amp;quot;Adam&amp;quot;,&amp;quot;Gordon&amp;quot;,&amp;quot;Bell&amp;quot;]&amp;#39; | jq -r &amp;#39;.[0], .[2]&amp;#39; Adam Bell To wrap those values into the shape I need, I can replace the values with the array indexes that return them: { &amp;quot;first_name&amp;quot;:.[0], &amp;quot;last_name&amp;quot;:.[2] } Or on a single line like this: $ echo &amp;#39;[&amp;quot;Adam&amp;quot;,&amp;quot;Gordon&amp;quot;,&amp;quot;Bell&amp;quot;]&amp;#39; | jq -r &amp;#39;{ &amp;quot;first_name&amp;quot;:.[0], &amp;quot;last_name&amp;quot;: .[2]}&amp;#39; { &amp;quot;first_name&amp;quot;: &amp;quot;Adam&amp;quot;, &amp;quot;last_name&amp;quot;: &amp;quot;Bell&amp;quot; } This syntax is the same syntax for creating an object in a JSON document. The only difference is you can use the object and array queries you‚Äôve built up as the values. Back to GitHub Returning to my GitHub API problem, to wrap the number and the title up into an array I use the object constructor like this: $ curl https://api.github.com/repos/stedolan/jq/issues?per_page=2 | \ jq &amp;#39;[ .[] | { title: .title, number: .number} ]&amp;#39; [ { &amp;quot;title&amp;quot;: &amp;quot;Question about license.&amp;quot;, &amp;quot;number&amp;quot;: 2341 }, { &amp;quot;title&amp;quot;: &amp;quot;visibility of wiki pages&amp;quot;, &amp;quot;number&amp;quot;: 2340 } ] What I Learned: Object Constructors To put the elements you‚Äôve selected back into a JSON document, you can wrap them in an object constructor { ... }. If you were building up a JSON object out of several selectors, it would end up looking something like this: jq &amp;#39;{ &amp;quot;key1&amp;quot;: &amp;lt;&amp;lt;jq filter&amp;gt;&amp;gt;, &amp;quot;key2&amp;quot;: &amp;lt;&amp;lt;jq filter&amp;gt;&amp;gt; }&amp;#39; Which is the same syntax for an object in a JSON document, except with jq you can use filters as values.4 Sorting and Counting With JQ The next problem I have is that I want to summarize some this JSON data. Each issue returned by GitHub has a collection of labels: $ curl https://api.github.com/repos/stedolan/jq/issues/2289 | \ jq &amp;#39; { title: .title, number: .number, labels: .labels} &amp;#39; { &amp;quot;title&amp;quot;: &amp;quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&amp;quot;, &amp;quot;number&amp;quot;: 2289, &amp;quot;labels&amp;quot;: [ &amp;quot;feature request&amp;quot;, &amp;quot;dependencies&amp;quot; ] } jq Built-in Functions If I want those labels in alphabetical order I can use the built in sort function. It works like this: $ echo &amp;#39;[&amp;quot;3&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;1&amp;quot;]&amp;#39; | jq &amp;#39;sort&amp;#39; [&amp;quot;1&amp;quot;, &amp;quot;2&amp;quot;, &amp;quot;3&amp;quot;] This is similar to how I would sort an array in JavaScript: const l = [&amp;quot;3&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;1&amp;quot;]; l.sort(); Other built-ins that mirror JavaScript functionality are available, like length, reverse, and tostring and they can all be used in a similar way: $ echo &amp;#39;[&amp;quot;3&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;1&amp;quot;]&amp;#39; | jq &amp;#39;reverse&amp;#39; [&amp;quot;1&amp;quot;, &amp;quot;2&amp;quot;, &amp;quot;3&amp;quot;] $ echo &amp;#39;[&amp;quot;3&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;1&amp;quot;]&amp;#39; | jq &amp;#39;length&amp;#39; 3 If I can combine these built-ins with the selectors I‚Äôve built up so far, I‚Äôll have solved my label sorting problem. So I‚Äôll show that next. What I Learned: jq built-ins jq has many built-in functions. There are probably too many to remember but the built-ins tend to mirror JavaScript functions, so give those a try before heading to jq manual , and you might get lucky.5 Pipes and Filters Before I can use sort to sort the labels from my GitHub API request, I need to explain how pipes and filters work in jq. jq is a filter in the UNIX command line sense. You pipe (|) a JSON document to it, and it filters it and outputs it to standard out. I could easily use this feature to chain together jq invocations like this: echo &amp;#39;{&amp;quot;title&amp;quot;:&amp;quot;JQ Select&amp;quot;}&amp;#39; | jq &amp;#39;.title&amp;#39; | jq &amp;#39;length&amp;#39; 9 This is a wordy, though simple, way to determine the length of a string in a JSON document. You can use this same idea to combine various jq built-in functions with the features I‚Äôve shown so far. But there is an easier way, though. You can use pipes inside of jq and conceptually they work just like shell pipes: echo &amp;#39;{&amp;quot;title&amp;quot;:&amp;quot;JQ Select&amp;quot;}&amp;#39; | jq &amp;#39;.title | length&amp;#39; 9 Here are some more examples: .title | length will return the length of the title .number | tostring will return the issue number as a string .[] | .key will return the values of key key in the array (this is equivalent to this .[].key) This means that sorting my labels array is simple. I can just change .labels to .labels | sort: $ curl https://api.github.com/repos/stedolan/jq/issues/2289 | \ jq &amp;#39; { title: .title, number: .number, labels: .labels | sort } &amp;#39; { &amp;quot;title&amp;quot;: &amp;quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&amp;quot;, &amp;quot;number&amp;quot;: 2289, &amp;quot;labels&amp;quot;: [ &amp;quot;dependencies&amp;quot;, &amp;quot;feature request&amp;quot; ] } And if you want just a label count that is easy as well: $ curl https://api.github.com/repos/stedolan/jq/issues/2289 | \ jq &amp;#39; { title: .title, number: .number, labels: .labels | length } &amp;#39; { &amp;quot;title&amp;quot;: &amp;quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&amp;quot;, &amp;quot;number&amp;quot;: 2289, &amp;quot;labels&amp;quot;: 2 } What I Learned: Pipes and Filters Everything in jq is a filter that you can combine with pipes (|). This mimics the behavior of a UNIX shell. You can use the pipes and the jq built-ins to build complicated transformations from simple operations. It ends up looking something like this: jq &amp;#39; .key1.subkey2[] | sort &amp;#39; # sorting jq &amp;#39; .key2.subkey | length&amp;#39; # length of string or array jq &amp;#39; .key3 | floor | tostring | length&amp;#39; # and so on Maps and Selects Using JQ The issues list I was looking at has many low-quality issues in it.6 Let‚Äôs say I want to grab all the items that are labeled. This would let me skip all the drive-by fix-my-problem issues. Unfortunately, it‚Äôs impossible to do this with the GitHub API unless you specify all the possible labels in your query. However, I can easily do this query on the command line by filtering our results with jq. However, to do so, I‚Äôm going to need a couple more jq functions. My query so far looks like this: jq &amp;#39;[ .[] | { title: .title, number: .number, labels: .labels | length } ]&amp;#39; The first thing I can do is simplify it using map. jq &amp;#39;map({ title: .title, number: .number, labels: .labels | length }) map(...) let‚Äôs you unwrap an array, apply a filter and then rewrap the results back into an array. You can think of it as a shorthand for [ .[] | ... ] and it comes up quite a bit in my experience, so it‚Äôs worth it committing to memory. I can combine that with a select statement that looks like this: map(select(.labels &amp;gt; 0)) select is a built-in function that takes a boolean expression and only returns elements that match. It‚Äôs similar to the WHERE clause in a SQL statement or array filter in JavaScript. Like map, I find select comes up quite a bit, so while you may have to come back to this article or google it the first few times you need it, with luck, it will start to stick to your memory after that. Putting this all together looks like this: curl https://api.github.com/repos/stedolan/jq/issues?per_page=100 | \ jq &amp;#39;map({ title: .title, number: .number, labels: .labels | length }) | map(select(.labels &amp;gt; 0))&amp;#39; [ { &amp;quot;title&amp;quot;: &amp;quot;Bump lxml from 4.3.1 to 4.6.3 in /docs&amp;quot;, &amp;quot;number&amp;quot;: 2295, &amp;quot;labels&amp;quot;: 1 }, { &amp;quot;title&amp;quot;: &amp;quot;Bump pyyaml from 3.13 to 5.4 in /docs&amp;quot;, &amp;quot;number&amp;quot;: 2291, &amp;quot;labels&amp;quot;: 1 }, { &amp;quot;title&amp;quot;: &amp;quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&amp;quot;, &amp;quot;number&amp;quot;: 2289, &amp;quot;labels&amp;quot;: 1 }, { &amp;quot;title&amp;quot;: &amp;quot;Debugging help through showing pipeline intermediates. &amp;quot;, &amp;quot;number&amp;quot;: 2206, &amp;quot;labels&amp;quot;: 1 } ] This uses three object indexes, two maps, two pipes, a length function, and a select predicate. But if you‚Äôve followed along, this should all make sense. It‚Äôs all just composing together filters until you get the result you need. Now lets talk about how you can put this knowledge into practice. In Review What I Learned Here is what I‚Äôve learned so far: jq lets you select elements by starting with a . and accessing keys and arrays like it‚Äôs a JavaScript Object (which is it is). This feature uses the Object and Array index jq creates of a JSON document and look like this: jq &amp;#39;.key[0].subkey[2:3].subsubkey&amp;#39; jq programs can contain object constructors { ... } and array constructors [ ... ]. You use these when you want to wrap back up something you‚Äôve pulled out of a JSON document using the above indexes: jq &amp;#39;[ { key1: .key1, key2: .key2 } ]&amp;#39; jq contains built-in functions (length,sort,select,map) and pipes (|), and you can compose these together just like you can combine pipes and filters at the command line: jq &amp;#39;map({ order-of-magitude: .items | length | tostring | length }) Next Steps for Mastering jq Reading about (or writing about) a tool is not enough to master it. Action is needed. Here is my process for cementing this knowledge: 1. Complete the jq Tutorial jq-tutorial is not a tutorial at all, but a collection of around 20 interactive exercises that test you knowledge of jq. I‚Äôve found it extremely helpful. 2. Try Using Your Memory First Whenever I need to extract data or transform a JSON document, I try to do it first without looking anything up. If memory fails me, sometimes jqterm, which has auto-completion, is helpful. Often, I still need to look something up, but science has shown that repeated retrieval yields retention. So over time, my retention should improve. 3. Use It If you don‚Äôt use a tool, you will never master it. So when I have a task that can be solved using jq, then it is what I use. At least for the next little while, even if there is an easier way to do it. Whether it‚Äôs exploring a REST API or looking at docker inspect results, JSON is everywhere, so opportunities abound. 4. Learn More Lastly, to deepen my knowledge, I‚Äôm learning about recursive descent, declaring variables, and defining functions and advanced features found in the manual. Of course, these things rarely come up, but after writing all this, I‚Äôm hooked on this tool. Doing all this isn‚Äôt necessary, but if you follow me in some of these steps, I think using jq will become second nature. Conclusion So far I‚Äôve only covered the basics of jq. The jq query language is a full programming language and you can do lots of exciting things with it. You convert from JSON to CSV. You can define you own functions and even find primes with jq: # Denoting the input by $n, which is assumed to be a positive integer, # eratosthenes/0 produces an array of primes less than or equal to $n: def eratosthenes: (. + 1) as $n | (($n|sqrt) / 2) as $s | [null, null, range(2; $n)] | reduce (2, 1 + (2 * range(1; $s))) as $i (.; erase($i)) | map(select(.)); However, simple stuff ‚Äì like selecting elements, filtering by key, or value ‚Äì is often all you need. I hope this helps make jq more approachable and that you no longer have to go to google every time you want to query a JSON document7. While you‚Äôre here: Earthly is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today. alias gwip='git commit -a -m &quot;work in progress - fixup&quot;' I use this alias all the time and it gives me confidence that I can always get back to my last good state. I almost never end up reverting though, and the commits all get fixuped away, so I think it‚Äôs more useful psychologically than anything else.‚Ü©Ô∏é A note for the pedants: automated behavior is stored in your basal ganglia. It feels like it‚Äôs in my fingers, but really, these actions just fired at a level below my awareness.‚Ü©Ô∏é By default, jq pretty-prints all its output. This means that its output is not character-for-character identical to its input.‚Ü©Ô∏é It‚Äôs possible to use jq filters as keys in the Object constructor as well, but that is outside the scope of this guide.‚Ü©Ô∏é You also aren‚Äôt limited by the built-ins. You can write your own functions as well.‚Ü©Ô∏é People can‚Äôt figure out how to do something with jq and open an issue. Please don‚Äôt do this. GitHub issues aren‚Äôt the place to post your random struggles with understanding a tool.‚Ü©Ô∏é A lot of the credit for the strength of this jq summary goes to Michael Lynch who is writing a book about writing and provided me extensive feedback on an earlier draft of this article.‚Ü©Ô∏é</summary></entry><entry><title type="html">Plotting Precipitation with Python, Pandas and Matplotlib</title><link href="https://earthly.dev/blog/plotting-rainfall-data-with-python-and-matplotlib/" rel="alternate" type="text/html" title="Plotting Precipitation with Python, Pandas and Matplotlib" /><published>2021-08-18T00:00:00-04:00</published><updated>2021-08-18T00:00:00-04:00</updated><id>https://earthly.dev/blog/plotting-rainfall-data-with-python-and-matplotlib</id><content type="html" xml:base="https://earthly.dev/blog/plotting-rainfall-data-with-python-and-matplotlib/">&lt;h2 id=&quot;where-did-all-the-rain-go&quot;&gt;Where Did All The Rain Go?&lt;/h2&gt;
&lt;p&gt;It‚Äôs been a really dry summer here in Victoria BC (and the rest of the province). I couldn‚Äôt remember the last time it had rained, which got me looking at historical weather data. Before I knew it, rather than simply look up how many days it‚Äôs been since it last rained (42 and counting!), I was plotting cumulative annual rainfall.&lt;/p&gt;
&lt;h2 id=&quot;get-some-data&quot;&gt;Get Some Data&lt;/h2&gt;
&lt;p&gt;I ended up on Environment Canada‚Äôs &lt;a href=&quot;https://climate.weather.gc.ca/historical_data/search_historic_data_e.html&quot;&gt;historic data search page&lt;/a&gt;, and ended up with a table of daily weather recorded at Victoria International Airport, climate ID 1018621 (which is closer to Sidney BC, but I digress). On the right hand side of that page, there was an option to download the data as CSV. Upon clicking the &lt;code&gt;Download Data&lt;/code&gt; button, my web browser was redirected to:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://climate.weather.gc.ca/climate_data/bulk_data_e.html?format=csv&amp;amp;stationID=51337&amp;amp;Year=2021&amp;amp;Month=7&amp;amp;Day=1&amp;amp;time=&amp;amp;timeframe=2&amp;amp;submit=Download+Data&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The website gave me an option to change the range of data to download; however if you squint enough, the above URL looks like an API. Furthermore, the month and day values didn‚Äôt seem to affect anything ‚Äì since this was annual data, only the year was used.&lt;/p&gt;
&lt;p&gt;It‚Äôs also interesting to note that the &lt;code&gt;station ID&lt;/code&gt; is different from the &lt;code&gt;Climate ID&lt;/code&gt; even though Environment Canada defines ‚Äúthe climate ID is a 7 digit number assigned by the Meteorological Service of Canada to a site where official weather observations are taken, and serves as a permanent, unique identifier.‚Äù Perhaps there was a &lt;a href=&quot;/blog/thought-leaders/&quot;&gt;thought leader&lt;/a&gt; who was suffering from past trauma where a client‚Äôs definition of a ‚Äúpermanent unique identifier‚Äù didn‚Äôt match up with a relational databases‚Äô definition of a unique identifier, and insisted on creating a lookup table for these different IDs. Again, I digress, back to downloading data.&lt;/p&gt;
&lt;p&gt;I wrote a &lt;a href=&quot;/blog/understanding-bash&quot;&gt;bash&lt;/a&gt; while loop to download this data:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#!/bin/sh&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-2&quot;&gt;&lt;a href=&quot;#cb2-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-e&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-3&quot;&gt;&lt;a href=&quot;#cb2-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; year &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;seq&lt;/span&gt; 2013 2021&lt;span class=&quot;va&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cf&quot;&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-4&quot;&gt;&lt;a href=&quot;#cb2-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ex&quot;&gt;curl&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;https://climate.weather.gc.ca/climate_data/bulk_data_e.html?format=csv&amp;amp;stationID=51337&amp;amp;Year=&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;${year}&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;amp;timeframe=2&amp;quot;&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; victoria-weather-&lt;span class=&quot;va&quot;&gt;$year&lt;/span&gt;.csv&lt;/span&gt;
&lt;span id=&quot;cb2-5&quot;&gt;&lt;a href=&quot;#cb2-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;done&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;parsing-the-data&quot;&gt;Parsing the Data&lt;/h2&gt;
&lt;h3 id=&quot;using-the-standard-csv.reader-parser&quot;&gt;Using the Standard &lt;code&gt;csv.reader&lt;/code&gt; Parser&lt;/h3&gt;
&lt;p&gt;Python offers a standard library for parsing &lt;code&gt;.csv&lt;/code&gt; files, aptly named &lt;code&gt;csv&lt;/code&gt;. The &lt;code&gt;csv&lt;/code&gt; library is fairly low-level and provides a &lt;code&gt;csv.reader&lt;/code&gt; which can be used to iterate over rows:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; csv&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;open&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;#39;data/victoria-weather-2020.csv&amp;#39;&lt;/span&gt;) &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; fp:&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    reader &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; csv.reader(fp)&lt;/span&gt;
&lt;span id=&quot;cb3-4&quot;&gt;&lt;a href=&quot;#cb3-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; row &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; reader:&lt;/span&gt;
&lt;span id=&quot;cb3-5&quot;&gt;&lt;a href=&quot;#cb3-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;bu&quot;&gt;print&lt;/span&gt;(row)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will output something such as&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[&amp;#39;\ufeff&amp;quot;Longitude (x)&amp;quot;&amp;#39;, &amp;#39;Latitude (y)&amp;#39;, &amp;#39;Station Name&amp;#39;, &amp;#39;Climate ID&amp;#39;, &amp;#39;Date/Time&amp;#39;, &amp;#39;Year&amp;#39;, &amp;#39;Month&amp;#39;, &amp;#39;Day&amp;#39;, &amp;#39;Data Quality&amp;#39;, &amp;#39;Max Temp (¬∞C)&amp;#39;, &amp;#39;Max Temp Flag&amp;#39;, &amp;#39;Min Temp (¬∞C)&amp;#39;, &amp;#39;Min Temp Flag&amp;#39;, &amp;#39;Mean Temp (¬∞C)&amp;#39;, &amp;#39;Mean Temp Flag&amp;#39;, &amp;#39;Heat Deg Days (¬∞C)&amp;#39;, &amp;#39;Heat Deg Days Flag&amp;#39;, &amp;#39;Cool Deg Days (¬∞C)&amp;#39;, &amp;#39;Cool Deg Days Flag&amp;#39;, &amp;#39;Total Rain (mm)&amp;#39;, &amp;#39;Total Rain Flag&amp;#39;, &amp;#39;Total Snow (cm)&amp;#39;, &amp;#39;Total Snow Flag&amp;#39;, &amp;#39;Total Precip (mm)&amp;#39;, &amp;#39;Total Precip Flag&amp;#39;, &amp;#39;Snow on Grnd (cm)&amp;#39;, &amp;#39;Snow on Grnd Flag&amp;#39;, &amp;#39;Dir of Max Gust (10s deg)&amp;#39;, &amp;#39;Dir of Max Gust Flag&amp;#39;, &amp;#39;Spd of Max Gust (km/h)&amp;#39;, &amp;#39;Spd of Max Gust Flag&amp;#39;]
[&amp;#39;-123.43&amp;#39;, &amp;#39;48.65&amp;#39;, &amp;#39;VICTORIA INTL A&amp;#39;, &amp;#39;1018621&amp;#39;, &amp;#39;2020-01-01&amp;#39;, &amp;#39;2020&amp;#39;, &amp;#39;01&amp;#39;, &amp;#39;01&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;12.9&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;5.5&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;9.2&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;8.8&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;T&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;T&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;26&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;59&amp;#39;, &amp;#39;&amp;#39;]
[&amp;#39;-123.43&amp;#39;, &amp;#39;48.65&amp;#39;, &amp;#39;VICTORIA INTL A&amp;#39;, &amp;#39;1018621&amp;#39;, &amp;#39;2020-01-02&amp;#39;, &amp;#39;2020&amp;#39;, &amp;#39;01&amp;#39;, &amp;#39;02&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;6.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.9&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;3.5&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14.5&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14.6&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14.6&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;45&amp;#39;, &amp;#39;&amp;#39;]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The downside of using the standard python &lt;code&gt;csv.reader&lt;/code&gt; parser, is it simply returns all cells as strings, and doesn‚Äôt differentiate between cell headers and cell contents. Furthermore, the underlying data seems to have some sort of unicode character that‚Äôs not being correctly handled.&lt;/p&gt;
&lt;h3 id=&quot;using-the-standard-csv.dictreader-parser&quot;&gt;Using the Standard &lt;code&gt;csv.DictReader&lt;/code&gt; Parser&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;csv&lt;/code&gt; library provides a &lt;code&gt;csv.DictReader&lt;/code&gt; class which will use the first row as cell headers, and rather than returning the row as a list; instead it will return it as a dictionary:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{&amp;#39;\ufeff&amp;quot;Longitude (x)&amp;quot;&amp;#39;: &amp;#39;-123.43&amp;#39;, &amp;#39;Latitude (y)&amp;#39;: &amp;#39;48.65&amp;#39;, &amp;#39;Station Name&amp;#39;: &amp;#39;VICTORIA INTL A&amp;#39;, &amp;#39;Climate ID&amp;#39;: &amp;#39;1018621&amp;#39;, &amp;#39;Date/Time&amp;#39;: &amp;#39;2020-01-01&amp;#39;, &amp;#39;Year&amp;#39;: &amp;#39;2020&amp;#39;, &amp;#39;Month&amp;#39;: &amp;#39;01&amp;#39;, &amp;#39;Day&amp;#39;: &amp;#39;01&amp;#39;, &amp;#39;Data Quality&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Max Temp (¬∞C)&amp;#39;: &amp;#39;12.9&amp;#39;, &amp;#39;Max Temp Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Min Temp (¬∞C)&amp;#39;: &amp;#39;5.5&amp;#39;, &amp;#39;Min Temp Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Mean Temp (¬∞C)&amp;#39;: &amp;#39;9.2&amp;#39;, &amp;#39;Mean Temp Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Heat Deg Days (¬∞C)&amp;#39;: &amp;#39;8.8&amp;#39;, &amp;#39;Heat Deg Days Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Cool Deg Days (¬∞C)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Cool Deg Days Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Total Rain (mm)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Total Rain Flag&amp;#39;: &amp;#39;T&amp;#39;, &amp;#39;Total Snow (cm)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Total Snow Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Total Precip (mm)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Total Precip Flag&amp;#39;: &amp;#39;T&amp;#39;, &amp;#39;Snow on Grnd (cm)&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Snow on Grnd Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Dir of Max Gust (10s deg)&amp;#39;: &amp;#39;26&amp;#39;, &amp;#39;Dir of Max Gust Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Spd of Max Gust (km/h)&amp;#39;: &amp;#39;59&amp;#39;, &amp;#39;Spd of Max Gust Flag&amp;#39;: &amp;#39;&amp;#39;}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;However, the &lt;code&gt;DictReader&lt;/code&gt; doesn‚Äôt parse the cell contents and returns everything simply as strings ‚Äì leaving all type parsing to the user. Again we see the incorrectly handled unicode character appear ‚Äì this time within the key of every row.&lt;/p&gt;
&lt;h3 id=&quot;using-the-pandas-library&quot;&gt;Using the Pandas Library&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;pandas&lt;/code&gt; library is a third-party python library which provides tools for data analysis and manipulation. We will be using the &lt;code&gt;pandas.read_csv&lt;/code&gt; function to parse our data:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; pandas&lt;/span&gt;
&lt;span id=&quot;cb6-2&quot;&gt;&lt;a href=&quot;#cb6-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-3&quot;&gt;&lt;a href=&quot;#cb6-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;weather &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; pandas.read_csv(&lt;span class=&quot;st&quot;&gt;&amp;#39;data/victoria-weather-2020.csv&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb6-4&quot;&gt;&lt;a href=&quot;#cb6-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;print&lt;/span&gt;(weather)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will produce output such as:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;     Longitude (x)  Latitude (y)     Station Name  Climate ID   Date/Time  Year  Month  Day  ... Total Precip (mm)  Total Precip Flag Snow on Grnd (cm)  Snow on Grnd Flag Dir of Max Gust (10s deg)  Dir of Max Gust Flag Spd of Max Gust (km/h)  Spd of Max Gust Flag
0          -123.43         48.65  VICTORIA INTL A     1018621  2020-01-01  2020      1    1  ...                0.0                  T               NaN                NaN                      26.0                   NaN                   59.0                   NaN
1          -123.43         48.65  VICTORIA INTL A     1018621  2020-01-02  2020      1    2  ...               14.6                NaN               NaN                NaN                      14.0                   NaN                   45.0                   NaN
2          -123.43         48.65  VICTORIA INTL A     1018621  2020-01-03  2020      1    3  ...               11.2                NaN               NaN                NaN                      15.0                   NaN                   39.0                   NaN
..             ...           ...              ...         ...         ...   ...    ...  ...  ...                ...                ...               ...                ...                       ...                   ...                    ...                   ...
363        -123.43         48.65  VICTORIA INTL A     1018621  2020-12-29  2020     12   29  ...                8.7                NaN               NaN                NaN                       NaN                     M                    NaN                     M
364        -123.43         48.65  VICTORIA INTL A     1018621  2020-12-30  2020     12   30  ...               20.4                NaN               NaN                NaN                      14.0                   NaN                   61.0                   NaN
365        -123.43         48.65  VICTORIA INTL A     1018621  2020-12-31  2020     12   31  ...                7.2                NaN               NaN                NaN                      14.0                   NaN                   33.0                   NaN

[366 rows x 31 columns]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Notice how the columns have been automatically parsed to an appropriate data type, as well as the column headers are detected. Row numbers are additionally displayed, as well as the data is displayed as a table. This is possible due to the fact that the &lt;code&gt;read_csv&lt;/code&gt; function returns a &lt;code&gt;pandas.core.frame.DataFrame&lt;/code&gt; data type which among other things, implements the &lt;code&gt;__str__&lt;/code&gt; method which is used to render the string which is passed to the &lt;code&gt;print&lt;/code&gt; function.&lt;/p&gt;
&lt;h2 id=&quot;merging-multiple-datasets&quot;&gt;Merging Multiple Datasets&lt;/h2&gt;
&lt;p&gt;My dataset is split across multiple &lt;code&gt;csv&lt;/code&gt; files, with each file containing a dataset for a specific year. My first task is to merge them together. All the datasets are located under the &lt;code&gt;data&lt;/code&gt; directory, and are named &lt;code&gt;victoria-weather-YYYY.csv&lt;/code&gt; (where &lt;code&gt;YYYY&lt;/code&gt; is the year).&lt;/p&gt;
&lt;p&gt;Let‚Äôs write a function to parse all the data:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb8&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb8-1&quot;&gt;&lt;a href=&quot;#cb8-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; re&lt;/span&gt;
&lt;span id=&quot;cb8-2&quot;&gt;&lt;a href=&quot;#cb8-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; os&lt;/span&gt;
&lt;span id=&quot;cb8-3&quot;&gt;&lt;a href=&quot;#cb8-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; pandas&lt;/span&gt;
&lt;span id=&quot;cb8-4&quot;&gt;&lt;a href=&quot;#cb8-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-5&quot;&gt;&lt;a href=&quot;#cb8-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; get_data(weather_dir):&lt;/span&gt;
&lt;span id=&quot;cb8-6&quot;&gt;&lt;a href=&quot;#cb8-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    p &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; re.&lt;span class=&quot;bu&quot;&gt;compile&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;#39;victoria-weather-[0-9]+.csv&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb8-7&quot;&gt;&lt;a href=&quot;#cb8-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    data &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb8-8&quot;&gt;&lt;a href=&quot;#cb8-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; filename &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;sorted&lt;/span&gt;(os.listdir(weather_dir)):&lt;/span&gt;
&lt;span id=&quot;cb8-9&quot;&gt;&lt;a href=&quot;#cb8-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; p.match(filename):&lt;/span&gt;
&lt;span id=&quot;cb8-10&quot;&gt;&lt;a href=&quot;#cb8-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            path &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; os.path.join(weather_dir, filename)&lt;/span&gt;
&lt;span id=&quot;cb8-11&quot;&gt;&lt;a href=&quot;#cb8-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            yearly_data &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; pandas.read_csv(path)&lt;/span&gt;
&lt;span id=&quot;cb8-12&quot;&gt;&lt;a href=&quot;#cb8-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            data.append(yearly_data)&lt;/span&gt;
&lt;span id=&quot;cb8-13&quot;&gt;&lt;a href=&quot;#cb8-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; pandas.concat(data)&lt;/span&gt;
&lt;span id=&quot;cb8-14&quot;&gt;&lt;a href=&quot;#cb8-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-15&quot;&gt;&lt;a href=&quot;#cb8-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;weather &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; get_data(&lt;span class=&quot;st&quot;&gt;&amp;#39;data&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb8-16&quot;&gt;&lt;a href=&quot;#cb8-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;print&lt;/span&gt;(weather)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This function 1) uses a regular expression to ensure we only parse files which match the expected form, which prevents our program from crashing if any other files existed in the directory, 2) parses each file separately using the &lt;code&gt;read_csv&lt;/code&gt; function, 3) saves the returned data frame into the &lt;code&gt;data&lt;/code&gt; list, then finally 4) concatenates the data using the &lt;code&gt;concat&lt;/code&gt; function. This code should output a single data frame containing all the data spanning a decade:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;     Longitude (x)  Latitude (y)     Station Name  Climate ID   Date/Time  Year  Month  Day  Data Quality  ... Total Snow Flag Total Precip (mm)  Total Precip Flag Snow on Grnd (cm)  Snow on Grnd Flag Dir of Max Gust (10s deg)  Dir of Max Gust Flag Spd of Max Gust (km/h)  Spd of Max Gust Flag
0          -123.43         48.65  VICTORIA INTL A     1018621  2014-01-01  2014      1    1           NaN  ...              NaN               1.6                NaN               NaN                NaN                       NaN                   NaN                    &amp;lt;31                   NaN
1          -123.43         48.65  VICTORIA INTL A     1018621  2014-01-02  2014      1    2           NaN  ...              NaN               6.6                NaN               NaN                NaN                      21.0                   NaN                     37                   NaN
2          -123.43         48.65  VICTORIA INTL A     1018621  2014-01-03  2014      1    3           NaN  ...              NaN               0.0                NaN               NaN                NaN                      31.0                   NaN                     41                   NaN
3          -123.43         48.65  VICTORIA INTL A     1018621  2014-01-04  2014      1    4           NaN  ...              NaN               0.0                NaN               NaN                NaN                       NaN                   NaN                    &amp;lt;31                   NaN
4          -123.43         48.65  VICTORIA INTL A     1018621  2014-01-05  2014      1    5           NaN  ...              NaN               0.0                NaN               NaN                NaN                       NaN                   NaN                    &amp;lt;31                   NaN
..             ...           ...              ...         ...         ...   ...    ...  ...           ...  ...              ...               ...                ...               ...                ...                       ...                   ...                    ...                   ...
198        -123.43         48.65  VICTORIA INTL A     1018621  2021-07-18  2021      7   18           NaN  ...              NaN               0.0                NaN               NaN                NaN                       NaN                   NaN                    NaN                     M
199        -123.43         48.65  VICTORIA INTL A     1018621  2021-07-19  2021      7   19           NaN  ...              NaN               0.0                NaN               NaN                NaN                      25.0                   NaN                   37.0                   NaN
200        -123.43         48.65  VICTORIA INTL A     1018621  2021-07-20  2021      7   20           NaN  ...              NaN               0.0                NaN               NaN                NaN                      29.0                   NaN                   36.0                   NaN
201        -123.43         48.65  VICTORIA INTL A     1018621  2021-07-21  2021      7   21           NaN  ...              NaN               0.0                NaN               NaN                NaN                      28.0                   NaN                   33.0                   NaN
202        -123.43         48.65  VICTORIA INTL A     1018621  2021-07-22  2021      7   22           NaN  ...              NaN               0.0                NaN               NaN                NaN                       NaN                     M                    NaN                     M

[2760 rows x 31 columns]&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;raindrops-keep-falling-on-my-plots&quot;&gt;Raindrops Keep Falling on my Plots&lt;/h2&gt;
&lt;p&gt;Let‚Äôs plot the rainfall! We will use the &lt;code&gt;matplotlib&lt;/code&gt; library for visualizing this data.&lt;/p&gt;
&lt;p&gt;We can extract a single column of the data frame using the column name, e.g.¬†&lt;code&gt;weather['Total Precip (mm)']&lt;/code&gt;. This will return a &lt;code&gt;pandas.core.series.Series&lt;/code&gt; data type, which is similar to a list; however requires each element in the series to be the same data type. This allows pandas to keep all elements in contiguous memory, which allows faster SIMD-based operations.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;For another example of comparing generic data types against specific native types, checkout out our post on the &lt;a href=&quot;/blog/python-timsort-merge&quot;&gt;various tricks&lt;/a&gt; that python‚Äôs timsort uses to achieve better performance.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;A pandas series can be converted into a &lt;a href=&quot;/blog/python-concatenate-lists&quot;&gt;python list&lt;/a&gt; using the &lt;code&gt;.to_list()&lt;/code&gt; method; e.g.¬†&lt;code&gt;weather['Total Precip (mm)'].to_list()&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;plotting-the-data-interactively&quot;&gt;Plotting the Data Interactively&lt;/h3&gt;
&lt;p&gt;Here‚Äôs a quick example of plotting this data interactively:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb10-2&quot;&gt;&lt;a href=&quot;#cb10-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-3&quot;&gt;&lt;a href=&quot;#cb10-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Precip (mm)&amp;#39;&lt;/span&gt;].to_list()&lt;/span&gt;
&lt;span id=&quot;cb10-4&quot;&gt;&lt;a href=&quot;#cb10-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;plt.plot(rainfall)&lt;/span&gt;
&lt;span id=&quot;cb10-5&quot;&gt;&lt;a href=&quot;#cb10-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;plt.show()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will display a new window, containing a plot of the data:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-interactive-660-bb671d45d.webp 660w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-interactive-660-7bc7f4e71.png 660w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-interactive-660-7bc7f4e71.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC daily precipitation interactive plot
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;It &lt;em&gt;should&lt;/em&gt; be possible to omit the &lt;code&gt;.to_list()&lt;/code&gt; call, which would then pass the pandas series data type directly to the matplotlib &lt;code&gt;plot&lt;/code&gt; function rather than passing a standard python list; however, there‚Äôs a bug in matplotlib (or pandas), which produces the following erroneous plot:&lt;/p&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-interactive-bug-660-3a2b6a8f5.webp 660w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-interactive-bug-660-5252d6866.png 660w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-interactive-bug-660-5252d6866.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;p&gt;Notice how this plot has some bizarre lines that criss-cross the plot, and that the data points stop at roughly 350 rather than past 2500? At a quick glance, this might be an instance of &lt;a href=&quot;https://github.com/matplotlib/matplotlib/issues/16266&quot;&gt;this bug&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;saving-the-plot-programmatically&quot;&gt;Saving the Plot Programmatically&lt;/h3&gt;
&lt;p&gt;Lets revise the previous code to render the plot as a png instead of using an interactive window:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb11-2&quot;&gt;&lt;a href=&quot;#cb11-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-3&quot;&gt;&lt;a href=&quot;#cb11-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# create a new figure that is 10x7 inches&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-4&quot;&gt;&lt;a href=&quot;#cb11-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# which is rendered as 100 pixels per inch&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-5&quot;&gt;&lt;a href=&quot;#cb11-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# (matplotlib incorrectly refers to this as dots-per-inch, which is a printer term)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-6&quot;&gt;&lt;a href=&quot;#cb11-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; plt.figure(figsize&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;(&lt;span class=&quot;fl&quot;&gt;10.0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;7.0&lt;/span&gt;), dpi&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb11-7&quot;&gt;&lt;a href=&quot;#cb11-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-8&quot;&gt;&lt;a href=&quot;#cb11-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# define axes on the figure to take up the entire figure canvas&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-9&quot;&gt;&lt;a href=&quot;#cb11-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; fig.add_axes([&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;
&lt;span id=&quot;cb11-10&quot;&gt;&lt;a href=&quot;#cb11-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-11&quot;&gt;&lt;a href=&quot;#cb11-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# plot the rainfall amounts against the axes&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-12&quot;&gt;&lt;a href=&quot;#cb11-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.plot(rainfall)&lt;/span&gt;
&lt;span id=&quot;cb11-13&quot;&gt;&lt;a href=&quot;#cb11-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-14&quot;&gt;&lt;a href=&quot;#cb11-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# label the axes and title the plot&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-15&quot;&gt;&lt;a href=&quot;#cb11-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_xlabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;days since start of dataset&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb11-16&quot;&gt;&lt;a href=&quot;#cb11-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_ylabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;precipitation (mm)&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb11-17&quot;&gt;&lt;a href=&quot;#cb11-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_title(&lt;span class=&quot;st&quot;&gt;&amp;#39;Victoria BC daily precipitation&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb11-18&quot;&gt;&lt;a href=&quot;#cb11-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-19&quot;&gt;&lt;a href=&quot;#cb11-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# save the plot to disk&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-20&quot;&gt;&lt;a href=&quot;#cb11-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig.savefig(&lt;span class=&quot;st&quot;&gt;&amp;#39;daily-precipitation.png&amp;#39;&lt;/span&gt;, bbox_inches&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Which will produce:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-800-12093d32c.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-800-16e97b528.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-800-16e97b528.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC daily precipitation
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;h3 id=&quot;fixing-the-x-axis-label-to-display-the-date&quot;&gt;Fixing the X Axis Label to Display the Date&lt;/h3&gt;
&lt;p&gt;The previous plots didn‚Äôt make use of the &lt;code&gt;Date/Time&lt;/code&gt; column from our weather data &lt;code&gt;csv&lt;/code&gt; files; instead it was simply displaying the index of the list element. We need to instruct pandas to parse those columns as dates using the &lt;code&gt;parse_dates&lt;/code&gt; field. We will additionally define a date parsing function &lt;code&gt;yyyymmdd_parser&lt;/code&gt; which will be used to parse the date; without this function, pandas will attempt to guess the format of the date, which is a best-effort strategy and may not always work.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb12&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb12-1&quot;&gt;&lt;a href=&quot;#cb12-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; re&lt;/span&gt;
&lt;span id=&quot;cb12-2&quot;&gt;&lt;a href=&quot;#cb12-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; os&lt;/span&gt;
&lt;span id=&quot;cb12-3&quot;&gt;&lt;a href=&quot;#cb12-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; pandas&lt;/span&gt;
&lt;span id=&quot;cb12-4&quot;&gt;&lt;a href=&quot;#cb12-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; datetime&lt;/span&gt;
&lt;span id=&quot;cb12-5&quot;&gt;&lt;a href=&quot;#cb12-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb12-6&quot;&gt;&lt;a href=&quot;#cb12-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-7&quot;&gt;&lt;a href=&quot;#cb12-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# Our new date parser&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-8&quot;&gt;&lt;a href=&quot;#cb12-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; yyyymmdd_parser(s):&lt;/span&gt;
&lt;span id=&quot;cb12-9&quot;&gt;&lt;a href=&quot;#cb12-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; datetime.datetime.strptime(s, &lt;span class=&quot;st&quot;&gt;&amp;#39;%Y-%m-&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb12-10&quot;&gt;&lt;a href=&quot;#cb12-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-11&quot;&gt;&lt;a href=&quot;#cb12-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; get_data(weather_dir):&lt;/span&gt;
&lt;span id=&quot;cb12-12&quot;&gt;&lt;a href=&quot;#cb12-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    p &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; re.&lt;span class=&quot;bu&quot;&gt;compile&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;#39;victoria-weather-[0-9]+.csv&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb12-13&quot;&gt;&lt;a href=&quot;#cb12-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    data &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb12-14&quot;&gt;&lt;a href=&quot;#cb12-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; filename &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;sorted&lt;/span&gt;(os.listdir(weather_dir)):&lt;/span&gt;
&lt;span id=&quot;cb12-15&quot;&gt;&lt;a href=&quot;#cb12-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; p.match(filename):&lt;/span&gt;
&lt;span id=&quot;cb12-16&quot;&gt;&lt;a href=&quot;#cb12-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            path &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; os.path.join(weather_dir, filename)&lt;/span&gt;
&lt;span id=&quot;cb12-17&quot;&gt;&lt;a href=&quot;#cb12-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            &lt;span class=&quot;co&quot;&gt;# We identify which column contains the date, along with the date parser to use.&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-18&quot;&gt;&lt;a href=&quot;#cb12-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            yearly_data &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; pandas.read_csv(path, parse_dates&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;[&lt;span class=&quot;st&quot;&gt;&amp;#39;Date/Time&amp;#39;&lt;/span&gt;], date_parser&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;yyyymmdd_parser)&lt;/span&gt;
&lt;span id=&quot;cb12-19&quot;&gt;&lt;a href=&quot;#cb12-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            data.append(yearly_data)&lt;/span&gt;
&lt;span id=&quot;cb12-20&quot;&gt;&lt;a href=&quot;#cb12-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; pandas.concat(data)&lt;/span&gt;
&lt;span id=&quot;cb12-21&quot;&gt;&lt;a href=&quot;#cb12-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-22&quot;&gt;&lt;a href=&quot;#cb12-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;weather &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; get_data(&lt;span class=&quot;st&quot;&gt;&amp;#39;data&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb12-23&quot;&gt;&lt;a href=&quot;#cb12-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-24&quot;&gt;&lt;a href=&quot;#cb12-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Precip (mm)&amp;#39;&lt;/span&gt;].to_list()&lt;/span&gt;
&lt;span id=&quot;cb12-25&quot;&gt;&lt;a href=&quot;#cb12-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-26&quot;&gt;&lt;a href=&quot;#cb12-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# We will convert all dates into the native python datetime format, which works&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-27&quot;&gt;&lt;a href=&quot;#cb12-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# better with matplotlib.&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-28&quot;&gt;&lt;a href=&quot;#cb12-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;date &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [x.to_pydatetime() &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; x &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Date/Time&amp;#39;&lt;/span&gt;]]&lt;/span&gt;
&lt;span id=&quot;cb12-29&quot;&gt;&lt;a href=&quot;#cb12-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-30&quot;&gt;&lt;a href=&quot;#cb12-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; plt.figure(figsize&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;(&lt;span class=&quot;fl&quot;&gt;10.0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;7.0&lt;/span&gt;))&lt;/span&gt;
&lt;span id=&quot;cb12-31&quot;&gt;&lt;a href=&quot;#cb12-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; fig.add_axes([&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;
&lt;span id=&quot;cb12-32&quot;&gt;&lt;a href=&quot;#cb12-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-33&quot;&gt;&lt;a href=&quot;#cb12-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# We will pass in both the date and rainfall amounts which contain the x and y values respectively&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-34&quot;&gt;&lt;a href=&quot;#cb12-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.plot(date, rainfall)&lt;/span&gt;
&lt;span id=&quot;cb12-35&quot;&gt;&lt;a href=&quot;#cb12-35&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-36&quot;&gt;&lt;a href=&quot;#cb12-36&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_xlabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;date&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb12-37&quot;&gt;&lt;a href=&quot;#cb12-37&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_ylabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;precipitation (mm)&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb12-38&quot;&gt;&lt;a href=&quot;#cb12-38&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_title(&lt;span class=&quot;st&quot;&gt;&amp;#39;Victoria BC daily precipitation&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb12-39&quot;&gt;&lt;a href=&quot;#cb12-39&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig.savefig(&lt;span class=&quot;st&quot;&gt;&amp;#39;daily-precipitation-with-dates.png&amp;#39;&lt;/span&gt;, bbox_inches&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-with-dates-800-8e46ac732.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-with-dates-800-d8ad2d229.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-with-dates-800-d8ad2d229.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC daily precipitation with dates
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;While it‚Äôs interesting to get this data plotted, it‚Äôs not obviously easy to compare one years data against another.&lt;/p&gt;
&lt;h2 id=&quot;comparing-annual-data&quot;&gt;Comparing Annual Data&lt;/h2&gt;
&lt;p&gt;Let‚Äôs slice up the data and plot it against different years.&lt;/p&gt;
&lt;h3 id=&quot;splitting-up-the-data-by-year&quot;&gt;Splitting up the Data by Year&lt;/h3&gt;
&lt;p&gt;We will create a new function that splits up the data by year, and calculates a new field that is days since January 1st of the current year:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb13&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb13-1&quot;&gt;&lt;a href=&quot;#cb13-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; get_days_since_jan1(date):&lt;/span&gt;
&lt;span id=&quot;cb13-2&quot;&gt;&lt;a href=&quot;#cb13-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; date.timetuple().tm_yday &lt;span class=&quot;op&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-3&quot;&gt;&lt;a href=&quot;#cb13-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-4&quot;&gt;&lt;a href=&quot;#cb13-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; split_data_by_year(weather):&lt;/span&gt;
&lt;span id=&quot;cb13-5&quot;&gt;&lt;a href=&quot;#cb13-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    yearly_rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb13-6&quot;&gt;&lt;a href=&quot;#cb13-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    yearly_days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb13-7&quot;&gt;&lt;a href=&quot;#cb13-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    current_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-8&quot;&gt;&lt;a href=&quot;#cb13-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    by_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb13-9&quot;&gt;&lt;a href=&quot;#cb13-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; i, row &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; weather.iterrows():&lt;/span&gt;
&lt;span id=&quot;cb13-10&quot;&gt;&lt;a href=&quot;#cb13-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        date &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; row[&lt;span class=&quot;st&quot;&gt;&amp;#39;Date/Time&amp;#39;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb13-11&quot;&gt;&lt;a href=&quot;#cb13-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; row[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Precip (mm)&amp;#39;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb13-12&quot;&gt;&lt;a href=&quot;#cb13-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-13&quot;&gt;&lt;a href=&quot;#cb13-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; current_year &lt;span class=&quot;kw&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id=&quot;cb13-14&quot;&gt;&lt;a href=&quot;#cb13-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            current_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; date.year&lt;/span&gt;
&lt;span id=&quot;cb13-15&quot;&gt;&lt;a href=&quot;#cb13-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;elif&lt;/span&gt; current_year &lt;span class=&quot;op&quot;&gt;!=&lt;/span&gt; date.year:&lt;/span&gt;
&lt;span id=&quot;cb13-16&quot;&gt;&lt;a href=&quot;#cb13-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            by_year.append((current_year, pandas.DataFrame({&lt;/span&gt;
&lt;span id=&quot;cb13-17&quot;&gt;&lt;a href=&quot;#cb13-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                &lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;: yearly_days_since_jan1,&lt;/span&gt;
&lt;span id=&quot;cb13-18&quot;&gt;&lt;a href=&quot;#cb13-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                &lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;: yearly_rainfall,&lt;/span&gt;
&lt;span id=&quot;cb13-19&quot;&gt;&lt;a href=&quot;#cb13-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                })))&lt;/span&gt;
&lt;span id=&quot;cb13-20&quot;&gt;&lt;a href=&quot;#cb13-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            yearly_days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb13-21&quot;&gt;&lt;a href=&quot;#cb13-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            yearly_rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb13-22&quot;&gt;&lt;a href=&quot;#cb13-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            current_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; date.year&lt;/span&gt;
&lt;span id=&quot;cb13-23&quot;&gt;&lt;a href=&quot;#cb13-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-24&quot;&gt;&lt;a href=&quot;#cb13-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        yearly_rainfall.append(rainfall)&lt;/span&gt;
&lt;span id=&quot;cb13-25&quot;&gt;&lt;a href=&quot;#cb13-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        yearly_days_since_jan1.append(get_days_since_jan1(date))&lt;/span&gt;
&lt;span id=&quot;cb13-26&quot;&gt;&lt;a href=&quot;#cb13-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-27&quot;&gt;&lt;a href=&quot;#cb13-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; current_year &lt;span class=&quot;kw&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id=&quot;cb13-28&quot;&gt;&lt;a href=&quot;#cb13-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        by_year.append((current_year, pandas.DataFrame({&lt;/span&gt;
&lt;span id=&quot;cb13-29&quot;&gt;&lt;a href=&quot;#cb13-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            &lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;: yearly_days_since_jan1,&lt;/span&gt;
&lt;span id=&quot;cb13-30&quot;&gt;&lt;a href=&quot;#cb13-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            &lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;: yearly_rainfall,&lt;/span&gt;
&lt;span id=&quot;cb13-31&quot;&gt;&lt;a href=&quot;#cb13-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            })))&lt;/span&gt;
&lt;span id=&quot;cb13-32&quot;&gt;&lt;a href=&quot;#cb13-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-33&quot;&gt;&lt;a href=&quot;#cb13-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; by_year&lt;/span&gt;
&lt;span id=&quot;cb13-34&quot;&gt;&lt;a href=&quot;#cb13-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-35&quot;&gt;&lt;a href=&quot;#cb13-35&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;rainfall_by_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; slice_data_by_year(weather)&lt;/span&gt;
&lt;span id=&quot;cb13-36&quot;&gt;&lt;a href=&quot;#cb13-36&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;print&lt;/span&gt;(rainfall_by_year)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will then output something similar to:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[(2014,      days_since_jan1  rainfall
0                 0       1.6
1                 1       6.6
..              ...       ...
363             363       0.0
364             364       0.0
[365 rows x 2 columns]),

(2015,      days_since_jan1  rainfall
0                 0       0.0
1                 1       4.8
..              ...       ...
363             363       0.0
364             364       0.0
[366 rows x 2 columns]),

...&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;plotting-the-data-by-year&quot;&gt;Plotting the Data by Year&lt;/h3&gt;
&lt;p&gt;Rather than call &lt;code&gt;ax.plot&lt;/code&gt; a single time; in this example we will call it from inside a for loop once for each year in our data set. We pass the year as a label value, which will then be displayed on the legend.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb15&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb15-1&quot;&gt;&lt;a href=&quot;#cb15-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb15-2&quot;&gt;&lt;a href=&quot;#cb15-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-3&quot;&gt;&lt;a href=&quot;#cb15-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; plt.figure(figsize&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;(&lt;span class=&quot;fl&quot;&gt;10.0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;7.0&lt;/span&gt;), dpi&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb15-4&quot;&gt;&lt;a href=&quot;#cb15-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; fig.add_axes([&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;
&lt;span id=&quot;cb15-5&quot;&gt;&lt;a href=&quot;#cb15-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-6&quot;&gt;&lt;a href=&quot;#cb15-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; year, annual_data &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; rainfall_by_year:&lt;/span&gt;
&lt;span id=&quot;cb15-7&quot;&gt;&lt;a href=&quot;#cb15-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;].to_list()&lt;/span&gt;
&lt;span id=&quot;cb15-8&quot;&gt;&lt;a href=&quot;#cb15-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;].to_list()&lt;/span&gt;
&lt;span id=&quot;cb15-9&quot;&gt;&lt;a href=&quot;#cb15-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    ax.plot(days_since_jan1, rainfall, label&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;year)&lt;/span&gt;
&lt;span id=&quot;cb15-10&quot;&gt;&lt;a href=&quot;#cb15-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-11&quot;&gt;&lt;a href=&quot;#cb15-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# label the axes and title the plot&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-12&quot;&gt;&lt;a href=&quot;#cb15-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_xlabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;days since jan 1st&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb15-13&quot;&gt;&lt;a href=&quot;#cb15-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_ylabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;precipitation (mm)&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb15-14&quot;&gt;&lt;a href=&quot;#cb15-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_title(&lt;span class=&quot;st&quot;&gt;&amp;#39;Victoria BC daily precipitation since Jan 1st&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb15-15&quot;&gt;&lt;a href=&quot;#cb15-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-16&quot;&gt;&lt;a href=&quot;#cb15-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.legend()&lt;/span&gt;
&lt;span id=&quot;cb15-17&quot;&gt;&lt;a href=&quot;#cb15-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-18&quot;&gt;&lt;a href=&quot;#cb15-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# save the plot to disk&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-19&quot;&gt;&lt;a href=&quot;#cb15-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig.savefig(&lt;span class=&quot;st&quot;&gt;&amp;#39;daily-precipitation-by-year.png&amp;#39;&lt;/span&gt;, bbox_inches&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will produce the following plot:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-by-year-800-6e1e40fd1.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-by-year-800-d2636209c.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-by-year-800-d2636209c.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC daily precipitation with dates
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;Well that‚Äôs interesting, but still rather hard to compare one year against another. We can fix that by plotting the yearly cumulative sum.&lt;/p&gt;
&lt;h3 id=&quot;plotting-cumulative-annual-rainfall-by-year&quot;&gt;Plotting Cumulative Annual Rainfall by Year&lt;/h3&gt;
&lt;p&gt;One potential way to plot the cumulative annual rainfall would be to modify the &lt;code&gt;split_data_by_year&lt;/code&gt; function to keep a yearly running total for the rainfall; however, pandas implements a &lt;code&gt;cumsum&lt;/code&gt; function which can perform the calculation for us:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb16&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb16-1&quot;&gt;&lt;a href=&quot;#cb16-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb16-2&quot;&gt;&lt;a href=&quot;#cb16-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-3&quot;&gt;&lt;a href=&quot;#cb16-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; plt.figure(figsize&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;(&lt;span class=&quot;fl&quot;&gt;10.0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;7.0&lt;/span&gt;), dpi&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb16-4&quot;&gt;&lt;a href=&quot;#cb16-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; fig.add_axes([&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;
&lt;span id=&quot;cb16-5&quot;&gt;&lt;a href=&quot;#cb16-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-6&quot;&gt;&lt;a href=&quot;#cb16-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; year, annual_data &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; rainfall_by_year:&lt;/span&gt;
&lt;span id=&quot;cb16-7&quot;&gt;&lt;a href=&quot;#cb16-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;].to_list()&lt;/span&gt;
&lt;span id=&quot;cb16-8&quot;&gt;&lt;a href=&quot;#cb16-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;].cumsum().to_list()&lt;/span&gt;
&lt;span id=&quot;cb16-9&quot;&gt;&lt;a href=&quot;#cb16-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    ax.plot(days_since_jan1, rainfall, label&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;year)&lt;/span&gt;
&lt;span id=&quot;cb16-10&quot;&gt;&lt;a href=&quot;#cb16-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-11&quot;&gt;&lt;a href=&quot;#cb16-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# label the axes and title the plot&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-12&quot;&gt;&lt;a href=&quot;#cb16-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_xlabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;days since jan 1st&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb16-13&quot;&gt;&lt;a href=&quot;#cb16-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_ylabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;precipitation (mm)&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb16-14&quot;&gt;&lt;a href=&quot;#cb16-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_title(&lt;span class=&quot;st&quot;&gt;&amp;#39;Victoria BC cumulative annual precipitation&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb16-15&quot;&gt;&lt;a href=&quot;#cb16-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-16&quot;&gt;&lt;a href=&quot;#cb16-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.legend()&lt;/span&gt;
&lt;span id=&quot;cb16-17&quot;&gt;&lt;a href=&quot;#cb16-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-18&quot;&gt;&lt;a href=&quot;#cb16-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# save the plot to disk&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-19&quot;&gt;&lt;a href=&quot;#cb16-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig.savefig(&lt;span class=&quot;st&quot;&gt;&amp;#39;cumulative-annual-precipitation.png&amp;#39;&lt;/span&gt;, bbox_inches&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Finally, a clear image starts to appear:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-800-10424472a.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-800-42450ace6.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-800-42450ace6.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC cumulative annual precipitation
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;h3 id=&quot;accounting-for-missing-data&quot;&gt;Accounting for Missing Data&lt;/h3&gt;
&lt;p&gt;If you look closely at the previous plot, there‚Äôs a few gaps in the data. This occurred due to the fact that the initial data set contains an empty string &lt;code&gt;&quot;&quot;&lt;/code&gt; in places where either no data is available, or where the data is zero. Since it‚Äôs not obvious which case applies, pandas will parse this empty string as &lt;code&gt;nan&lt;/code&gt; (not-a-number).&lt;/p&gt;
&lt;p&gt;In our case, the Environment Canada data encodes no snow as &lt;code&gt;&quot;&quot;&lt;/code&gt; rather than &lt;code&gt;0&lt;/code&gt; cm. We will instruct pandas to fill in these gaps with a default value of &lt;code&gt;0&lt;/code&gt;, using the &lt;code&gt;fillna()&lt;/code&gt; method:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb17&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb17-1&quot;&gt;&lt;a href=&quot;#cb17-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Precip (mm)&amp;#39;&lt;/span&gt;] &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Precip (mm)&amp;#39;&lt;/span&gt;].fillna(&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb17-2&quot;&gt;&lt;a href=&quot;#cb17-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Snow (cm)&amp;#39;&lt;/span&gt;] &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Snow (cm)&amp;#39;&lt;/span&gt;].fillna(&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will produce a plot without gaps:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-no-gaps-800-60cdfabc8.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-no-gaps-800-d82f716e2.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-no-gaps-800-d82f716e2.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC cumulative annual precipitation
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;h3 id=&quot;reordering-the-legend-and-fixing-the-x-axis&quot;&gt;Reordering the Legend and Fixing the X Axis&lt;/h3&gt;
&lt;p&gt;The previous plot is difficult to see which colours correspond to which years (especially hard if you are colour blind). We will re-order the legend from wettest to driest years, with 2021 being dead-last.&lt;/p&gt;
&lt;p&gt;To sort the data, we will create a new function &lt;code&gt;get_total_rainfall&lt;/code&gt;, which returns a new value for python‚Äôs &lt;code&gt;sorted&lt;/code&gt; function to use when sorting values. We return a tuple so that the year can be used to differentiate between cases where the annual precipitation is identical.&lt;/p&gt;
&lt;p&gt;Additionally, let‚Äôs fix the x-axis to display the name of the month, rather than an integer value.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb18&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb18-1&quot;&gt;&lt;a href=&quot;#cb18-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib&lt;/span&gt;
&lt;span id=&quot;cb18-2&quot;&gt;&lt;a href=&quot;#cb18-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb18-3&quot;&gt;&lt;a href=&quot;#cb18-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-4&quot;&gt;&lt;a href=&quot;#cb18-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; plt.figure(figsize&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;(&lt;span class=&quot;fl&quot;&gt;10.0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;7.0&lt;/span&gt;), dpi&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb18-5&quot;&gt;&lt;a href=&quot;#cb18-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; fig.add_axes([&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;
&lt;span id=&quot;cb18-6&quot;&gt;&lt;a href=&quot;#cb18-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-7&quot;&gt;&lt;a href=&quot;#cb18-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; get_total_rainfall(val):&lt;/span&gt;
&lt;span id=&quot;cb18-8&quot;&gt;&lt;a href=&quot;#cb18-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    year, annual_data &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; val&lt;/span&gt;
&lt;span id=&quot;cb18-9&quot;&gt;&lt;a href=&quot;#cb18-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    total_rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;].cumsum().to_list()[&lt;span class=&quot;op&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb18-10&quot;&gt;&lt;a href=&quot;#cb18-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; (total_rainfall, year)&lt;/span&gt;
&lt;span id=&quot;cb18-11&quot;&gt;&lt;a href=&quot;#cb18-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-12&quot;&gt;&lt;a href=&quot;#cb18-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; year, annual_data &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;sorted&lt;/span&gt;(rainfall_by_year, key&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;get_total_rainfall, reverse&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;True&lt;/span&gt;):&lt;/span&gt;
&lt;span id=&quot;cb18-13&quot;&gt;&lt;a href=&quot;#cb18-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;].to_list()&lt;/span&gt;
&lt;span id=&quot;cb18-14&quot;&gt;&lt;a href=&quot;#cb18-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;].cumsum().to_list()&lt;/span&gt;
&lt;span id=&quot;cb18-15&quot;&gt;&lt;a href=&quot;#cb18-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    ax.plot(days_since_jan1, rainfall, label&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;year)&lt;/span&gt;
&lt;span id=&quot;cb18-16&quot;&gt;&lt;a href=&quot;#cb18-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-17&quot;&gt;&lt;a href=&quot;#cb18-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# format x axis values as month names rather than days since jan 1st&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-18&quot;&gt;&lt;a href=&quot;#cb18-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; format_days_since_jan1(days, pos&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;):&lt;/span&gt;
&lt;span id=&quot;cb18-19&quot;&gt;&lt;a href=&quot;#cb18-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    date &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; datetime.date(&lt;span class=&quot;dv&quot;&gt;2020&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; datetime.timedelta(days)&lt;/span&gt;
&lt;span id=&quot;cb18-20&quot;&gt;&lt;a href=&quot;#cb18-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; date.strftime(&lt;span class=&quot;st&quot;&gt;&amp;#39;%b&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb18-21&quot;&gt;&lt;a href=&quot;#cb18-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.xaxis.set_major_formatter(matplotlib.ticker.FuncFormatter(format_days_since_jan1))&lt;/span&gt;
&lt;span id=&quot;cb18-22&quot;&gt;&lt;a href=&quot;#cb18-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-23&quot;&gt;&lt;a href=&quot;#cb18-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# label the axes and title the plot&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-24&quot;&gt;&lt;a href=&quot;#cb18-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_xlabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;calendar date&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb18-25&quot;&gt;&lt;a href=&quot;#cb18-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_ylabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;precipitation (mm)&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb18-26&quot;&gt;&lt;a href=&quot;#cb18-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_title(&lt;span class=&quot;st&quot;&gt;&amp;#39;Victoria BC cumulative annual precipitation&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb18-27&quot;&gt;&lt;a href=&quot;#cb18-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-28&quot;&gt;&lt;a href=&quot;#cb18-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.legend()&lt;/span&gt;
&lt;span id=&quot;cb18-29&quot;&gt;&lt;a href=&quot;#cb18-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-30&quot;&gt;&lt;a href=&quot;#cb18-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# save the plot to disk&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-31&quot;&gt;&lt;a href=&quot;#cb18-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig.savefig(&lt;span class=&quot;st&quot;&gt;&amp;#39;cumulative-annual-precipitation-sorted-legend.png&amp;#39;&lt;/span&gt;, bbox_inches&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And here we have it, 2021 has been a really dry year here in Victoria:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-sorted-legend-800-2250e68fc.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-sorted-legend-800-4f2dc358d.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-sorted-legend-800-4f2dc358d.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC cumulative annual precipitation v2
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;h2 id=&quot;accounting-for-snow&quot;&gt;Accounting for Snow&lt;/h2&gt;
&lt;p&gt;The previous plots have an error ‚Äì they were only plotting rainfall, and not accounting for snowfall. It‚Äôs difficult to directly convert snowfall into an equivalent amount of precipitation due to the variety of snow crystal sizes ‚Äì some snow is wet, while other snow is fairly dry. On the west-coast (wet-coast as some call it); when we do get snow, it tends to be fairly wet. We will assume that 13mm of snow is equivalent to 1mm of rain &lt;a href=&quot;#fn1&quot; class=&quot;footnote-ref&quot; id=&quot;fnref1&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Let‚Äôs revise our &lt;code&gt;split_data_by_year&lt;/code&gt; function to calculate this.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb19&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb19-1&quot;&gt;&lt;a href=&quot;#cb19-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; split_data_by_year(weather):&lt;/span&gt;
&lt;span id=&quot;cb19-2&quot;&gt;&lt;a href=&quot;#cb19-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    yearly_rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb19-3&quot;&gt;&lt;a href=&quot;#cb19-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    yearly_days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb19-4&quot;&gt;&lt;a href=&quot;#cb19-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    current_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-5&quot;&gt;&lt;a href=&quot;#cb19-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    by_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb19-6&quot;&gt;&lt;a href=&quot;#cb19-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; i, row &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; weather.iterrows():&lt;/span&gt;
&lt;span id=&quot;cb19-7&quot;&gt;&lt;a href=&quot;#cb19-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        date &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; row[&lt;span class=&quot;st&quot;&gt;&amp;#39;Date/Time&amp;#39;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb19-8&quot;&gt;&lt;a href=&quot;#cb19-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; row[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Precip (mm)&amp;#39;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb19-9&quot;&gt;&lt;a href=&quot;#cb19-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-10&quot;&gt;&lt;a href=&quot;#cb19-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;co&quot;&gt;# 1cm snow = 10mm snow; 13mm of snow = 1mm of rain&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-11&quot;&gt;&lt;a href=&quot;#cb19-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        snowfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; row[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Snow (cm)&amp;#39;&lt;/span&gt;] &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;fl&quot;&gt;10.0&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;fl&quot;&gt;13.0&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-12&quot;&gt;&lt;a href=&quot;#cb19-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        rainfall &lt;span class=&quot;op&quot;&gt;+=&lt;/span&gt; snowfall&lt;/span&gt;
&lt;span id=&quot;cb19-13&quot;&gt;&lt;a href=&quot;#cb19-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-14&quot;&gt;&lt;a href=&quot;#cb19-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; current_year &lt;span class=&quot;kw&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id=&quot;cb19-15&quot;&gt;&lt;a href=&quot;#cb19-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            current_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; date.year&lt;/span&gt;
&lt;span id=&quot;cb19-16&quot;&gt;&lt;a href=&quot;#cb19-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;elif&lt;/span&gt; current_year &lt;span class=&quot;op&quot;&gt;!=&lt;/span&gt; date.year:&lt;/span&gt;
&lt;span id=&quot;cb19-17&quot;&gt;&lt;a href=&quot;#cb19-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            by_year.append((current_year, pandas.DataFrame({&lt;/span&gt;
&lt;span id=&quot;cb19-18&quot;&gt;&lt;a href=&quot;#cb19-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                &lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;: yearly_days_since_jan1,&lt;/span&gt;
&lt;span id=&quot;cb19-19&quot;&gt;&lt;a href=&quot;#cb19-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                &lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;: yearly_rainfall,&lt;/span&gt;
&lt;span id=&quot;cb19-20&quot;&gt;&lt;a href=&quot;#cb19-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                })))&lt;/span&gt;
&lt;span id=&quot;cb19-21&quot;&gt;&lt;a href=&quot;#cb19-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            yearly_days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb19-22&quot;&gt;&lt;a href=&quot;#cb19-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            yearly_rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb19-23&quot;&gt;&lt;a href=&quot;#cb19-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            current_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; date.year&lt;/span&gt;
&lt;span id=&quot;cb19-24&quot;&gt;&lt;a href=&quot;#cb19-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-25&quot;&gt;&lt;a href=&quot;#cb19-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        yearly_rainfall.append(rainfall)&lt;/span&gt;
&lt;span id=&quot;cb19-26&quot;&gt;&lt;a href=&quot;#cb19-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        yearly_days_since_jan1.append(get_days_since_jan1(date))&lt;/span&gt;
&lt;span id=&quot;cb19-27&quot;&gt;&lt;a href=&quot;#cb19-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-28&quot;&gt;&lt;a href=&quot;#cb19-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; current_year &lt;span class=&quot;kw&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id=&quot;cb19-29&quot;&gt;&lt;a href=&quot;#cb19-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        by_year.append((current_year, pandas.DataFrame({&lt;/span&gt;
&lt;span id=&quot;cb19-30&quot;&gt;&lt;a href=&quot;#cb19-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            &lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;: yearly_days_since_jan1,&lt;/span&gt;
&lt;span id=&quot;cb19-31&quot;&gt;&lt;a href=&quot;#cb19-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            &lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;: yearly_rainfall,&lt;/span&gt;
&lt;span id=&quot;cb19-32&quot;&gt;&lt;a href=&quot;#cb19-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            })))&lt;/span&gt;
&lt;span id=&quot;cb19-33&quot;&gt;&lt;a href=&quot;#cb19-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-34&quot;&gt;&lt;a href=&quot;#cb19-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; by_year&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you look closely, once we adjust for snow, it turned out that 2017 was a wetter year compared to 2014:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-with-snow-800-e85637744.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-with-snow-800-bc4754e2f.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-with-snow-800-bc4754e2f.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC cumulative annual precipitation including snow
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;None of that however changes the fact that it‚Äôs been a very dry year, and my garden is browner than ever. On the other hand, my tomatoes have been loving the heat.&lt;/p&gt;
&lt;p&gt;If you would like to try generating the above graphs, all the code (and data) can be found under &lt;a href=&quot;https://github.com/earthly/example-plotting-precipitation&quot;&gt;github.com/earthly/example-plotting-precipitation&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;notice--info notice--big&quot;&gt;
&lt;p&gt;
&lt;strong&gt;While you‚Äôre here:&lt;/strong&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today.
&lt;/p&gt;
&lt;/div&gt;
&lt;section class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&quot;fn1&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;https://www.nssl.noaa.gov/education/svrwx101/winter/faq/&lt;a href=&quot;#fnref1&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;‚Ü©Ô∏é&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;</content><author><name>Alex Couture-Beil</name></author><category term="Tutorials" /><summary type="html">Where Did All The Rain Go? It‚Äôs been a really dry summer here in Victoria BC (and the rest of the province). I couldn‚Äôt remember the last time it had rained, which got me looking at historical weather data. Before I knew it, rather than simply look up how many days it‚Äôs been since it last rained (42 and counting!), I was plotting cumulative annual rainfall. Get Some Data I ended up on Environment Canada‚Äôs historic data search page, and ended up with a table of daily weather recorded at Victoria International Airport, climate ID 1018621 (which is closer to Sidney BC, but I digress). On the right hand side of that page, there was an option to download the data as CSV. Upon clicking the Download Data button, my web browser was redirected to: https://climate.weather.gc.ca/climate_data/bulk_data_e.html?format=csv&amp;amp;stationID=51337&amp;amp;Year=2021&amp;amp;Month=7&amp;amp;Day=1&amp;amp;time=&amp;amp;timeframe=2&amp;amp;submit=Download+Data The website gave me an option to change the range of data to download; however if you squint enough, the above URL looks like an API. Furthermore, the month and day values didn‚Äôt seem to affect anything ‚Äì since this was annual data, only the year was used. It‚Äôs also interesting to note that the station ID is different from the Climate ID even though Environment Canada defines ‚Äúthe climate ID is a 7 digit number assigned by the Meteorological Service of Canada to a site where official weather observations are taken, and serves as a permanent, unique identifier.‚Äù Perhaps there was a thought leader who was suffering from past trauma where a client‚Äôs definition of a ‚Äúpermanent unique identifier‚Äù didn‚Äôt match up with a relational databases‚Äô definition of a unique identifier, and insisted on creating a lookup table for these different IDs. Again, I digress, back to downloading data. I wrote a bash while loop to download this data: #!/bin/sh set -e for year in $(seq 2013 2021); do curl &amp;quot;https://climate.weather.gc.ca/climate_data/bulk_data_e.html?format=csv&amp;amp;stationID=51337&amp;amp;Year=${year}&amp;amp;timeframe=2&amp;quot; &amp;gt; victoria-weather-$year.csv done Parsing the Data Using the Standard csv.reader Parser Python offers a standard library for parsing .csv files, aptly named csv. The csv library is fairly low-level and provides a csv.reader which can be used to iterate over rows: import csv with open(&amp;#39;data/victoria-weather-2020.csv&amp;#39;) as fp: reader = csv.reader(fp) for row in reader: print(row) This will output something such as [&amp;#39;\ufeff&amp;quot;Longitude (x)&amp;quot;&amp;#39;, &amp;#39;Latitude (y)&amp;#39;, &amp;#39;Station Name&amp;#39;, &amp;#39;Climate ID&amp;#39;, &amp;#39;Date/Time&amp;#39;, &amp;#39;Year&amp;#39;, &amp;#39;Month&amp;#39;, &amp;#39;Day&amp;#39;, &amp;#39;Data Quality&amp;#39;, &amp;#39;Max Temp (¬∞C)&amp;#39;, &amp;#39;Max Temp Flag&amp;#39;, &amp;#39;Min Temp (¬∞C)&amp;#39;, &amp;#39;Min Temp Flag&amp;#39;, &amp;#39;Mean Temp (¬∞C)&amp;#39;, &amp;#39;Mean Temp Flag&amp;#39;, &amp;#39;Heat Deg Days (¬∞C)&amp;#39;, &amp;#39;Heat Deg Days Flag&amp;#39;, &amp;#39;Cool Deg Days (¬∞C)&amp;#39;, &amp;#39;Cool Deg Days Flag&amp;#39;, &amp;#39;Total Rain (mm)&amp;#39;, &amp;#39;Total Rain Flag&amp;#39;, &amp;#39;Total Snow (cm)&amp;#39;, &amp;#39;Total Snow Flag&amp;#39;, &amp;#39;Total Precip (mm)&amp;#39;, &amp;#39;Total Precip Flag&amp;#39;, &amp;#39;Snow on Grnd (cm)&amp;#39;, &amp;#39;Snow on Grnd Flag&amp;#39;, &amp;#39;Dir of Max Gust (10s deg)&amp;#39;, &amp;#39;Dir of Max Gust Flag&amp;#39;, &amp;#39;Spd of Max Gust (km/h)&amp;#39;, &amp;#39;Spd of Max Gust Flag&amp;#39;] [&amp;#39;-123.43&amp;#39;, &amp;#39;48.65&amp;#39;, &amp;#39;VICTORIA INTL A&amp;#39;, &amp;#39;1018621&amp;#39;, &amp;#39;2020-01-01&amp;#39;, &amp;#39;2020&amp;#39;, &amp;#39;01&amp;#39;, &amp;#39;01&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;12.9&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;5.5&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;9.2&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;8.8&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;T&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;T&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;26&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;59&amp;#39;, &amp;#39;&amp;#39;] [&amp;#39;-123.43&amp;#39;, &amp;#39;48.65&amp;#39;, &amp;#39;VICTORIA INTL A&amp;#39;, &amp;#39;1018621&amp;#39;, &amp;#39;2020-01-02&amp;#39;, &amp;#39;2020&amp;#39;, &amp;#39;01&amp;#39;, &amp;#39;02&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;6.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.9&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;3.5&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14.5&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14.6&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14.6&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;45&amp;#39;, &amp;#39;&amp;#39;] The downside of using the standard python csv.reader parser, is it simply returns all cells as strings, and doesn‚Äôt differentiate between cell headers and cell contents. Furthermore, the underlying data seems to have some sort of unicode character that‚Äôs not being correctly handled. Using the Standard csv.DictReader Parser The csv library provides a csv.DictReader class which will use the first row as cell headers, and rather than returning the row as a list; instead it will return it as a dictionary: {&amp;#39;\ufeff&amp;quot;Longitude (x)&amp;quot;&amp;#39;: &amp;#39;-123.43&amp;#39;, &amp;#39;Latitude (y)&amp;#39;: &amp;#39;48.65&amp;#39;, &amp;#39;Station Name&amp;#39;: &amp;#39;VICTORIA INTL A&amp;#39;, &amp;#39;Climate ID&amp;#39;: &amp;#39;1018621&amp;#39;, &amp;#39;Date/Time&amp;#39;: &amp;#39;2020-01-01&amp;#39;, &amp;#39;Year&amp;#39;: &amp;#39;2020&amp;#39;, &amp;#39;Month&amp;#39;: &amp;#39;01&amp;#39;, &amp;#39;Day&amp;#39;: &amp;#39;01&amp;#39;, &amp;#39;Data Quality&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Max Temp (¬∞C)&amp;#39;: &amp;#39;12.9&amp;#39;, &amp;#39;Max Temp Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Min Temp (¬∞C)&amp;#39;: &amp;#39;5.5&amp;#39;, &amp;#39;Min Temp Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Mean Temp (¬∞C)&amp;#39;: &amp;#39;9.2&amp;#39;, &amp;#39;Mean Temp Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Heat Deg Days (¬∞C)&amp;#39;: &amp;#39;8.8&amp;#39;, &amp;#39;Heat Deg Days Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Cool Deg Days (¬∞C)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Cool Deg Days Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Total Rain (mm)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Total Rain Flag&amp;#39;: &amp;#39;T&amp;#39;, &amp;#39;Total Snow (cm)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Total Snow Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Total Precip (mm)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Total Precip Flag&amp;#39;: &amp;#39;T&amp;#39;, &amp;#39;Snow on Grnd (cm)&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Snow on Grnd Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Dir of Max Gust (10s deg)&amp;#39;: &amp;#39;26&amp;#39;, &amp;#39;Dir of Max Gust Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Spd of Max Gust (km/h)&amp;#39;: &amp;#39;59&amp;#39;, &amp;#39;Spd of Max Gust Flag&amp;#39;: &amp;#39;&amp;#39;} However, the DictReader doesn‚Äôt parse the cell contents and returns everything simply as strings ‚Äì leaving all type parsing to the user. Again we see the incorrectly handled unicode character appear ‚Äì this time within the key of every row. Using the Pandas Library The pandas library is a third-party python library which provides tools for data analysis and manipulation. We will be using the pandas.read_csv function to parse our data: import pandas weather = pandas.read_csv(&amp;#39;data/victoria-weather-2020.csv&amp;#39;) print(weather) This will produce output such as: Longitude (x) Latitude (y) Station Name Climate ID Date/Time Year Month Day ... Total Precip (mm) Total Precip Flag Snow on Grnd (cm) Snow on Grnd Flag Dir of Max Gust (10s deg) Dir of Max Gust Flag Spd of Max Gust (km/h) Spd of Max Gust Flag 0 -123.43 48.65 VICTORIA INTL A 1018621 2020-01-01 2020 1 1 ... 0.0 T NaN NaN 26.0 NaN 59.0 NaN 1 -123.43 48.65 VICTORIA INTL A 1018621 2020-01-02 2020 1 2 ... 14.6 NaN NaN NaN 14.0 NaN 45.0 NaN 2 -123.43 48.65 VICTORIA INTL A 1018621 2020-01-03 2020 1 3 ... 11.2 NaN NaN NaN 15.0 NaN 39.0 NaN .. ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... 363 -123.43 48.65 VICTORIA INTL A 1018621 2020-12-29 2020 12 29 ... 8.7 NaN NaN NaN NaN M NaN M 364 -123.43 48.65 VICTORIA INTL A 1018621 2020-12-30 2020 12 30 ... 20.4 NaN NaN NaN 14.0 NaN 61.0 NaN 365 -123.43 48.65 VICTORIA INTL A 1018621 2020-12-31 2020 12 31 ... 7.2 NaN NaN NaN 14.0 NaN 33.0 NaN [366 rows x 31 columns] Notice how the columns have been automatically parsed to an appropriate data type, as well as the column headers are detected. Row numbers are additionally displayed, as well as the data is displayed as a table. This is possible due to the fact that the read_csv function returns a pandas.core.frame.DataFrame data type which among other things, implements the __str__ method which is used to render the string which is passed to the print function. Merging Multiple Datasets My dataset is split across multiple csv files, with each file containing a dataset for a specific year. My first task is to merge them together. All the datasets are located under the data directory, and are named victoria-weather-YYYY.csv (where YYYY is the year). Let‚Äôs write a function to parse all the data: import re import os import pandas def get_data(weather_dir): p = re.compile(&amp;#39;victoria-weather-[0-9]+.csv&amp;#39;) data = [] for filename in sorted(os.listdir(weather_dir)): if p.match(filename): path = os.path.join(weather_dir, filename) yearly_data = pandas.read_csv(path) data.append(yearly_data) return pandas.concat(data) weather = get_data(&amp;#39;data&amp;#39;) print(weather) This function 1) uses a regular expression to ensure we only parse files which match the expected form, which prevents our program from crashing if any other files existed in the directory, 2) parses each file separately using the read_csv function, 3) saves the returned data frame into the data list, then finally 4) concatenates the data using the concat function. This code should output a single data frame containing all the data spanning a decade: Longitude (x) Latitude (y) Station Name Climate ID Date/Time Year Month Day Data Quality ... Total Snow Flag Total Precip (mm) Total Precip Flag Snow on Grnd (cm) Snow on Grnd Flag Dir of Max Gust (10s deg) Dir of Max Gust Flag Spd of Max Gust (km/h) Spd of Max Gust Flag 0 -123.43 48.65 VICTORIA INTL A 1018621 2014-01-01 2014 1 1 NaN ... NaN 1.6 NaN NaN NaN NaN NaN &amp;lt;31 NaN 1 -123.43 48.65 VICTORIA INTL A 1018621 2014-01-02 2014 1 2 NaN ... NaN 6.6 NaN NaN NaN 21.0 NaN 37 NaN 2 -123.43 48.65 VICTORIA INTL A 1018621 2014-01-03 2014 1 3 NaN ... NaN 0.0 NaN NaN NaN 31.0 NaN 41 NaN 3 -123.43 48.65 VICTORIA INTL A 1018621 2014-01-04 2014 1 4 NaN ... NaN 0.0 NaN NaN NaN NaN NaN &amp;lt;31 NaN 4 -123.43 48.65 VICTORIA INTL A 1018621 2014-01-05 2014 1 5 NaN ... NaN 0.0 NaN NaN NaN NaN NaN &amp;lt;31 NaN .. ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... 198 -123.43 48.65 VICTORIA INTL A 1018621 2021-07-18 2021 7 18 NaN ... NaN 0.0 NaN NaN NaN NaN NaN NaN M 199 -123.43 48.65 VICTORIA INTL A 1018621 2021-07-19 2021 7 19 NaN ... NaN 0.0 NaN NaN NaN 25.0 NaN 37.0 NaN 200 -123.43 48.65 VICTORIA INTL A 1018621 2021-07-20 2021 7 20 NaN ... NaN 0.0 NaN NaN NaN 29.0 NaN 36.0 NaN 201 -123.43 48.65 VICTORIA INTL A 1018621 2021-07-21 2021 7 21 NaN ... NaN 0.0 NaN NaN NaN 28.0 NaN 33.0 NaN 202 -123.43 48.65 VICTORIA INTL A 1018621 2021-07-22 2021 7 22 NaN ... NaN 0.0 NaN NaN NaN NaN M NaN M [2760 rows x 31 columns] Raindrops Keep Falling on my Plots Let‚Äôs plot the rainfall! We will use the matplotlib library for visualizing this data. We can extract a single column of the data frame using the column name, e.g.¬†weather['Total Precip (mm)']. This will return a pandas.core.series.Series data type, which is similar to a list; however requires each element in the series to be the same data type. This allows pandas to keep all elements in contiguous memory, which allows faster SIMD-based operations. For another example of comparing generic data types against specific native types, checkout out our post on the various tricks that python‚Äôs timsort uses to achieve better performance. A pandas series can be converted into a python list using the .to_list() method; e.g.¬†weather['Total Precip (mm)'].to_list() Plotting the Data Interactively Here‚Äôs a quick example of plotting this data interactively: import matplotlib.pyplot as plt rainfall = weather[&amp;#39;Total Precip (mm)&amp;#39;].to_list() plt.plot(rainfall) plt.show() This will display a new window, containing a plot of the data: Victoria BC daily precipitation interactive plot It should be possible to omit the .to_list() call, which would then pass the pandas series data type directly to the matplotlib plot function rather than passing a standard python list; however, there‚Äôs a bug in matplotlib (or pandas), which produces the following erroneous plot: Notice how this plot has some bizarre lines that criss-cross the plot, and that the data points stop at roughly 350 rather than past 2500? At a quick glance, this might be an instance of this bug. Saving the Plot Programmatically Lets revise the previous code to render the plot as a png instead of using an interactive window: import matplotlib.pyplot as plt # create a new figure that is 10x7 inches # which is rendered as 100 pixels per inch # (matplotlib incorrectly refers to this as dots-per-inch, which is a printer term) fig = plt.figure(figsize=(10.0, 7.0), dpi=100) # define axes on the figure to take up the entire figure canvas ax = fig.add_axes([0, 0, 1, 1]) # plot the rainfall amounts against the axes ax.plot(rainfall) # label the axes and title the plot ax.set_xlabel(&amp;#39;days since start of dataset&amp;#39;) ax.set_ylabel(&amp;#39;precipitation (mm)&amp;#39;) ax.set_title(&amp;#39;Victoria BC daily precipitation&amp;#39;) # save the plot to disk fig.savefig(&amp;#39;daily-precipitation.png&amp;#39;, bbox_inches=&amp;#39;tight&amp;#39;) Which will produce: Victoria BC daily precipitation Fixing the X Axis Label to Display the Date The previous plots didn‚Äôt make use of the Date/Time column from our weather data csv files; instead it was simply displaying the index of the list element. We need to instruct pandas to parse those columns as dates using the parse_dates field. We will additionally define a date parsing function yyyymmdd_parser which will be used to parse the date; without this function, pandas will attempt to guess the format of the date, which is a best-effort strategy and may not always work. import re import os import pandas import datetime import matplotlib.pyplot as plt # Our new date parser def yyyymmdd_parser(s): return datetime.datetime.strptime(s, &amp;#39;%Y-%m-%d&amp;#39;) def get_data(weather_dir): p = re.compile(&amp;#39;victoria-weather-[0-9]+.csv&amp;#39;) data = [] for filename in sorted(os.listdir(weather_dir)): if p.match(filename): path = os.path.join(weather_dir, filename) # We identify which column contains the date, along with the date parser to use. yearly_data = pandas.read_csv(path, parse_dates=[&amp;#39;Date/Time&amp;#39;], date_parser=yyyymmdd_parser) data.append(yearly_data) return pandas.concat(data) weather = get_data(&amp;#39;data&amp;#39;) rainfall = weather[&amp;#39;Total Precip (mm)&amp;#39;].to_list() # We will convert all dates into the native python datetime format, which works # better with matplotlib. date = [x.to_pydatetime() for x in weather[&amp;#39;Date/Time&amp;#39;]] fig = plt.figure(figsize=(10.0, 7.0)) ax = fig.add_axes([0,0,1,1]) # We will pass in both the date and rainfall amounts which contain the x and y values respectively ax.plot(date, rainfall) ax.set_xlabel(&amp;#39;date&amp;#39;) ax.set_ylabel(&amp;#39;precipitation (mm)&amp;#39;) ax.set_title(&amp;#39;Victoria BC daily precipitation&amp;#39;) fig.savefig(&amp;#39;daily-precipitation-with-dates.png&amp;#39;, bbox_inches=&amp;#39;tight&amp;#39;) Victoria BC daily precipitation with dates While it‚Äôs interesting to get this data plotted, it‚Äôs not obviously easy to compare one years data against another. Comparing Annual Data Let‚Äôs slice up the data and plot it against different years. Splitting up the Data by Year We will create a new function that splits up the data by year, and calculates a new field that is days since January 1st of the current year: def get_days_since_jan1(date): return date.timetuple().tm_yday - 1 def split_data_by_year(weather): yearly_rainfall = [] yearly_days_since_jan1 = [] current_year = None by_year = [] for i, row in weather.iterrows(): date = row[&amp;#39;Date/Time&amp;#39;] rainfall = row[&amp;#39;Total Precip (mm)&amp;#39;] if current_year is None: current_year = date.year elif current_year != date.year: by_year.append((current_year, pandas.DataFrame({ &amp;#39;days_since_jan1&amp;#39;: yearly_days_since_jan1, &amp;#39;rainfall&amp;#39;: yearly_rainfall, }))) yearly_days_since_jan1 = [] yearly_rainfall = [] current_year = date.year yearly_rainfall.append(rainfall) yearly_days_since_jan1.append(get_days_since_jan1(date)) if current_year is not None: by_year.append((current_year, pandas.DataFrame({ &amp;#39;days_since_jan1&amp;#39;: yearly_days_since_jan1, &amp;#39;rainfall&amp;#39;: yearly_rainfall, }))) return by_year rainfall_by_year = slice_data_by_year(weather) print(rainfall_by_year) This will then output something similar to: [(2014, days_since_jan1 rainfall 0 0 1.6 1 1 6.6 .. ... ... 363 363 0.0 364 364 0.0 [365 rows x 2 columns]), (2015, days_since_jan1 rainfall 0 0 0.0 1 1 4.8 .. ... ... 363 363 0.0 364 364 0.0 [366 rows x 2 columns]), ... Plotting the Data by Year Rather than call ax.plot a single time; in this example we will call it from inside a for loop once for each year in our data set. We pass the year as a label value, which will then be displayed on the legend. import matplotlib.pyplot as plt fig = plt.figure(figsize=(10.0, 7.0), dpi=100) ax = fig.add_axes([0, 0, 1, 1]) for year, annual_data in rainfall_by_year: days_since_jan1 = annual_data[&amp;#39;days_since_jan1&amp;#39;].to_list() rainfall = annual_data[&amp;#39;rainfall&amp;#39;].to_list() ax.plot(days_since_jan1, rainfall, label=year) # label the axes and title the plot ax.set_xlabel(&amp;#39;days since jan 1st&amp;#39;) ax.set_ylabel(&amp;#39;precipitation (mm)&amp;#39;) ax.set_title(&amp;#39;Victoria BC daily precipitation since Jan 1st&amp;#39;) ax.legend() # save the plot to disk fig.savefig(&amp;#39;daily-precipitation-by-year.png&amp;#39;, bbox_inches=&amp;#39;tight&amp;#39;) This will produce the following plot: Victoria BC daily precipitation with dates Well that‚Äôs interesting, but still rather hard to compare one year against another. We can fix that by plotting the yearly cumulative sum. Plotting Cumulative Annual Rainfall by Year One potential way to plot the cumulative annual rainfall would be to modify the split_data_by_year function to keep a yearly running total for the rainfall; however, pandas implements a cumsum function which can perform the calculation for us: import matplotlib.pyplot as plt fig = plt.figure(figsize=(10.0, 7.0), dpi=100) ax = fig.add_axes([0, 0, 1, 1]) for year, annual_data in rainfall_by_year: days_since_jan1 = annual_data[&amp;#39;days_since_jan1&amp;#39;].to_list() rainfall = annual_data[&amp;#39;rainfall&amp;#39;].cumsum().to_list() ax.plot(days_since_jan1, rainfall, label=year) # label the axes and title the plot ax.set_xlabel(&amp;#39;days since jan 1st&amp;#39;) ax.set_ylabel(&amp;#39;precipitation (mm)&amp;#39;) ax.set_title(&amp;#39;Victoria BC cumulative annual precipitation&amp;#39;) ax.legend() # save the plot to disk fig.savefig(&amp;#39;cumulative-annual-precipitation.png&amp;#39;, bbox_inches=&amp;#39;tight&amp;#39;) Finally, a clear image starts to appear: Victoria BC cumulative annual precipitation Accounting for Missing Data If you look closely at the previous plot, there‚Äôs a few gaps in the data. This occurred due to the fact that the initial data set contains an empty string &quot;&quot; in places where either no data is available, or where the data is zero. Since it‚Äôs not obvious which case applies, pandas will parse this empty string as nan (not-a-number). In our case, the Environment Canada data encodes no snow as &quot;&quot; rather than 0 cm. We will instruct pandas to fill in these gaps with a default value of 0, using the fillna() method: weather[&amp;#39;Total Precip (mm)&amp;#39;] = weather[&amp;#39;Total Precip (mm)&amp;#39;].fillna(0) weather[&amp;#39;Total Snow (cm)&amp;#39;] = weather[&amp;#39;Total Snow (cm)&amp;#39;].fillna(0) This will produce a plot without gaps: Victoria BC cumulative annual precipitation Reordering the Legend and Fixing the X Axis The previous plot is difficult to see which colours correspond to which years (especially hard if you are colour blind). We will re-order the legend from wettest to driest years, with 2021 being dead-last. To sort the data, we will create a new function get_total_rainfall, which returns a new value for python‚Äôs sorted function to use when sorting values. We return a tuple so that the year can be used to differentiate between cases where the annual precipitation is identical. Additionally, let‚Äôs fix the x-axis to display the name of the month, rather than an integer value. import matplotlib import matplotlib.pyplot as plt fig = plt.figure(figsize=(10.0, 7.0), dpi=100) ax = fig.add_axes([0, 0, 1, 1]) def get_total_rainfall(val): year, annual_data = val total_rainfall = annual_data[&amp;#39;rainfall&amp;#39;].cumsum().to_list()[-1] return (total_rainfall, year) for year, annual_data in sorted(rainfall_by_year, key=get_total_rainfall, reverse=True): days_since_jan1 = annual_data[&amp;#39;days_since_jan1&amp;#39;].to_list() rainfall = annual_data[&amp;#39;rainfall&amp;#39;].cumsum().to_list() ax.plot(days_since_jan1, rainfall, label=year) # format x axis values as month names rather than days since jan 1st def format_days_since_jan1(days, pos=None): date = datetime.date(2020, 1, 1) + datetime.timedelta(days) return date.strftime(&amp;#39;%b&amp;#39;) ax.xaxis.set_major_formatter(matplotlib.ticker.FuncFormatter(format_days_since_jan1)) # label the axes and title the plot ax.set_xlabel(&amp;#39;calendar date&amp;#39;) ax.set_ylabel(&amp;#39;precipitation (mm)&amp;#39;) ax.set_title(&amp;#39;Victoria BC cumulative annual precipitation&amp;#39;) ax.legend() # save the plot to disk fig.savefig(&amp;#39;cumulative-annual-precipitation-sorted-legend.png&amp;#39;, bbox_inches=&amp;#39;tight&amp;#39;) And here we have it, 2021 has been a really dry year here in Victoria: Victoria BC cumulative annual precipitation v2 Accounting for Snow The previous plots have an error ‚Äì they were only plotting rainfall, and not accounting for snowfall. It‚Äôs difficult to directly convert snowfall into an equivalent amount of precipitation due to the variety of snow crystal sizes ‚Äì some snow is wet, while other snow is fairly dry. On the west-coast (wet-coast as some call it); when we do get snow, it tends to be fairly wet. We will assume that 13mm of snow is equivalent to 1mm of rain 1. Let‚Äôs revise our split_data_by_year function to calculate this. def split_data_by_year(weather): yearly_rainfall = [] yearly_days_since_jan1 = [] current_year = None by_year = [] for i, row in weather.iterrows(): date = row[&amp;#39;Date/Time&amp;#39;] rainfall = row[&amp;#39;Total Precip (mm)&amp;#39;] # 1cm snow = 10mm snow; 13mm of snow = 1mm of rain snowfall = row[&amp;#39;Total Snow (cm)&amp;#39;] * 10.0 / 13.0 rainfall += snowfall if current_year is None: current_year = date.year elif current_year != date.year: by_year.append((current_year, pandas.DataFrame({ &amp;#39;days_since_jan1&amp;#39;: yearly_days_since_jan1, &amp;#39;rainfall&amp;#39;: yearly_rainfall, }))) yearly_days_since_jan1 = [] yearly_rainfall = [] current_year = date.year yearly_rainfall.append(rainfall) yearly_days_since_jan1.append(get_days_since_jan1(date)) if current_year is not None: by_year.append((current_year, pandas.DataFrame({ &amp;#39;days_since_jan1&amp;#39;: yearly_days_since_jan1, &amp;#39;rainfall&amp;#39;: yearly_rainfall, }))) return by_year If you look closely, once we adjust for snow, it turned out that 2017 was a wetter year compared to 2014: Victoria BC cumulative annual precipitation including snow None of that however changes the fact that it‚Äôs been a very dry year, and my garden is browner than ever. On the other hand, my tomatoes have been loving the heat. If you would like to try generating the above graphs, all the code (and data) can be found under github.com/earthly/example-plotting-precipitation. While you‚Äôre here: Earthly is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today. https://www.nssl.noaa.gov/education/svrwx101/winter/faq/‚Ü©Ô∏é</summary></entry><entry><title type="html">How to Convert from JSON to CSV at The Command Line</title><link href="https://earthly.dev/blog/convert-to-from-json/" rel="alternate" type="text/html" title="How to Convert from JSON to CSV at The Command Line" /><published>2021-08-12T00:00:00-04:00</published><updated>2021-08-12T00:00:00-04:00</updated><id>https://earthly.dev/blog/convert-to-from-json</id><content type="html" xml:base="https://earthly.dev/blog/convert-to-from-json/">&lt;p&gt;How do you convert JSON values to CSV and back at the command line? I‚Äôve done this task on many occasions and been stung by the edge cases frequently enough that &lt;strong&gt;it‚Äôs time for me to share my favorite tools for this conversion process.&lt;/strong&gt; But first, some background.&lt;/p&gt;
&lt;h2 id=&quot;background-you-probably-want-a-csv-conversion-tool&quot;&gt;Background: You Probably Want a CSV Conversion Tool&lt;/h2&gt;
&lt;p&gt;The CSV format seems simple at first glance: You have a fixed number of fields per row and each field is separated by a comma.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1997,Ford,E350\n&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;However, if you need to use commas in the value, then the fields must be delimited with &lt;code&gt;&quot;&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1997,Ford,E350,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;Super, luxurious truck&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;\n&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can use this same trick to delimit a line break, and use double double-quotes if you need to include &lt;code&gt;&quot;&lt;/code&gt; in your values or headings.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1997,Ford,E350,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;Go get one &amp;quot;&amp;quot;now&amp;quot;&amp;quot;\n&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;they are going fast&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;\n&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Things get more complex from there, and even the &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc4180&quot;&gt;CSV standard&lt;/a&gt; does not specify how to handle all the edge cases and some formatting options are non-compatible. Wikipedia puts it this way:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The CSV file format is not fully standardized. Separating fields with commas is the foundation, but commas in the data or embedded line breaks have to be handled specially. Some implementations disallow such content while others surround the field with quotation marks, which yet again creates the need for escaping these if they are present in the data.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So although it seems like CSV conversion can be done by hand in python, or your language of choice, using an existing tool that is known to handle the edges cases well it the way to go.&lt;/p&gt;
&lt;p&gt;With that in mind, let‚Äôs review some tools for converting from JSON to CSV at the command line.&lt;/p&gt;
&lt;h2 id=&quot;convert-json-to-csv-via-the-command-line&quot;&gt;Convert JSON to CSV via the Command Line&lt;/h2&gt;
&lt;p&gt;The simplest way to do this JSON to CSV conversion is with &lt;code&gt;dasel&lt;/code&gt;. &lt;code&gt;dasel&lt;/code&gt; is a tool for DAta SELection. Think of it as a &lt;code&gt;jq&lt;/code&gt; that supports selection on formats besides just JSON.&lt;/p&gt;
&lt;p&gt;It‚Äôs easy to install (&lt;code&gt;brew install dasel&lt;/code&gt;), and it works great as a format converter.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;   &lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;    &lt;/span&gt;
&lt;span id=&quot;cb4-4&quot;&gt;&lt;a href=&quot;#cb4-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-5&quot;&gt;&lt;a href=&quot;#cb4-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;#f00&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-6&quot;&gt;&lt;a href=&quot;#cb4-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-7&quot;&gt;&lt;a href=&quot;#cb4-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-8&quot;&gt;&lt;a href=&quot;#cb4-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;   &lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb4-9&quot;&gt;&lt;a href=&quot;#cb4-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-10&quot;&gt;&lt;a href=&quot;#cb4-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;#0f0&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-11&quot;&gt;&lt;a href=&quot;#cb4-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-12&quot;&gt;&lt;a href=&quot;#cb4-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-13&quot;&gt;&lt;a href=&quot;#cb4-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;   &lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb4-14&quot;&gt;&lt;a href=&quot;#cb4-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-15&quot;&gt;&lt;a href=&quot;#cb4-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;#00f&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-16&quot;&gt;&lt;a href=&quot;#cb4-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-17&quot;&gt;&lt;a href=&quot;#cb4-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-18&quot;&gt;&lt;a href=&quot;#cb4-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figcaption&gt;
simple.json
&lt;/figcaption&gt;
&lt;p&gt;The conversion is easy:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; dasel &lt;span class=&quot;at&quot;&gt;-r&lt;/span&gt; json &lt;span class=&quot;at&quot;&gt;-w&lt;/span&gt; csv &lt;span class=&quot;op&quot;&gt;&amp;lt;&lt;/span&gt; sample.json &lt;/span&gt;
&lt;span id=&quot;cb5-2&quot;&gt;&lt;a href=&quot;#cb5-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;color,id,value&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-3&quot;&gt;&lt;a href=&quot;#cb5-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;red&lt;/span&gt;,1,#f00&lt;/span&gt;
&lt;span id=&quot;cb5-4&quot;&gt;&lt;a href=&quot;#cb5-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;green,2,#0f0&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-5&quot;&gt;&lt;a href=&quot;#cb5-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;blue,3,#00f&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figcaption&gt;
converting with &lt;code&gt;dasel&lt;/code&gt;
&lt;/figcaption&gt;
&lt;p&gt;&lt;code&gt;dasel&lt;/code&gt; handles newlines and values containing commas as well.&lt;/p&gt;
&lt;h2 id=&quot;convert-json-to-csv-via-the-command-line-using-jq&quot;&gt;Convert JSON to CSV via the Command Line using JQ&lt;/h2&gt;
&lt;p&gt;If you don‚Äôt want to install &lt;code&gt;dasel&lt;/code&gt; or if you just love &lt;code&gt;jq&lt;/code&gt; (&lt;code&gt;brew install jq&lt;/code&gt;) then this solution may work well for you. Before I discovered &lt;code&gt;dasel&lt;/code&gt; this was the main approach I used:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; cat simple.json&lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;(map(keys) | add | unique) as $cols | map(. as $row | $cols | map($row[.])) as $rows | $cols, $rows[] | @csv&amp;#39;&lt;/span&gt; &lt;/span&gt;
&lt;span id=&quot;cb6-2&quot;&gt;&lt;a href=&quot;#cb6-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-3&quot;&gt;&lt;a href=&quot;#cb6-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,1,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#f00&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-4&quot;&gt;&lt;a href=&quot;#cb6-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,2,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#0f0&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-5&quot;&gt;&lt;a href=&quot;#cb6-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,3,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#00f&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figcaption&gt;
Convert any JSON to CSV with JQ
&lt;/figcaption&gt;
&lt;p&gt;A full explanation for how this works is beyond the scope of this article, but the idea is to use &lt;code&gt;(map(keys) | add | unique)&lt;/code&gt; to get the column names and then gather the values for those columns into &lt;code&gt;$row&lt;/code&gt; and use the &lt;code&gt;@csv&lt;/code&gt; filter to convert the array of rows in a CSV format.&lt;/p&gt;
&lt;h2 id=&quot;convert-json-to-csv-via-the-command-line-and-choose-ordering-column&quot;&gt;Convert JSON to CSV via the Command Line and Choose Ordering Column&lt;/h2&gt;
&lt;p&gt;The downside to the previous two approaches is that you can‚Äôt specify which columns to exclude nor their order. Both &lt;code&gt;jq&lt;/code&gt; and &lt;code&gt;dazel&lt;/code&gt; support a query language for customizing the output, but if you don‚Äôt want to dive into CSS selectors, the &lt;code&gt;jsonv&lt;/code&gt; tool is a great alternative.&lt;/p&gt;
&lt;p&gt;To convert, we will use &lt;code&gt;jsonv&lt;/code&gt; and pipe it our JSON file. Then, we will specify the columns to include, and we redirect its output to a file.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb7&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb7-1&quot;&gt;&lt;a href=&quot;#cb7-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;cat&lt;/span&gt; simple.json &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jsonv&lt;/span&gt; id,color,value &lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; simple.csv&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This gives us a simple CSV file:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb8&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb8-1&quot;&gt;&lt;a href=&quot;#cb8-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; cat simple.csv&lt;/span&gt;
&lt;span id=&quot;cb8-2&quot;&gt;&lt;a href=&quot;#cb8-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#f00&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-3&quot;&gt;&lt;a href=&quot;#cb8-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;2,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#0f0&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-4&quot;&gt;&lt;a href=&quot;#cb8-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;3,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#00f&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-5&quot;&gt;&lt;a href=&quot;#cb8-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;4,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;cyan&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#0ff&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-6&quot;&gt;&lt;a href=&quot;#cb8-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;5,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;magenta&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#f0f&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-7&quot;&gt;&lt;a href=&quot;#cb8-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;6,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;yellow&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#ff0&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-8&quot;&gt;&lt;a href=&quot;#cb8-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;7,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;black&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#000&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;jsonv&lt;/code&gt; handles more complex examples as well. Under the hood, it uses &lt;code&gt;gnuawk&lt;/code&gt; (&lt;code&gt;gawk&lt;/code&gt;). You can install it using curl:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl -Ls https://raw.github.com/archan937/jsonv.sh/master/install.sh | bash&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can install &lt;code&gt;gawk&lt;/code&gt; using brew (&lt;code&gt;brew install gawk&lt;/code&gt;) or your package manager of choice.&lt;/p&gt;
&lt;h2 id=&quot;convert-csv-to-json-at-the-command-line&quot;&gt;Convert CSV to JSON at The Command Line&lt;/h2&gt;
&lt;p&gt;For converting CSV to JSON, we can use &lt;code&gt;dasel&lt;/code&gt; again. The read (&lt;code&gt;-r&lt;/code&gt;) and write (&lt;code&gt;-w&lt;/code&gt;) options mean that it‚Äôs easy to convert from any of its supported file formats (JSON, YAML, TOML, XML, and CSV).&lt;/p&gt;
&lt;p&gt;We can get our original JSON document back from CSV like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; cat sample.csv&lt;/span&gt;
&lt;span id=&quot;cb10-2&quot;&gt;&lt;a href=&quot;#cb10-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;ID,&lt;/span&gt; color, value&lt;/span&gt;
&lt;span id=&quot;cb10-3&quot;&gt;&lt;a href=&quot;#cb10-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#f00&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-4&quot;&gt;&lt;a href=&quot;#cb10-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;2,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#0f0&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-5&quot;&gt;&lt;a href=&quot;#cb10-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;3,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#00f&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;er&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;dasel&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;csv&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;-w&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;json&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;sample.csv&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-2&quot;&gt;&lt;a href=&quot;#cb11-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-3&quot;&gt;&lt;a href=&quot;#cb11-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;ID&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-4&quot;&gt;&lt;a href=&quot;#cb11-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-5&quot;&gt;&lt;a href=&quot;#cb11-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;#f00&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-6&quot;&gt;&lt;a href=&quot;#cb11-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-7&quot;&gt;&lt;a href=&quot;#cb11-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-8&quot;&gt;&lt;a href=&quot;#cb11-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;ID&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-9&quot;&gt;&lt;a href=&quot;#cb11-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-10&quot;&gt;&lt;a href=&quot;#cb11-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;#0f0&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-11&quot;&gt;&lt;a href=&quot;#cb11-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-12&quot;&gt;&lt;a href=&quot;#cb11-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-13&quot;&gt;&lt;a href=&quot;#cb11-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;ID&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;3&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-14&quot;&gt;&lt;a href=&quot;#cb11-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-15&quot;&gt;&lt;a href=&quot;#cb11-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;#00f&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-16&quot;&gt;&lt;a href=&quot;#cb11-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;convert-csv-to-json-command-line-with-csvtojson&quot;&gt;Convert CSV to JSON Command Line with &lt;code&gt;csvtojson&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;Another option is to grab the npm tool &lt;code&gt;csvtojson&lt;/code&gt; (&lt;code&gt;npm i --save csvtojson&lt;/code&gt;). If you don‚Äôt already have npm and Node.js installed then installing &lt;code&gt;dasel&lt;/code&gt; is a simple solution. Once installed, you can convert to CSV by sending input to &lt;code&gt;csvtojson&lt;/code&gt; over standard in:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb12&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb12-1&quot;&gt;&lt;a href=&quot;#cb12-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;csvtojson&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;lt;&lt;/span&gt; sample.csv&lt;/span&gt;
&lt;span id=&quot;cb12-2&quot;&gt;&lt;a href=&quot;#cb12-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-3&quot;&gt;&lt;a href=&quot;#cb12-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;ID&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#f00&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;}&lt;/span&gt;,&lt;/span&gt;
&lt;span id=&quot;cb12-4&quot;&gt;&lt;a href=&quot;#cb12-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;ID&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#0f0&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;}&lt;/span&gt;,&lt;/span&gt;
&lt;span id=&quot;cb12-5&quot;&gt;&lt;a href=&quot;#cb12-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;ID&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;3&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#00f&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-6&quot;&gt;&lt;a href=&quot;#cb12-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;You now have the knowledge and the tools you need to convert JSON to CSV and CSV to JSON. &lt;a href=&quot;https://stedolan.github.io/jq/&quot;&gt;&lt;code&gt;jq&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://github.com/TomWright/dasel&quot;&gt;&lt;code&gt;dasel&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://www.npmjs.com/package/csvtojson&quot;&gt;&lt;code&gt;csvtojson&lt;/code&gt;&lt;/a&gt; and &lt;a href=&quot;https://github.com/archan937/jsonv.sh&quot;&gt;&lt;code&gt;jsonv&lt;/code&gt;&lt;/a&gt; are handy command line tools that can be used on Linux, MacOS and Windows under WSL 2.&lt;/p&gt;
&lt;div class=&quot;notice--info notice--big&quot;&gt;
&lt;p&gt;
&lt;strong&gt;While you‚Äôre here:&lt;/strong&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today.
&lt;/p&gt;
&lt;/div&gt;</content><author><name>Adam Gordon Bell</name></author><category term="Tutorials" /><summary type="html">How do you convert JSON values to CSV and back at the command line? I‚Äôve done this task on many occasions and been stung by the edge cases frequently enough that it‚Äôs time for me to share my favorite tools for this conversion process. But first, some background. Background: You Probably Want a CSV Conversion Tool The CSV format seems simple at first glance: You have a fixed number of fields per row and each field is separated by a comma. 1997,Ford,E350\n However, if you need to use commas in the value, then the fields must be delimited with &quot;: 1997,Ford,E350,&amp;quot;Super, luxurious truck&amp;quot;\n You can use this same trick to delimit a line break, and use double double-quotes if you need to include &quot; in your values or headings. 1997,Ford,E350,&amp;quot;Go get one &amp;quot;&amp;quot;now&amp;quot;&amp;quot;\n they are going fast&amp;quot;\n Things get more complex from there, and even the CSV standard does not specify how to handle all the edge cases and some formatting options are non-compatible. Wikipedia puts it this way: The CSV file format is not fully standardized. Separating fields with commas is the foundation, but commas in the data or embedded line breaks have to be handled specially. Some implementations disallow such content while others surround the field with quotation marks, which yet again creates the need for escaping these if they are present in the data. So although it seems like CSV conversion can be done by hand in python, or your language of choice, using an existing tool that is known to handle the edges cases well it the way to go. With that in mind, let‚Äôs review some tools for converting from JSON to CSV at the command line. Convert JSON to CSV via the Command Line The simplest way to do this JSON to CSV conversion is with dasel. dasel is a tool for DAta SELection. Think of it as a jq that supports selection on formats besides just JSON. It‚Äôs easy to install (brew install dasel), and it works great as a format converter. [ { &amp;quot;id&amp;quot; : 1, &amp;quot;color&amp;quot;: &amp;quot;red&amp;quot;, &amp;quot;value&amp;quot;: &amp;quot;#f00&amp;quot; }, { &amp;quot;id&amp;quot; : 2, &amp;quot;color&amp;quot;: &amp;quot;green&amp;quot;, &amp;quot;value&amp;quot;: &amp;quot;#0f0&amp;quot; }, { &amp;quot;id&amp;quot; : 3, &amp;quot;color&amp;quot;: &amp;quot;blue&amp;quot;, &amp;quot;value&amp;quot;: &amp;quot;#00f&amp;quot; } ] simple.json The conversion is easy: $ dasel -r json -w csv &amp;lt; sample.json color,id,value red,1,#f00 green,2,#0f0 blue,3,#00f converting with dasel dasel handles newlines and values containing commas as well. Convert JSON to CSV via the Command Line using JQ If you don‚Äôt want to install dasel or if you just love jq (brew install jq) then this solution may work well for you. Before I discovered dasel this was the main approach I used: $ cat simple.json| jq -r &amp;#39;(map(keys) | add | unique) as $cols | map(. as $row | $cols | map($row[.])) as $rows | $cols, $rows[] | @csv&amp;#39; &amp;quot;color&amp;quot;,&amp;quot;id&amp;quot;,&amp;quot;value&amp;quot; &amp;quot;red&amp;quot;,1,&amp;quot;#f00&amp;quot; &amp;quot;green&amp;quot;,2,&amp;quot;#0f0&amp;quot; &amp;quot;blue&amp;quot;,3,&amp;quot;#00f&amp;quot; Convert any JSON to CSV with JQ A full explanation for how this works is beyond the scope of this article, but the idea is to use (map(keys) | add | unique) to get the column names and then gather the values for those columns into $row and use the @csv filter to convert the array of rows in a CSV format. Convert JSON to CSV via the Command Line and Choose Ordering Column The downside to the previous two approaches is that you can‚Äôt specify which columns to exclude nor their order. Both jq and dazel support a query language for customizing the output, but if you don‚Äôt want to dive into CSS selectors, the jsonv tool is a great alternative. To convert, we will use jsonv and pipe it our JSON file. Then, we will specify the columns to include, and we redirect its output to a file. cat simple.json | jsonv id,color,value &amp;gt; simple.csv This gives us a simple CSV file: $ cat simple.csv 1,&amp;quot;red&amp;quot;,&amp;quot;#f00&amp;quot; 2,&amp;quot;green&amp;quot;,&amp;quot;#0f0&amp;quot; 3,&amp;quot;blue&amp;quot;,&amp;quot;#00f&amp;quot; 4,&amp;quot;cyan&amp;quot;,&amp;quot;#0ff&amp;quot; 5,&amp;quot;magenta&amp;quot;,&amp;quot;#f0f&amp;quot; 6,&amp;quot;yellow&amp;quot;,&amp;quot;#ff0&amp;quot; 7,&amp;quot;black&amp;quot;,&amp;quot;#000&amp;quot; jsonv handles more complex examples as well. Under the hood, it uses gnuawk (gawk). You can install it using curl: curl -Ls https://raw.github.com/archan937/jsonv.sh/master/install.sh | bash You can install gawk using brew (brew install gawk) or your package manager of choice. Convert CSV to JSON at The Command Line For converting CSV to JSON, we can use dasel again. The read (-r) and write (-w) options mean that it‚Äôs easy to convert from any of its supported file formats (JSON, YAML, TOML, XML, and CSV). We can get our original JSON document back from CSV like this: $ cat sample.csv ID, color, value 1,&amp;quot;red&amp;quot;,&amp;quot;#f00&amp;quot; 2,&amp;quot;green&amp;quot;,&amp;quot;#0f0&amp;quot; 3,&amp;quot;blue&amp;quot;,&amp;quot;#00f&amp;quot; $ dasel -r csv -w json &amp;lt; sample.csv { &amp;quot;ID&amp;quot;: &amp;quot;1&amp;quot;, &amp;quot;color&amp;quot;: &amp;quot;red&amp;quot;, &amp;quot;value&amp;quot;: &amp;quot;#f00&amp;quot; } { &amp;quot;ID&amp;quot;: &amp;quot;2&amp;quot;, &amp;quot;color&amp;quot;: &amp;quot;green&amp;quot;, &amp;quot;value&amp;quot;: &amp;quot;#0f0&amp;quot; } { &amp;quot;ID&amp;quot;: &amp;quot;3&amp;quot;, &amp;quot;color&amp;quot;: &amp;quot;blue&amp;quot;, &amp;quot;value&amp;quot;: &amp;quot;#00f&amp;quot; } Convert CSV to JSON Command Line with csvtojson Another option is to grab the npm tool csvtojson (npm i --save csvtojson). If you don‚Äôt already have npm and Node.js installed then installing dasel is a simple solution. Once installed, you can convert to CSV by sending input to csvtojson over standard in: csvtojson &amp;lt; sample.csv [ {&amp;quot;ID&amp;quot;:&amp;quot;1&amp;quot;,&amp;quot;color&amp;quot;:&amp;quot;red&amp;quot;,&amp;quot;value&amp;quot;:&amp;quot;#f00&amp;quot;}, {&amp;quot;ID&amp;quot;:&amp;quot;2&amp;quot;,&amp;quot;color&amp;quot;:&amp;quot;green&amp;quot;,&amp;quot;value&amp;quot;:&amp;quot;#0f0&amp;quot;}, {&amp;quot;ID&amp;quot;:&amp;quot;3&amp;quot;,&amp;quot;color&amp;quot;:&amp;quot;blue&amp;quot;,&amp;quot;value&amp;quot;:&amp;quot;#00f&amp;quot;} ] Conclusion You now have the knowledge and the tools you need to convert JSON to CSV and CSV to JSON. jq, dasel, csvtojson and jsonv are handy command line tools that can be used on Linux, MacOS and Windows under WSL 2. While you‚Äôre here: Earthly is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today.</summary></entry><entry><title type="html">Idiots And Maniacs</title><link href="https://earthly.dev/blog/idiots-and-maniacs/" rel="alternate" type="text/html" title="Idiots And Maniacs" /><published>2021-07-30T00:00:00-04:00</published><updated>2021-07-30T00:00:00-04:00</updated><id>https://earthly.dev/blog/idiots-and-maniacs</id><content type="html" xml:base="https://earthly.dev/blog/idiots-and-maniacs/">&lt;h2 id=&quot;observability&quot;&gt;Observability&lt;/h2&gt;
&lt;p&gt;If you do software-as-a-service development and you have paying customers, you at some point learn about the need for operational monitoring and observability. Personally, I went through a process something like this:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Service has some basic &lt;a href=&quot;/blog/understanding-docker-logging-and-log-files&quot;&gt;logging&lt;/a&gt; and an uptime alert.&lt;/li&gt;
&lt;li&gt;Service has a health-check endpoint, is deployed in triplicate behind a load balancer.&lt;/li&gt;
&lt;li&gt;Logs are real-time shipped to Splunk / ELK Stack.&lt;/li&gt;
&lt;li&gt;Metrics set up in Datadog / Prometheus with paging.&lt;/li&gt;
&lt;li&gt;Distributed Tracing set up for debugging across services.&lt;/li&gt;
&lt;li&gt;And so on.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Each step requires more work to set up and has some additional benefits. I moved through each step by necessity as my service handled more requests and became more important to customers.&lt;/p&gt;
&lt;p&gt;If you had shown step-1-me what a simple REST service looks like in step 5, I would have been shocked. The metrics counters and distributed tracing spans, and various operational concerns make the service more complex. I would have thought that whoever wrote the service was obsessed with operational issues, to the detriment of solving the problems at hand. I would have thought the service author was an observability maniac.&lt;/p&gt;
&lt;p&gt;On the other hand, if step-5-me were to get paged because a service written by step-1-me was down, he would not be happy. He would have a hard time figuring out what was wrong, and he‚Äôd be pretty sure the service author was an idiot who had never been paged in the middle of the night.&lt;/p&gt;
&lt;p&gt;It reminds me a lot of driving when it first snows here in Peterborough.&lt;/p&gt;
&lt;h2 id=&quot;driving&quot;&gt;Driving&lt;/h2&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/idiots-and-maniacs/9580-800-b155e3159.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/idiots-and-maniacs/9580-800-0cb86c200.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img width=&quot;1200px&quot; src=&quot;/blog/generated/assets/images/idiots-and-maniacs/9580-800-0cb86c200.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;p&gt;In the winter, in Peterborough, we get snow. It‚Äôs just a fact of life, and people learn how to drive in snowy conditions. But on the first substantial snowfall of the year, people struggle to remember how to drive.&lt;/p&gt;
&lt;p&gt;Some will drive way below the speed limit and slow down traffic for everyone. They are idiots in the snow. Others get frustrated by the slow drivers and go too fast for the road conditions. Don‚Äôt they know there is snow on the road?&lt;/p&gt;
&lt;p&gt;Everyone driving slower than me is an idiot, but everyone going faster than me is a maniac.&lt;/p&gt;
&lt;p&gt;So it is with software development. Everyone who takes an idea further than I have is a maniac, and people who haven‚Äôt taken it as far as me are idiots.&lt;/p&gt;
&lt;h2 id=&quot;testing&quot;&gt;Testing&lt;/h2&gt;
&lt;p&gt;There was a time when I thought all code should have 80% unit test code coverage as a minimum. Anything less was practically unethical, and if you didn‚Äôt think so, then you hadn‚Äôt read Clean Code‚Ñ¢Ô∏è enough times.&lt;/p&gt;
&lt;div class=&quot;align-right&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/idiots-and-maniacs/9770-400-5e5247841.webp 400w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/idiots-and-maniacs/9770-400-1cc7b22be.png 400w&quot; type=&quot;image/png&quot;&gt;&lt;img width=&quot;300px&quot; src=&quot;/blog/generated/assets/images/idiots-and-maniacs/9770-400-1cc7b22be.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;On the other hand, Richard Hipp ‚Äì who tests to 100% code coverage at the machine code level, covering every branch by running billions of tests each release&lt;a href=&quot;#fn1&quot; class=&quot;footnote-ref&quot; id=&quot;fnref1&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; ‚Äì is a testing maniac.&lt;/p&gt;
&lt;p&gt;I hope you see where I‚Äôm going. This idiot to maniac gradient feels right, but it makes no sense&lt;a href=&quot;#fn2&quot; class=&quot;footnote-ref&quot; id=&quot;fnref2&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;. How can I be the only the person driving the right speed? Wherever you find yourself along the spectrum is more a reflection of the context in which you work than anything else.&lt;/p&gt;
&lt;h2 id=&quot;more-examples&quot;&gt;More Examples&lt;/h2&gt;
&lt;p&gt;Here are some made-up and exaggerated examples:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Typescript Developer:&lt;/strong&gt; JavaScript developers are &lt;strong&gt;idiots&lt;/strong&gt;. Don‚Äôt they know how many bugs the type system could have caught for them.&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Typescript Developer:&lt;/strong&gt; Elm developers are obsessed with types. They are &lt;strong&gt;maniacs&lt;/strong&gt; about using types to catch things at compile time.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Go Developer:&lt;/strong&gt; The JVM is such a heavyweight runtime and uses so much memory.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Go Developer:&lt;/strong&gt; Rust is so complex! Who wants to manage memory manually. Use a GC, you &lt;strong&gt;maniacs&lt;/strong&gt;!&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kotlin Developer:&lt;/strong&gt; Java is so verbose and ugly. Welcome to 2021. Kotlin has a lot of sugar and type improvements that make writing correct code simpler.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kotlin Developer:&lt;/strong&gt; Scala is for &lt;strong&gt;maniacs&lt;/strong&gt;. There is so much syntactic sugar and type stuff that it‚Äôs not worth learning about.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I‚Äôm not trying to pick on any of these languages - Typescript, Go, and Kotlin are exceptionally well suited to their niche. But contexts vary&lt;a href=&quot;#fn3&quot; class=&quot;footnote-ref&quot; id=&quot;fnref3&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt;, and it takes mental effort to see that people making other trade-offs sometimes have good reasons for it.&lt;/p&gt;
&lt;p&gt;That doesn‚Äôt mean that other people are never wrong, though. People choose the wrong tool for the job all the time. For example, if I were doing SQLite‚Äôs level of testing for a low-reliability, low-traffic, state-less web service when a couple of integration tests would do, then that‚Äôd be a mistake, but you‚Äôd have to know the context to make that call.&lt;/p&gt;
&lt;div class=&quot;notice--info notice--big&quot;&gt;
&lt;p&gt;
&lt;strong&gt;While you‚Äôre here:&lt;/strong&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today.
&lt;/p&gt;
&lt;/div&gt;
&lt;section class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&quot;fn1&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;Richard is the creator of SQLite. See my &lt;a href=&quot;https://corecursive.com/066-sqlite-with-richard-hipp/#billions-of-tests&quot;&gt;interview&lt;/a&gt; with him for a discussion of his testing approach.&lt;a href=&quot;#fnref1&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;‚Ü©Ô∏é&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn2&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;&lt;strong&gt;Article Update:&lt;/strong&gt; Apparently I‚Äôve unintentionally stolen this idiot to maniac spectrum idea from &lt;a href=&quot;https://www.youtube.com/watch?v=XWPCE2tTLZQ&quot;&gt;George Carlin&lt;/a&gt;. Thanks to tjones21xx on Reddit for pointing this out. All credit for this idea goes to Carlin.&lt;a href=&quot;#fnref2&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;‚Ü©Ô∏é&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn3&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;Personal and team familiarity can also be part of the context. PHP may not seem to be the best choice for building a command-line tool, but if it‚Äôs a small tool used by a team of PHP developers, then it might be the best choice.&lt;a href=&quot;#fnref3&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;‚Ü©Ô∏é&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;</content><author><name>Adam Gordon Bell</name></author><category term="Articles" /><summary type="html">Observability If you do software-as-a-service development and you have paying customers, you at some point learn about the need for operational monitoring and observability. Personally, I went through a process something like this: Service has some basic logging and an uptime alert. Service has a health-check endpoint, is deployed in triplicate behind a load balancer. Logs are real-time shipped to Splunk / ELK Stack. Metrics set up in Datadog / Prometheus with paging. Distributed Tracing set up for debugging across services. And so on. Each step requires more work to set up and has some additional benefits. I moved through each step by necessity as my service handled more requests and became more important to customers. If you had shown step-1-me what a simple REST service looks like in step 5, I would have been shocked. The metrics counters and distributed tracing spans, and various operational concerns make the service more complex. I would have thought that whoever wrote the service was obsessed with operational issues, to the detriment of solving the problems at hand. I would have thought the service author was an observability maniac. On the other hand, if step-5-me were to get paged because a service written by step-1-me was down, he would not be happy. He would have a hard time figuring out what was wrong, and he‚Äôd be pretty sure the service author was an idiot who had never been paged in the middle of the night. It reminds me a lot of driving when it first snows here in Peterborough. Driving In the winter, in Peterborough, we get snow. It‚Äôs just a fact of life, and people learn how to drive in snowy conditions. But on the first substantial snowfall of the year, people struggle to remember how to drive. Some will drive way below the speed limit and slow down traffic for everyone. They are idiots in the snow. Others get frustrated by the slow drivers and go too fast for the road conditions. Don‚Äôt they know there is snow on the road? Everyone driving slower than me is an idiot, but everyone going faster than me is a maniac. So it is with software development. Everyone who takes an idea further than I have is a maniac, and people who haven‚Äôt taken it as far as me are idiots. Testing There was a time when I thought all code should have 80% unit test code coverage as a minimum. Anything less was practically unethical, and if you didn‚Äôt think so, then you hadn‚Äôt read Clean Code‚Ñ¢Ô∏è enough times. On the other hand, Richard Hipp ‚Äì who tests to 100% code coverage at the machine code level, covering every branch by running billions of tests each release1 ‚Äì is a testing maniac. I hope you see where I‚Äôm going. This idiot to maniac gradient feels right, but it makes no sense2. How can I be the only the person driving the right speed? Wherever you find yourself along the spectrum is more a reflection of the context in which you work than anything else. More Examples Here are some made-up and exaggerated examples: Typescript Developer: JavaScript developers are idiots. Don‚Äôt they know how many bugs the type system could have caught for them. Typescript Developer: Elm developers are obsessed with types. They are maniacs about using types to catch things at compile time. Go Developer: The JVM is such a heavyweight runtime and uses so much memory. Go Developer: Rust is so complex! Who wants to manage memory manually. Use a GC, you maniacs! Kotlin Developer: Java is so verbose and ugly. Welcome to 2021. Kotlin has a lot of sugar and type improvements that make writing correct code simpler. Kotlin Developer: Scala is for maniacs. There is so much syntactic sugar and type stuff that it‚Äôs not worth learning about. I‚Äôm not trying to pick on any of these languages - Typescript, Go, and Kotlin are exceptionally well suited to their niche. But contexts vary3, and it takes mental effort to see that people making other trade-offs sometimes have good reasons for it. That doesn‚Äôt mean that other people are never wrong, though. People choose the wrong tool for the job all the time. For example, if I were doing SQLite‚Äôs level of testing for a low-reliability, low-traffic, state-less web service when a couple of integration tests would do, then that‚Äôd be a mistake, but you‚Äôd have to know the context to make that call. While you‚Äôre here: Earthly is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today. Richard is the creator of SQLite. See my interview with him for a discussion of his testing approach.‚Ü©Ô∏é Article Update: Apparently I‚Äôve unintentionally stolen this idiot to maniac spectrum idea from George Carlin. Thanks to tjones21xx on Reddit for pointing this out. All credit for this idea goes to Carlin.‚Ü©Ô∏é Personal and team familiarity can also be part of the context. PHP may not seem to be the best choice for building a command-line tool, but if it‚Äôs a small tool used by a team of PHP developers, then it might be the best choice.‚Ü©Ô∏é</summary></entry><entry><title type="html">Building in Visual Studio Code with a Makefile</title><link href="https://earthly.dev/blog/vscode-make/" rel="alternate" type="text/html" title="Building in Visual Studio Code with a Makefile" /><published>2021-07-28T00:00:00-04:00</published><updated>2021-07-28T00:00:00-04:00</updated><id>https://earthly.dev/blog/vscode-make</id><content type="html" xml:base="https://earthly.dev/blog/vscode-make/">&lt;p&gt;Microsoft announced &lt;a href=&quot;https://devblogs.microsoft.com/cppblog/now-announcing-makefile-support-in-visual-studio-code/&quot;&gt;recently&lt;/a&gt; a new Visual Studio Code extension to handle Makefiles. This extension provides a set of commands to the editor that will facilitate working with projects that rely on a Makefile to speed up the build.&lt;/p&gt;
&lt;p&gt;In this tutorial, you‚Äôll set up a simple C++ project that depends on a well-known Python library to produce some sample charts. This is not a deep tutorial about &lt;a href=&quot;/blog/g++-makefile/&quot;&gt;make and Makefiles&lt;/a&gt;, but to get the most out of the extension you will need to have some concepts clear.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Make&lt;/em&gt; is one of the most used tools to build software projects, for good reason:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;You can get an implementation for almost any major operating system (POSIX/Windows/MacOS)&lt;/li&gt;
&lt;li&gt;It‚Äôs technology agnostic. You can use it to build projects on any programming language (here‚Äôs an example for &lt;a href=&quot;https://medium.com/lithictech/makefile-javascript-26731fb26867&quot;&gt;JavaScript&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Its task runner capabilities provide a multipurpose tool for almost any task.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A &lt;em&gt;Makefile&lt;/em&gt; is a simple text file that defines rules to be executed. The usual purpose for Makefile in C++ projects is to recompile and link necessary files based on the modifications done to dependencies. However, Makefile and make are far more useful than that. The rules defined in a Makefile combine concepts like:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Shell scripting&lt;/li&gt;
&lt;li&gt;Regular expressions&lt;/li&gt;
&lt;li&gt;Target notation&lt;/li&gt;
&lt;li&gt;Project structure&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To illustrate this power, the &lt;a href=&quot;https://github.com/nickmancol/vscode_makefile&quot;&gt;sample project&lt;/a&gt; contains a single C++ source code file. The source code for the example is pretty simple ‚Äî- it flips a coin as many times as the &lt;code&gt;iters&lt;/code&gt; argument is passed, and then prints the number of heads and tails counted from each flip.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode cpp&quot;&gt;&lt;code class=&quot;sourceCode cpp&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;cstdlib&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;assert.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-6&quot;&gt;&lt;a href=&quot;#cb1-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;time.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;pp&quot;&gt;  &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-7&quot;&gt;&lt;a href=&quot;#cb1-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-8&quot;&gt;&lt;a href=&quot;#cb1-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; flip_coins&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; iters&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-9&quot;&gt;&lt;a href=&quot;#cb1-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  srand &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;time&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;NULL&lt;span class=&quot;op&quot;&gt;));&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-10&quot;&gt;&lt;a href=&quot;#cb1-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; heads&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; tails &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-11&quot;&gt;&lt;a href=&quot;#cb1-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-12&quot;&gt;&lt;a href=&quot;#cb1-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; i&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;i &lt;span class=&quot;op&quot;&gt;&amp;lt;&lt;/span&gt; iters&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;i&lt;span class=&quot;op&quot;&gt;++){&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-13&quot;&gt;&lt;a href=&quot;#cb1-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;   &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;rand&lt;span class=&quot;op&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;?&lt;/span&gt; heads&lt;span class=&quot;op&quot;&gt;++&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;:&lt;/span&gt; tails&lt;span class=&quot;op&quot;&gt;++;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-14&quot;&gt;&lt;a href=&quot;#cb1-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-15&quot;&gt;&lt;a href=&quot;#cb1-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  printf&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; Heads, &lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; Tails&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;heads&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; tails&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-16&quot;&gt;&lt;a href=&quot;#cb1-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; abs&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;tails&lt;span class=&quot;op&quot;&gt;-&lt;/span&gt;heads&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-17&quot;&gt;&lt;a href=&quot;#cb1-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-18&quot;&gt;&lt;a href=&quot;#cb1-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-19&quot;&gt;&lt;a href=&quot;#cb1-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; main&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; argc&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; argv&lt;span class=&quot;op&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-20&quot;&gt;&lt;a href=&quot;#cb1-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;ot&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;argc &lt;span class=&quot;op&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-21&quot;&gt;&lt;a href=&quot;#cb1-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; iters &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; atoi&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;argv&lt;span class=&quot;op&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;]);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-22&quot;&gt;&lt;a href=&quot;#cb1-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; diff &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; flip_coins&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;iters&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-23&quot;&gt;&lt;a href=&quot;#cb1-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;lt;&lt;/span&gt; iters&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-24&quot;&gt;&lt;a href=&quot;#cb1-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      printf&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;With enough trials Heads should be equal to Tails&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-25&quot;&gt;&lt;a href=&quot;#cb1-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-26&quot;&gt;&lt;a href=&quot;#cb1-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This code will be compiled and linked with a simple Makefile that also will provide a couple of other standard rules for cleaning the compiled code and run a simple test.&lt;/p&gt;
&lt;h2 id=&quot;creating-c-projects-with-vs-code&quot;&gt;Creating C++ Projects with VS Code&lt;/h2&gt;
&lt;p&gt;The &lt;a href=&quot;https://marketplace.visualstudio.com/items?itemName=ms-vscode.makefile-tools&quot;&gt;VS Code extension &lt;strong&gt;Makefile Tools&lt;/strong&gt;&lt;/a&gt; is still in preview but is actively developed. The installation process is similar to any other extension in VS Code:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9360.png&quot; alt=&quot;Makefile VSCode extension&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Makefile VSCode extension&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;After installing the extension, verify the availability of the &lt;code&gt;make&lt;/code&gt; command in the system.&lt;/p&gt;
&lt;p&gt;The most common implementation is &lt;a href=&quot;https://www.gnu.org/software/make/&quot;&gt;GNU Make&lt;/a&gt;, which includes some non-standard extensions. If your installation of &lt;code&gt;make&lt;/code&gt; is not available in the default path, you can configure it in VS Code at &lt;strong&gt;File &amp;gt; Preferences &amp;gt; Settings &amp;gt; Extensions makefile&lt;/strong&gt;.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9380.png&quot; alt=&quot;Make path&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Make path&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;To compile and link the project, you can add a Makefile to the root of the project folder. It will be detected automatically by the extension. If you have a different structure, with a Makefile in another location, you can configure it at &lt;strong&gt;File &amp;gt; Preferences &amp;gt; Settings &amp;gt; Extensions &amp;gt; makefile&lt;/strong&gt;.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9450.png&quot; alt=&quot;Makefile path&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Makefile path&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;This sample Makefile defines five simple rules:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;all&lt;/code&gt;: Cleans the compiled files from the target folder, then compiles and run the test code.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;default&lt;/code&gt;: Delegates to &lt;code&gt;CoinFlipper.cpp&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CoinFlipper.cpp&lt;/code&gt;: Compiles the single source file.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;test&lt;/code&gt;: Delegates to &lt;code&gt;CoinFlipper.cpp&lt;/code&gt;, then runs the output main function passing an argument.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;clean&lt;/code&gt;: Deletes compiled files.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-2&quot;&gt;&lt;a href=&quot;#cb2-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# A simple makefile for compiling a c++ project&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-3&quot;&gt;&lt;a href=&quot;#cb2-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-4&quot;&gt;&lt;a href=&quot;#cb2-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;SRC&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;./src&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-5&quot;&gt;&lt;a href=&quot;#cb2-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;TARGET&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;./target&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-6&quot;&gt;&lt;a href=&quot;#cb2-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;GCC &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; g++&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-7&quot;&gt;&lt;a href=&quot;#cb2-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;CFLAGS &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; -o &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;TARGET&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;/CoinFlipper.out&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-8&quot;&gt;&lt;a href=&quot;#cb2-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;ARGS &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; 101&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-9&quot;&gt;&lt;a href=&quot;#cb2-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;RM &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; rm -rf&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-10&quot;&gt;&lt;a href=&quot;#cb2-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-11&quot;&gt;&lt;a href=&quot;#cb2-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;all:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; clean default test&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-12&quot;&gt;&lt;a href=&quot;#cb2-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-13&quot;&gt;&lt;a href=&quot;#cb2-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;default:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; CoinFlipper.cpp&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-14&quot;&gt;&lt;a href=&quot;#cb2-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-15&quot;&gt;&lt;a href=&quot;#cb2-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;CoinFlipper.cpp:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-16&quot;&gt;&lt;a href=&quot;#cb2-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;GCC&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;CFLAGS&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;SRC&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;/main/CoinFlipper.cpp&lt;/span&gt;
&lt;span id=&quot;cb2-17&quot;&gt;&lt;a href=&quot;#cb2-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-18&quot;&gt;&lt;a href=&quot;#cb2-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;test:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; CoinFlipper.cpp&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-19&quot;&gt;&lt;a href=&quot;#cb2-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;TARGET&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;/CoinFlipper.out &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;ARGS&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-20&quot;&gt;&lt;a href=&quot;#cb2-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-21&quot;&gt;&lt;a href=&quot;#cb2-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;clean:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-22&quot;&gt;&lt;a href=&quot;#cb2-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;RM&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;TARGET&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;/*.out&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The Makefile Tools Extension provides a new ‚Äúperspective‚Äù to the Visual Studio Code IDE. This contains three different commands and three different project configurations to run the Makefile:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9480.png&quot; alt=&quot;Makefile tools perspective&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Makefile tools perspective&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The &lt;code&gt;Configuration:[Default]&lt;/code&gt; refers to the make command configurations defined in the &lt;code&gt;.vscode/settings.json&lt;/code&gt; file. This configuration is used to pass arguments to the make utility.&lt;/p&gt;
&lt;p&gt;In the following example, two configurations are defined:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Default&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Print make version&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;Print make versions&lt;/code&gt; adds the &lt;code&gt;--version&lt;/code&gt; argument to the make utility every time the project is built using the Makefile extension. This argument is not especially useful but you can explore different arguments to fit your case.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;dt&quot;&gt;&amp;quot;makefile.configurations&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;     &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-4&quot;&gt;&lt;a href=&quot;#cb3-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;         &lt;span class=&quot;dt&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Default&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-5&quot;&gt;&lt;a href=&quot;#cb3-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;         &lt;span class=&quot;dt&quot;&gt;&amp;quot;makeArgs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;[]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-6&quot;&gt;&lt;a href=&quot;#cb3-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;     &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-7&quot;&gt;&lt;a href=&quot;#cb3-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;     &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-8&quot;&gt;&lt;a href=&quot;#cb3-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;         &lt;span class=&quot;dt&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Print make version&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-9&quot;&gt;&lt;a href=&quot;#cb3-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;         &lt;span class=&quot;dt&quot;&gt;&amp;quot;makeArgs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;--version&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-10&quot;&gt;&lt;a href=&quot;#cb3-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;     &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-11&quot;&gt;&lt;a href=&quot;#cb3-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-12&quot;&gt;&lt;a href=&quot;#cb3-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The second configuration is the default build target rule for the make utility, which is equivalent to running &lt;code&gt;make [target]&lt;/code&gt; directly. The IDE will let show you a list of target rules defined in the Makefile configured for the project:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9540.png&quot; alt=&quot;config build target&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;config build target&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Finally, the third configuration available in the perspective is the &lt;code&gt;Launch target&lt;/code&gt;. This shows you a list of compiled files that can be run from the perspective using the commands &lt;code&gt;Debug&lt;/code&gt; and &lt;code&gt;Run&lt;/code&gt;. This is useful if you want to debug your source code with GDB or LLDB debuggers.&lt;/p&gt;
&lt;p&gt;In this example, the only file runnable is &lt;code&gt;CoinFlipper.out&lt;/code&gt;, compiled from the source code.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9560.png&quot; alt=&quot;make launch target&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;make launch target&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The commands in the Makefile are self-explanatory:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Build&lt;/code&gt; runs make with the target configured previously.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;all&lt;/code&gt; instead of &lt;code&gt;default&lt;/code&gt; passes no arguments to the make utility.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Debug&lt;/code&gt; and &lt;code&gt;Run in terminal&lt;/code&gt; commands launch the target (&lt;code&gt;CoinFlipper.out&lt;/code&gt; in the example) with/without the debug support.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Once you build the project, the terminal view shows the result of the execution:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Building target &amp;quot;all&amp;quot; with command: &amp;quot;make all&amp;quot;
rm -rf ./target/*.out
g++ -o ./target/CoinFlipper.out ./src/main/CoinFlipper.cpp
./target/CoinFlipper.out 101
50 Heads, 51 Tails
With enough trials Heads should be equal to Tails
Target all built successfully.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As you can see from the previous image, the target was built successfully after cleaning, compiling, and running the compiled program. The extension also provides commands to run other targets easily without changing the configurations in the perspective.&lt;/p&gt;
&lt;p&gt;The following image shows the commands available for the Makefile in the sample project:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9630.png&quot; alt=&quot;The makefile commands palette.&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;The makefile commands palette.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;building-complex-projects&quot;&gt;Building Complex Projects&lt;/h2&gt;
&lt;p&gt;Makefiles are more complex than this. Many projects have several levels of dependencies, configurations, and quirks that make supports easily. For example, the &lt;a href=&quot;https://github.com/FFmpeg/FFmpeg&quot;&gt;FFmpeg&lt;/a&gt; project is a collection of libraries to work with audio, video, and subtitles among other utilities. To build it, you can download the source from GitHub and examine the Makefile:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9680.png&quot; alt=&quot;The makefile for FFmpeg.&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;The makefile for FFmpeg.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The &lt;a href=&quot;https://trac.ffmpeg.org/wiki/CompilationGuide/Generic&quot;&gt;developer documentation&lt;/a&gt; for the project states that before building the source code with the provided Makefile, you need to run the &lt;a href=&quot;/blog/autoconf/&quot;&gt;&lt;code&gt;configure&lt;/code&gt;&lt;/a&gt; script located at the root of the project‚Äôs source code. Fortunately, the Makefile Tools Extension provides a setting to define the preconfiguration files required to run before executing the make commands, again in &lt;strong&gt;File &amp;gt; Preferences &amp;gt; Settings&lt;/strong&gt;.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9730.png&quot; alt=&quot;The makefile preconfiguration.&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;The makefile preconfiguration.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;In the &lt;strong&gt;Commands&lt;/strong&gt; section of the Makefile Tools Extension perspective, you can run the preconfigure command. This will run the configure script, and then you‚Äôre ready to experiment with the Makefile through the extension.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Large codebase projects need a build system to keep them under the development team‚Äôs control, and Makefiles are one the most ubiquitous and flexible ways to define building these complex software projects.&lt;/p&gt;
&lt;p&gt;With the new &lt;a href=&quot;https://marketplace.visualstudio.com/items?itemName=ms-vscode.makefile-tools&quot;&gt;Makefile Tools Extension&lt;/a&gt;, Visual Studio Code greatly simplifies access for new developers. Though it is still tagged as in preview, this extension has been thoroughly tested by the Microsoft Team, building over seventy open-source projects written in different languages (including C, C++, and Python) successfully.&lt;/p&gt;
&lt;p&gt;If you want to learn about the power of make and Makefile, consider checking out the &lt;a href=&quot;https://makefiletutorial.com/#include-makefiles&quot;&gt;Makefile Tutorial&lt;/a&gt;, and if you want the simplicity of a Makefile with the isolation of containers take a look at &lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt;.&lt;/p&gt;</content><author><name>Nicolas Bohorquez</name></author><category term="Tutorials" /><summary type="html">Microsoft announced recently a new Visual Studio Code extension to handle Makefiles. This extension provides a set of commands to the editor that will facilitate working with projects that rely on a Makefile to speed up the build. In this tutorial, you‚Äôll set up a simple C++ project that depends on a well-known Python library to produce some sample charts. This is not a deep tutorial about make and Makefiles, but to get the most out of the extension you will need to have some concepts clear. Make is one of the most used tools to build software projects, for good reason: You can get an implementation for almost any major operating system (POSIX/Windows/MacOS) It‚Äôs technology agnostic. You can use it to build projects on any programming language (here‚Äôs an example for JavaScript. Its task runner capabilities provide a multipurpose tool for almost any task. A Makefile is a simple text file that defines rules to be executed. The usual purpose for Makefile in C++ projects is to recompile and link necessary files based on the modifications done to dependencies. However, Makefile and make are far more useful than that. The rules defined in a Makefile combine concepts like: Shell scripting Regular expressions Target notation Project structure To illustrate this power, the sample project contains a single C++ source code file. The source code for the example is pretty simple ‚Äî- it flips a coin as many times as the iters argument is passed, and then prints the number of heads and tails counted from each flip. #include &amp;lt;cstdio&amp;gt; #include &amp;lt;cstdlib&amp;gt; #include &amp;lt;stdlib.h&amp;gt; #include &amp;lt;assert.h&amp;gt; #include &amp;lt;time.h&amp;gt; int flip_coins(int iters) { srand (time(NULL)); int heads, tails = 0; for(int i=0;i &amp;lt; iters;i++){ (rand() % 10 + 1) &amp;lt;= 5 ? heads++ : tails++; } printf(&amp;quot;%d Heads, %d Tails\n&amp;quot;,heads, tails); return abs(tails-heads); } int main(int argc,char* argv[]) { assert (argc == 2); int iters = atoi(argv[1]); int diff = flip_coins(iters); if(100 &amp;lt; iters) { printf(&amp;quot;With enough trials Heads should be equal to Tails\n&amp;quot;); } } This code will be compiled and linked with a simple Makefile that also will provide a couple of other standard rules for cleaning the compiled code and run a simple test. Creating C++ Projects with VS Code The VS Code extension Makefile Tools is still in preview but is actively developed. The installation process is similar to any other extension in VS Code: Makefile VSCode extension After installing the extension, verify the availability of the make command in the system. The most common implementation is GNU Make, which includes some non-standard extensions. If your installation of make is not available in the default path, you can configure it in VS Code at File &amp;gt; Preferences &amp;gt; Settings &amp;gt; Extensions makefile. Make path To compile and link the project, you can add a Makefile to the root of the project folder. It will be detected automatically by the extension. If you have a different structure, with a Makefile in another location, you can configure it at File &amp;gt; Preferences &amp;gt; Settings &amp;gt; Extensions &amp;gt; makefile. Makefile path This sample Makefile defines five simple rules: all: Cleans the compiled files from the target folder, then compiles and run the test code. default: Delegates to CoinFlipper.cpp. CoinFlipper.cpp: Compiles the single source file. test: Delegates to CoinFlipper.cpp, then runs the output main function passing an argument. clean: Deletes compiled files. # # A simple makefile for compiling a c++ project # SRC=./src TARGET=./target GCC = g++ CFLAGS = -o $(TARGET)/CoinFlipper.out ARGS = 101 RM = rm -rf all: clean default test default: CoinFlipper.cpp CoinFlipper.cpp: $(GCC) $(CFLAGS) $(SRC)/main/CoinFlipper.cpp test: CoinFlipper.cpp $(TARGET)/CoinFlipper.out $(ARGS) clean: $(RM) $(TARGET)/*.out The Makefile Tools Extension provides a new ‚Äúperspective‚Äù to the Visual Studio Code IDE. This contains three different commands and three different project configurations to run the Makefile: Makefile tools perspective The Configuration:[Default] refers to the make command configurations defined in the .vscode/settings.json file. This configuration is used to pass arguments to the make utility. In the following example, two configurations are defined: Default Print make version Print make versions adds the --version argument to the make utility every time the project is built using the Makefile extension. This argument is not especially useful but you can explore different arguments to fit your case. { &amp;quot;makefile.configurations&amp;quot;: [ { &amp;quot;name&amp;quot;: &amp;quot;Default&amp;quot;, &amp;quot;makeArgs&amp;quot;: [] }, { &amp;quot;name&amp;quot;: &amp;quot;Print make version&amp;quot;, &amp;quot;makeArgs&amp;quot;: [&amp;quot;--version&amp;quot;] } ] } The second configuration is the default build target rule for the make utility, which is equivalent to running make [target] directly. The IDE will let show you a list of target rules defined in the Makefile configured for the project: config build target Finally, the third configuration available in the perspective is the Launch target. This shows you a list of compiled files that can be run from the perspective using the commands Debug and Run. This is useful if you want to debug your source code with GDB or LLDB debuggers. In this example, the only file runnable is CoinFlipper.out, compiled from the source code. make launch target The commands in the Makefile are self-explanatory: Build runs make with the target configured previously. all instead of default passes no arguments to the make utility. Debug and Run in terminal commands launch the target (CoinFlipper.out in the example) with/without the debug support. Once you build the project, the terminal view shows the result of the execution: Building target &amp;quot;all&amp;quot; with command: &amp;quot;make all&amp;quot; rm -rf ./target/*.out g++ -o ./target/CoinFlipper.out ./src/main/CoinFlipper.cpp ./target/CoinFlipper.out 101 50 Heads, 51 Tails With enough trials Heads should be equal to Tails Target all built successfully. As you can see from the previous image, the target was built successfully after cleaning, compiling, and running the compiled program. The extension also provides commands to run other targets easily without changing the configurations in the perspective. The following image shows the commands available for the Makefile in the sample project: The makefile commands palette. Building Complex Projects Makefiles are more complex than this. Many projects have several levels of dependencies, configurations, and quirks that make supports easily. For example, the FFmpeg project is a collection of libraries to work with audio, video, and subtitles among other utilities. To build it, you can download the source from GitHub and examine the Makefile: The makefile for FFmpeg. The developer documentation for the project states that before building the source code with the provided Makefile, you need to run the configure script located at the root of the project‚Äôs source code. Fortunately, the Makefile Tools Extension provides a setting to define the preconfiguration files required to run before executing the make commands, again in File &amp;gt; Preferences &amp;gt; Settings. The makefile preconfiguration. In the Commands section of the Makefile Tools Extension perspective, you can run the preconfigure command. This will run the configure script, and then you‚Äôre ready to experiment with the Makefile through the extension. Conclusion Large codebase projects need a build system to keep them under the development team‚Äôs control, and Makefiles are one the most ubiquitous and flexible ways to define building these complex software projects. With the new Makefile Tools Extension, Visual Studio Code greatly simplifies access for new developers. Though it is still tagged as in preview, this extension has been thoroughly tested by the Microsoft Team, building over seventy open-source projects written in different languages (including C, C++, and Python) successfully. If you want to learn about the power of make and Makefile, consider checking out the Makefile Tutorial, and if you want the simplicity of a Makefile with the isolation of containers take a look at Earthly.</summary></entry><entry><title type="html">Using Continuous Testing in DevOps Workflows</title><link href="https://earthly.dev/blog/continuous-testing-in-devops/" rel="alternate" type="text/html" title="Using Continuous Testing in DevOps Workflows" /><published>2021-07-27T00:00:00-04:00</published><updated>2021-07-27T00:00:00-04:00</updated><id>https://earthly.dev/blog/continuous-testing-in-devops</id><content type="html" xml:base="https://earthly.dev/blog/continuous-testing-in-devops/">&lt;p&gt;Automation testing is a crucial element to speed up your delivery process. It aims to flush out any potential regressions. The more you automate, the more confidence you gain in the quality of your software because the quality of each release of your application or library is measurable. Additionally, you reduce costs and save time and effort by reducing manual testing.&lt;/p&gt;
&lt;p&gt;The caveat is that automated tests have no value if they are not executed regularly alongside your continuous integration (CI) pipeline. CI refers to frequently merging developer code changes and building and creating an artifact that can later be tested and deployed.&lt;/p&gt;
&lt;p&gt;Extending the CI process by adding automated tests is referred to as continuous testing (CT). CT enables you to apply the fail-fast principle. You test each code change, build, and deployment against several layers of automated tests. Thus, it results in rapid feedback on the quality of your product and the state of the development process.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/actions&quot;&gt;GitHub Actions&lt;/a&gt; is a great first step for implementing CT. It‚Äôs flexible and powerful enough to bring every step of the CI/CT process into a single place. Your application, tests, and workflow configuration lives with your code in your repository. Furthermore, the learning curve for GitHub Actions is relatively smooth thanks to the &lt;a href=&quot;https://github.com/marketplace?type=actions&quot;&gt;Marketplace&lt;/a&gt; that provides thousands of Actions ready to use out of the box.&lt;/p&gt;
&lt;h2 id=&quot;what-does-it-take-to-implement-continuous-testing&quot;&gt;What Does It Take to Implement Continuous Testing?&lt;/h2&gt;
&lt;p&gt;A good CI/CT process always contains at least the following steps:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Build&lt;/li&gt;
&lt;li&gt;Deployment&lt;/li&gt;
&lt;li&gt;Integration tests&lt;/li&gt;
&lt;li&gt;End-to-end tests&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In this tutorial, you will implement these four steps using GitHub Actions, as well as add performance tests.&lt;/p&gt;
&lt;p&gt;The Build steps include code compilation and unit tests. Also, note that it‚Äôs convenient to deploy your application in a &lt;code&gt;dev&lt;/code&gt; environment before running complex tests such as integration and end-to-end. However, you may also run your application in GitHub Actions for test purposes.&lt;/p&gt;
&lt;p&gt;In this article, I assume you‚Äôll deploy to a &lt;code&gt;dev&lt;/code&gt; environment and focus on implementing different types of tests. Here is a visual of the final workflow for this tutorial:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/40nOj1F.png&quot; alt=&quot;Final GitHub Action Workflow&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Final GitHub Action Workflow&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Implementing continuous testing can be challenging. If you are on a team that is new to this fail-fast approach, it may be a frustrating transition. In addition, seeing builds or pipelines failing can be overwhelming at the beginning. I suggest prioritizing fixing tests over focusing on new features. This may also be a significant change.&lt;/p&gt;
&lt;p&gt;To remediate those challenges, you should rely on the five DevOps principles described by &lt;a href=&quot;https://twitter.com/jezhumble&quot;&gt;Jez Humble&lt;/a&gt; in &lt;em&gt;The DevOps Handbook&lt;/em&gt;:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Culture&lt;/li&gt;
&lt;li&gt;Automate&lt;/li&gt;
&lt;li&gt;Lean&lt;/li&gt;
&lt;li&gt;Measure&lt;/li&gt;
&lt;li&gt;Sharing&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Implementing continuous testing is first a change in &lt;strong&gt;culture&lt;/strong&gt;. Selecting the right tools for CI/CT can greatly improve collaboration.&lt;/p&gt;
&lt;p&gt;Keep your process &lt;strong&gt;lean&lt;/strong&gt;. Testing should not slow down your process. Instead, select the right amount of tests at the right time in the process. Monitor your &lt;a href=&quot;https://docs.github.com/en/actions/managing-workflow-runs/viewing-job-execution-time&quot;&gt;job execution time&lt;/a&gt;, prefer small tasks that can fail fast, and provide rapid feedback instead of long-running ones.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Automate&lt;/strong&gt; as much and as early as possible because it helps validate that the integration is successful. Delaying test implementation is counterproductive.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Measure&lt;/strong&gt; your improvement and build a baseline for the quality of your software. For example, collect your code coverage, number of successful vs.¬†failed tests, and performance metric.&lt;/p&gt;
&lt;p&gt;Don‚Äôt forget to encourage knowledge &lt;strong&gt;sharing&lt;/strong&gt;. Test automation is not a single person‚Äôs job: everyone on the team should know how the test suites work and learn how to fix simple errors when the workflows fail.&lt;/p&gt;
&lt;h2 id=&quot;implementing-cict-with-github-actions&quot;&gt;Implementing CI/CT With GitHub Actions&lt;/h2&gt;
&lt;p&gt;Now that you know the basics of CT, it‚Äôs time to see how to implement the first step by creating a GitHub Actions workflow that builds and runs your unit tests.&lt;/p&gt;
&lt;h3 id=&quot;build-a-github-actions-workflow-with-unit-tests&quot;&gt;Build a GitHub Actions Workflow with Unit Tests&lt;/h3&gt;
&lt;p&gt;The first thing you need to get started is an initial workflow. If you already committed your application to a GitHub repository, click &lt;strong&gt;Actions&lt;/strong&gt;. GitHub will automatically select and recommend a simple workflow that best suits your language.&lt;/p&gt;
&lt;p&gt;Select one of them by clicking &lt;strong&gt;Set up this workflow&lt;/strong&gt;, review the workflow steps, and commit.&lt;/p&gt;
&lt;p&gt;Right away, you should see your workflow starting to build and test your application. Many starting workflows also include linting that validates the formatting and detects potential errors.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/043P3GAA.png&quot; alt=&quot;Get Started with GitHub Action Workflow&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Get Started with GitHub Action Workflow&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;A GitHub Actions workflow contains three elements:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Triggers&lt;/strong&gt; (&lt;code&gt;on&lt;/code&gt;) specify when the workflow must be executed. The most common use case is to run a workflow on &lt;a href=&quot;https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions#on&quot;&gt;push and pull-request on the &lt;code&gt;main&lt;/code&gt; branch&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Jobs&lt;/strong&gt; determine sets of actions composing your pipeline and are executed in parallel unless dependencies between jobs are specified.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Steps&lt;/strong&gt; are the individual components of a job and can be of two types: &lt;code&gt;Scripts&lt;/code&gt; or &lt;code&gt;Actions&lt;/code&gt;. Steps defining a &lt;code&gt;run&lt;/code&gt; attribute execute a command on the host defined by &lt;code&gt;runs-on&lt;/code&gt; at the beginning of a job. Steps containing &lt;code&gt;uses&lt;/code&gt; execute an &lt;a href=&quot;https://docs.github.com/en/actions/creating-actions&quot;&gt;Action&lt;/a&gt;, a reusable automation script.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It‚Äôs straightforward to extend a workflow once you understand those three concepts. Here‚Äôs a sample workflow for a Python application:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode yaml&quot;&gt;&lt;code class=&quot;sourceCode yaml&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Python application&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;pull_request&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; main &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-6&quot;&gt;&lt;a href=&quot;#cb1-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-7&quot;&gt;&lt;a href=&quot;#cb1-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-8&quot;&gt;&lt;a href=&quot;#cb1-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-9&quot;&gt;&lt;a href=&quot;#cb1-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-10&quot;&gt;&lt;a href=&quot;#cb1-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ubuntu-latest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-11&quot;&gt;&lt;a href=&quot;#cb1-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-12&quot;&gt;&lt;a href=&quot;#cb1-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-13&quot;&gt;&lt;a href=&quot;#cb1-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/checkout@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-14&quot;&gt;&lt;a href=&quot;#cb1-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Set up Python 3.9&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-15&quot;&gt;&lt;a href=&quot;#cb1-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/setup-python@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-16&quot;&gt;&lt;a href=&quot;#cb1-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-17&quot;&gt;&lt;a href=&quot;#cb1-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;python-version&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fl&quot;&gt;3.9&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-18&quot;&gt;&lt;a href=&quot;#cb1-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Install dependencies&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-19&quot;&gt;&lt;a href=&quot;#cb1-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;      run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;|&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-20&quot;&gt;&lt;a href=&quot;#cb1-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        python -m pip install --upgrade pip&lt;/span&gt;
&lt;span id=&quot;cb1-21&quot;&gt;&lt;a href=&quot;#cb1-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        pip install flake8 pytest&lt;/span&gt;
&lt;span id=&quot;cb1-22&quot;&gt;&lt;a href=&quot;#cb1-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        if [ -f requirements.txt ]; then pip install -r requirements.txt; fi&lt;/span&gt;
&lt;span id=&quot;cb1-23&quot;&gt;&lt;a href=&quot;#cb1-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Lint with flake8&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-24&quot;&gt;&lt;a href=&quot;#cb1-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;      run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;|&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-25&quot;&gt;&lt;a href=&quot;#cb1-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        # stop the build if there are Python syntax errors or undefined names&lt;/span&gt;
&lt;span id=&quot;cb1-26&quot;&gt;&lt;a href=&quot;#cb1-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics&lt;/span&gt;
&lt;span id=&quot;cb1-27&quot;&gt;&lt;a href=&quot;#cb1-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        # exit-zero treats all errors as warnings. The GitHub editor is 127 chars wide&lt;/span&gt;
&lt;span id=&quot;cb1-28&quot;&gt;&lt;a href=&quot;#cb1-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        flake8 . --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics&lt;/span&gt;
&lt;span id=&quot;cb1-29&quot;&gt;&lt;a href=&quot;#cb1-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Test with pytest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-30&quot;&gt;&lt;a href=&quot;#cb1-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;      run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;|&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-31&quot;&gt;&lt;a href=&quot;#cb1-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        pytest&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This what a basic workflow looks like:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/KVnFfF4.png&quot; alt=&quot;Most basic GitHub Actions workflow&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Most basic GitHub Actions workflow&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;add-code-coverage-reports&quot;&gt;Add Code Coverage Reports&lt;/h3&gt;
&lt;p&gt;On GitHub, most users rely on third parties to get coverage reports (such as &lt;a href=&quot;https://www.sonarqube.org/&quot;&gt;SonarQube&lt;/a&gt; or &lt;a href=&quot;https://about.codecov.io/&quot;&gt;Codecov&lt;/a&gt;). Integrating those SaaS into your workflow is simple, thanks to the GitHub Actions Marketplace. Most third parties providing code coverage reports have created an Action to make the integration seamless.&lt;/p&gt;
&lt;p&gt;But let‚Äôs not rely on a third party yet. Instead, generate a badge to display in your &lt;code&gt;Readme.md&lt;/code&gt;. You‚Äôre putting in place the first step toward tracking code quality.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Edit your existing &lt;code&gt;Test with xxx&lt;/code&gt; step to generate a coverage report.&lt;/li&gt;
&lt;li&gt;Save the coverage report as an artifact. &lt;a href=&quot;https://docs.github.com/en/actions/guides/storing-workflow-data-as-artifacts&quot;&gt;Storing workflow data as artifacts&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Create a new job called &lt;code&gt;gating&lt;/code&gt; and download the coverage report. This job must be executed after &lt;code&gt;build&lt;/code&gt;; therefore, you must declare &lt;code&gt;needs: build&lt;/code&gt; in your configuration.&lt;/li&gt;
&lt;li&gt;Parse the coverage report to extract the coverage value. I provided a small script that does just that.&lt;/li&gt;
&lt;li&gt;Generate the badge and add it to your README. Follow the setup step in the documentation of &lt;a href=&quot;https://github.com/Schneegans/dynamic-badges-action&quot;&gt;schneegans/dynamic-badges-action@v1.1.0&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode yml&quot;&gt;&lt;code class=&quot;sourceCode yaml&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# This workflow will install Python dependencies, run tests, and lint with a single version of Python&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-2&quot;&gt;&lt;a href=&quot;#cb2-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# For more information see: https://help.github.com/actions/language-and-framework-guides/using-python-with-github-actions&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-3&quot;&gt;&lt;a href=&quot;#cb2-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-4&quot;&gt;&lt;a href=&quot;#cb2-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Python application&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-5&quot;&gt;&lt;a href=&quot;#cb2-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-6&quot;&gt;&lt;a href=&quot;#cb2-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-7&quot;&gt;&lt;a href=&quot;#cb2-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-8&quot;&gt;&lt;a href=&quot;#cb2-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; main &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-9&quot;&gt;&lt;a href=&quot;#cb2-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;pull_request&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-10&quot;&gt;&lt;a href=&quot;#cb2-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; main &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-11&quot;&gt;&lt;a href=&quot;#cb2-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-12&quot;&gt;&lt;a href=&quot;#cb2-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-13&quot;&gt;&lt;a href=&quot;#cb2-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-14&quot;&gt;&lt;a href=&quot;#cb2-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ubuntu-latest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-15&quot;&gt;&lt;a href=&quot;#cb2-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-16&quot;&gt;&lt;a href=&quot;#cb2-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/checkout@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-17&quot;&gt;&lt;a href=&quot;#cb2-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Set up Python 3.9&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-18&quot;&gt;&lt;a href=&quot;#cb2-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/setup-python@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-19&quot;&gt;&lt;a href=&quot;#cb2-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-20&quot;&gt;&lt;a href=&quot;#cb2-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;python-version&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fl&quot;&gt;3.9&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-21&quot;&gt;&lt;a href=&quot;#cb2-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Install dependencies&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-22&quot;&gt;&lt;a href=&quot;#cb2-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-23&quot;&gt;&lt;a href=&quot;#cb2-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Lint with flake8&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-24&quot;&gt;&lt;a href=&quot;#cb2-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-25&quot;&gt;&lt;a href=&quot;#cb2-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Test with pytest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-26&quot;&gt;&lt;a href=&quot;#cb2-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;      # Update the command to generate coverage report&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-27&quot;&gt;&lt;a href=&quot;#cb2-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; pytest --cov-report xml --cov=phonebook tests/&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-28&quot;&gt;&lt;a href=&quot;#cb2-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Upload pytest test coverage&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-29&quot;&gt;&lt;a href=&quot;#cb2-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;      # Upload the coverage result as an artifact&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-30&quot;&gt;&lt;a href=&quot;#cb2-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/upload-artifact@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-31&quot;&gt;&lt;a href=&quot;#cb2-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-32&quot;&gt;&lt;a href=&quot;#cb2-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; coverage-results&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-33&quot;&gt;&lt;a href=&quot;#cb2-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; coverage.xml&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-34&quot;&gt;&lt;a href=&quot;#cb2-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;      # Use always() to always run this step to publish test results when there are test failures&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-35&quot;&gt;&lt;a href=&quot;#cb2-35&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ${{ always() }}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-36&quot;&gt;&lt;a href=&quot;#cb2-36&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-37&quot;&gt;&lt;a href=&quot;#cb2-37&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;gating&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-38&quot;&gt;&lt;a href=&quot;#cb2-38&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ubuntu-latest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-39&quot;&gt;&lt;a href=&quot;#cb2-39&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; build&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-40&quot;&gt;&lt;a href=&quot;#cb2-40&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-41&quot;&gt;&lt;a href=&quot;#cb2-41&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-42&quot;&gt;&lt;a href=&quot;#cb2-42&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Download coverage report&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-43&quot;&gt;&lt;a href=&quot;#cb2-43&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/download-artifact@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-44&quot;&gt;&lt;a href=&quot;#cb2-44&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-45&quot;&gt;&lt;a href=&quot;#cb2-45&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; coverage-results&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-46&quot;&gt;&lt;a href=&quot;#cb2-46&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Get the Coverage&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-47&quot;&gt;&lt;a href=&quot;#cb2-47&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; bash&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-48&quot;&gt;&lt;a href=&quot;#cb2-48&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;      run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;|&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-49&quot;&gt;&lt;a href=&quot;#cb2-49&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        regex=&amp;#39;&amp;lt;coverage.+line-rate=&amp;quot;([0-9).[0-9]+)&amp;quot;.+&amp;gt;&amp;#39;&lt;/span&gt;
&lt;span id=&quot;cb2-50&quot;&gt;&lt;a href=&quot;#cb2-50&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        line=$(grep -oP $regex coverage.xml)&lt;/span&gt;
&lt;span id=&quot;cb2-51&quot;&gt;&lt;a href=&quot;#cb2-51&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        [[ $line =~ $regex ]]&lt;/span&gt;
&lt;span id=&quot;cb2-52&quot;&gt;&lt;a href=&quot;#cb2-52&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        coverage=$( bc &amp;lt;&amp;lt;&amp;lt; ${BASH_REMATCH[1]}*100 )&lt;/span&gt;
&lt;span id=&quot;cb2-53&quot;&gt;&lt;a href=&quot;#cb2-53&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        if (( $(echo &amp;quot;$coverage &amp;gt; 80&amp;quot; |bc -l) )); then&lt;/span&gt;
&lt;span id=&quot;cb2-54&quot;&gt;&lt;a href=&quot;#cb2-54&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          COLOR=green&lt;/span&gt;
&lt;span id=&quot;cb2-55&quot;&gt;&lt;a href=&quot;#cb2-55&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        else&lt;/span&gt;
&lt;span id=&quot;cb2-56&quot;&gt;&lt;a href=&quot;#cb2-56&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          COLOR=red&lt;/span&gt;
&lt;span id=&quot;cb2-57&quot;&gt;&lt;a href=&quot;#cb2-57&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        fi&lt;/span&gt;
&lt;span id=&quot;cb2-58&quot;&gt;&lt;a href=&quot;#cb2-58&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        echo &amp;quot;COVERAGE=${coverage%.*}%&amp;quot; &amp;gt;&amp;gt; $GITHUB_ENV&lt;/span&gt;
&lt;span id=&quot;cb2-59&quot;&gt;&lt;a href=&quot;#cb2-59&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        echo &amp;quot;COLOR=$COLOR&amp;quot; &amp;gt;&amp;gt; $GITHUB_ENV&lt;/span&gt;
&lt;span id=&quot;cb2-60&quot;&gt;&lt;a href=&quot;#cb2-60&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Create the Badge&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-61&quot;&gt;&lt;a href=&quot;#cb2-61&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;      # save the badge configuration in a Gist&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-62&quot;&gt;&lt;a href=&quot;#cb2-62&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; schneegans/dynamic-badges-action@v1.1.0&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-63&quot;&gt;&lt;a href=&quot;#cb2-63&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-64&quot;&gt;&lt;a href=&quot;#cb2-64&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;auth&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ${{ secrets.GIST_SECRET }}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-65&quot;&gt;&lt;a href=&quot;#cb2-65&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;gistID&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ab3bde9504060bd1feb361555e79f51d&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-66&quot;&gt;&lt;a href=&quot;#cb2-66&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; coverage.json&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-67&quot;&gt;&lt;a href=&quot;#cb2-67&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; coverage&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-68&quot;&gt;&lt;a href=&quot;#cb2-68&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ${{ env.COVERAGE }}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-69&quot;&gt;&lt;a href=&quot;#cb2-69&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ${{ env.COLOR }}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is what your updated workflow looks like:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/1626877878.png&quot; alt=&quot;GitHub Action workflow including code coverage badge&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;GitHub Action workflow including code coverage badge&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;And you got a badge to decorate your &lt;code&gt;readme.md&lt;/code&gt;.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/1626878146.png&quot; alt=&quot;GitHub code coverage badge&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;GitHub code coverage badge&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;extending-ct-with-other-types-of-testing&quot;&gt;Extending CT with Other Types of Testing&lt;/h2&gt;
&lt;p&gt;You have a basic CI workflow that includes unit tests and coverage reports. Now to obtain an excellent CT workflow, you need to expand with more layers of tests. You will add three new jobs:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;For API testing,&lt;/li&gt;
&lt;li&gt;For end-to-end testing&lt;/li&gt;
&lt;li&gt;For performance testing&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;add-api-testing&quot;&gt;Add API Testing&lt;/h3&gt;
&lt;p&gt;API testing is part of &lt;a href=&quot;/blog/unit-vs-integration&quot;&gt;integration testing&lt;/a&gt;. Integration testing aims to determine whether individual units meet your requirement when combined together. When performing integration testing, you target the boundary (or interfaces) of your system. In this specific case, you are aiming your test at a RESTful API. Having API tests ensures that sets of functionality meet your requirement and validates that your web server and connection to a database works properly.&lt;/p&gt;
&lt;p&gt;While you could write an API test in the same language as your application, you should also consider a tool like &lt;a href=&quot;https://blog.scottlogic.com/2020/02/04/GraduateGuideToAPITesting.html&quot;&gt;Postman/Newman&lt;/a&gt;. Postman lets you define a sequence of HTTPS calls and validate each of them using their JavaScript test framework. This makes it easy to share integration test suites. Other developers can use them to facilitate their development process, for instance, mobile developers working with a different stack than backend developers. Newman is the command-line interface that lets you run the Postman tests.&lt;/p&gt;
&lt;p&gt;Now that you have selected an API testing framework go to GitHub &lt;a href=&quot;https://github.com/marketplace?type=actions&quot;&gt;Actions Marketplace&lt;/a&gt; and look for an Action that meets your demands. For instance, &lt;a href=&quot;https://github.com/marketplace/actions/newman-action&quot;&gt;Newman Action&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Now edit your workflow configuration:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Add a new job that must be executed after the deployment using &lt;code&gt;needs: deploy&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Define the steps of your job:
&lt;ul&gt;
&lt;li&gt;Check out your repository using the Action &lt;code&gt;actions/checkout@master&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Run Newman using the Action you just found in the Marketplace.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Move the gating job at the end of the workflow by changing the &lt;code&gt;needs&lt;/code&gt; property.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode yaml&quot;&gt;&lt;code class=&quot;sourceCode yaml&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Python application&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-4&quot;&gt;&lt;a href=&quot;#cb3-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-5&quot;&gt;&lt;a href=&quot;#cb3-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; main &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-6&quot;&gt;&lt;a href=&quot;#cb3-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-7&quot;&gt;&lt;a href=&quot;#cb3-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-8&quot;&gt;&lt;a href=&quot;#cb3-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-9&quot;&gt;&lt;a href=&quot;#cb3-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-10&quot;&gt;&lt;a href=&quot;#cb3-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;deploy&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-11&quot;&gt;&lt;a href=&quot;#cb3-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;co&quot;&gt; # our deployment steps&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-12&quot;&gt;&lt;a href=&quot;#cb3-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;tests_api&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-13&quot;&gt;&lt;a href=&quot;#cb3-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; deploy&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-14&quot;&gt;&lt;a href=&quot;#cb3-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ubuntu-latest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-15&quot;&gt;&lt;a href=&quot;#cb3-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-16&quot;&gt;&lt;a href=&quot;#cb3-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/checkout@master&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-17&quot;&gt;&lt;a href=&quot;#cb3-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; matt-ball/newman-action@master&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-18&quot;&gt;&lt;a href=&quot;#cb3-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-19&quot;&gt;&lt;a href=&quot;#cb3-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;collection&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; tests_integration/postman_collection.json&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-20&quot;&gt;&lt;a href=&quot;#cb3-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;environment&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; tests_integration/postman_environment.json&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-21&quot;&gt;&lt;a href=&quot;#cb3-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;gating&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-22&quot;&gt;&lt;a href=&quot;#cb3-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; tests_api&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-23&quot;&gt;&lt;a href=&quot;#cb3-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;co&quot;&gt; # we move the gating at the end of the workflow&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now your workflow should contain four sequential jobs:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/1626878353.png&quot; alt=&quot;GitHub Actions workflow including API tests&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;GitHub Actions workflow including API tests&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;add-end-to-end-testing&quot;&gt;Add End-to-End Testing&lt;/h3&gt;
&lt;p&gt;End-to-end testing (e2e) aims to test complete use cases from the user perspective. Think of e2e as replacing a human with a robot.&lt;/p&gt;
&lt;p&gt;When it comes to selecting an e2e framework, I recommend prioritizing one that supports the Gherkin language. Gherkin promotes writing tests in natural language (aka, plain English). With this approach, more people can understand test cases, including product owners and business analysts. As a result, you foster better collaboration within the team.&lt;/p&gt;
&lt;p&gt;Verbalizing tests also ensure that you are writing them from the user‚Äôs perspective and not making the mistake of testing the functions you just coded.&lt;/p&gt;
&lt;p&gt;I selected &lt;a href=&quot;https://robotframework.org/&quot;&gt;Robot Framework&lt;/a&gt; for this example. Robot Framework uses &lt;a href=&quot;https://www.selenium.dev/&quot;&gt;Selenium&lt;/a&gt; to control a web browser and thus replace a human by simulating clicks and text entries.&lt;/p&gt;
&lt;p&gt;Once again, you can go to &lt;a href=&quot;https://github.com/marketplace?type=actions&quot;&gt;GitHub Actions Marketplace&lt;/a&gt; and look for an Action meeting your needs. For instance, &lt;a href=&quot;https://github.com/marketplace/actions/robot-framework&quot;&gt;Robot Framework Docker Action&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Add a new job called &lt;code&gt;test_e2e&lt;/code&gt; to the workflow configuration. This job must be executed after deploy using &lt;code&gt;needs: deploy&lt;/code&gt;. You will notice that since &lt;code&gt;tests_api&lt;/code&gt; and &lt;code&gt;test_e2e&lt;/code&gt; both need &lt;code&gt;deploy&lt;/code&gt;, they will be executed in parallel after the deployment.&lt;/p&gt;
&lt;p&gt;Have a look at the result:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/1626878240.png&quot; alt=&quot;GitHub Actions workflow including end-to-end tests&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;GitHub Actions workflow including end-to-end tests&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Your configuration should look along those lines to achieve this workflow:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode yaml&quot;&gt;&lt;code class=&quot;sourceCode yaml&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Python application&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-4&quot;&gt;&lt;a href=&quot;#cb4-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-5&quot;&gt;&lt;a href=&quot;#cb4-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; main &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-6&quot;&gt;&lt;a href=&quot;#cb4-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-7&quot;&gt;&lt;a href=&quot;#cb4-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-8&quot;&gt;&lt;a href=&quot;#cb4-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-9&quot;&gt;&lt;a href=&quot;#cb4-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;deploy&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-10&quot;&gt;&lt;a href=&quot;#cb4-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;tests_api&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-11&quot;&gt;&lt;a href=&quot;#cb4-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;test_e2e&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-12&quot;&gt;&lt;a href=&quot;#cb4-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ubuntu-latest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-13&quot;&gt;&lt;a href=&quot;#cb4-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; deploy&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-14&quot;&gt;&lt;a href=&quot;#cb4-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Run Robot Framework Tests&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-15&quot;&gt;&lt;a href=&quot;#cb4-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-16&quot;&gt;&lt;a href=&quot;#cb4-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Checkout&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-17&quot;&gt;&lt;a href=&quot;#cb4-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/checkout@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-18&quot;&gt;&lt;a href=&quot;#cb4-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Create folder for reports&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-19&quot;&gt;&lt;a href=&quot;#cb4-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; mkdir reports&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-20&quot;&gt;&lt;a href=&quot;#cb4-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Robot Framework Test&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-21&quot;&gt;&lt;a href=&quot;#cb4-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;        # &lt;/span&gt;&lt;span class=&quot;al&quot;&gt;NOTE&lt;/span&gt;&lt;span class=&quot;co&quot;&gt;: joonvena/robotframework-docker-action@v0.1 had permissions issue&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-22&quot;&gt;&lt;a href=&quot;#cb4-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;        # This action is based on a Docker image. I had to fall back to that image&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-23&quot;&gt;&lt;a href=&quot;#cb4-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;        # and use --user flag&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-24&quot;&gt;&lt;a href=&quot;#cb4-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;        run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;|&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-25&quot;&gt;&lt;a href=&quot;#cb4-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          docker run \&lt;/span&gt;
&lt;span id=&quot;cb4-26&quot;&gt;&lt;a href=&quot;#cb4-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            -v ${PWD}/reports:/opt/robotframework/reports:Z \&lt;/span&gt;
&lt;span id=&quot;cb4-27&quot;&gt;&lt;a href=&quot;#cb4-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            -v $/tests_e2e:/opt/robotframework/tests:Z \&lt;/span&gt;
&lt;span id=&quot;cb4-28&quot;&gt;&lt;a href=&quot;#cb4-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            --user $(id -u):$(id -g) \&lt;/span&gt;
&lt;span id=&quot;cb4-29&quot;&gt;&lt;a href=&quot;#cb4-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            -e BROWSER=chrome \&lt;/span&gt;
&lt;span id=&quot;cb4-30&quot;&gt;&lt;a href=&quot;#cb4-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            ppodgorsek/robot-framework:latest&lt;/span&gt;
&lt;span id=&quot;cb4-31&quot;&gt;&lt;a href=&quot;#cb4-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Upload test results&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-32&quot;&gt;&lt;a href=&quot;#cb4-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/upload-artifact@v1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-33&quot;&gt;&lt;a href=&quot;#cb4-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; always()&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-34&quot;&gt;&lt;a href=&quot;#cb4-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-35&quot;&gt;&lt;a href=&quot;#cb4-35&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; robotframework report&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-36&quot;&gt;&lt;a href=&quot;#cb4-36&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; reports&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-37&quot;&gt;&lt;a href=&quot;#cb4-37&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;gating&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-38&quot;&gt;&lt;a href=&quot;#cb4-38&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;tests_api&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; test_e2e&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-39&quot;&gt;&lt;a href=&quot;#cb4-39&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;co&quot;&gt; # move the gating at the end of the workflow&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;add-performance-testing&quot;&gt;Add Performance Testing&lt;/h3&gt;
&lt;p&gt;Performance testing is a broad topic because there are multiple types of performance testing. Most online sources agree on six types:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Load testing&lt;/li&gt;
&lt;li&gt;Stress testing&lt;/li&gt;
&lt;li&gt;Soak testing&lt;/li&gt;
&lt;li&gt;Spike testing&lt;/li&gt;
&lt;li&gt;Scalability testing&lt;/li&gt;
&lt;li&gt;Capacity testing.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;However, I don‚Äôt recommend you try to include each of them. Instead, consider one of two ways to tackle performance testing:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;strong&gt;Identify bottlenecks.&lt;/strong&gt; Design an experiment that identifies bottlenecks and measures the limit of your system.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Benchmarking.&lt;/strong&gt; Identify critical elements of your application and measure its speed. The goal is to improve one performance metric over time; conversely, you want to be alerted in case of metric degradation and address the problem as soon as possible.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;As before, create a new job (called &lt;code&gt;test_performance&lt;/code&gt;). This time I did not find an Action on the Marketplace that fit my requirement. But I recommend &lt;a href=&quot;https://medium.com/nerd-for-tech/ci-build-performance-testing-with-github-action-e6b227097c83&quot;&gt;this Medium article&lt;/a&gt; to help you select your framework and implement the steps of the job yourself.&lt;/p&gt;
&lt;p&gt;Here is the workflow I came up with for my Python application:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode yml&quot;&gt;&lt;code class=&quot;sourceCode yaml&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Python application&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-2&quot;&gt;&lt;a href=&quot;#cb5-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-3&quot;&gt;&lt;a href=&quot;#cb5-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-4&quot;&gt;&lt;a href=&quot;#cb5-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-5&quot;&gt;&lt;a href=&quot;#cb5-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; main &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-6&quot;&gt;&lt;a href=&quot;#cb5-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-7&quot;&gt;&lt;a href=&quot;#cb5-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-8&quot;&gt;&lt;a href=&quot;#cb5-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-9&quot;&gt;&lt;a href=&quot;#cb5-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;deploy&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-10&quot;&gt;&lt;a href=&quot;#cb5-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;tests_api&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-11&quot;&gt;&lt;a href=&quot;#cb5-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;test_e2e&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-12&quot;&gt;&lt;a href=&quot;#cb5-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;test_performances&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-13&quot;&gt;&lt;a href=&quot;#cb5-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Check performance regression.&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-14&quot;&gt;&lt;a href=&quot;#cb5-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ubuntu-latest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-15&quot;&gt;&lt;a href=&quot;#cb5-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; deploy&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-16&quot;&gt;&lt;a href=&quot;#cb5-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-17&quot;&gt;&lt;a href=&quot;#cb5-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/checkout@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-18&quot;&gt;&lt;a href=&quot;#cb5-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Set up Python 3.9&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-19&quot;&gt;&lt;a href=&quot;#cb5-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/setup-python@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-20&quot;&gt;&lt;a href=&quot;#cb5-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-21&quot;&gt;&lt;a href=&quot;#cb5-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;python-version&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fl&quot;&gt;3.9&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-22&quot;&gt;&lt;a href=&quot;#cb5-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Install dependencies&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-23&quot;&gt;&lt;a href=&quot;#cb5-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;        run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;|&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-24&quot;&gt;&lt;a href=&quot;#cb5-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          python -m pip install --upgrade pip&lt;/span&gt;
&lt;span id=&quot;cb5-25&quot;&gt;&lt;a href=&quot;#cb5-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          pip install flake8 pytest&lt;/span&gt;
&lt;span id=&quot;cb5-26&quot;&gt;&lt;a href=&quot;#cb5-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi&lt;/span&gt;
&lt;span id=&quot;cb5-27&quot;&gt;&lt;a href=&quot;#cb5-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          if [ -f test-requirements.txt ]; then pip install -r test-requirements.txt; fi&lt;/span&gt;
&lt;span id=&quot;cb5-28&quot;&gt;&lt;a href=&quot;#cb5-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Run benchmark&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-29&quot;&gt;&lt;a href=&quot;#cb5-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; pytest tests_performances --benchmark-json output.json&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-30&quot;&gt;&lt;a href=&quot;#cb5-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Store benchmark result&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-31&quot;&gt;&lt;a href=&quot;#cb5-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; rhysd/github-action-benchmark@v1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-32&quot;&gt;&lt;a href=&quot;#cb5-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;        # &lt;/span&gt;&lt;span class=&quot;al&quot;&gt;NOTE&lt;/span&gt;&lt;span class=&quot;co&quot;&gt;: this action only works for public repository&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-33&quot;&gt;&lt;a href=&quot;#cb5-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;        # A pull-request is open with a fix&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-34&quot;&gt;&lt;a href=&quot;#cb5-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-35&quot;&gt;&lt;a href=&quot;#cb5-35&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;tool&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;pytest&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-36&quot;&gt;&lt;a href=&quot;#cb5-36&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;output-file-path&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; output.json&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-37&quot;&gt;&lt;a href=&quot;#cb5-37&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;          # Personal access token to deploy GitHub Pages branch&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-38&quot;&gt;&lt;a href=&quot;#cb5-38&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;github-token&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; $&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-39&quot;&gt;&lt;a href=&quot;#cb5-39&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;          # Push and deploy GitHub pages branch automatically&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-40&quot;&gt;&lt;a href=&quot;#cb5-40&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;auto-push&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-41&quot;&gt;&lt;a href=&quot;#cb5-41&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;          # Show alert with commit comment on detecting possible performance regression&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-42&quot;&gt;&lt;a href=&quot;#cb5-42&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;alert-threshold&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;200%&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-43&quot;&gt;&lt;a href=&quot;#cb5-43&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;comment-on-alert&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-44&quot;&gt;&lt;a href=&quot;#cb5-44&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;fail-on-alert&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-45&quot;&gt;&lt;a href=&quot;#cb5-45&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;alert-comment-cc-users&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;@xNok&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Your final workflow must look like this:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/1626878379.png&quot; alt=&quot;GitHub Actions workflow including performances tests&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;GitHub Actions workflow including performances tests&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Continuous testing is the next step after you successfully implement &lt;a href=&quot;/blog/continuous-integration&quot;&gt;continuous integration&lt;/a&gt;. It further improves the speed of your application development process and adds a quality control layer to it.&lt;/p&gt;
&lt;p&gt;Remember, there are three essential stages in a continuous testing workflow, each testing your system from a different perspective:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Unit tests validate the internal logic.&lt;/li&gt;
&lt;li&gt;Integration tests validate the response of the system from its boundary.&lt;/li&gt;
&lt;li&gt;End-to-end tests validate the system from the user‚Äôs perspective.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Adding performance tests can help you track important metrics and ensure that changes do not negatively impact your users.&lt;/p&gt;
&lt;p&gt;Finally, to succeed in implementing CT, remember that testing should become part of your team‚Äôs DNA and share the same five pillars as DevOps: culture, automation, lean, measurement, and sharing.&lt;/p&gt;
&lt;p&gt;As your CT process grows and becomes more ingrained in how you work, take a look at &lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly‚Äôs&lt;/a&gt; ability to produce a repeatable build process. It can help make testing in GitHub Actions a more straightforward process.&lt;/p&gt;</content><author><name>Alexandre Cou√´delo</name></author><category term="Tutorials" /><summary type="html">Automation testing is a crucial element to speed up your delivery process. It aims to flush out any potential regressions. The more you automate, the more confidence you gain in the quality of your software because the quality of each release of your application or library is measurable. Additionally, you reduce costs and save time and effort by reducing manual testing. The caveat is that automated tests have no value if they are not executed regularly alongside your continuous integration (CI) pipeline. CI refers to frequently merging developer code changes and building and creating an artifact that can later be tested and deployed. Extending the CI process by adding automated tests is referred to as continuous testing (CT). CT enables you to apply the fail-fast principle. You test each code change, build, and deployment against several layers of automated tests. Thus, it results in rapid feedback on the quality of your product and the state of the development process. GitHub Actions is a great first step for implementing CT. It‚Äôs flexible and powerful enough to bring every step of the CI/CT process into a single place. Your application, tests, and workflow configuration lives with your code in your repository. Furthermore, the learning curve for GitHub Actions is relatively smooth thanks to the Marketplace that provides thousands of Actions ready to use out of the box. What Does It Take to Implement Continuous Testing? A good CI/CT process always contains at least the following steps: Build Deployment Integration tests End-to-end tests In this tutorial, you will implement these four steps using GitHub Actions, as well as add performance tests. The Build steps include code compilation and unit tests. Also, note that it‚Äôs convenient to deploy your application in a dev environment before running complex tests such as integration and end-to-end. However, you may also run your application in GitHub Actions for test purposes. In this article, I assume you‚Äôll deploy to a dev environment and focus on implementing different types of tests. Here is a visual of the final workflow for this tutorial: Final GitHub Action Workflow Implementing continuous testing can be challenging. If you are on a team that is new to this fail-fast approach, it may be a frustrating transition. In addition, seeing builds or pipelines failing can be overwhelming at the beginning. I suggest prioritizing fixing tests over focusing on new features. This may also be a significant change. To remediate those challenges, you should rely on the five DevOps principles described by Jez Humble in The DevOps Handbook: Culture Automate Lean Measure Sharing Implementing continuous testing is first a change in culture. Selecting the right tools for CI/CT can greatly improve collaboration. Keep your process lean. Testing should not slow down your process. Instead, select the right amount of tests at the right time in the process. Monitor your job execution time, prefer small tasks that can fail fast, and provide rapid feedback instead of long-running ones. Automate as much and as early as possible because it helps validate that the integration is successful. Delaying test implementation is counterproductive. Measure your improvement and build a baseline for the quality of your software. For example, collect your code coverage, number of successful vs.¬†failed tests, and performance metric. Don‚Äôt forget to encourage knowledge sharing. Test automation is not a single person‚Äôs job: everyone on the team should know how the test suites work and learn how to fix simple errors when the workflows fail. Implementing CI/CT With GitHub Actions Now that you know the basics of CT, it‚Äôs time to see how to implement the first step by creating a GitHub Actions workflow that builds and runs your unit tests. Build a GitHub Actions Workflow with Unit Tests The first thing you need to get started is an initial workflow. If you already committed your application to a GitHub repository, click Actions. GitHub will automatically select and recommend a simple workflow that best suits your language. Select one of them by clicking Set up this workflow, review the workflow steps, and commit. Right away, you should see your workflow starting to build and test your application. Many starting workflows also include linting that validates the formatting and detects potential errors. Get Started with GitHub Action Workflow A GitHub Actions workflow contains three elements: Triggers (on) specify when the workflow must be executed. The most common use case is to run a workflow on push and pull-request on the main branch. Jobs determine sets of actions composing your pipeline and are executed in parallel unless dependencies between jobs are specified. Steps are the individual components of a job and can be of two types: Scripts or Actions. Steps defining a run attribute execute a command on the host defined by runs-on at the beginning of a job. Steps containing uses execute an Action, a reusable automation script. It‚Äôs straightforward to extend a workflow once you understand those three concepts. Here‚Äôs a sample workflow for a Python application: name: Python application on: pull_request: branches: [ main ] jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v2 - name: Set up Python 3.9 uses: actions/setup-python@v2 with: python-version: 3.9 - name: Install dependencies run: | python -m pip install --upgrade pip pip install flake8 pytest if [ -f requirements.txt ]; then pip install -r requirements.txt; fi - name: Lint with flake8 run: | # stop the build if there are Python syntax errors or undefined names flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics # exit-zero treats all errors as warnings. The GitHub editor is 127 chars wide flake8 . --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics - name: Test with pytest run: | pytest This what a basic workflow looks like: Most basic GitHub Actions workflow Add Code Coverage Reports On GitHub, most users rely on third parties to get coverage reports (such as SonarQube or Codecov). Integrating those SaaS into your workflow is simple, thanks to the GitHub Actions Marketplace. Most third parties providing code coverage reports have created an Action to make the integration seamless. But let‚Äôs not rely on a third party yet. Instead, generate a badge to display in your Readme.md. You‚Äôre putting in place the first step toward tracking code quality. Edit your existing Test with xxx step to generate a coverage report. Save the coverage report as an artifact. Storing workflow data as artifacts. Create a new job called gating and download the coverage report. This job must be executed after build; therefore, you must declare needs: build in your configuration. Parse the coverage report to extract the coverage value. I provided a small script that does just that. Generate the badge and add it to your README. Follow the setup step in the documentation of schneegans/dynamic-badges-action@v1.1.0. # This workflow will install Python dependencies, run tests, and lint with a single version of Python # For more information see: https://help.github.com/actions/language-and-framework-guides/using-python-with-github-actions name: Python application on: push: branches: [ main ] pull_request: branches: [ main ] jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v2 - name: Set up Python 3.9 uses: actions/setup-python@v2 with: python-version: 3.9 - name: Install dependencies [...] - name: Lint with flake8 [...] - name: Test with pytest # Update the command to generate coverage report run: pytest --cov-report xml --cov=phonebook tests/ - name: Upload pytest test coverage # Upload the coverage result as an artifact uses: actions/upload-artifact@v2 with: name: coverage-results path: coverage.xml # Use always() to always run this step to publish test results when there are test failures if: ${{ always() }} gating: runs-on: ubuntu-latest needs: build steps: - name: Download coverage report uses: actions/download-artifact@v2 with: name: coverage-results - name: Get the Coverage shell: bash run: | regex=&amp;#39;&amp;lt;coverage.+line-rate=&amp;quot;([0-9).[0-9]+)&amp;quot;.+&amp;gt;&amp;#39; line=$(grep -oP $regex coverage.xml) [[ $line =~ $regex ]] coverage=$( bc &amp;lt;&amp;lt;&amp;lt; ${BASH_REMATCH[1]}*100 ) if (( $(echo &amp;quot;$coverage &amp;gt; 80&amp;quot; |bc -l) )); then COLOR=green else COLOR=red fi echo &amp;quot;COVERAGE=${coverage%.*}%&amp;quot; &amp;gt;&amp;gt; $GITHUB_ENV echo &amp;quot;COLOR=$COLOR&amp;quot; &amp;gt;&amp;gt; $GITHUB_ENV - name: Create the Badge # save the badge configuration in a Gist uses: schneegans/dynamic-badges-action@v1.1.0 with: auth: ${{ secrets.GIST_SECRET }} gistID: ab3bde9504060bd1feb361555e79f51d filename: coverage.json label: coverage message: ${{ env.COVERAGE }} color: ${{ env.COLOR }} This is what your updated workflow looks like: GitHub Action workflow including code coverage badge And you got a badge to decorate your readme.md. GitHub code coverage badge Extending CT with Other Types of Testing You have a basic CI workflow that includes unit tests and coverage reports. Now to obtain an excellent CT workflow, you need to expand with more layers of tests. You will add three new jobs: For API testing, For end-to-end testing For performance testing Add API Testing API testing is part of integration testing. Integration testing aims to determine whether individual units meet your requirement when combined together. When performing integration testing, you target the boundary (or interfaces) of your system. In this specific case, you are aiming your test at a RESTful API. Having API tests ensures that sets of functionality meet your requirement and validates that your web server and connection to a database works properly. While you could write an API test in the same language as your application, you should also consider a tool like Postman/Newman. Postman lets you define a sequence of HTTPS calls and validate each of them using their JavaScript test framework. This makes it easy to share integration test suites. Other developers can use them to facilitate their development process, for instance, mobile developers working with a different stack than backend developers. Newman is the command-line interface that lets you run the Postman tests. Now that you have selected an API testing framework go to GitHub Actions Marketplace and look for an Action that meets your demands. For instance, Newman Action. Now edit your workflow configuration: Add a new job that must be executed after the deployment using needs: deploy. Define the steps of your job: Check out your repository using the Action actions/checkout@master. Run Newman using the Action you just found in the Marketplace. Move the gating job at the end of the workflow by changing the needs property. name: Python application on: push: branches: [ main ] jobs: build: [...] deploy: [...] # our deployment steps tests_api: needs: deploy runs-on: ubuntu-latest steps: - uses: actions/checkout@master - uses: matt-ball/newman-action@master with: collection: tests_integration/postman_collection.json environment: tests_integration/postman_environment.json gating: needs: tests_api [...] # we move the gating at the end of the workflow Now your workflow should contain four sequential jobs: GitHub Actions workflow including API tests Add End-to-End Testing End-to-end testing (e2e) aims to test complete use cases from the user perspective. Think of e2e as replacing a human with a robot. When it comes to selecting an e2e framework, I recommend prioritizing one that supports the Gherkin language. Gherkin promotes writing tests in natural language (aka, plain English). With this approach, more people can understand test cases, including product owners and business analysts. As a result, you foster better collaboration within the team. Verbalizing tests also ensure that you are writing them from the user‚Äôs perspective and not making the mistake of testing the functions you just coded. I selected Robot Framework for this example. Robot Framework uses Selenium to control a web browser and thus replace a human by simulating clicks and text entries. Once again, you can go to GitHub Actions Marketplace and look for an Action meeting your needs. For instance, Robot Framework Docker Action. Add a new job called test_e2e to the workflow configuration. This job must be executed after deploy using needs: deploy. You will notice that since tests_api and test_e2e both need deploy, they will be executed in parallel after the deployment. Have a look at the result: GitHub Actions workflow including end-to-end tests Your configuration should look along those lines to achieve this workflow: name: Python application on: push: branches: [ main ] jobs: build: [...] deploy: [...] tests_api: [...] test_e2e: runs-on: ubuntu-latest needs: deploy name: Run Robot Framework Tests steps: - name: Checkout uses: actions/checkout@v2 - name: Create folder for reports run: mkdir reports - name: Robot Framework Test # NOTE: joonvena/robotframework-docker-action@v0.1 had permissions issue # This action is based on a Docker image. I had to fall back to that image # and use --user flag run: | docker run \ -v ${PWD}/reports:/opt/robotframework/reports:Z \ -v $/tests_e2e:/opt/robotframework/tests:Z \ --user $(id -u):$(id -g) \ -e BROWSER=chrome \ ppodgorsek/robot-framework:latest - name: Upload test results uses: actions/upload-artifact@v1 if: always() with: name: robotframework report path: reports gating: needs: [tests_api, test_e2e] [...] # move the gating at the end of the workflow Add Performance Testing Performance testing is a broad topic because there are multiple types of performance testing. Most online sources agree on six types: Load testing Stress testing Soak testing Spike testing Scalability testing Capacity testing. However, I don‚Äôt recommend you try to include each of them. Instead, consider one of two ways to tackle performance testing: Identify bottlenecks. Design an experiment that identifies bottlenecks and measures the limit of your system. Benchmarking. Identify critical elements of your application and measure its speed. The goal is to improve one performance metric over time; conversely, you want to be alerted in case of metric degradation and address the problem as soon as possible. As before, create a new job (called test_performance). This time I did not find an Action on the Marketplace that fit my requirement. But I recommend this Medium article to help you select your framework and implement the steps of the job yourself. Here is the workflow I came up with for my Python application: name: Python application on: push: branches: [ main ] jobs: build: [...] deploy: [...] tests_api: [...] test_e2e: [...] test_performances: name: Check performance regression. runs-on: ubuntu-latest needs: deploy steps: - uses: actions/checkout@v2 - name: Set up Python 3.9 uses: actions/setup-python@v2 with: python-version: 3.9 - name: Install dependencies run: | python -m pip install --upgrade pip pip install flake8 pytest if [ -f requirements.txt ]; then pip install -r requirements.txt; fi if [ -f test-requirements.txt ]; then pip install -r test-requirements.txt; fi - name: Run benchmark run: pytest tests_performances --benchmark-json output.json - name: Store benchmark result uses: rhysd/github-action-benchmark@v1 # NOTE: this action only works for public repository # A pull-request is open with a fix with: tool: &amp;#39;pytest&amp;#39; output-file-path: output.json # Personal access token to deploy GitHub Pages branch github-token: $ # Push and deploy GitHub pages branch automatically auto-push: true # Show alert with commit comment on detecting possible performance regression alert-threshold: &amp;#39;200%&amp;#39; comment-on-alert: true fail-on-alert: true alert-comment-cc-users: &amp;#39;@xNok&amp;#39; Your final workflow must look like this: GitHub Actions workflow including performances tests Conclusion Continuous testing is the next step after you successfully implement continuous integration. It further improves the speed of your application development process and adds a quality control layer to it. Remember, there are three essential stages in a continuous testing workflow, each testing your system from a different perspective: Unit tests validate the internal logic. Integration tests validate the response of the system from its boundary. End-to-end tests validate the system from the user‚Äôs perspective. Adding performance tests can help you track important metrics and ensure that changes do not negatively impact your users. Finally, to succeed in implementing CT, remember that testing should become part of your team‚Äôs DNA and share the same five pillars as DevOps: culture, automation, lean, measurement, and sharing. As your CT process grows and becomes more ingrained in how you work, take a look at Earthly‚Äôs ability to produce a repeatable build process. It can help make testing in GitHub Actions a more straightforward process.</summary></entry><entry><title type="html">6 Command Line Tools for Productive Programmers</title><link href="https://earthly.dev/blog/command-line-tools/" rel="alternate" type="text/html" title="6 Command Line Tools for Productive Programmers" /><published>2021-07-23T00:00:00-04:00</published><updated>2021-07-23T00:00:00-04:00</updated><id>https://earthly.dev/blog/command-line-tools</id><content type="html" xml:base="https://earthly.dev/blog/command-line-tools/">&lt;p&gt;Lately, I‚Äôve been doing a lot more things at the command line. I‚Äôm not a hard-core terminal guy ‚Äì I use VSCode more than Vim ‚Äì but I‚Äôm always surprised at the number of complex tasks that can be done using just the POSIX standard command-line tools like &lt;code&gt;grep&lt;/code&gt;, &lt;code&gt;cat&lt;/code&gt; and &lt;code&gt;sort&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Tools are powerful. A good tool makes work easier and faster, and a great tool unlocks new abilities: Previously impossible things become possible and sometimes easy.&lt;/p&gt;
&lt;p&gt;As I‚Äôve learned more, I‚Äôve been adding some new tools to my command-line toolbox, and in this article, I‚Äôd like to share some I‚Äôve found valuable.&lt;/p&gt;
&lt;h2 id=&quot;broot&quot;&gt;&lt;code&gt;broot&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;I‚Äôm not sure how I came across &lt;code&gt;broot&lt;/code&gt;, but it‚Äôs pretty handy. If you are in a small directory and want to see the lay of the land, &lt;code&gt;tree&lt;/code&gt; is excellent.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;‚úó tree
.
‚îú‚îÄ‚îÄ dartboard.png
‚îú‚îÄ‚îÄ header.jpg
‚îú‚îÄ‚îÄ opensign.png
‚îú‚îÄ‚îÄ quote1.png
‚îî‚îÄ‚îÄ trophy.png

0 directories, 5 files&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;However, if the directory has many files or sub-directories, &lt;code&gt;tree&lt;/code&gt; becomes much less helpful: you only see the last screen full of information as files scroll past you.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ tree 
&amp;lt; scrolling text for a long time &amp;gt;
‚îú‚îÄ‚îÄ banner.js
‚îî‚îÄ‚îÄ index.html

328 directories, 2028 files&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;broot&lt;/code&gt; solves this problem by being aware of the size of your terminal window and adapting its output to fit it.&lt;/p&gt;
&lt;div class=&quot;wide-code&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/command-line-tools/broot-800-39409e646.png&quot; srcset=&quot;/blog/generated/assets/images/command-line-tools/broot-400-39409e646.png 400w, /blog/generated/assets/images/command-line-tools/broot-600-39409e646.png 600w, /blog/generated/assets/images/command-line-tools/broot-800-39409e646.png 800w, /blog/generated/assets/images/command-line-tools/broot-1000-39409e646.png 1000w&quot;&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;You can navigate around using the arrow keys in &lt;code&gt;broot&lt;/code&gt; and it is also helpful for tracking down disk space usage by passing in the &lt;code&gt;-w&lt;/code&gt; flag (&lt;code&gt;broot -w&lt;/code&gt;):&lt;/p&gt;
&lt;div class=&quot;wide-code&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/command-line-tools/broot2-800-84e520359.png&quot; srcset=&quot;/blog/generated/assets/images/command-line-tools/broot2-400-84e520359.png 400w, /blog/generated/assets/images/command-line-tools/broot2-600-84e520359.png 600w, /blog/generated/assets/images/command-line-tools/broot2-800-84e520359.png 800w, /blog/generated/assets/images/command-line-tools/broot2-1000-84e520359.png 1000w&quot;&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;It can do lots of other things, so take a look at the &lt;a href=&quot;https://github.com/Canop/broot&quot;&gt;GitHub guide&lt;/a&gt;, but for me, its just a better &lt;code&gt;tree&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;‚ÑπÔ∏è Install BRoot&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Install on MacOS using &lt;code&gt;brew&lt;/code&gt; or follow &lt;a href=&quot;https://dystroy.org/broot/install/&quot;&gt;installation instructions&lt;/a&gt; for other environments.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;brew&lt;/span&gt; install broot&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;funky&quot;&gt;Funky&lt;/h2&gt;
&lt;p&gt;If you live in the terminal, and you want to &lt;a href=&quot;https://blog.sanctum.geek.nz/unix-as-ide-files/&quot;&gt;use your terminal as an IDE&lt;/a&gt;, then it‚Äôs helpful to have your terminal change based on the current directory. There are many ways to do this. &lt;a href=&quot;https://direnv.net/&quot;&gt;&lt;code&gt;DirEnv&lt;/code&gt;&lt;/a&gt; loads and unloads &lt;code&gt;.env&lt;/code&gt; files as you enter directories. &lt;a href=&quot;https://github.com/cxreg/smartcd&quot;&gt;&lt;code&gt;smartcd&lt;/code&gt;&lt;/a&gt; is similar. It lets you run a shell script whenever you change to a particular path ‚Äì you can start and stop services, change the prompt, or anything else you want.&lt;/p&gt;
&lt;p&gt;However, my favorite of this genre is the strangely named &lt;a href=&quot;https://github.com/bbugyi200/funky&quot;&gt;&lt;code&gt;funky&lt;/code&gt;&lt;/a&gt;, which ‚Äútakes shell functions to the next level by making them easier to define, more flexible, and more interactive.‚Äù&lt;/p&gt;
&lt;p&gt;The way &lt;code&gt;funky&lt;/code&gt; works is simple: as you enter a directory, &lt;code&gt;funky&lt;/code&gt; looks for a &lt;code&gt;.funky&lt;/code&gt; file which contains a list of bash functions. It loads them, and when you leave, it unloads them.&lt;/p&gt;
&lt;p&gt;This means that when I‚Äôm in the directory for this Jekyll blog, I have aliases loaded for creating a new post, linting my markdown, pulling in images, and so on. I can list these by typing &lt;code&gt;funky&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; funky&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;lint()&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;markdownlint&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--fix&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;./_posts/*.md&amp;quot;&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;set-header()&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;cp&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;latest-image&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;image-folder&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;/header.jpg&amp;quot;&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-4&quot;&gt;&lt;a href=&quot;#cb4-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;set-image()&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;cp&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;latest-image&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;image-folder&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;date&lt;/span&gt; +%s&lt;span class=&quot;va&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;.png&amp;quot;&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;funky&lt;/code&gt; can do more than this, though. It has features for interactively adding and editing functions and for registering global functions and aliases. What I like, though, is just being able to quickly give a command, in a specific context, a short alias.&lt;/p&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;‚ÑπÔ∏è Install Funky&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Install Funky using pip&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;pip3&lt;/span&gt; install pyfunky&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then add hooks to your &lt;code&gt;.zshrc&lt;/code&gt;, &lt;code&gt;bashrc&lt;/code&gt; or equivalent:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;## find where funky.sh was installed by pip and source it&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-2&quot;&gt;&lt;a href=&quot;#cb6-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;source&lt;/span&gt; /usr/local/lib/python3.9/site-packages/scripts/shell/funky.sh&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;fuzzy-finder-fzf&quot;&gt;Fuzzy Finder (FZF)&lt;/h2&gt;
&lt;div class=&quot;wide-code&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/command-line-tools/1626788538-800-b7c54354e.png&quot; srcset=&quot;/blog/generated/assets/images/command-line-tools/1626788538-400-b7c54354e.png 400w, /blog/generated/assets/images/command-line-tools/1626788538-600-b7c54354e.png 600w, /blog/generated/assets/images/command-line-tools/1626788538-800-b7c54354e.png 800w, /blog/generated/assets/images/command-line-tools/1626788538-1000-b7c54354e.png 1000w&quot;&gt;&lt;/p&gt;
&lt;figcaption&gt;
Using &lt;code&gt;fzf&lt;/code&gt; to locate the generated images for this post.
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;If &lt;code&gt;funky&lt;/code&gt; and &lt;code&gt;broot&lt;/code&gt; improved my productivity, then more tools could only improve it more. So I headed over to &lt;a href=&quot;https://lobste.rs/s/yfgwjr/what_interesting_command_line_tools_do&quot;&gt;Lobste.rs&lt;/a&gt; and asked what other tools people were using. &lt;code&gt;FZF&lt;/code&gt; came up quite a bit, and I‚Äôve started using it myself now.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/junegunn/fzf&quot;&gt;FZF&lt;/a&gt; is a command-line fuzzy finder. It‚Äôs fast, and it interactively lets you filter options down based on a fuzzy keyword match in many places where you need to input a value at the command-line.&lt;/p&gt;
&lt;p&gt;If you install the included shortcuts (&lt;code&gt;/usr/local/opt/fzf/install&lt;/code&gt;), you can use &lt;code&gt;**&lt;/code&gt; anywhere and get an interactive fuzzy finder to narrow down to the desired path. &lt;code&gt;FZF&lt;/code&gt; also makes searching your &lt;code&gt;history&lt;/code&gt; much faster.&lt;/p&gt;
&lt;p&gt;It‚Äôs a UNIX filter that reads in input, shows you an interactive list that you filter down, and then sends the selected item out the other side but describing that way undersells its usefulness.&lt;/p&gt;
&lt;p&gt;I recommend watching this video where Alexey Samoshkin walks through many possible uses for &lt;code&gt;FZF&lt;/code&gt; with a soothing piano playing in the background:&lt;/p&gt;
&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/qgG5Jhi_Els&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;
&lt;/iframe&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;‚ÑπÔ∏è Install FZF&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Install FZF using your &lt;a href=&quot;https://github.com/junegunn/fzf#using-linux-package-managers&quot;&gt;package manager of choice&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb7&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb7-1&quot;&gt;&lt;a href=&quot;#cb7-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;brew&lt;/span&gt; install fzf&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then add hooks to your &lt;code&gt;.zshrc&lt;/code&gt;, &lt;code&gt;bashrc&lt;/code&gt; or equivalent:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb8&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb8-1&quot;&gt;&lt;a href=&quot;#cb8-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#ZSH&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-2&quot;&gt;&lt;a href=&quot;#cb8-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;source&lt;/span&gt; ~/.fzf.zsh &lt;/span&gt;
&lt;span id=&quot;cb8-3&quot;&gt;&lt;a href=&quot;#cb8-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#BASH&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-4&quot;&gt;&lt;a href=&quot;#cb8-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;source&lt;/span&gt; ~/.fzf.bash&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;mcfly&quot;&gt;McFly&lt;/h2&gt;
&lt;div class=&quot;wide-code&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/command-line-tools/1626788971-800-0b1e50ab8.png&quot; srcset=&quot;/blog/generated/assets/images/command-line-tools/1626788971-400-0b1e50ab8.png 400w, /blog/generated/assets/images/command-line-tools/1626788971-600-0b1e50ab8.png 600w, /blog/generated/assets/images/command-line-tools/1626788971-800-0b1e50ab8.png 800w, /blog/generated/assets/images/command-line-tools/1626788971-1000-0b1e50ab8.png 1000w&quot;&gt;&lt;/p&gt;
&lt;figcaption&gt;
Using McFly to suggest common earthly commands in this path.
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;&lt;code&gt;FZF&lt;/code&gt; is excellent for filtering file paths in a command line when you want to open a file (&lt;code&gt;vim **&lt;/code&gt;), but for command-line completion, there is more information available than the raw history file. &lt;a href=&quot;https://github.com/cantino/mcfly/&quot;&gt;&lt;code&gt;McFly&lt;/code&gt;&lt;/a&gt; attempts to use this extra information to provide more relevant results.&lt;/p&gt;
&lt;p&gt;What extra information? To start with, McFly considers these options in its ranking heuristics:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The commands you typed before the command.&lt;/li&gt;
&lt;li&gt;How often you run the command.&lt;/li&gt;
&lt;li&gt;How recently have you run the command.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It tracks all this in a SQLite database where it also tracks and weighs suggestions by:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The command‚Äôs exit status.&lt;/li&gt;
&lt;li&gt;The directory you ran the command in.&lt;/li&gt;
&lt;li&gt;If you have selected it in McFly before.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Being suggested failed commands is a pet peeve of mine, but I never considered narrowing the choice based on the current directory or down-ranking items that are never selected.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;McFly&lt;/code&gt; uses a neural net to do its ranking, and one possible downside is the lag in coming up with suggestions if your SQLite database gets too large. However, &lt;code&gt;MCFLY_HISTORY_LIMIT&lt;/code&gt; is available to limit this growth.&lt;/p&gt;
&lt;p&gt;I‚Äôve only been using it for a couple of days, so I can‚Äôt give a fair appraisal of it, but the concept makes me pretty hopeful: using extra information to customize tools towards real-world usage.&lt;/p&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;‚ÑπÔ∏è Install McFly&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;You can install McFly &lt;a href=&quot;https://github.com/cantino/mcfly/#installation&quot;&gt;several ways&lt;/a&gt;. Here is brew: :&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb9&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb9-1&quot;&gt;&lt;a href=&quot;#cb9-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;brew&lt;/span&gt; tap cantino/mcfly&lt;/span&gt;
&lt;span id=&quot;cb9-2&quot;&gt;&lt;a href=&quot;#cb9-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;brew&lt;/span&gt; install mcfly&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then add hooks to your &lt;code&gt;.zshrc&lt;/code&gt;, &lt;code&gt;bashrc&lt;/code&gt; or equivalent:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;mcfly&lt;/span&gt; init zsh&lt;span class=&quot;va&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The fact that the binary emits the init script rather than dumping an init script into my home directory is a nice touch. &lt;code&gt;zoxide&lt;/code&gt; - the following tool - does this as well.&lt;/p&gt;
&lt;p&gt;I found that &lt;code&gt;FZF&lt;/code&gt; was interfering with the &lt;code&gt;CTRL-R&lt;/code&gt; of McFly and had to comment out &lt;a href=&quot;https://github.com/junegunn/fzf/blob/764316a53d0eb60b315f0bbcd513de58ed57a876/shell/key-bindings.zsh#L109&quot;&gt;this line&lt;/a&gt; in the &lt;code&gt;FZF&lt;/code&gt; init script to get McFly working.&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;better-cd&quot;&gt;Better CD&lt;/h2&gt;
&lt;div class=&quot;wide-code&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/command-line-tools/1626789626-800-fe7102962.png&quot; srcset=&quot;/blog/generated/assets/images/command-line-tools/1626789626-400-fe7102962.png 400w, /blog/generated/assets/images/command-line-tools/1626789626-600-fe7102962.png 600w, /blog/generated/assets/images/command-line-tools/1626789626-800-fe7102962.png 800w, /blog/generated/assets/images/command-line-tools/1626789626-1000-fe7102962.png 1000w&quot;&gt;&lt;/p&gt;
&lt;figcaption&gt;
Using &lt;code&gt;zoxide&lt;/code&gt; as a &lt;code&gt;cd&lt;/code&gt; replacement.
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;&lt;code&gt;FZF&lt;/code&gt; works nicely for some path completions, but I didn‚Äôt find it helpful when changing directories with &lt;code&gt;cd&lt;/code&gt;: After typing &lt;code&gt;cd **TAB&lt;/code&gt; from my home directory, it takes a while for &lt;code&gt;FZF&lt;/code&gt; to build up the full list options. It was much faster to use my existing ZSH completions of &lt;code&gt;cd TAB &amp;lt;choose a dir&amp;gt; TAB &amp;lt;choose a dir&amp;gt;&lt;/code&gt; to navigate to a folder.&lt;/p&gt;
&lt;p&gt;However, many tools exist which attempt to improve upon &lt;code&gt;cd&lt;/code&gt;. &lt;a href=&quot;https://github.com/wting/autojump&quot;&gt;&lt;code&gt;autojump&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://github.com/rupa/z&quot;&gt;&lt;code&gt;z&lt;/code&gt;&lt;/a&gt;, and &lt;a href=&quot;https://github.com/clvv/fasd&quot;&gt;&lt;code&gt;Fasd&lt;/code&gt;&lt;/a&gt; all track directory usage and give you a single key shortcut for changing to commonly accessed directories. &lt;a href=&quot;https://www.reddit.com/r/commandline/comments/4v5nlt/what_cd_tool_do_you_use_if_any_autojump_j_z_etc/&quot;&gt;&lt;code&gt;r/commandline&lt;/code&gt;&lt;/a&gt; has an detailed discussion of these various &lt;code&gt;cd&lt;/code&gt; replacements, but the one that has the most momentum is &lt;code&gt;zoxide&lt;/code&gt;. &lt;a href=&quot;https://github.com/ajeetdsouza/zoxide&quot;&gt;zoxide&lt;/a&gt; is a rewrite of z in Rust and promises improved speed.&lt;/p&gt;
&lt;p&gt;After you install it, you can use it just like &lt;code&gt;cd&lt;/code&gt; (&lt;code&gt;z ~/path/foo/bar&lt;/code&gt;), but you can also change directories based on ranked text matches of the path (&lt;code&gt;z bar&lt;/code&gt; ~= &lt;code&gt;cd ~/path/foo/bar&lt;/code&gt; ). Instead of needing to supply the full path to change locations, you can instead provide a unique sub-string of the path, and &lt;code&gt;zoxide&lt;/code&gt; will use its usage history to get you where you want.&lt;/p&gt;
&lt;p&gt;For ease of adoption, I‚Äôve chosen to have &lt;code&gt;zoxide&lt;/code&gt; replace &lt;code&gt;cd&lt;/code&gt;, which is as simple as using the &lt;code&gt;--cmd&lt;/code&gt; flag when you add the initialization shell code (&lt;code&gt;eval &quot;$(zoxide init zsh --cmd cd)&quot;&lt;/code&gt;).&lt;/p&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;‚ÑπÔ∏è Install zoxide&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;zoxide&lt;/code&gt; can be installed &lt;a href=&quot;https://github.com/ajeetdsouza/zoxide#step-1-install-zoxide&quot;&gt;several ways&lt;/a&gt;. Here is brew: :&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;brew&lt;/span&gt; install zoxide&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then add hooks to your &lt;code&gt;.zshrc&lt;/code&gt;, &lt;code&gt;bashrc&lt;/code&gt; or equivalent:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb12&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb12-1&quot;&gt;&lt;a href=&quot;#cb12-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;zoxide&lt;/span&gt; init zsh &lt;span class=&quot;at&quot;&gt;--cmd&lt;/span&gt; cd&lt;span class=&quot;va&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;gitupdate&quot;&gt;GitUpdate&lt;/h2&gt;
&lt;p&gt;This tool is another find from the &lt;a href=&quot;https://lobste.rs/s/yfgwjr/what_interesting_command_line_tools_do&quot;&gt;Lobste.rs&lt;/a&gt; thread. When working on a git branch, I like to commit my work frequently. For example, before I try to delete some huge block of text in a blog post, or before I attempt to refactor some piece of code, I commit my work. Of course, I‚Äôll squash, or restructure, these commits later on, but for convenience, I have a git alias called &lt;code&gt;wip&lt;/code&gt; (‚Äôwork in progress`) which gives me a low effort way to commit.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git wip = !git add --all; git ci -m WIP&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/nikitavoloboev/gitupdate&quot;&gt;&lt;code&gt;gitupdate&lt;/code&gt;&lt;/a&gt; is a simple improvement on this idea. &lt;code&gt;gitupdate .&lt;/code&gt; commits your files but uses the file names (but not extensions) of the changed files to create a more meaningful commit message. It‚Äôs great for times when the commit message doesn‚Äôt matter.&lt;/p&gt;
&lt;div class=&quot;wide-code&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/command-line-tools/1626790555-800-65425229c.png&quot; srcset=&quot;/blog/generated/assets/images/command-line-tools/1626790555-400-65425229c.png 400w, /blog/generated/assets/images/command-line-tools/1626790555-600-65425229c.png 600w, /blog/generated/assets/images/command-line-tools/1626790555-800-65425229c.png 800w, /blog/generated/assets/images/command-line-tools/1626790555-1000-65425229c.png 1000w&quot;&gt;&lt;/p&gt;
&lt;figcaption&gt;
GitUpdate generates a commit message, commits, and pushes.
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;‚ÑπÔ∏è Install GitUpdate&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb14&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb14-1&quot;&gt;&lt;a href=&quot;#cb14-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;git&lt;/span&gt; clone https://github.com/nikitavoloboev/gitupdate&lt;/span&gt;
&lt;span id=&quot;cb14-2&quot;&gt;&lt;a href=&quot;#cb14-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;go&lt;/span&gt; build&lt;/span&gt;
&lt;span id=&quot;cb14-3&quot;&gt;&lt;a href=&quot;#cb14-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;sudo&lt;/span&gt; cp gitupdate /usr/local/bin&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;other-tools&quot;&gt;Other Tools&lt;/h2&gt;
&lt;p&gt;There are many other helpful command-line tools. More than can be covered well in a single article. JQ, &lt;a href=&quot;/blog/mitmproxy&quot;&gt;&lt;code&gt;mitmproxy&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://pandoc.org/&quot;&gt;Pandoc&lt;/a&gt;, and &lt;a href=&quot;https://man7.org/linux/man-pages/man1/pstree.1.html&quot;&gt;PSTree&lt;/a&gt; are some I use frequently. There is also a whole class of Rust rewrites of common POSIX tools that warrant an article of their own.&lt;/p&gt;
&lt;p&gt;Of course, &lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; itself is a command-line tool, and one I constantly use for gluing together various development steps together. It, and the tools I use for &lt;a href=&quot;/blog/markdown-lint&quot;&gt;linting prose&lt;/a&gt;, have become a standard part of how I work.&lt;/p&gt;
&lt;p&gt;What less common command-line tools do you use? If you have tool suggestions, I‚Äôd love to hear them. You can find my Twitter account and email below, and I‚Äôd love to hear what you are using.&lt;/p&gt;</content><author><name>Adam Gordon Bell</name></author><category term="Tutorials" /><summary type="html">Lately, I‚Äôve been doing a lot more things at the command line. I‚Äôm not a hard-core terminal guy ‚Äì I use VSCode more than Vim ‚Äì but I‚Äôm always surprised at the number of complex tasks that can be done using just the POSIX standard command-line tools like grep, cat and sort. Tools are powerful. A good tool makes work easier and faster, and a great tool unlocks new abilities: Previously impossible things become possible and sometimes easy. As I‚Äôve learned more, I‚Äôve been adding some new tools to my command-line toolbox, and in this article, I‚Äôd like to share some I‚Äôve found valuable. broot I‚Äôm not sure how I came across broot, but it‚Äôs pretty handy. If you are in a small directory and want to see the lay of the land, tree is excellent. ‚úó tree . ‚îú‚îÄ‚îÄ dartboard.png ‚îú‚îÄ‚îÄ header.jpg ‚îú‚îÄ‚îÄ opensign.png ‚îú‚îÄ‚îÄ quote1.png ‚îî‚îÄ‚îÄ trophy.png 0 directories, 5 files However, if the directory has many files or sub-directories, tree becomes much less helpful: you only see the last screen full of information as files scroll past you. $ tree &amp;lt; scrolling text for a long time &amp;gt; ‚îú‚îÄ‚îÄ banner.js ‚îî‚îÄ‚îÄ index.html 328 directories, 2028 files broot solves this problem by being aware of the size of your terminal window and adapting its output to fit it. You can navigate around using the arrow keys in broot and it is also helpful for tracking down disk space usage by passing in the -w flag (broot -w): It can do lots of other things, so take a look at the GitHub guide, but for me, its just a better tree. ‚ÑπÔ∏è Install BRoot Install on MacOS using brew or follow installation instructions for other environments. brew install broot Funky If you live in the terminal, and you want to use your terminal as an IDE, then it‚Äôs helpful to have your terminal change based on the current directory. There are many ways to do this. DirEnv loads and unloads .env files as you enter directories. smartcd is similar. It lets you run a shell script whenever you change to a particular path ‚Äì you can start and stop services, change the prompt, or anything else you want. However, my favorite of this genre is the strangely named funky, which ‚Äútakes shell functions to the next level by making them easier to define, more flexible, and more interactive.‚Äù The way funky works is simple: as you enter a directory, funky looks for a .funky file which contains a list of bash functions. It loads them, and when you leave, it unloads them. This means that when I‚Äôm in the directory for this Jekyll blog, I have aliases loaded for creating a new post, linting my markdown, pulling in images, and so on. I can list these by typing funky $ funky lint() { markdownlint --fix &amp;quot;./_posts/*.md&amp;quot;; } set-header() { cp &amp;quot;$(latest-image)&amp;quot; &amp;quot;$(image-folder)/header.jpg&amp;quot;; } set-image() { cp &amp;quot;$(latest-image)&amp;quot; &amp;quot;$(image-folder)/$(date +%s).png&amp;quot;; } funky can do more than this, though. It has features for interactively adding and editing functions and for registering global functions and aliases. What I like, though, is just being able to quickly give a command, in a specific context, a short alias. ‚ÑπÔ∏è Install Funky Install Funky using pip pip3 install pyfunky Then add hooks to your .zshrc, bashrc or equivalent: ## find where funky.sh was installed by pip and source it source /usr/local/lib/python3.9/site-packages/scripts/shell/funky.sh Fuzzy Finder (FZF) Using fzf to locate the generated images for this post. If funky and broot improved my productivity, then more tools could only improve it more. So I headed over to Lobste.rs and asked what other tools people were using. FZF came up quite a bit, and I‚Äôve started using it myself now. FZF is a command-line fuzzy finder. It‚Äôs fast, and it interactively lets you filter options down based on a fuzzy keyword match in many places where you need to input a value at the command-line. If you install the included shortcuts (/usr/local/opt/fzf/install), you can use ** anywhere and get an interactive fuzzy finder to narrow down to the desired path. FZF also makes searching your history much faster. It‚Äôs a UNIX filter that reads in input, shows you an interactive list that you filter down, and then sends the selected item out the other side but describing that way undersells its usefulness. I recommend watching this video where Alexey Samoshkin walks through many possible uses for FZF with a soothing piano playing in the background: ‚ÑπÔ∏è Install FZF Install FZF using your package manager of choice: brew install fzf Then add hooks to your .zshrc, bashrc or equivalent: #ZSH source ~/.fzf.zsh #BASH source ~/.fzf.bash McFly Using McFly to suggest common earthly commands in this path. FZF is excellent for filtering file paths in a command line when you want to open a file (vim **), but for command-line completion, there is more information available than the raw history file. McFly attempts to use this extra information to provide more relevant results. What extra information? To start with, McFly considers these options in its ranking heuristics: The commands you typed before the command. How often you run the command. How recently have you run the command. It tracks all this in a SQLite database where it also tracks and weighs suggestions by: The command‚Äôs exit status. The directory you ran the command in. If you have selected it in McFly before. Being suggested failed commands is a pet peeve of mine, but I never considered narrowing the choice based on the current directory or down-ranking items that are never selected. McFly uses a neural net to do its ranking, and one possible downside is the lag in coming up with suggestions if your SQLite database gets too large. However, MCFLY_HISTORY_LIMIT is available to limit this growth. I‚Äôve only been using it for a couple of days, so I can‚Äôt give a fair appraisal of it, but the concept makes me pretty hopeful: using extra information to customize tools towards real-world usage. ‚ÑπÔ∏è Install McFly You can install McFly several ways. Here is brew: : brew tap cantino/mcfly brew install mcfly Then add hooks to your .zshrc, bashrc or equivalent: eval &amp;quot;$(mcfly init zsh)&amp;quot; The fact that the binary emits the init script rather than dumping an init script into my home directory is a nice touch. zoxide - the following tool - does this as well. I found that FZF was interfering with the CTRL-R of McFly and had to comment out this line in the FZF init script to get McFly working. Better CD Using zoxide as a cd replacement. FZF works nicely for some path completions, but I didn‚Äôt find it helpful when changing directories with cd: After typing cd **TAB from my home directory, it takes a while for FZF to build up the full list options. It was much faster to use my existing ZSH completions of cd TAB &amp;lt;choose a dir&amp;gt; TAB &amp;lt;choose a dir&amp;gt; to navigate to a folder. However, many tools exist which attempt to improve upon cd. autojump, z, and Fasd all track directory usage and give you a single key shortcut for changing to commonly accessed directories. r/commandline has an detailed discussion of these various cd replacements, but the one that has the most momentum is zoxide. zoxide is a rewrite of z in Rust and promises improved speed. After you install it, you can use it just like cd (z ~/path/foo/bar), but you can also change directories based on ranked text matches of the path (z bar ~= cd ~/path/foo/bar ). Instead of needing to supply the full path to change locations, you can instead provide a unique sub-string of the path, and zoxide will use its usage history to get you where you want. For ease of adoption, I‚Äôve chosen to have zoxide replace cd, which is as simple as using the --cmd flag when you add the initialization shell code (eval &quot;$(zoxide init zsh --cmd cd)&quot;). ‚ÑπÔ∏è Install zoxide zoxide can be installed several ways. Here is brew: : brew install zoxide Then add hooks to your .zshrc, bashrc or equivalent: eval &amp;quot;$(zoxide init zsh --cmd cd)&amp;quot; GitUpdate This tool is another find from the Lobste.rs thread. When working on a git branch, I like to commit my work frequently. For example, before I try to delete some huge block of text in a blog post, or before I attempt to refactor some piece of code, I commit my work. Of course, I‚Äôll squash, or restructure, these commits later on, but for convenience, I have a git alias called wip (‚Äôwork in progress`) which gives me a low effort way to commit. git wip = !git add --all; git ci -m WIP gitupdate is a simple improvement on this idea. gitupdate . commits your files but uses the file names (but not extensions) of the changed files to create a more meaningful commit message. It‚Äôs great for times when the commit message doesn‚Äôt matter. GitUpdate generates a commit message, commits, and pushes. ‚ÑπÔ∏è Install GitUpdate git clone https://github.com/nikitavoloboev/gitupdate go build sudo cp gitupdate /usr/local/bin Other Tools There are many other helpful command-line tools. More than can be covered well in a single article. JQ, mitmproxy, Pandoc, and PSTree are some I use frequently. There is also a whole class of Rust rewrites of common POSIX tools that warrant an article of their own. Of course, Earthly itself is a command-line tool, and one I constantly use for gluing together various development steps together. It, and the tools I use for linting prose, have become a standard part of how I work. What less common command-line tools do you use? If you have tool suggestions, I‚Äôd love to hear them. You can find my Twitter account and email below, and I‚Äôd love to hear what you are using.</summary></entry><entry><title type="html">Install `matplotlib` In A Docker Container</title><link href="https://earthly.dev/blog/python-matplotlib-docker/" rel="alternate" type="text/html" title="Install `matplotlib` In A Docker Container" /><published>2021-07-16T00:00:00-04:00</published><updated>2021-07-16T00:00:00-04:00</updated><id>https://earthly.dev/blog/python-matplotlib-docker</id><content type="html" xml:base="https://earthly.dev/blog/python-matplotlib-docker/">&lt;p&gt;&lt;code&gt;matplotlib&lt;/code&gt; is an excellent library for creating graphs and visualizations in Python. For example, I used it to generate the performance graphs in &lt;a href=&quot;/blog/python-timsort-merge&quot;&gt;my merging article&lt;/a&gt;, and internally, we use it now and again for visualizing any metrics we produce. It is a bit hard to install inside a docker container, though.&lt;/p&gt;
&lt;h2 id=&quot;installing-matplotlib-in-alpine-linux&quot;&gt;Installing Matplotlib in Alpine Linux&lt;/h2&gt;
&lt;p&gt;On Alpine, or an Alpine-based docker image, it‚Äôs &lt;em&gt;possible&lt;/em&gt; to install &lt;code&gt;matplotlib&lt;/code&gt;; however it will involve compiling it from source as pip does not provide any pre-compiled binaries ‚Äì this will take quite a bit of time. If you don‚Äôt mind compiling from source, you will need to have its dependencies in place to make this work:&lt;/p&gt;
&lt;pre class=&quot;docker&quot;&gt;&lt;code&gt; FROM python:3.6-alpine
 RUN apk add g++ jpeg-dev zlib-dev libjpeg make
 RUN pip3 install matplotlib&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;installing-matplotlib-in-ubuntu&quot;&gt;Installing Matplotlib in Ubuntu&lt;/h2&gt;
&lt;p&gt;On Ubuntu, or a Ubuntu-based docker image, the process is much simpler:&lt;/p&gt;
&lt;pre class=&quot;docker&quot;&gt;&lt;code&gt; FROM ubuntu:20.10
 RUN apt-get update &amp;amp;&amp;amp; apt-get install -y python3 python3-pip
 RUN pip3 install matplotlib&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In either case, after you‚Äôve installed it, you can quickly generate great graphs and visualizations:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; numpy &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; np&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;from&lt;/span&gt; scipy.interpolate &lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; splprep, splev&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-4&quot;&gt;&lt;a href=&quot;#cb3-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb3-5&quot;&gt;&lt;a href=&quot;#cb3-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;from&lt;/span&gt; matplotlib.path &lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; Path&lt;/span&gt;
&lt;span id=&quot;cb3-6&quot;&gt;&lt;a href=&quot;#cb3-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;from&lt;/span&gt; matplotlib.patches &lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; PathPatch&lt;/span&gt;
&lt;span id=&quot;cb3-7&quot;&gt;&lt;a href=&quot;#cb3-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-8&quot;&gt;&lt;a href=&quot;#cb3-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;N &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;400&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-9&quot;&gt;&lt;a href=&quot;#cb3-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;t &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; np.linspace(&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; np.pi, N)&lt;/span&gt;
&lt;span id=&quot;cb3-10&quot;&gt;&lt;a href=&quot;#cb3-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;r &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;fl&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; np.cos(t)&lt;/span&gt;
&lt;span id=&quot;cb3-11&quot;&gt;&lt;a href=&quot;#cb3-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;x, y &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; r &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; np.cos(t), r &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; np.sin(t)&lt;/span&gt;
&lt;span id=&quot;cb3-12&quot;&gt;&lt;a href=&quot;#cb3-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig, ax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; plt.subplots()&lt;/span&gt;
&lt;span id=&quot;cb3-13&quot;&gt;&lt;a href=&quot;#cb3-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.plot(x, y)&lt;/span&gt;
&lt;span id=&quot;cb3-14&quot;&gt;&lt;a href=&quot;#cb3-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;plt.xlabel(&lt;span class=&quot;st&quot;&gt;&amp;quot;X value&amp;quot;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb3-15&quot;&gt;&lt;a href=&quot;#cb3-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;plt.ylabel(&lt;span class=&quot;st&quot;&gt;&amp;quot;Y value&amp;quot;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb3-16&quot;&gt;&lt;a href=&quot;#cb3-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;plt.savefig(&lt;span class=&quot;st&quot;&gt;&amp;#39;1.png&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/blog/assets/images/python-matplotlib-docker/1.png&quot; alt=&quot;Simple Graph&quot; /&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;h2 id=&quot;appendix-alpine-vs-ubuntu-pip-install&quot;&gt;Appendix: Alpine vs Ubuntu Pip Install&lt;/h2&gt;
&lt;p&gt;Why is the Ubuntu process fast and simple and the Alpine process slow? The reason is &lt;code&gt;glibc&lt;/code&gt;. The pip wheels for &lt;code&gt;matplotlib&lt;/code&gt; are compiled c/c++ programs that dynamically link to &lt;code&gt;glibc&lt;/code&gt; and Alpine does not have &lt;code&gt;glibc&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Alpine tries to stay small and so uses &lt;code&gt;musl-libc&lt;/code&gt; instead. Unfortunately, this means compiling from source on Alpine, which can be a lengthy process.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/49037742/why-does-it-take-ages-to-install-pandas-on-alpine-linux/58210701#58210701&quot;&gt;ThisGuyCantEven&lt;/a&gt; on Stack Overflow has more details:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Pip looks first for a wheel with the correct binaries, if it can‚Äôt find one, it tries to compile the binaries from the c/c++ source and links them against &lt;code&gt;musl&lt;/code&gt;. In many cases, this won‚Äôt even work unless you have the python headers from python3-dev or build tools like make.&lt;/p&gt;
&lt;p&gt;Now the silver lining, as others have mentioned, there are &lt;code&gt;apk&lt;/code&gt; packages with the proper binaries provided by the community, using these will save you the (sometimes lengthy) process of building the binaries.&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>Adam Gordon Bell</name></author><category term="Tutorials" /><summary type="html">matplotlib is an excellent library for creating graphs and visualizations in Python. For example, I used it to generate the performance graphs in my merging article, and internally, we use it now and again for visualizing any metrics we produce. It is a bit hard to install inside a docker container, though. Installing Matplotlib in Alpine Linux On Alpine, or an Alpine-based docker image, it‚Äôs possible to install matplotlib; however it will involve compiling it from source as pip does not provide any pre-compiled binaries ‚Äì this will take quite a bit of time. If you don‚Äôt mind compiling from source, you will need to have its dependencies in place to make this work: FROM python:3.6-alpine RUN apk add g++ jpeg-dev zlib-dev libjpeg make RUN pip3 install matplotlib Installing Matplotlib in Ubuntu On Ubuntu, or a Ubuntu-based docker image, the process is much simpler: FROM ubuntu:20.10 RUN apt-get update &amp;amp;&amp;amp; apt-get install -y python3 python3-pip RUN pip3 install matplotlib In either case, after you‚Äôve installed it, you can quickly generate great graphs and visualizations: import numpy as np from scipy.interpolate import splprep, splev import matplotlib.pyplot as plt from matplotlib.path import Path from matplotlib.patches import PathPatch N = 400 t = np.linspace(0, 3 * np.pi, N) r = 0.5 + np.cos(t) x, y = r * np.cos(t), r * np.sin(t) fig, ax = plt.subplots() ax.plot(x, y) plt.xlabel(&amp;quot;X value&amp;quot;) plt.ylabel(&amp;quot;Y value&amp;quot;) plt.savefig(&amp;#39;1.png&amp;#39;) Appendix: Alpine vs Ubuntu Pip Install Why is the Ubuntu process fast and simple and the Alpine process slow? The reason is glibc. The pip wheels for matplotlib are compiled c/c++ programs that dynamically link to glibc and Alpine does not have glibc. Alpine tries to stay small and so uses musl-libc instead. Unfortunately, this means compiling from source on Alpine, which can be a lengthy process. ThisGuyCantEven on Stack Overflow has more details: Pip looks first for a wheel with the correct binaries, if it can‚Äôt find one, it tries to compile the binaries from the c/c++ source and links them against musl. In many cases, this won‚Äôt even work unless you have the python headers from python3-dev or build tools like make. Now the silver lining, as others have mentioned, there are apk packages with the proper binaries provided by the community, using these will save you the (sometimes lengthy) process of building the binaries.</summary></entry><entry><title type="html">Creating a Golang Makefile</title><link href="https://earthly.dev/blog/golang-makefile/" rel="alternate" type="text/html" title="Creating a Golang Makefile" /><published>2021-07-15T00:00:00-04:00</published><updated>2021-07-15T00:00:00-04:00</updated><id>https://earthly.dev/blog/golang-makefile</id><content type="html" xml:base="https://earthly.dev/blog/golang-makefile/">&lt;div class=&quot;narrow-code&quot;&gt;
&lt;p&gt;Building and testing any large codebase is time-consuming, error-prone, and repetitive. Golang supports multi-platform builds, which is excellent, but it needs multiple commands to build the binaries for different platforms, which means more time-consuming and repetitive steps when building binaries. If that‚Äôs not enough, most projects have some dependencies that need to be installed before building the binary, and you probably want to run tests and ensure the code quality with linters and code coverage tools.&lt;/p&gt;
&lt;p&gt;If this is starting to sound like a nightmare, rest assured: there is an easier way. The utility tool &lt;a href=&quot;https://en.wikipedia.org/wiki/Make_(software)&quot;&gt;Make&lt;/a&gt; is used to automate tasks. It streamlines development and automates repetitive tasks with a single command. Make helps with testing, building, cleaning, and installing Go projects. In this tutorial, you will learn how you can leverage make and makefiles to automate all those frustrating and repetitive Golang tasks. You will learn how to build, clean, and test a Go sample project using make and a &lt;code&gt;Makefile&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&quot;adding-a-makefile-to-your-project&quot;&gt;Adding a Makefile To Your Project&lt;/h2&gt;
&lt;p&gt;To start using make commands, you first need to create a &lt;code&gt;Makefile&lt;/code&gt; in the root directory of your project. Let‚Äôs create a simple &lt;code&gt;hello world&lt;/code&gt; project with a &lt;code&gt;Makefile&lt;/code&gt; in it.&lt;/p&gt;
&lt;h3 id=&quot;main.go&quot;&gt;&lt;code&gt;main.go&lt;/code&gt;&lt;/h3&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode go&quot;&gt;&lt;code class=&quot;sourceCode go&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;package&lt;/span&gt; main&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;fmt&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;func&lt;/span&gt; main&lt;span class=&quot;op&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-6&quot;&gt;&lt;a href=&quot;#cb1-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; fmt&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;Println&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;hello world&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-7&quot;&gt;&lt;a href=&quot;#cb1-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To run this project, you would normally need to build the project and run the binary:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;go&lt;/span&gt; build main.go&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you want a different binary name and also want to create a build for a specific OS, you can specify this during the build:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;va&quot;&gt;GOARCH&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;amd64 &lt;span class=&quot;va&quot;&gt;GOOS&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;darwin &lt;span class=&quot;ex&quot;&gt;go&lt;/span&gt; build &lt;span class=&quot;at&quot;&gt;-o&lt;/span&gt; hello-world main.go&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You may want the build to create binary for multiple OS. For that, you will need to run multiple commands:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GOARCH=amd64 GOOS=darwin go build -o hello-world-darwin main.go
GOARCH=amd64 GOOS=linux go build -o hello-world-linux main.go
GOARCH=amd64 GOOS=window go build -o hello-world-windows main.go&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;go run hello-world&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The above commands can be simplified using Makefile. You can specify rules to a specific command and run a simple make command. You would not need to remember the commands and the flags or environment variables needed for executing it.&lt;/p&gt;
&lt;h3 id=&quot;makefile&quot;&gt;Makefile&lt;/h3&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;hello-world&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-2&quot;&gt;&lt;a href=&quot;#cb6-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-3&quot;&gt;&lt;a href=&quot;#cb6-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;build:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-4&quot;&gt;&lt;a href=&quot;#cb6-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; GOARCH=amd64 GOOS=darwin go build -o &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-darwin main.go&lt;/span&gt;
&lt;span id=&quot;cb6-5&quot;&gt;&lt;a href=&quot;#cb6-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; GOARCH=amd64 GOOS=linux go build -o &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-linux main.go&lt;/span&gt;
&lt;span id=&quot;cb6-6&quot;&gt;&lt;a href=&quot;#cb6-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; GOARCH=amd64 GOOS=window go build -o &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-windows main.go&lt;/span&gt;
&lt;span id=&quot;cb6-7&quot;&gt;&lt;a href=&quot;#cb6-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-8&quot;&gt;&lt;a href=&quot;#cb6-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;run:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-9&quot;&gt;&lt;a href=&quot;#cb6-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; ./&lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-10&quot;&gt;&lt;a href=&quot;#cb6-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-11&quot;&gt;&lt;a href=&quot;#cb6-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;build_and_run:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; build run&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-12&quot;&gt;&lt;a href=&quot;#cb6-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-13&quot;&gt;&lt;a href=&quot;#cb6-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;clean:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-14&quot;&gt;&lt;a href=&quot;#cb6-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; go clean&lt;/span&gt;
&lt;span id=&quot;cb6-15&quot;&gt;&lt;a href=&quot;#cb6-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-darwin&lt;/span&gt;
&lt;span id=&quot;cb6-16&quot;&gt;&lt;a href=&quot;#cb6-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-linux&lt;/span&gt;
&lt;span id=&quot;cb6-17&quot;&gt;&lt;a href=&quot;#cb6-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-windows&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now with these simple commands, you can build and run the Go project:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make run
make build&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Or you can use a single command for both build and run:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make build_and_run&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Finally, you can run the clean command for the cleanup of binaries:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make clean&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;These commands are very handy and help to streamline the development process. Now all of your team members can use the same command. This reduces inconsistency and helps to eliminate project build-related errors that can arise with inconsistent manual commands.&lt;/p&gt;
&lt;h2 id=&quot;improving-the-development-experience-with-makefiles&quot;&gt;Improving the Development Experience with Makefiles&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;make&lt;/code&gt; uses the Makefile as its source of commands to execute and these commands are defined as a &lt;em&gt;rules&lt;/em&gt; in the Makefile. A single rule defines target, dependencies, and the recipe of the Makefile.&lt;/p&gt;
&lt;h3 id=&quot;terminology&quot;&gt;Terminology&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Target:&lt;/strong&gt; Targets are the main component of a Makefile. The make command executes the recipe by its target name. As you saw in the last section, I used commands like &lt;code&gt;build&lt;/code&gt;, &lt;code&gt;run&lt;/code&gt;, and &lt;code&gt;build_and_clean&lt;/code&gt;. These are called &lt;em&gt;targets&lt;/em&gt;. Targets are the interface to the commands I want to execute.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Dependencies:&lt;/strong&gt; A target can have dependencies that need to be executed before running the target. For example, the &lt;code&gt;build_and_clean&lt;/code&gt; command has two dependencies: &lt;code&gt;build&lt;/code&gt; and &lt;code&gt;run&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Recipe:&lt;/strong&gt; Recipes are the actual commands that will be executed when the target is run. A recipe can be a single command or a collection of commands. You can specify multiple commands in a target using a line break. In the example above, the recipe for the run target is &lt;code&gt;./${BINARY_NAME}&lt;/code&gt;. A recipe should always contain a tab at the start.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;variables&quot;&gt;Variables&lt;/h3&gt;
&lt;p&gt;Variables are essential to any kind of script you write. So Makefiles also have a mechanism to use variables. These are useful when you want the same configs or outputs to be used for different targets. In the example above, I have added the &lt;code&gt;BINARY_NAME&lt;/code&gt; variable, which is reused across different targets.&lt;/p&gt;
&lt;p&gt;The variable can be substituted by enclosing it &lt;code&gt;${&amp;lt;variable_name&amp;gt;}&lt;/code&gt;. I have used the variable in the run command to execute the binary that was created from the build command:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;hello-world&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-2&quot;&gt;&lt;a href=&quot;#cb10-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-3&quot;&gt;&lt;a href=&quot;#cb10-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;run:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-4&quot;&gt;&lt;a href=&quot;#cb10-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; ./&lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Variables can be defined either by using &lt;code&gt;=&lt;/code&gt; or &lt;code&gt;:=&lt;/code&gt;. &lt;code&gt;=&lt;/code&gt; will recursively expand the variable. This will replace the value at the point when it is substituted. For example:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;x &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; foo&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-2&quot;&gt;&lt;a href=&quot;#cb11-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;y &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; bar&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-3&quot;&gt;&lt;a href=&quot;#cb11-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;x &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; later&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-4&quot;&gt;&lt;a href=&quot;#cb11-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-5&quot;&gt;&lt;a href=&quot;#cb11-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;all:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-6&quot;&gt;&lt;a href=&quot;#cb11-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; echo &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;When you run the &lt;code&gt;all&lt;/code&gt; command, it will replace the value of &lt;code&gt;x&lt;/code&gt; with the last updated value. The value has been changed to &lt;code&gt;later&lt;/code&gt;, so it will print:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt; later bar&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The other kind of variable assignment is &lt;code&gt;:=&lt;/code&gt;. These are &lt;em&gt;simple expanded&lt;/em&gt; variables. The variable is expanded at the first scan. So if you assign the variable using this operator, it will print the first value:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb13&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb13-1&quot;&gt;&lt;a href=&quot;#cb13-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;x &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;:=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; foo&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-2&quot;&gt;&lt;a href=&quot;#cb13-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;y &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;:=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; bar&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-3&quot;&gt;&lt;a href=&quot;#cb13-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;x &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;:=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; later&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-4&quot;&gt;&lt;a href=&quot;#cb13-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-5&quot;&gt;&lt;a href=&quot;#cb13-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;all:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-6&quot;&gt;&lt;a href=&quot;#cb13-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; echo &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt; foo bar&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;some-useful-tips&quot;&gt;Some Useful Tips&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;To make comments in a Makefile, you can simply add a &lt;code&gt;#&lt;/code&gt; before any line.&lt;/li&gt;
&lt;li&gt;To disable printing the recipe while running the target command, use &lt;code&gt;@&lt;/code&gt; before the recipe.&lt;/li&gt;
&lt;li&gt;Use the &lt;code&gt;SHELL&lt;/code&gt; variable to define the shell to execute the recipe.&lt;/li&gt;
&lt;li&gt;Define the &lt;code&gt;.DEFAULT_GOAL&lt;/code&gt; with the name of the target.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You can also define functions or loops in the Makefile. You can find more details on it &lt;a href=&quot;https://makefiletutorial.com&quot;&gt;in this make file tutorial&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;automating-tasks-using-makefile&quot;&gt;Automating Tasks Using Makefile&lt;/h2&gt;
&lt;p&gt;While developing a project, you will have a lot of repetitive tasks that you might like to automate. In Golang, some of those tasks are testing, running test coverage, linting, and managing dependencies. I will be creating a Makefile that contains all the rules to automate these tasks:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb15&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb15-1&quot;&gt;&lt;a href=&quot;#cb15-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;hello-world&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-2&quot;&gt;&lt;a href=&quot;#cb15-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-3&quot;&gt;&lt;a href=&quot;#cb15-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;build:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-4&quot;&gt;&lt;a href=&quot;#cb15-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; GOARCH=amd64 GOOS=darwin go build -o &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-darwin main.go&lt;/span&gt;
&lt;span id=&quot;cb15-5&quot;&gt;&lt;a href=&quot;#cb15-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; GOARCH=amd64 GOOS=linux go build -o &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-linux main.go&lt;/span&gt;
&lt;span id=&quot;cb15-6&quot;&gt;&lt;a href=&quot;#cb15-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; GOARCH=amd64 GOOS=window go build -o &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-windows main.go&lt;/span&gt;
&lt;span id=&quot;cb15-7&quot;&gt;&lt;a href=&quot;#cb15-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-8&quot;&gt;&lt;a href=&quot;#cb15-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;run:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-9&quot;&gt;&lt;a href=&quot;#cb15-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; ./&lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-10&quot;&gt;&lt;a href=&quot;#cb15-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-11&quot;&gt;&lt;a href=&quot;#cb15-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;build_and_run:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; build run&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-12&quot;&gt;&lt;a href=&quot;#cb15-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-13&quot;&gt;&lt;a href=&quot;#cb15-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;clean:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-14&quot;&gt;&lt;a href=&quot;#cb15-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; go clean&lt;/span&gt;
&lt;span id=&quot;cb15-15&quot;&gt;&lt;a href=&quot;#cb15-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-darwin&lt;/span&gt;
&lt;span id=&quot;cb15-16&quot;&gt;&lt;a href=&quot;#cb15-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-linux&lt;/span&gt;
&lt;span id=&quot;cb15-17&quot;&gt;&lt;a href=&quot;#cb15-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-windows&lt;/span&gt;
&lt;span id=&quot;cb15-18&quot;&gt;&lt;a href=&quot;#cb15-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-19&quot;&gt;&lt;a href=&quot;#cb15-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;test:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-20&quot;&gt;&lt;a href=&quot;#cb15-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; go test ./...&lt;/span&gt;
&lt;span id=&quot;cb15-21&quot;&gt;&lt;a href=&quot;#cb15-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-22&quot;&gt;&lt;a href=&quot;#cb15-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;test_coverage:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-23&quot;&gt;&lt;a href=&quot;#cb15-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; go test ./... -coverprofile=coverage.out&lt;/span&gt;
&lt;span id=&quot;cb15-24&quot;&gt;&lt;a href=&quot;#cb15-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-25&quot;&gt;&lt;a href=&quot;#cb15-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;dep:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-26&quot;&gt;&lt;a href=&quot;#cb15-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; go mod download&lt;/span&gt;
&lt;span id=&quot;cb15-27&quot;&gt;&lt;a href=&quot;#cb15-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-28&quot;&gt;&lt;a href=&quot;#cb15-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;vet:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-29&quot;&gt;&lt;a href=&quot;#cb15-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; go vet&lt;/span&gt;
&lt;span id=&quot;cb15-30&quot;&gt;&lt;a href=&quot;#cb15-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-31&quot;&gt;&lt;a href=&quot;#cb15-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;lint:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-32&quot;&gt;&lt;a href=&quot;#cb15-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; golangci-lint run --enable-all&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;With this simple Makefile, you can now easily execute commands to run tasks:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make test
make test_coverage
make dep
make vet
make lint&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; I am using an external package, &lt;a href=&quot;https://github.com/golangci/golangci-lint&quot;&gt;&lt;code&gt;golangci-lint&lt;/code&gt;&lt;/a&gt;, for linting. If you are using &lt;code&gt;go mod&lt;/code&gt;, make sure to add it to your &lt;code&gt;go.mod&lt;/code&gt; file.&lt;/p&gt;
&lt;p&gt;Any CI/CD tool that you are using can now simply use these targets.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Golang is a popular language for developing large-scale projects. Larger projects have multiple developers and require continuous automation to scale. Streamlining the development process by automating the tasks that are required during development, testing, and release will pay off with a faster and more reliable development process and a easier release process.&lt;/p&gt;
&lt;p&gt;For next-level automation and to further improve the automation, tools like &lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly.dev&lt;/a&gt; can be helpful. If you are also using Docker along with Makefile, Earthly can help make your development process smoother, taking some of the best ideas from Makefiles and Dockerfiles and combining them into one specification.&lt;/p&gt;
&lt;/div&gt;</content><author><name>Milap Neupane</name></author><category term="Tutorials" /><summary type="html">Building and testing any large codebase is time-consuming, error-prone, and repetitive. Golang supports multi-platform builds, which is excellent, but it needs multiple commands to build the binaries for different platforms, which means more time-consuming and repetitive steps when building binaries. If that‚Äôs not enough, most projects have some dependencies that need to be installed before building the binary, and you probably want to run tests and ensure the code quality with linters and code coverage tools. If this is starting to sound like a nightmare, rest assured: there is an easier way. The utility tool Make is used to automate tasks. It streamlines development and automates repetitive tasks with a single command. Make helps with testing, building, cleaning, and installing Go projects. In this tutorial, you will learn how you can leverage make and makefiles to automate all those frustrating and repetitive Golang tasks. You will learn how to build, clean, and test a Go sample project using make and a Makefile. Adding a Makefile To Your Project To start using make commands, you first need to create a Makefile in the root directory of your project. Let‚Äôs create a simple hello world project with a Makefile in it. main.go package main import &amp;quot;fmt&amp;quot; func main() { fmt.Println(&amp;quot;hello world&amp;quot;) } To run this project, you would normally need to build the project and run the binary: go build main.go If you want a different binary name and also want to create a build for a specific OS, you can specify this during the build: GOARCH=amd64 GOOS=darwin go build -o hello-world main.go You may want the build to create binary for multiple OS. For that, you will need to run multiple commands: GOARCH=amd64 GOOS=darwin go build -o hello-world-darwin main.go GOARCH=amd64 GOOS=linux go build -o hello-world-linux main.go GOARCH=amd64 GOOS=window go build -o hello-world-windows main.go go run hello-world The above commands can be simplified using Makefile. You can specify rules to a specific command and run a simple make command. You would not need to remember the commands and the flags or environment variables needed for executing it. Makefile BINARY_NAME=hello-world build: GOARCH=amd64 GOOS=darwin go build -o ${BINARY_NAME}-darwin main.go GOARCH=amd64 GOOS=linux go build -o ${BINARY_NAME}-linux main.go GOARCH=amd64 GOOS=window go build -o ${BINARY_NAME}-windows main.go run: ./${BINARY_NAME} build_and_run: build run clean: go clean rm ${BINARY_NAME}-darwin rm ${BINARY_NAME}-linux rm ${BINARY_NAME}-windows Now with these simple commands, you can build and run the Go project: make run make build Or you can use a single command for both build and run: make build_and_run Finally, you can run the clean command for the cleanup of binaries: make clean These commands are very handy and help to streamline the development process. Now all of your team members can use the same command. This reduces inconsistency and helps to eliminate project build-related errors that can arise with inconsistent manual commands. Improving the Development Experience with Makefiles make uses the Makefile as its source of commands to execute and these commands are defined as a rules in the Makefile. A single rule defines target, dependencies, and the recipe of the Makefile. Terminology Target: Targets are the main component of a Makefile. The make command executes the recipe by its target name. As you saw in the last section, I used commands like build, run, and build_and_clean. These are called targets. Targets are the interface to the commands I want to execute. Dependencies: A target can have dependencies that need to be executed before running the target. For example, the build_and_clean command has two dependencies: build and run. Recipe: Recipes are the actual commands that will be executed when the target is run. A recipe can be a single command or a collection of commands. You can specify multiple commands in a target using a line break. In the example above, the recipe for the run target is ./${BINARY_NAME}. A recipe should always contain a tab at the start. Variables Variables are essential to any kind of script you write. So Makefiles also have a mechanism to use variables. These are useful when you want the same configs or outputs to be used for different targets. In the example above, I have added the BINARY_NAME variable, which is reused across different targets. The variable can be substituted by enclosing it ${&amp;lt;variable_name&amp;gt;}. I have used the variable in the run command to execute the binary that was created from the build command: BINARY_NAME=hello-world run: ./${BINARY_NAME} Variables can be defined either by using = or :=. = will recursively expand the variable. This will replace the value at the point when it is substituted. For example: x = foo y = $(x) bar x = later all: echo $(y) When you run the all command, it will replace the value of x with the last updated value. The value has been changed to later, so it will print: &amp;gt; later bar The other kind of variable assignment is :=. These are simple expanded variables. The variable is expanded at the first scan. So if you assign the variable using this operator, it will print the first value: x := foo y := $(x) bar x := later all: echo $(y) &amp;gt; foo bar Some Useful Tips To make comments in a Makefile, you can simply add a # before any line. To disable printing the recipe while running the target command, use @ before the recipe. Use the SHELL variable to define the shell to execute the recipe. Define the .DEFAULT_GOAL with the name of the target. You can also define functions or loops in the Makefile. You can find more details on it in this make file tutorial. Automating Tasks Using Makefile While developing a project, you will have a lot of repetitive tasks that you might like to automate. In Golang, some of those tasks are testing, running test coverage, linting, and managing dependencies. I will be creating a Makefile that contains all the rules to automate these tasks: BINARY_NAME=hello-world build: GOARCH=amd64 GOOS=darwin go build -o ${BINARY_NAME}-darwin main.go GOARCH=amd64 GOOS=linux go build -o ${BINARY_NAME}-linux main.go GOARCH=amd64 GOOS=window go build -o ${BINARY_NAME}-windows main.go run: ./${BINARY_NAME} build_and_run: build run clean: go clean rm ${BINARY_NAME}-darwin rm ${BINARY_NAME}-linux rm ${BINARY_NAME}-windows test: go test ./... test_coverage: go test ./... -coverprofile=coverage.out dep: go mod download vet: go vet lint: golangci-lint run --enable-all With this simple Makefile, you can now easily execute commands to run tasks: make test make test_coverage make dep make vet make lint Note: I am using an external package, golangci-lint, for linting. If you are using go mod, make sure to add it to your go.mod file. Any CI/CD tool that you are using can now simply use these targets. Conclusion Golang is a popular language for developing large-scale projects. Larger projects have multiple developers and require continuous automation to scale. Streamlining the development process by automating the tasks that are required during development, testing, and release will pay off with a faster and more reliable development process and a easier release process. For next-level automation and to further improve the automation, tools like Earthly.dev can be helpful. If you are also using Docker along with Makefile, Earthly can help make your development process smoother, taking some of the best ideas from Makefiles and Dockerfiles and combining them into one specification.</summary></entry><entry><title type="html">Beating TimSort at Merging</title><link href="https://earthly.dev/blog/python-timsort-merge/" rel="alternate" type="text/html" title="Beating TimSort at Merging" /><published>2021-07-13T00:00:00-04:00</published><updated>2021-07-13T00:00:00-04:00</updated><id>https://earthly.dev/blog/python-timsort-merge</id><content type="html" xml:base="https://earthly.dev/blog/python-timsort-merge/">&lt;div class=&quot;narrow-code&quot;&gt;
&lt;p&gt;Here is a problem. You are tasked with improving the hot loop of a Python program: maybe it is an in-memory sequential index of some sort. The slow part is the updating, where you are adding a new sorted list of items to the already sorted index. You need to combine two sorted lists and keep the result sorted. How do you do that update?&lt;/p&gt;
&lt;p&gt;Yes, this sounds like a LeetCode problem, and maybe in the real-world you would reach for some existing &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/util/SortedSet.html&quot;&gt;sorted set&lt;/a&gt; &lt;a href=&quot;http://www.cplusplus.com/reference/set/set/&quot;&gt;data structure&lt;/a&gt;, but if you were working with python lists, you might do something like this&lt;a href=&quot;#fn1&quot; class=&quot;footnote-ref&quot; id=&quot;fnref1&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; merge_sorted_lists(l1, l2):&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    sorted_list &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;while&lt;/span&gt; (l1 &lt;span class=&quot;kw&quot;&gt;and&lt;/span&gt; l2):&lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; (l1[&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;] &lt;span class=&quot;op&quot;&gt;&amp;lt;=&lt;/span&gt; l2[&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;]): &lt;span class=&quot;co&quot;&gt;# Compare both heads&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-6&quot;&gt;&lt;a href=&quot;#cb1-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            item &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; l1.pop(&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;co&quot;&gt;# Pop from the head&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-7&quot;&gt;&lt;a href=&quot;#cb1-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            sorted_list.append(item)&lt;/span&gt;
&lt;span id=&quot;cb1-8&quot;&gt;&lt;a href=&quot;#cb1-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;else&lt;/span&gt;:&lt;/span&gt;
&lt;span id=&quot;cb1-9&quot;&gt;&lt;a href=&quot;#cb1-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            item &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; l2.pop(&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb1-10&quot;&gt;&lt;a href=&quot;#cb1-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            sorted_list.append(item)&lt;/span&gt;
&lt;span id=&quot;cb1-11&quot;&gt;&lt;a href=&quot;#cb1-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-12&quot;&gt;&lt;a href=&quot;#cb1-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;co&quot;&gt;# Add the remaining of the lists&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-13&quot;&gt;&lt;a href=&quot;#cb1-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    sorted_list.extend(l1 &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; l1 &lt;span class=&quot;cf&quot;&gt;else&lt;/span&gt; l2)&lt;/span&gt;
&lt;span id=&quot;cb1-14&quot;&gt;&lt;a href=&quot;#cb1-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-15&quot;&gt;&lt;a href=&quot;#cb1-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; sorted_list&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Python has a built-in method in &lt;a href=&quot;https://github.com/python/cpython/blob/3.7/Lib/heapq.py#L314&quot;&gt;&lt;code&gt;heapq.merge&lt;/code&gt;&lt;/a&gt; that does this. It takes advantage of the fact that our lists are already sorted, so we can get a new sorted list linear time rather than the &lt;code&gt;n*log(n)&lt;/code&gt; time it would take for combining and sorting two unsorted lists.&lt;/p&gt;
&lt;p&gt;Imagine my surprise then when I saw this performance graph from Stack Overflow:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/python-timsort-merge/performance-sort1-800-629c946b4.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/python-timsort-merge/performance-sort1-800-84f6208b2.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/python-timsort-merge/performance-sort1-800-84f6208b2.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Python‚Äôs sort is beating merge at merging sorted lists!
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;Sorting the list is faster than just merging the list in almost all cases! That doesn‚Äôt sound right, but I checked it, and it‚Äôs true. As Stack Overflow user &lt;a href=&quot;https://stackoverflow.com/users/4279/jfs&quot;&gt;JFS&lt;/a&gt; puts it:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Long story short, unless &lt;code&gt;len(l1 + l2)&lt;/code&gt; &amp;gt;= 1,000,000 use sort&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The reason sort beats merge in most cases is because of a man named Tim Peters.&lt;/p&gt;
&lt;h2 id=&quot;timsort&quot;&gt;TimSort&lt;/h2&gt;
&lt;p&gt;Python‚Äôs &lt;code&gt;list.sort&lt;/code&gt; is the original implementation of a hybrid sorting algorithm called TimSort, named after its author, Tim Peters.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[Here is] stable, natural merge sort, modestly called Timsort (hey, I earned it &lt;wink&gt;). It has supernatural performance on many kinds of partially ordered arrays (less than lg(N!) comparisons needed, and as few as N-1), yet as fast as Python‚Äôs previous highly tuned sample sort hybrid on random arrays.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figcaption&gt;
Tim Peters explaining &lt;a href=&quot;https://github.com/python/cpython/commit/92f81f2e63b5eaa6d748d51a10e32108517bf3bf#diff-6d09fc0f0b57214c2e3a838d366425836c296fa931fe9dc430f604b7e3950c29&quot;&gt;TimSort&lt;/a&gt;
&lt;/figcaption&gt;
&lt;p&gt;Timsort is designed to find runs of sequential numbers and merge them together:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The main routine marches over the array once, left to right, alternately identifying the next run, then merging it into the previous runs ‚Äúintelligently‚Äù. Everything else is complication for speed, and some hard-won measure of memory efficiency.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This is why &lt;code&gt;(x + y).sort()&lt;/code&gt; can be surprisingly fast: once it finds the sequential runs of numbers, it functions like our merge algorithm: combining the two sorted lists in linear time.&lt;/p&gt;
&lt;p&gt;Timsort does have to do extra work, though. It needs to do a pass over the data to find these sequential runs, and &lt;code&gt;heapq.merge&lt;/code&gt; knows where the runs are ahead of time. Timsort overcomes this disadvantage by being written in C rather than Python. Or as ShawdowRanger on Stack Overflow explains it:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;CPython‚Äôs &lt;code&gt;list.sort&lt;/code&gt; is implemented in C (avoiding interpreter overhead), while &lt;code&gt;heapq.merge&lt;/code&gt; is mostly implemented in Python, and optimizes for the ‚Äúmany iterables‚Äù case in a way that slows the ‚Äútwo iterables‚Äù case.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This means that if I drop down to C and write a C extension I should be able to beat Timsort. This turned out to be easier than I thought it would be&lt;a href=&quot;#fn2&quot; class=&quot;footnote-ref&quot; id=&quot;fnref2&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;the-c-extension&quot;&gt;The C Extension&lt;/h2&gt;
&lt;p&gt;The bulk of the C Extension, whose performance I‚Äôm going to cover in a minute, is just the pop the stack algorithm discussed before, but using an index to point to the head of the stack:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode c&quot;&gt;&lt;code class=&quot;sourceCode c&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;co&quot;&gt;//New List&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-2&quot;&gt;&lt;a href=&quot;#cb2-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  PyObject&lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; mergedList &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; PyList_New&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt; n1 &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; n2 &lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-3&quot;&gt;&lt;a href=&quot;#cb2-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-4&quot;&gt;&lt;a href=&quot;#cb2-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt; i &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;;&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-5&quot;&gt;&lt;a href=&quot;#cb2-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    elem1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; PyList_GetItem&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt; listObj1&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; i1 &lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-6&quot;&gt;&lt;a href=&quot;#cb2-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    elem2 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; PyList_GetItem&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt; listObj2&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; i2 &lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-7&quot;&gt;&lt;a href=&quot;#cb2-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    result &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; PyObject_RichCompareBool&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;v&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; w&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; Py_LT&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-8&quot;&gt;&lt;a href=&quot;#cb2-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt; result &lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-9&quot;&gt;&lt;a href=&quot;#cb2-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      &lt;span class=&quot;co&quot;&gt;// List1 has smallest, Pop from list 1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-10&quot;&gt;&lt;a href=&quot;#cb2-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      &lt;span class=&quot;cf&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-11&quot;&gt;&lt;a href=&quot;#cb2-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        PyList_SetItem&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt; mergedList&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; i&lt;span class=&quot;op&quot;&gt;++,&lt;/span&gt; elem1 &lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-12&quot;&gt;&lt;a href=&quot;#cb2-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        i1&lt;span class=&quot;op&quot;&gt;++;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-13&quot;&gt;&lt;a href=&quot;#cb2-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-14&quot;&gt;&lt;a href=&quot;#cb2-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-15&quot;&gt;&lt;a href=&quot;#cb2-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      &lt;span class=&quot;cf&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-16&quot;&gt;&lt;a href=&quot;#cb2-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          &lt;span class=&quot;co&quot;&gt;// List2 has smallest, Pop from list 2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-17&quot;&gt;&lt;a href=&quot;#cb2-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        PyList_SetItem&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt; mergedList&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; i&lt;span class=&quot;op&quot;&gt;++,&lt;/span&gt; elem2 &lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-18&quot;&gt;&lt;a href=&quot;#cb2-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        i2&lt;span class=&quot;op&quot;&gt;++;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-19&quot;&gt;&lt;a href=&quot;#cb2-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-20&quot;&gt;&lt;a href=&quot;#cb2-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-21&quot;&gt;&lt;a href=&quot;#cb2-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt; i2 &lt;span class=&quot;op&quot;&gt;&amp;gt;=&lt;/span&gt; n2 &lt;span class=&quot;op&quot;&gt;||&lt;/span&gt; i1 &lt;span class=&quot;op&quot;&gt;&amp;gt;=&lt;/span&gt; n1 &lt;span class=&quot;op&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-22&quot;&gt;&lt;a href=&quot;#cb2-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;co&quot;&gt;//One list is empty, add remainder of other list to result&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-23&quot;&gt;&lt;a href=&quot;#cb2-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;op&quot;&gt;...&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-24&quot;&gt;&lt;a href=&quot;#cb2-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-25&quot;&gt;&lt;a href=&quot;#cb2-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-26&quot;&gt;&lt;a href=&quot;#cb2-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-27&quot;&gt;&lt;a href=&quot;#cb2-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; mergedList&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figcaption&gt;
C merge (&lt;a href=&quot;https://github.com/earthly/pymerge/blob/main/merge.c&quot;&gt;full and final version on GitHub&lt;/a&gt;)
&lt;/figcaption&gt;
&lt;p&gt;The nice thing about C extensions in Python is that they are easy to use. Once compiled, I can just &lt;code&gt;import merge&lt;/code&gt; and use my new merge method:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; merge&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# create some sorted lists&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-4&quot;&gt;&lt;a href=&quot;#cb3-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;a &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;list&lt;/span&gt;(&lt;span class=&quot;bu&quot;&gt;range&lt;/span&gt;(&lt;span class=&quot;op&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1700&lt;/span&gt;))&lt;/span&gt;
&lt;span id=&quot;cb3-5&quot;&gt;&lt;a href=&quot;#cb3-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;b &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;list&lt;/span&gt;(&lt;span class=&quot;bu&quot;&gt;range&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;1400&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1800&lt;/span&gt;))&lt;/span&gt;
&lt;span id=&quot;cb3-6&quot;&gt;&lt;a href=&quot;#cb3-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-7&quot;&gt;&lt;a href=&quot;#cb3-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# merge them&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-8&quot;&gt;&lt;a href=&quot;#cb3-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;merge.merge(a, b)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;testing-it&quot;&gt;Testing It&lt;/h2&gt;
&lt;p&gt;Testing my new merge with a list of integers and floats, we can see that we are beating Timsort, especially for long lists:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; merge&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; timeit&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-4&quot;&gt;&lt;a href=&quot;#cb4-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;a &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;list&lt;/span&gt;(&lt;span class=&quot;bu&quot;&gt;range&lt;/span&gt;(&lt;span class=&quot;op&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1700&lt;/span&gt;)) &lt;/span&gt;
&lt;span id=&quot;cb4-5&quot;&gt;&lt;a href=&quot;#cb4-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;b &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [&lt;span class=&quot;fl&quot;&gt;0.1&lt;/span&gt;] &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;list&lt;/span&gt;(&lt;span class=&quot;bu&quot;&gt;range&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;1400&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1800&lt;/span&gt;))&lt;/span&gt;
&lt;span id=&quot;cb4-6&quot;&gt;&lt;a href=&quot;#cb4-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-7&quot;&gt;&lt;a href=&quot;#cb4-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; merge_test():&lt;/span&gt;
&lt;span id=&quot;cb4-8&quot;&gt;&lt;a href=&quot;#cb4-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;   m1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; merge.merge(a, b)&lt;/span&gt;
&lt;span id=&quot;cb4-9&quot;&gt;&lt;a href=&quot;#cb4-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-10&quot;&gt;&lt;a href=&quot;#cb4-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; sort_test():&lt;/span&gt;
&lt;span id=&quot;cb4-11&quot;&gt;&lt;a href=&quot;#cb4-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;   m2 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; a &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; b&lt;/span&gt;
&lt;span id=&quot;cb4-12&quot;&gt;&lt;a href=&quot;#cb4-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;   m2.sort()&lt;/span&gt;
&lt;span id=&quot;cb4-13&quot;&gt;&lt;a href=&quot;#cb4-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-14&quot;&gt;&lt;a href=&quot;#cb4-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;sort_time &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; timeit.timeit(&lt;span class=&quot;st&quot;&gt;&amp;quot;sort_test()&amp;quot;&lt;/span&gt;, setup&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;from __main__ import sort_test&amp;quot;&lt;/span&gt;, number&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100000&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb4-15&quot;&gt;&lt;a href=&quot;#cb4-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;merge_time &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; timeit.timeit(&lt;span class=&quot;st&quot;&gt;&amp;quot;merge_test()&amp;quot;&lt;/span&gt;, setup&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;from __main__ import merge_test&amp;quot;&lt;/span&gt;,number&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100000&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb4-16&quot;&gt;&lt;a href=&quot;#cb4-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-17&quot;&gt;&lt;a href=&quot;#cb4-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ss&quot;&gt;f&amp;#39;timsort took &lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;{&lt;/span&gt;sort_time&lt;span class=&quot;sc&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt; seconds&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb4-18&quot;&gt;&lt;a href=&quot;#cb4-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ss&quot;&gt;f&amp;#39;merge took &lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;{&lt;/span&gt;merge_time&lt;span class=&quot;sc&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt; seconds&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;timsort&lt;/span&gt; took 3.9523325259999997 seconds&lt;/span&gt;
&lt;span id=&quot;cb5-2&quot;&gt;&lt;a href=&quot;#cb5-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;merge&lt;/span&gt; took 3.0547665259999994 seconds&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Graphing the performance we get this:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/python-timsort-merge/beating-with-hetro1-800-f0ab30520.png&quot; srcset=&quot;/blog/generated/assets/images/python-timsort-merge/beating-with-hetro1-400-f0ab30520.png 400w, /blog/generated/assets/images/python-timsort-merge/beating-with-hetro1-600-f0ab30520.png 600w, /blog/generated/assets/images/python-timsort-merge/beating-with-hetro1-800-f0ab30520.png 800w, /blog/generated/assets/images/python-timsort-merge/beating-with-hetro1-1000-f0ab30520.png 1000w&quot;&gt;&lt;/p&gt;
&lt;figcaption&gt;
We are beating Timsort with our merge
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;But if we switch to a list of only integers &lt;code&gt;sort&lt;/code&gt; is beating us for small lists and even on big lists our performance improvement is thin at best:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/python-timsort-merge/losing-with-homo-800-f3e6b8fd6.png&quot; srcset=&quot;/blog/generated/assets/images/python-timsort-merge/losing-with-homo-400-f3e6b8fd6.png 400w, /blog/generated/assets/images/python-timsort-merge/losing-with-homo-600-f3e6b8fd6.png 600w, /blog/generated/assets/images/python-timsort-merge/losing-with-homo-800-f3e6b8fd6.png 800w, /blog/generated/assets/images/python-timsort-merge/losing-with-homo-1000-f3e6b8fd6.png 1000w&quot;&gt;&lt;/p&gt;
&lt;figcaption&gt;
With lists of all &lt;code&gt;int&lt;/code&gt; or all &lt;code&gt;float&lt;/code&gt; we lose our advantage.
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;What is going on here?&lt;/p&gt;
&lt;h2 id=&quot;timsorts-special-comparisons&quot;&gt;Timsort‚Äôs Special Comparisons&lt;/h2&gt;
&lt;p&gt;It turns out that Timsort has some extra tricks up its sleeves in the case of a list of integers. In that initial pass over the list, it checks the types of the elements, and if they are all uniform it tries to use a cheaper comparison operation.&lt;/p&gt;
&lt;p&gt;Specifically, if your list is all &lt;a href=&quot;https://github.com/python/cpython/blob/main/Objects/listobject.c#L2085&quot;&gt;longs&lt;/a&gt;, &lt;a href=&quot;https://github.com/python/cpython/blob/main/Objects/listobject.c#L2113&quot;&gt;floats&lt;/a&gt;, or &lt;a href=&quot;https://github.com/python/cpython/blob/main/Objects/listobject.c#L2061&quot;&gt;Latin strings&lt;/a&gt; Timsort will save a lot of cycles on the comparison operations.&lt;/p&gt;
&lt;p&gt;Learning from Timsort we can bring in these comparison operations ourselves. We don‚Äôt want to do a full pass over the list, or we will lose our advantage, so we can just specialize our merge by offering separate calls for longs, floats, and Latin alphabet strings like so:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode c&quot;&gt;&lt;code class=&quot;sourceCode c&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;//Default comparison&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-2&quot;&gt;&lt;a href=&quot;#cb6-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;PyObject&lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; merge&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt; PyObject&lt;span class=&quot;op&quot;&gt;*,&lt;/span&gt; PyObject&lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-3&quot;&gt;&lt;a href=&quot;#cb6-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-4&quot;&gt;&lt;a href=&quot;#cb6-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;//Compare assuming ints&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-5&quot;&gt;&lt;a href=&quot;#cb6-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;PyObject&lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; merge_int&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt; PyObject&lt;span class=&quot;op&quot;&gt;*,&lt;/span&gt; PyObject&lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-6&quot;&gt;&lt;a href=&quot;#cb6-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-7&quot;&gt;&lt;a href=&quot;#cb6-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;//Compare assuming floats&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-8&quot;&gt;&lt;a href=&quot;#cb6-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;PyObject&lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; merge_float&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt; PyObject&lt;span class=&quot;op&quot;&gt;*,&lt;/span&gt; PyObject&lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-9&quot;&gt;&lt;a href=&quot;#cb6-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-10&quot;&gt;&lt;a href=&quot;#cb6-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;//Compare assuming latin&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-11&quot;&gt;&lt;a href=&quot;#cb6-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;PyObject&lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; merge_latin&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt; PyObject&lt;span class=&quot;op&quot;&gt;*,&lt;/span&gt; PyObject&lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figcaption&gt;
merge.h
&lt;/figcaption&gt;
&lt;h2 id=&quot;beating-timsort&quot;&gt;Beating TimSort&lt;/h2&gt;
&lt;p&gt;Doing that, we now can finally beat Timsort at merging sorted lists, not just when the list is a heterogeneous mix of elements, but also when it‚Äôs all integers, or floating-point numbers, or one byte per char strings.&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/python-timsort-merge/summary1-int-800-b27eb2dbe.png&quot; srcset=&quot;/blog/generated/assets/images/python-timsort-merge/summary1-int-400-b27eb2dbe.png 400w, /blog/generated/assets/images/python-timsort-merge/summary1-int-600-b27eb2dbe.png 600w, /blog/generated/assets/images/python-timsort-merge/summary1-int-800-b27eb2dbe.png 800w, /blog/generated/assets/images/python-timsort-merge/summary1-int-1000-b27eb2dbe.png 1000w&quot;&gt;&lt;/p&gt;
&lt;figcaption&gt;
merge vs TimSort for &lt;code&gt;int&lt;/code&gt;.
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/python-timsort-merge/summary2-float-800-28225b9ff.png&quot; srcset=&quot;/blog/generated/assets/images/python-timsort-merge/summary2-float-400-28225b9ff.png 400w, /blog/generated/assets/images/python-timsort-merge/summary2-float-600-28225b9ff.png 600w, /blog/generated/assets/images/python-timsort-merge/summary2-float-800-28225b9ff.png 800w, /blog/generated/assets/images/python-timsort-merge/summary2-float-1000-28225b9ff.png 1000w&quot;&gt;&lt;/p&gt;
&lt;figcaption&gt;
merge vs TimSort for &lt;code&gt;float&lt;/code&gt;.
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/python-timsort-merge/summary3-latin-800-af4f97615.png&quot; srcset=&quot;/blog/generated/assets/images/python-timsort-merge/summary3-latin-400-af4f97615.png 400w, /blog/generated/assets/images/python-timsort-merge/summary3-latin-600-af4f97615.png 600w, /blog/generated/assets/images/python-timsort-merge/summary3-latin-800-af4f97615.png 800w, /blog/generated/assets/images/python-timsort-merge/summary3-latin-1000-af4f97615.png 1000w&quot;&gt;&lt;/p&gt;
&lt;figcaption&gt;
merge vs TimSort for Latin alphabet strings.
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/python-timsort-merge/summary4-else-800-34d33a495.png&quot; srcset=&quot;/blog/generated/assets/images/python-timsort-merge/summary4-else-400-34d33a495.png 400w, /blog/generated/assets/images/python-timsort-merge/summary4-else-600-34d33a495.png 600w, /blog/generated/assets/images/python-timsort-merge/summary4-else-800-34d33a495.png 800w, /blog/generated/assets/images/python-timsort-merge/summary4-else-1000-34d33a495.png 1000w&quot;&gt;&lt;/p&gt;
&lt;figcaption&gt;
merge vs TimSort for everything without a specialized compare.
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;The default &lt;code&gt;merge&lt;/code&gt; beats Timsort for heterogeneous lists, and the specialized versions are there for when you have uniform types in your list, and you need to go fast.&lt;/p&gt;
&lt;h2 id=&quot;timsort-is-good&quot;&gt;TimSort Is Good&lt;/h2&gt;
&lt;p&gt;There, I have beat Timsort for merging sorting lists, although I had to pull in some code from TimSort itself to get here. I‚Äôm not sure how valuable this is: if you need to go fast, you might not choose Python, but it was a fun learning project.&lt;/p&gt;
&lt;p&gt;Also, I learned that dropping down to C isn‚Äôt as scary as it sounds. The build steps are a bit more involved, but with the included &lt;a href=&quot;https://github.com/earthly/pymerge/blob/main/Earthfile&quot;&gt;Earthfile&lt;/a&gt;, the build is a one-liner and works cross-platform. You can find the code &lt;a href=&quot;https://github.com/earthly/pymerge&quot;&gt;on GitHub&lt;/a&gt; and an intro to &lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; on this very site, and with that example, you can build your own C extension reasonably quickly.&lt;/p&gt;
&lt;p&gt;The surprising thing, though, is how good Timsort still is. It wasn‚Äôt designed for merging sorted lists but for sorting real-world data. It turns out real-world data is often partially sorted, just like our use case.&lt;/p&gt;
&lt;p&gt;Timsort on partially sorted data shows us where Big O notation can misinform us. If your input always keeps you near the median or best-case performance, then the worst-case performance doesn‚Äôt matter much. It‚Äôs no wonder then that since its first creation, Timsort has spread from Python to JavaScript, Swift, and Rust. Thank you, Tim Peters!&lt;/p&gt;
&lt;/div&gt;
&lt;section class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&quot;fn1&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;Practically, you might not want to use pop, but just track an index of where the head of the stack should be, like the C code shown later.&lt;a href=&quot;#fnref1&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;‚Ü©Ô∏é&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn2&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;It was easier because my teammate Alex has experience writing C extensions for Python, so by the time I had found the Python header files, Alex had already put together a prototype solution.&lt;a href=&quot;#fnref2&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;‚Ü©Ô∏é&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;</content><author><name>Adam Gordon Bell</name></author><category term="Tutorials" /><summary type="html">Here is a problem. You are tasked with improving the hot loop of a Python program: maybe it is an in-memory sequential index of some sort. The slow part is the updating, where you are adding a new sorted list of items to the already sorted index. You need to combine two sorted lists and keep the result sorted. How do you do that update? Yes, this sounds like a LeetCode problem, and maybe in the real-world you would reach for some existing sorted set data structure, but if you were working with python lists, you might do something like this1: def merge_sorted_lists(l1, l2): sorted_list = [] while (l1 and l2): if (l1[0] &amp;lt;= l2[0]): # Compare both heads item = l1.pop(0) # Pop from the head sorted_list.append(item) else: item = l2.pop(0) sorted_list.append(item) # Add the remaining of the lists sorted_list.extend(l1 if l1 else l2) return sorted_list Python has a built-in method in heapq.merge that does this. It takes advantage of the fact that our lists are already sorted, so we can get a new sorted list linear time rather than the n*log(n) time it would take for combining and sorting two unsorted lists. Imagine my surprise then when I saw this performance graph from Stack Overflow: Python‚Äôs sort is beating merge at merging sorted lists! Sorting the list is faster than just merging the list in almost all cases! That doesn‚Äôt sound right, but I checked it, and it‚Äôs true. As Stack Overflow user JFS puts it: Long story short, unless len(l1 + l2) &amp;gt;= 1,000,000 use sort The reason sort beats merge in most cases is because of a man named Tim Peters. TimSort Python‚Äôs list.sort is the original implementation of a hybrid sorting algorithm called TimSort, named after its author, Tim Peters. [Here is] stable, natural merge sort, modestly called Timsort (hey, I earned it ). It has supernatural performance on many kinds of partially ordered arrays (less than lg(N!) comparisons needed, and as few as N-1), yet as fast as Python‚Äôs previous highly tuned sample sort hybrid on random arrays. Tim Peters explaining TimSort Timsort is designed to find runs of sequential numbers and merge them together: The main routine marches over the array once, left to right, alternately identifying the next run, then merging it into the previous runs ‚Äúintelligently‚Äù. Everything else is complication for speed, and some hard-won measure of memory efficiency. This is why (x + y).sort() can be surprisingly fast: once it finds the sequential runs of numbers, it functions like our merge algorithm: combining the two sorted lists in linear time. Timsort does have to do extra work, though. It needs to do a pass over the data to find these sequential runs, and heapq.merge knows where the runs are ahead of time. Timsort overcomes this disadvantage by being written in C rather than Python. Or as ShawdowRanger on Stack Overflow explains it: CPython‚Äôs list.sort is implemented in C (avoiding interpreter overhead), while heapq.merge is mostly implemented in Python, and optimizes for the ‚Äúmany iterables‚Äù case in a way that slows the ‚Äútwo iterables‚Äù case. This means that if I drop down to C and write a C extension I should be able to beat Timsort. This turned out to be easier than I thought it would be2. The C Extension The bulk of the C Extension, whose performance I‚Äôm going to cover in a minute, is just the pop the stack algorithm discussed before, but using an index to point to the head of the stack: //New List PyObject* mergedList = PyList_New( n1 + n2 ); for( i = 0;; ) { elem1 = PyList_GetItem( listObj1, i1 ); elem2 = PyList_GetItem( listObj2, i2 ); result = PyObject_RichCompareBool(v, w, Py_LT); switch( result ) { // List1 has smallest, Pop from list 1 case 1: PyList_SetItem( mergedList, i++, elem1 ); i1++; break; case 0: // List2 has smallest, Pop from list 2 PyList_SetItem( mergedList, i++, elem2 ); i2++; break; } if( i2 &amp;gt;= n2 || i1 &amp;gt;= n1 )) { //One list is empty, add remainder of other list to result ... break; } } return mergedList; C merge (full and final version on GitHub) The nice thing about C extensions in Python is that they are easy to use. Once compiled, I can just import merge and use my new merge method: import merge # create some sorted lists a = list(range(-100, 1700)) b = list(range(1400, 1800)) # merge them merge.merge(a, b) Testing It Testing my new merge with a list of integers and floats, we can see that we are beating Timsort, especially for long lists: import merge import timeit a = list(range(-100, 1700)) b = [0.1] + list(range(1400, 1800)) def merge_test(): m1 = merge.merge(a, b) def sort_test(): m2 = a + b m2.sort() sort_time = timeit.timeit(&amp;quot;sort_test()&amp;quot;, setup=&amp;quot;from __main__ import sort_test&amp;quot;, number=100000) merge_time = timeit.timeit(&amp;quot;merge_test()&amp;quot;, setup=&amp;quot;from __main__ import merge_test&amp;quot;,number=100000) print(f&amp;#39;timsort took {sort_time} seconds&amp;#39;) print(f&amp;#39;merge took {merge_time} seconds&amp;#39;) timsort took 3.9523325259999997 seconds merge took 3.0547665259999994 seconds Graphing the performance we get this: We are beating Timsort with our merge But if we switch to a list of only integers sort is beating us for small lists and even on big lists our performance improvement is thin at best: With lists of all int or all float we lose our advantage. What is going on here? Timsort‚Äôs Special Comparisons It turns out that Timsort has some extra tricks up its sleeves in the case of a list of integers. In that initial pass over the list, it checks the types of the elements, and if they are all uniform it tries to use a cheaper comparison operation. Specifically, if your list is all longs, floats, or Latin strings Timsort will save a lot of cycles on the comparison operations. Learning from Timsort we can bring in these comparison operations ourselves. We don‚Äôt want to do a full pass over the list, or we will lose our advantage, so we can just specialize our merge by offering separate calls for longs, floats, and Latin alphabet strings like so: //Default comparison PyObject* merge( PyObject*, PyObject* ); //Compare assuming ints PyObject* merge_int( PyObject*, PyObject* ); //Compare assuming floats PyObject* merge_float( PyObject*, PyObject* ); //Compare assuming latin PyObject* merge_latin( PyObject*, PyObject* ) merge.h Beating TimSort Doing that, we now can finally beat Timsort at merging sorted lists, not just when the list is a heterogeneous mix of elements, but also when it‚Äôs all integers, or floating-point numbers, or one byte per char strings. merge vs TimSort for int. merge vs TimSort for float. merge vs TimSort for Latin alphabet strings. merge vs TimSort for everything without a specialized compare. The default merge beats Timsort for heterogeneous lists, and the specialized versions are there for when you have uniform types in your list, and you need to go fast. TimSort Is Good There, I have beat Timsort for merging sorting lists, although I had to pull in some code from TimSort itself to get here. I‚Äôm not sure how valuable this is: if you need to go fast, you might not choose Python, but it was a fun learning project. Also, I learned that dropping down to C isn‚Äôt as scary as it sounds. The build steps are a bit more involved, but with the included Earthfile, the build is a one-liner and works cross-platform. You can find the code on GitHub and an intro to Earthly on this very site, and with that example, you can build your own C extension reasonably quickly. The surprising thing, though, is how good Timsort still is. It wasn‚Äôt designed for merging sorted lists but for sorting real-world data. It turns out real-world data is often partially sorted, just like our use case. Timsort on partially sorted data shows us where Big O notation can misinform us. If your input always keeps you near the median or best-case performance, then the worst-case performance doesn‚Äôt matter much. It‚Äôs no wonder then that since its first creation, Timsort has spread from Python to JavaScript, Swift, and Rust. Thank you, Tim Peters! Practically, you might not want to use pop, but just track an index of where the head of the stack should be, like the C code shown later.‚Ü©Ô∏é It was easier because my teammate Alex has experience writing C extensions for Python, so by the time I had found the Python header files, Alex had already put together a prototype solution.‚Ü©Ô∏é</summary></entry></feed>
<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.1.1">Jekyll</generator><link href="https://earthly.dev/blog/feed.xml" rel="self" type="application/atom+xml" /><link href="https://earthly.dev/blog/" rel="alternate" type="text/html" /><updated>2021-05-19T16:42:33-04:00</updated><id>https://earthly.dev/blog/feed.xml</id><title type="html">Earthly Blog</title><subtitle>Build automation for the container era.</subtitle><entry><title type="html">How to Not Use Our Build Tool</title><link href="https://earthly.dev/blog/dont-use-earthly/" rel="alternate" type="text/html" title="How to Not Use Our Build Tool" /><published>2021-05-19T00:00:00-04:00</published><updated>2021-05-19T00:00:00-04:00</updated><id>https://earthly.dev/blog/dont-use-earthly</id><content type="html" xml:base="https://earthly.dev/blog/dont-use-earthly/">&lt;p&gt;In our journey to becoming better software engineers we have learned of various ways in which the team’s productivity could be improved. We noticed that a focus on build repeatability and maintainability goes a long way towards keeping the team focused on what really matters: delivering great software. Many of these ideas helped shape what Earthly is today. In fact, the complexity of the matter is what got us to &lt;a href=&quot;https://earthly.dev/blog/the-world-deserves-better-builds/&quot;&gt;start Earthly in the first place&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I wanted to sit down and write about all the tricks we learned and that we used every day to help make builds more manageable in the absence of Earthly. It’s kinda like a “what would you do if you couldn’t use Earthly” article. This will hopefully give you some ideas on best practices around build script maintenance, or it might help you decide on whether Earthly is something for you (or if the alternative is preferrable).&lt;/p&gt;
&lt;p&gt;In this article, we will walk through the 10,000 feet view of your build strategy, then dive into some specific tricks, tools, and techniques you might use to keep your builds effective and reproducible, with other off-the-shelf tools.&lt;/p&gt;
&lt;h2 id=&quot;putting-together-complex-builds---assumptions&quot;&gt;Putting Together Complex Builds - Assumptions&lt;/h2&gt;
&lt;p&gt;Since this is a guide about how not to use Earthly, we’ll try to achieve the same benefits of Earthly, using other tools. Here are some assumptions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;You are building cloud or web services, targeting Linux.&lt;/li&gt;
&lt;li&gt;You have a setup where multiple programming languages come together (e.g. multiple microservices).&lt;/li&gt;
&lt;li&gt;You would like to have fast local dev-test cycles for individual components.&lt;/li&gt;
&lt;li&gt;You would like to be able to iterate quickly when there is a CI failure.&lt;/li&gt;
&lt;li&gt;Developers on your team use varying platforms for day-to-day development: some Linux, some Mac, some Windows.&lt;/li&gt;
&lt;li&gt;You would like to optimize for cross-team collaboration.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;scope-the-glue-layer&quot;&gt;Scope: The Glue Layer&lt;/h2&gt;
&lt;p&gt;We will focus primarily on the glue layer of your builds. The stuff that brings everything together - maybe it packages things up for releases, or maybe it prepares packages for deployment, or perhaps it is simply a script that the CI definition calls into.&lt;/p&gt;
&lt;p&gt;This is a diagram we sometimes use to describe the glue layer. In this article, we’ll be focusing on the Dockerfile, Makefile, and Bash parts of that glue layer. Not having a glue layer can make CI failures difficult to reproduce, or for other teams unfamiliar with the language-specific build tooling to effectively create the right environment to run builds.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/blog/assets/images/dont-use-earthly/glue-layer.png&quot; alt=&quot;The glue layer&quot; /&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;p&gt;The glue layer is the layer between the various projects that need to be built and will act as the common denominator - &lt;a href=&quot;https://earthly.dev/blog/migrating-from-travis/#neutral-build-specifications&quot;&gt;a vendor-neutral build specification&lt;/a&gt;. If we don’t choose such a glue layer, then the CI YAML (or Groovy?) becomes the glue layer and that would mean that it’s more difficult to run it locally for fast iteration.&lt;/p&gt;
&lt;p&gt;Because we want to encourage cross-team collaboration, we want to standardize the tooling across teams as much as possible. Different language ecosystems will have different tools and we want to keep using those. You can’t tell the frontend team not to use package.json / NPM / Yarn etc - that would be terribly cumbersome for them. So we’re not touching the language-specific build layer.&lt;/p&gt;
&lt;p&gt;In addition, because we want to be able to iterate quickly when there are CI failures, we will containerize the build as much as possible. If the failure is part of a containerized script, then it will be easier to reproduce it locally.&lt;/p&gt;
&lt;p&gt;A popular choice for the glue layer is to use Makefile + Dockerfile. Makefiles are great as a collection of everyday commands that we can use (&lt;code&gt;make build&lt;/code&gt;, &lt;code&gt;make start&lt;/code&gt;, &lt;code&gt;make package&lt;/code&gt;, &lt;code&gt;make test&lt;/code&gt;), while Dockerfiles help keep most of the build containerized.&lt;/p&gt;
&lt;p&gt;Another option might be to use bash + Dockerfile, where a collection scripts for everyday tasks exist under a &lt;code&gt;hack&lt;/code&gt; or &lt;code&gt;scripts&lt;/code&gt; directory (&lt;code&gt;./hack/build&lt;/code&gt;, &lt;code&gt;./hack/test&lt;/code&gt;, &lt;code&gt;./hack/release&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;Yet another, more exotic, option is to use another scripting language, such as Python or JavaScript (see, for example, the &lt;a href=&quot;https://github.com/google/zx&quot;&gt;zx&lt;/a&gt; library). Keep in mind, however, that it’s best when most of the engineers can read and write the build scripts with ease. Sometimes too much flexibility of the programming language can make it harder for others to read and understand the scripts. This is an especially important point as the build scripts will likely be read much more often than they will be written.&lt;/p&gt;
&lt;p&gt;For this guide, we’ll use Makefile + Dockerfile, as an arbitrary choice. Note, however, that neither Bash nor Makefile is very intuitive at first glance and you will need to help out junior developers, or developers that simply haven’t had the opportunity to learn these yet. And also, these are purely arbitrary choices, based on what we see as popular technologies used in this area. Your own choice may vary for good reasons. This guide is not saying that Makefile / Bash / Dockerfile are the only right choices.&lt;/p&gt;
&lt;h2 id=&quot;tips-for-taming-makefiles-in-large-teams&quot;&gt;Tips for Taming Makefiles in Large Teams&lt;/h2&gt;
&lt;p&gt;While there is &lt;a href=&quot;https://www.shellcheck.net/&quot;&gt;shellcheck&lt;/a&gt; for linting shell scripts and avoiding the typical pitfalls, there is currently no linter for Makefiles. Part of the reason is that there are multiple styles or philosophies as to how to write Makefiles that it is hard to enforce specific rules that prevent human errors. For example, take a look at this &lt;a href=&quot;https://tech.davis-hansson.com/p/make/&quot;&gt;particularly opinionated approach&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Makefiles have the ability to manage the chain of dependencies and avoid duplicate work. However, this feature is heavily based on file creation time (if an input is newer than the output, then rebuild the target), and in most cases that is not enough. If you really want to, it is possible to force everything into that model. However, that tends to create very complicated Makefiles that often only one person on the team understands. This person becomes the “Build Guru” and all build maintenance works flow through them. This “Build Guru” dynamic is very common but best avoided. With Makefiles, using a limited subset of the Makefile language can help avoid this pattern and keep everything more maintainable for the entire team.&lt;/p&gt;
&lt;p&gt;If the Makefile wraps an existing build (for example, a Gradle-based or NPM-based build), it might make more sense to avoid Makefile’s more advanced features in those particular projects, to help the team be comfortable with making changes to the Makefile, with limited knowledge. In such cases, the caching would be handled by the wrapped build system and not by the Makefile itself.&lt;/p&gt;
&lt;p&gt;Here are some guidelines to help keep Makefiles simple and understandable, when the Makefile wraps another build system.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Only use &lt;a href=&quot;https://www.gnu.org/software/make/manual/html_node/Phony-Targets.html&quot;&gt;&lt;code&gt;.PHONY&lt;/code&gt; targets&lt;/a&gt;. Explanation: regular Makefile targets are names of files that need to be output. If the file does not exist or it is older than its inputs, &lt;code&gt;make&lt;/code&gt; decides to run the target. A &lt;code&gt;.PHONY&lt;/code&gt; target is a target that is not really a file - it’s just a name that the user can use as a short-hand to refer to a recipe to be run.&lt;code&gt;.PHONY&lt;/code&gt; targets don’t use the freshness algorithm.&lt;/li&gt;
&lt;li&gt;Avoid overusing the distinct features of the different variable flavors (&lt;code&gt;=&lt;/code&gt; vs &lt;code&gt;:=&lt;/code&gt; vs &lt;code&gt;?=&lt;/code&gt; vs &lt;code&gt;+=&lt;/code&gt; vs &lt;code&gt;!=&lt;/code&gt;). Someone not knowing the details of how Makefiles work will be confused if the logic relies heavily on the specific flavor.&lt;/li&gt;
&lt;li&gt;Avoid order-only prerequisite types (&lt;code&gt;targets : normal-prerequisites | order-only-prerequisites&lt;/code&gt;). The &lt;code&gt;order-only-prerequisite&lt;/code&gt; can be misleading to someone new to Makefiles.&lt;/li&gt;
&lt;li&gt;Avoid complex rules involving &lt;code&gt;patsubst&lt;/code&gt; or special variables like &lt;code&gt;$&amp;lt;&lt;/code&gt;, &lt;code&gt;$^&lt;/code&gt;, &lt;code&gt;$*&lt;/code&gt;, &lt;code&gt;$@&lt;/code&gt;. The way these work is a mystery to Makefile newcomers and it can be really hard to Google for the meaning.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In other words, try not to be too smart about Makefiles. Note, however, that if the Makefile does not wrap an existing build system, then it is likely that you’ll need the advanced features of Makefile to correctly make use of the caching system.&lt;/p&gt;
&lt;p&gt;Another thing to consider is that certain UNIX commands vary from platform to platform. For example, &lt;code&gt;sed&lt;/code&gt; and &lt;code&gt;find&lt;/code&gt; have important differences between GNU/Linux and macOS, and while Windows can behave very much like Linux through WSL 2, testing is needed to verify everything you are using will work the same. Ask a colleague to test out your scripts on their platform if in doubt.&lt;/p&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;Remember The Tab&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Use of the tab character is mandatory in Makefiles or you’ll get this error. This usually catches newbies off-guard.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;code&gt;Makefile:273: *** missing separator.  Stop.&lt;/code&gt;&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;tips-for-dockerfiles&quot;&gt;Tips for Dockerfiles&lt;/h2&gt;
&lt;p&gt;To help keep builds reproducible, it’s useful to have a version of the build in containerized form. If performance allows, this might be the day-to-day form that everyone uses. If not, at the very least, it’s the form that is used to debug CI failures.&lt;/p&gt;
&lt;p&gt;Dockerfiles are the bread and butter of containerized builds. However, they have an important limitation: they can only output Docker images. They weren’t designed to run unit tests or to output regular artifacts (binaries, jars, packages, etc). However, with some wrapper code, it is possible to extract regular files from images or to execute unit tests too. The following will illustrate how.&lt;/p&gt;
&lt;h3 id=&quot;use-multi-stage-dockerfiles-or-multiple-dockerfiles&quot;&gt;Use Multi-stage Dockerfiles or Multiple Dockerfiles&lt;/h3&gt;
&lt;p&gt;To help split up Dockerfile recipes into logical groupings, you can make use of multiple Dockerfile targets (also called multi-stage builds) and/or of multiple Dockerfile files.&lt;/p&gt;
&lt;p&gt;To define targets use &lt;code&gt;FROM ... AS ...&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode dockerfile&quot;&gt;&lt;code class=&quot;sourceCode dockerfile&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; alpine:latest AS my-target-name&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;...&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; ubuntu:latest AS another-target-name&lt;/span&gt;
&lt;span id=&quot;cb1-6&quot;&gt;&lt;a href=&quot;#cb1-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-7&quot;&gt;&lt;a href=&quot;#cb1-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;...&lt;/span&gt;
&lt;span id=&quot;cb1-8&quot;&gt;&lt;a href=&quot;#cb1-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-9&quot;&gt;&lt;a href=&quot;#cb1-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; my-target-name AS yet-another-target-name&lt;/span&gt;
&lt;span id=&quot;cb1-10&quot;&gt;&lt;a href=&quot;#cb1-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-11&quot;&gt;&lt;a href=&quot;#cb1-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A target can be used in another &lt;code&gt;FROM&lt;/code&gt; command or a &lt;code&gt;COPY&lt;/code&gt; command (&lt;code&gt;COPY --from=my-target-name &amp;lt;file-from&amp;gt; &amp;lt;file-to&amp;gt;&lt;/code&gt;) to copy resulting files from one target into another. This flexibility allows your definition to be more modular, and possibly also more efficient in cache, or more efficient in the size of the final image.&lt;/p&gt;
&lt;p&gt;To invoke a specific Dockerfile target, you can use the &lt;code&gt;--target&lt;/code&gt; flag of &lt;code&gt;docker build&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; build &lt;span class=&quot;at&quot;&gt;--target&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;my-target-name &lt;span class=&quot;at&quot;&gt;-t&lt;/span&gt; my-build-image .&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If a target is not specified, &lt;code&gt;docker build&lt;/code&gt; will simply build the last target in the file.&lt;/p&gt;
&lt;h3 id=&quot;running-containerized-unit-tests&quot;&gt;Running Containerized Unit Tests&lt;/h3&gt;
&lt;p&gt;In order to run unit tests in containers, you might take either of the following strategies:&lt;/p&gt;
&lt;ol type=&quot;a&quot;&gt;
&lt;li&gt;
Run the test as a Dockerfile target
&lt;/li&gt;
&lt;li&gt;
Build a container with all the necessary code and set the entrypoint to execute the unit tests, then run that container.
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;A third, less recommended, option is to execute tests as additional layers of the final image. This is not a great option because it unnecessarily bloats your image size and also, there’s no way to skip them. If you just want an image quickly this option will end up getting in your way.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Option a.&lt;/strong&gt; has the advantage that if nothing changes, the Dockerfile caching will simply reuse previous work and return quickly. Since you don’t need the image being created, you can simply skip mentioning a tag via &lt;code&gt;-t&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; build .&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Option b.&lt;/strong&gt; requires managing an extra image, but might make them look more like the integration tests. Plus, if you want to mount in the source code instead of &lt;code&gt;COPY&lt;/code&gt;ing it (faster on Linux), this option allows that.&lt;/p&gt;
&lt;h3 id=&quot;running-integration-tests&quot;&gt;Running Integration Tests&lt;/h3&gt;
&lt;p&gt;When running containerized integration tests that depend on additional services, only &lt;strong&gt;option b.&lt;/strong&gt; above is available. In such cases, you might want to make use of docker-compose to manage multiple containers running together. Even if your setup is small, it’s just easier to be able to kill everything at once if your tests hang.&lt;/p&gt;
&lt;p&gt;Another option is to use &lt;a href=&quot;https://github.com/testcontainers&quot;&gt;testcontainers&lt;/a&gt; - a language-specific library that allows you to bring up containerized helper services during integration testing. This can be a great abstraction, however, if you want to keep the integration tests containerized too, you’ll need to mount &lt;code&gt;/var/run/docker.sock&lt;/code&gt; (this is sometimes referred to as “docker-out-of-docker”). This will allow the integration test code to bring up the necessary helper services via testcontainers.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; run &lt;span class=&quot;at&quot;&gt;-v&lt;/span&gt; /var/run/docker.sock:/var/run/docker.sock ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Either way, to keep your test suite as easy to use as possible, it’s great if you can map the series of commands needed to run the integration tests to a single make command (e.g. &lt;code&gt;make integration&lt;/code&gt;) and use this command without any additional settings or wrappers in your CI scripts too. That way, if your CI breaks, then you have a very easy one-liner that should (hopefully) reproduce the failure on your local machine.&lt;/p&gt;
&lt;h3 id=&quot;outputting-regular-files&quot;&gt;Outputting Regular Files&lt;/h3&gt;
&lt;p&gt;Even the most containerized builds benefit from being able to occasionally output regular files. Here are some possible situations:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Binaries / Packages / Library archives&lt;/li&gt;
&lt;li&gt;Releaseables (deb packages, source code tarballs)&lt;/li&gt;
&lt;li&gt;Screenshots from UI tests&lt;/li&gt;
&lt;li&gt;Test coverage reports&lt;/li&gt;
&lt;li&gt;Performance profile reports&lt;/li&gt;
&lt;li&gt;Database schema init scripts&lt;/li&gt;
&lt;li&gt;Generated source code files (to help IDEs with syntax highlighting)&lt;/li&gt;
&lt;li&gt;Generated configuration&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To output regular files as part of a containerized build, there are a few options.&lt;/p&gt;
&lt;ol type=&quot;a&quot;&gt;
&lt;li&gt;
Generate the file(s) into a host-mounted volume as part of &lt;code&gt;docker run&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;
Generate the file(s) as part of &lt;code&gt;docker run&lt;/code&gt; and then extract them using &lt;code&gt;docker cp&lt;/code&gt;.
&lt;/li&gt;
&lt;li&gt;
Generate the file(s) as the contents of an image during &lt;code&gt;docker build&lt;/code&gt; then extract them using the &lt;code&gt;docker build -o&lt;/code&gt;option.
&lt;/li&gt;
&lt;li&gt;
Generate the file(s) as the contents of an image during &lt;code&gt;docker build&lt;/code&gt; then extract them using &lt;code&gt;docker cp&lt;/code&gt;.
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Let’s take these one at a time:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Option a. Generate the file(s) into a host-mounted volume as part of &lt;code&gt;docker run&lt;/code&gt;&lt;/strong&gt;: This is by far the most used, but arguably the least useful. This technique involves setting the entrypoint as the command that generates the resulting artifact and mounting an output directory (or maybe even the entire source code directory) where the result can be stored and shared with the host system.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; run &lt;span class=&quot;at&quot;&gt;--rm&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$PWD&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;/output:/output&amp;quot;&lt;/span&gt; my-image:latest&lt;/span&gt;
&lt;span id=&quot;cb5-2&quot;&gt;&lt;a href=&quot;#cb5-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;ls&lt;/span&gt; /output&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The typical issue with this approach is that the resulting artifacts are owned by &lt;code&gt;root&lt;/code&gt;. Getting rid of them or moving them around then requires &lt;code&gt;sudo&lt;/code&gt;. There are, of course, ways to generate the files as a different user within the container, but this can be cumbersome.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Option b. Generate the file(s) as part of &lt;code&gt;docker run&lt;/code&gt; and then extract them using &lt;code&gt;docker cp&lt;/code&gt;&lt;/strong&gt;: This option involves executing the &lt;code&gt;docker run&lt;/code&gt; and then afterward issuing &lt;code&gt;docker cp&lt;/code&gt; to extract the resulting artifact. Here’s an example:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; run &lt;span class=&quot;at&quot;&gt;--name&lt;/span&gt; build-artifact my-image:latest&lt;/span&gt;
&lt;span id=&quot;cb6-2&quot;&gt;&lt;a href=&quot;#cb6-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; cp build-artifact:/output/my-artifact ./output/my-artifact&lt;/span&gt;
&lt;span id=&quot;cb6-3&quot;&gt;&lt;a href=&quot;#cb6-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; rm build-artifact&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This option will produce results owned by the right user. The one possible downside of this approach is that if the &lt;code&gt;docker run&lt;/code&gt; fails, a hanging &lt;code&gt;build-artifact&lt;/code&gt; container remains, which will cause the next run to fail due to naming conflict. This can be easily fixed, however, by adding &lt;code&gt;docker rm -f build-artifact&lt;/code&gt; at the beginning of the script.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Option c. Generate the file(s) as the contents of an image during &lt;code&gt;docker build&lt;/code&gt; then extract them using the &lt;code&gt;docker build -o&lt;/code&gt; option&lt;/strong&gt;: This is a lesser-known technique particularly suited for outputting entire directories. It essentially outputs the root directory of an entire image to the host. Here’s how this might be used.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb7&quot;&gt;&lt;pre class=&quot;sourceCode dockerfile&quot;&gt;&lt;code class=&quot;sourceCode dockerfile&quot;&gt;&lt;span id=&quot;cb7-1&quot;&gt;&lt;a href=&quot;#cb7-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; alpine AS base&lt;/span&gt;
&lt;span id=&quot;cb7-2&quot;&gt;&lt;a href=&quot;#cb7-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;RUN&lt;/span&gt; mkdir -p /output&lt;/span&gt;
&lt;span id=&quot;cb7-3&quot;&gt;&lt;a href=&quot;#cb7-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;RUN&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;quot;contents&amp;quot;&lt;/span&gt; &amp;gt;/output/my-artifact&lt;/span&gt;
&lt;span id=&quot;cb7-4&quot;&gt;&lt;a href=&quot;#cb7-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb7-5&quot;&gt;&lt;a href=&quot;#cb7-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; scratch&lt;/span&gt;
&lt;span id=&quot;cb7-6&quot;&gt;&lt;a href=&quot;#cb7-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;COPY&lt;/span&gt; --from=base /output/* /&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb8&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb8-1&quot;&gt;&lt;a href=&quot;#cb8-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; build &lt;span class=&quot;at&quot;&gt;-o&lt;/span&gt; ./output .&lt;/span&gt;
&lt;span id=&quot;cb8-2&quot;&gt;&lt;a href=&quot;#cb8-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;cat&lt;/span&gt; ./output/my-artifact &lt;span class=&quot;co&quot;&gt;# prints &amp;quot;contents&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The use of the scratch base image is such that the final image is minimal and only the required artifact is copied over to the host.&lt;/p&gt;
&lt;p&gt;This technique outputs files owned by the right user, however sometimes the fact that it outputs a whole directory can be limiting.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Option d. Generate the file(s) as the contents of an image during &lt;code&gt;docker build&lt;/code&gt; then extract them using &lt;code&gt;docker cp&lt;/code&gt;&lt;/strong&gt;: This technique is somewhat similar to &lt;strong&gt;option b.&lt;/strong&gt; except that no &lt;code&gt;docker run&lt;/code&gt; is used.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb9&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb9-1&quot;&gt;&lt;a href=&quot;#cb9-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; build &lt;span class=&quot;at&quot;&gt;-t&lt;/span&gt; my-image:latest .&lt;/span&gt;
&lt;span id=&quot;cb9-2&quot;&gt;&lt;a href=&quot;#cb9-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; create &lt;span class=&quot;at&quot;&gt;--name&lt;/span&gt; output-artifact my-image:latest&lt;/span&gt;
&lt;span id=&quot;cb9-3&quot;&gt;&lt;a href=&quot;#cb9-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; cp output-artifact:/output/my-artifact ./output/my-artifact&lt;/span&gt;
&lt;span id=&quot;cb9-4&quot;&gt;&lt;a href=&quot;#cb9-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; rm output-artifact&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This option too will produce artifacts owned by the right user.&lt;/p&gt;
&lt;h2 id=&quot;tips-for-taming-bash-scripts&quot;&gt;Tips for Taming Bash Scripts&lt;/h2&gt;
&lt;p&gt;Regardless of the build setup, bash scripts are sometimes inevitable, especially when extensive release logic is needed and the language-specific tooling doesn’t offer specific support.&lt;/p&gt;
&lt;p&gt;If you’re new to bash scripting, I’ll run through a few of the more useful beginner tricks from our &lt;a href=&quot;https://earthly.dev/blog/understanding-bash/&quot;&gt;understanding bash article&lt;/a&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Spaces are surprisingly important. &lt;code&gt;A=B&lt;/code&gt; is different from &lt;code&gt;A = B&lt;/code&gt;. Also &lt;code&gt;if[$A=$B]&lt;/code&gt; does not work - it has to be &lt;code&gt;if [ $A = $B ]&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Variables can cause really weird things if they are not wrapped in double-quotes. The reason is that a variable that contains spaces can expand across multiple command parameters unless it’s within quotes. To prevent any surprises, a good rule is to never expand a variable outside of double-quotes. So use &lt;code&gt;&quot;$ABC&quot;&lt;/code&gt; always and not simply &lt;code&gt;$ABC&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;A really good tool to check for some common errors like the above is &lt;a href=&quot;https://www.shellcheck.net/&quot;&gt;&lt;code&gt;shellcheck&lt;/code&gt;&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;If there is an error in a bash script, by default, the script simply continues without a worry. This is very often not what you want - you want to terminate immediately so that the user is aware that something has failed. To enable this, put &lt;code&gt;set -e&lt;/code&gt; at the top of the file.&lt;/li&gt;
&lt;li&gt;A series of piped commands can also fail and bash doesn’t terminate by default. To terminate immediately in such cases, you can enable &lt;code&gt;set -o pipefail&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;An undefined variable is treated as the empty string in bash. However a lot of times an undefined variable can also be caused by a typo, or an incomplete rename during a refactor, or some other human error. To avoid surprises, you can do &lt;code&gt;set -u&lt;/code&gt;, which will cause the script to fail on undefined variables. To initialize a variable with a default value (and avoid this error, if you’d like to allow an optional external variable), you can use &lt;code&gt;: &quot;${&amp;lt;variable-name&amp;gt;:=&amp;lt;default-value&amp;gt;}&quot;&lt;/code&gt;. Just don’t forget the &lt;code&gt;:&lt;/code&gt; in front of it.&lt;/li&gt;
&lt;li&gt;If you have no idea what your bash script is doing, you can make it print every statement being evaluated using &lt;code&gt;set -x&lt;/code&gt;. It’s especially useful when debugging.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;importing-code-and-artifacts-from-another-repository&quot;&gt;Importing Code and Artifacts from Another Repository&lt;/h2&gt;
&lt;p&gt;Sometimes it’s useful to import the result of one build from repo A into the build of repo B. Here are some examples of situations where this is needed:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Building some binaries in a core repo and packaging the release in a “build-tooling” repo (example in &lt;a href=&quot;https://github.com/Kong/kong-build-tools&quot;&gt;kong&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Generating protobuf files in one repo and reusing those files in multiple other repos (client(s) and server)&lt;/li&gt;
&lt;li&gt;Pre-computing some initialization data in one repo and using it in another repo&lt;/li&gt;
&lt;li&gt;Cases where the language-specific tooling offers little or no support for importing code from another repository&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;There are multiple ways to achieve importing on your own. In general, if the language you use provides solid importing mechanisms, there is little to no reason to build any scripting that does the same thing. In other cases, you might go with one of the following makeshift options:&lt;/p&gt;
&lt;ol type=&quot;a&quot;&gt;
&lt;li&gt;
Git clone
&lt;/li&gt;
&lt;li&gt;
Submodule
&lt;/li&gt;
&lt;li&gt;
Pass files via a Docker image
&lt;/li&gt;
&lt;li&gt;
Pass files via S3
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Option a. Git clone&lt;/strong&gt;: This relies on git-cloning one repo from within the other. It’s especially useful when the code itself is needed and not necessarily an artifact resulting from building that code. Here how this might be achieved in a Makefile:&lt;/p&gt;
&lt;!-- markdownlint-disable no-hard-tabs --&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;my-dep:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; ./deps/my-dep&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-2&quot;&gt;&lt;a href=&quot;#cb10-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-3&quot;&gt;&lt;a href=&quot;#cb10-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;./deps/my-dep:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-4&quot;&gt;&lt;a href=&quot;#cb10-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  mkdir -p deps&lt;/span&gt;
&lt;span id=&quot;cb10-5&quot;&gt;&lt;a href=&quot;#cb10-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  rm -rf ./deps/my-dep&lt;/span&gt;
&lt;span id=&quot;cb10-6&quot;&gt;&lt;a href=&quot;#cb10-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  git clone --branch v1.2.3 &amp;lt;clone-url&amp;gt; ./deps/my-dep&lt;/span&gt;
&lt;span id=&quot;cb10-7&quot;&gt;&lt;a href=&quot;#cb10-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-8&quot;&gt;&lt;a href=&quot;#cb10-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;clean:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-9&quot;&gt;&lt;a href=&quot;#cb10-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  rm -rf ./deps&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!-- markdownlint-enable no-hard-tabs --&gt;
&lt;p&gt;Although it’s relatively crude in that it wipes the whole dir and re-clones it when necessary, it’s also pretty robust because there’s nothing assumed about the state of that directory. (Just make sure you’re not making important changes in that directory as those may be lost!)&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;--branch&lt;/code&gt; setting takes any git tag, sha, or branch, or, in general, a git ref. This helps pin the dependency to something specific if that is needed.&lt;/p&gt;
&lt;p&gt;You’ll need to be careful about how you use the &lt;code&gt;&amp;lt;clone-url&amp;gt;&lt;/code&gt; as some engineers will use HTTPS auth, while others will use &lt;code&gt;ssh&lt;/code&gt; auth. You might want to standardize on only one of the two options and use git’s &lt;code&gt;insteadof&lt;/code&gt; feature if an individual developer would like to switch to the other URL.&lt;/p&gt;
&lt;p&gt;For example, if a developer wants to dynamically switch from &lt;code&gt;https://&lt;/code&gt; to SSH GitHub URLs, they can do:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;git&lt;/span&gt; config &lt;span class=&quot;at&quot;&gt;--global&lt;/span&gt; url.&lt;span class=&quot;st&quot;&gt;&amp;quot;git@github.com:&amp;quot;&lt;/span&gt;.insteadOf &lt;span class=&quot;st&quot;&gt;&amp;quot;https://github.com/&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Option b. Submodule&lt;/strong&gt;: This is another popular option especially when the source code itself is also needed. The technique involves relying on the &lt;a href=&quot;https://git-scm.com/book/en/v2/Git-Tools-Submodules&quot;&gt;&lt;code&gt;git submodule&lt;/code&gt;&lt;/a&gt; capabilities built into git.&lt;/p&gt;
&lt;p&gt;The way it works is that git marks certain paths within the repository where submodules (other git repositories) can be cloned into. You can use the following command to add such submodules:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb12&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb12-1&quot;&gt;&lt;a href=&quot;#cb12-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;git&lt;/span&gt; submodule add &lt;span class=&quot;op&quot;&gt;&amp;lt;&lt;/span&gt;clone-url&lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;lt;&lt;/span&gt;path&lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This command clones the referenced repository into that path and also adds a &lt;code&gt;.gitmodules&lt;/code&gt; file in the root of your repository, which might look like this.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb13&quot;&gt;&lt;pre class=&quot;sourceCode toml&quot;&gt;&lt;code class=&quot;sourceCode toml&quot;&gt;&lt;span id=&quot;cb13-1&quot;&gt;&lt;a href=&quot;#cb13-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;submodule&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;&amp;quot;&amp;lt;name&amp;gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-2&quot;&gt;&lt;a href=&quot;#cb13-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;&amp;lt;path&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-3&quot;&gt;&lt;a href=&quot;#cb13-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;&amp;lt;clone-url&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Besides this entry, git internally also stores the git sha of the submoduled repository, so it is tied strongly to a specific version of it.&lt;/p&gt;
&lt;p&gt;Although there is significant tooling out there for working with submodules, some people don’t enjoy them because they require adjusting the typical git workflow to account for maintaining the submodules. In some cases, when submodules are overused, they can create more confusion than necessary. You can tell things can get complex when git comes with commands like &lt;code&gt;git submodule foreach 'git stash'&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;There is much more to submodules than is in scope for this guide, but a good run-down can be found in the &lt;a href=&quot;https://git-scm.com/book/en/v2/Git-Tools-Submodules&quot;&gt;git official documentation&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Option c. Pass files via a Docker image&lt;/strong&gt;: This option involves creating a Docker image that is not really actually run. It is merely used as a package repository.&lt;/p&gt;
&lt;p&gt;The advantage of this technique is that Docker images support tags, which allow for embedding into a release-process-based workflow. This technique is especially useful when artifacts beyond the source code itself are needed. Things like binaries, or generated files.&lt;/p&gt;
&lt;p&gt;However, this option does require repo A to execute a build that packages up the image before it can be used in repo B. If &lt;strong&gt;options a.&lt;/strong&gt; and &lt;strong&gt;b.&lt;/strong&gt; are simply &lt;strong&gt;commit to repo A&lt;/strong&gt; -&amp;gt; &lt;strong&gt;use in repo B&lt;/strong&gt;, for &lt;strong&gt;option c.&lt;/strong&gt; the sequence is &lt;strong&gt;commit to repo A&lt;/strong&gt; -&amp;gt; &lt;strong&gt;wait for CI build of repo A to complete&lt;/strong&gt; -&amp;gt; &lt;strong&gt;use in repo B&lt;/strong&gt;.&lt;/p&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;Side Note&lt;/strong&gt;. If the CI is slow, this can be a productivity hog. To counter this situation, make sure that the individual engineer on the team can build the image independently from the CI, in order to be able to iterate locally quickly.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Here’s how this option works in general.&lt;/p&gt;
&lt;p&gt;Repo A:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb14&quot;&gt;&lt;pre class=&quot;sourceCode dockerfile&quot;&gt;&lt;code class=&quot;sourceCode dockerfile&quot;&gt;&lt;span id=&quot;cb14-1&quot;&gt;&lt;a href=&quot;#cb14-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; scratch&lt;/span&gt;
&lt;span id=&quot;cb14-2&quot;&gt;&lt;a href=&quot;#cb14-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;COPY&lt;/span&gt; ./build/files ./&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb15&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb15-1&quot;&gt;&lt;a href=&quot;#cb15-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; build &lt;span class=&quot;at&quot;&gt;-t&lt;/span&gt; my-registry/my-artifacts:my_tag .&lt;/span&gt;
&lt;span id=&quot;cb15-2&quot;&gt;&lt;a href=&quot;#cb15-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; push my-registry/my-artifacts:my_tag&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Repo B:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;docker pull my-registry/my-artifacts:my_tag
docker create --name output-artifacts my-registry/my-artifacts:my_tag
docker cp output-artifacts:files ./deps/files
docker rm output-artifacts&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The nice thing about this approach is that Docker will use its cache if an artifact has not changed.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Option d. Pass files via S3&lt;/strong&gt;: This option is very similar to &lt;strong&gt;option c.&lt;/strong&gt;, except that it uses an S3 bucket instead of a Docker registry for storing artifacts.&lt;/p&gt;
&lt;p&gt;Although I’ve heard this being used as a viable alternative, I’ve never seen this in action myself. With the wide range of Docker registries available out there, I don’t think this option is necessarily better. If, however, your company for whatever reason cannot provide you with a Docker registry repository, just know that using S3 (or any other cloud blob store) is also a possibility.&lt;/p&gt;
&lt;h2 id=&quot;parallelism-with-makefiles-and-dockerfiles&quot;&gt;Parallelism with Makefiles and Dockerfiles&lt;/h2&gt;
&lt;p&gt;The bread and butter of improving build speed are caching and parallelism. We will look at each of these topics in the context of Makefiles and Dockerfiles.&lt;/p&gt;
&lt;p&gt;Makefiles have parallelism support out of the box. Running any make target with the &lt;code&gt;-j&lt;/code&gt; option tells Make to execute dependencies in parallel (e.g. &lt;code&gt;make -j build&lt;/code&gt;). Although this is a seemingly easy win for performance, it comes with a number of strings attached, that you should be aware of.&lt;/p&gt;
&lt;p&gt;First of all, Make targets are not isolated - they all operate on the same directory. When you run multiple such targets in parallel, you may get very surprising results due to race conditions. Imagine if, for one of your targets, you really want to run a clean build, so you make it depend on the target &lt;code&gt;clean&lt;/code&gt;. And then you have another target, which ensures that your &lt;code&gt;build&lt;/code&gt; directory has been created. Well if these run in parallel, you can imagine how they could get in each other’s way.&lt;/p&gt;
&lt;p&gt;To really make use of this option, you’ll need to design target dependencies with parallelism mindfulness. You’ll need to really think about dependencies whether they need to be built in a certain order, or if they can be built in any order.&lt;/p&gt;
&lt;p&gt;If you need dependencies to be built in a specific order, a great way to achieve that is to use recursive Make calls:&lt;/p&gt;
&lt;!-- markdownlint-disable no-hard-tabs --&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb17&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb17-1&quot;&gt;&lt;a href=&quot;#cb17-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;build:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb17-2&quot;&gt;&lt;a href=&quot;#cb17-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;MAKE&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt; dep1&lt;/span&gt;
&lt;span id=&quot;cb17-3&quot;&gt;&lt;a href=&quot;#cb17-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;MAKE&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt; dep2&lt;/span&gt;
&lt;span id=&quot;cb17-4&quot;&gt;&lt;a href=&quot;#cb17-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;MAKE&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt; dep3&lt;/span&gt;
&lt;span id=&quot;cb17-5&quot;&gt;&lt;a href=&quot;#cb17-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  actually build&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!-- markdownlint-enable no-hard-tabs --&gt;
&lt;p&gt;If dependencies can execute in any order, then declaring them as regular target dependencies will be fine:&lt;/p&gt;
&lt;!-- markdownlint-disable no-hard-tabs --&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb18&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb18-1&quot;&gt;&lt;a href=&quot;#cb18-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;build:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; dep1 dep2 dep3&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-2&quot;&gt;&lt;a href=&quot;#cb18-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  actually build&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!-- markdownlint-enable no-hard-tabs --&gt;
&lt;p&gt;Note that these principles may be difficult to uphold in a large team, as not all engineers will be running the build with the parallel option turned on. So a lot of times the parallelism capability is not tested, and as a result, it can break often. Keep these things in mind as you may need to reinforce the use of parallelism in project READMEs to hopefully be better supported by individual PRs.&lt;/p&gt;
&lt;p&gt;Another, either alternative or complementary option, is to make use of Dockerfile parallelism. With &lt;a href=&quot;https://github.com/moby/buildkit&quot;&gt;Buildkit&lt;/a&gt; turned on (&lt;code&gt;DOCKER_BUILDKIT=1 docker build ...&lt;/code&gt;), Dockerfiles are built with parallelism automatically, if they involve multiple targets. So for example, if you have targets &lt;code&gt;dep1&lt;/code&gt;, &lt;code&gt;dep2&lt;/code&gt; and &lt;code&gt;dep3&lt;/code&gt; and you &lt;code&gt;COPY&lt;/code&gt; files from them like so:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb19&quot;&gt;&lt;pre class=&quot;sourceCode dockerfile&quot;&gt;&lt;code class=&quot;sourceCode dockerfile&quot;&gt;&lt;span id=&quot;cb19-1&quot;&gt;&lt;a href=&quot;#cb19-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; alpine AS build&lt;/span&gt;
&lt;span id=&quot;cb19-2&quot;&gt;&lt;a href=&quot;#cb19-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;COPY&lt;/span&gt; --from=dep1 /output/artifact1 ./&lt;/span&gt;
&lt;span id=&quot;cb19-3&quot;&gt;&lt;a href=&quot;#cb19-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;COPY&lt;/span&gt; --from=dep2 /output/artifact2 ./&lt;/span&gt;
&lt;span id=&quot;cb19-4&quot;&gt;&lt;a href=&quot;#cb19-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;COPY&lt;/span&gt; --from=dep3 /output/artifact3 ./&lt;/span&gt;
&lt;span id=&quot;cb19-5&quot;&gt;&lt;a href=&quot;#cb19-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;RUN&lt;/span&gt; actually build&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then &lt;code&gt;dep1&lt;/code&gt;, &lt;code&gt;dep2&lt;/code&gt;, and &lt;code&gt;dep3&lt;/code&gt; will be executed in parallel. The nice thing about this is that there is nothing shared between these three targets (unlike the Makefile case) and they will just work in parallel. No special considerations are necessary.&lt;/p&gt;
&lt;h2 id=&quot;shared-caching&quot;&gt;Shared Caching&lt;/h2&gt;
&lt;p&gt;Another way to speed up builds is to make use of shared caching. Shared caching is especially relevant in modern CI setups where the CI task is sandboxed. Because the CI is sandboxed, it cannot reuse the result of a previous build.&lt;/p&gt;
&lt;p&gt;There are, of course, CI-supported cache saving features. However, those features are not usable when testing locally. And in the end, all that CI caching does is just upload a file or directory to cloud storage, which can be downloaded later in another instance of the build.&lt;/p&gt;
&lt;p&gt;Dockerfile builds have pretty powerful cache saving and importing capabilities, thanks to the new &lt;a href=&quot;https://github.com/moby/buildkit&quot;&gt;Buildkit&lt;/a&gt; engine. To use these capabilities, you need to first enable Buildkit (&lt;code&gt;DOCKER_BUILDKIT=1 docker build ...&lt;/code&gt;) and then pass the right arguments to turn these features on.&lt;/p&gt;
&lt;p&gt;First, you need to push images together with the cache manifest:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb20&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb20-1&quot;&gt;&lt;a href=&quot;#cb20-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;va&quot;&gt;DOCKER_BUILDKIT&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;1 &lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; build &lt;span class=&quot;at&quot;&gt;-t&lt;/span&gt; my-registry/my-image &lt;span class=&quot;at&quot;&gt;--build-arg&lt;/span&gt; BUILDKIT_INLINE_CACHE=1 .&lt;/span&gt;
&lt;span id=&quot;cb20-2&quot;&gt;&lt;a href=&quot;#cb20-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; push my-registry/my-image&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And then you need to make use of the cache in subsequent builds using &lt;code&gt;--cache-from&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb21&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb21-1&quot;&gt;&lt;a href=&quot;#cb21-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;va&quot;&gt;DOCKER_BUILDKIT&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;1 &lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; build &lt;span class=&quot;at&quot;&gt;--cache-from&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;my-registry/my-image &lt;span class=&quot;at&quot;&gt;-t&lt;/span&gt; my-registry/my-image .&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Doing both in the same command looks like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb22&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb22-1&quot;&gt;&lt;a href=&quot;#cb22-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;va&quot;&gt;DOCKER_BUILDKIT&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;1 &lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; build &lt;span class=&quot;at&quot;&gt;--cache-from&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;my-registry/my-image &lt;span class=&quot;at&quot;&gt;-t&lt;/span&gt; my-registry/my-image &lt;span class=&quot;at&quot;&gt;--build-arg&lt;/span&gt; BUILDKIT_INLINE_CACHE=1 .&lt;/span&gt;
&lt;span id=&quot;cb22-2&quot;&gt;&lt;a href=&quot;#cb22-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;docker&lt;/span&gt; push my-registry/my-image&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If the image does not already exist (or if it does not have a cache manifest embedded), there will be a warning, but the build will work fine otherwise.&lt;/p&gt;
&lt;h2 id=&quot;managing-secrets&quot;&gt;Managing Secrets&lt;/h2&gt;
&lt;p&gt;Mature CI/CD setups often hold more secrets than there are available in the production environment. That’s because they often need access to registries, artifactories, git repositories, as well as staging environments where additional testing can be performed, and also the production environment itself, where live releases are deployed to, together with schema write access to DBs for upgrades, and also possibly S3 access. Wow - that’s a mouthful.&lt;/p&gt;
&lt;p&gt;Oh, did I also mention that the CI runs a ton of code imported from the web? That &lt;code&gt;npm install&lt;/code&gt; one of your colleagues ran in CI will download half the internet. And not all of it is particularly &lt;a href=&quot;https://www.zdnet.com/article/codecov-breach-impacted-hundreds-of-customer-networks/&quot;&gt;trust-worthy&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This whole thing makes for an incredibly risky attack surface. Giving access to build secrets to every developer adds an unnecessary extra dimension to the whole risk.&lt;/p&gt;
&lt;p&gt;However, to be able to reproduce some of the builds, you really need to give at least &lt;em&gt;some&lt;/em&gt; access. At the very least, developers need read access to most Docker registries and package artifactories / package repositories. In fact, if you want to ensure that artifacts and images that make it to production are never created on a developer’s computer (because you don’t know if their specific environment will produce the releasable correctly consistently), you can simply not give out write access to any Docker repository and make it a rule that only the CI may have write access. (You might still need separate, non-production repos for local testing, though).&lt;/p&gt;
&lt;p&gt;For the read access, it’s best if each engineer gets their own account and credentials. In case someone is terminated, you can simply revoke access from that engineer’s account and know that all other credentials are not compromised.&lt;/p&gt;
&lt;p&gt;For reproducing CI/CD failures in pipelines with more sensitive access, you will need to maintain a small list of employees who will receive more privileged production access.&lt;/p&gt;
&lt;p&gt;To share the initial credentials with each engineer, if an email invite feature is not provided by the system, it’s best to use a password manager to send credentials one-to-one. Sometimes this process gets fairly manual in larger teams, but for the reasons mentioned above, it’s important to maintain segregated access.&lt;/p&gt;
&lt;p&gt;For a seamless setup, you can also store build credentials in HashiCorp Vault and use the Vault CLI in scripts to read secrets where they are needed.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb23&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb23-1&quot;&gt;&lt;a href=&quot;#cb23-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;vault&lt;/span&gt; read &lt;span class=&quot;at&quot;&gt;-field&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;foo secret/my-secret&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This may be helpful in setups where extensive use of build credentials is required. Managing a &lt;a href=&quot;https://www.vaultproject.io/docs/install&quot;&gt;Vault installation&lt;/a&gt;, however, is a whole project of its own, and going into those details is perhaps a story for another day.&lt;/p&gt;
&lt;h2 id=&quot;maintaining-consistency&quot;&gt;Maintaining Consistency&lt;/h2&gt;
&lt;p&gt;Now to turn to a more philosophical aspect of builds. A great build setup is one where every engineer can understand what it does fairly quickly and where every engineer can contribute with minimal to no help at all. Although these principles are obvious goals to have, the norm is quite the opposite.&lt;/p&gt;
&lt;p&gt;Engineers don’t have an innate need to mess things up. It’s not like we wake up in the morning trying to make builds cumbersome and complex for everyone else. The issue is usually that builds simply grow organically into an eventual big hairball of mess.&lt;/p&gt;
&lt;p&gt;The result of this is that new team members have difficulty making sense of the build scripts and colleagues from other teams have difficulty in contributing to your team’s project, thus creating integration gaps.&lt;/p&gt;
&lt;p&gt;Think about how this is in your organization. Is it difficult for you to contribute to another team’s codebase? Do you know how to run the project’s unit and integration test suites? Is there even an integration test between the two projects?&lt;/p&gt;
&lt;p&gt;To help teams meld with each other, it’s particularly important to have a standard way to build and test any project in the organization. If the build is containerized and everyone has read access to the right base images, then everyone can build and test each other’s codebases, thus eliminating at least one of the natural barriers that get formed between engineering teams.&lt;/p&gt;
&lt;p&gt;If you want to go a step further, you can even standardize a set of commands for the repositories across the organization. For example:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;make build&lt;/code&gt; - builds the project&lt;/li&gt;
&lt;li&gt;&lt;code&gt;make test&lt;/code&gt; - runs the unit tests&lt;/li&gt;
&lt;li&gt;&lt;code&gt;make integration&lt;/code&gt; - runs the integration tests&lt;/li&gt;
&lt;li&gt;&lt;code&gt;make ci&lt;/code&gt; - executes the same script that is run in CI&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Then your engineers will be able to build another team’s codebase in their sleep!&lt;/p&gt;
&lt;h2 id=&quot;other-options&quot;&gt;Other Options&lt;/h2&gt;
&lt;p&gt;This article wouldn’t be complete without mentioning that if you’re a large organization (thousands of engineers), you can also take a look at some large-scale build systems as popular alternatives to in-house scripts. The names that come to mind are &lt;a href=&quot;https://bazel.build/&quot;&gt;Bazel&lt;/a&gt;, &lt;a href=&quot;https://buck.build/&quot;&gt;Buck&lt;/a&gt; and &lt;a href=&quot;https://v1.pantsbuild.org/&quot;&gt;Pants&lt;/a&gt;. These systems imply heavy organization buy-in and well-staffed build engineering teams to manage them.&lt;/p&gt;
&lt;p&gt;Some of these can provide some of the most advanced capabilities available on planet Earth, however, they do come with the tradeoff that they don’t integrate well with most open-source tooling and so all projects need to be adapted to fit the paradigm.&lt;/p&gt;
&lt;p&gt;If you’d like to get started exploring these, we have previously written about &lt;a href=&quot;https://earthly.dev/blog/monorepo-with-bazel/&quot;&gt;Monorepos and Bazel&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;parting-words-and-mandatory-plug&quot;&gt;Parting Words and Mandatory Plug&lt;/h2&gt;
&lt;p&gt;Getting everyone to write containerized builds is difficult in a growing organization. As you can see from this article, certain operations within containerized builds are not trivial to achieve and the wheel may be reinvented many times across the different teams.&lt;/p&gt;
&lt;p&gt;For these reasons, we have built Earthly. Through Earthly, we wanted to give containerized builds to the world, for the sake of reproducibility. From our own experience, we saw that Dockerfiles alone are not meant as build scripts, but rather as container image definitions. In true Unix philosophy, they are a great tool for that specific job - they do one thing and they do it well. To go the extra step and have containerized builds scripts (not just image definitions), a number of tricks and wrappers are necessary. Earthly takes the best ideas from Dockerfiles and Makefiles and puts them into a unified syntax that anyone can understand at-a-glance.&lt;/p&gt;
&lt;p&gt;Give Earthly a try and tell us what you think via our &lt;a href=&quot;https://earthly.dev/slack&quot;&gt;Slack&lt;/a&gt; or our &lt;a href=&quot;https://github.com/earthly/earthly/issues&quot;&gt;GitHub issue tracker&lt;/a&gt;.&lt;/p&gt;</content><author><name>Vlad A. Ionescu</name></author><category term="Articles" /><category term="Makefile" /><category term="Dockerfile" /><category term="Bash" /><category term="Build scripts" /><category term="Build strategy" /><category term="Repeatable builds" /><category term="Glue layer" /><summary type="html">In our journey to becoming better software engineers we have learned of various ways in which the team’s productivity could be improved. We noticed that a focus on build repeatability and maintainability goes a long way towards keeping the team focused on what really matters: delivering great software. Many of these ideas helped shape what Earthly is today. In fact, the complexity of the matter is what got us to start Earthly in the first place.</summary></entry><entry><title type="html">What Is Continuous Integration?</title><link href="https://earthly.dev/blog/continuous-integration/" rel="alternate" type="text/html" title="What Is Continuous Integration?" /><published>2021-05-17T00:00:00-04:00</published><updated>2021-05-17T00:00:00-04:00</updated><id>https://earthly.dev/blog/continuous-integration</id><content type="html" xml:base="https://earthly.dev/blog/continuous-integration/">&lt;p&gt;Continuous integration has become prevalent in software development, but it’s still a complex and wide-ranging topic. In this post, we’ll cover the basics of continuous integration, the differences between CI and CD, and common CI tools. You’ll also find some tips for the best way to set up CI in your environment.&lt;/p&gt;
&lt;h2 id=&quot;what-is-continuous-integration&quot;&gt;What Is Continuous Integration?&lt;/h2&gt;
&lt;p&gt;Continuous integration (CI) is a set of operating principles and practices in the DevOps process that helps software development teams release faster and more reliable application updates. With the advancement of modern tooling, most CI processes center around automated tests, static analysis, and building releasable software. This process is helpful for teams that want to ensure each update to their software is working, stable, and ready to deploy before they integrate it into their production environment.&lt;/p&gt;
&lt;p&gt;For example, if a team member makes a change to a project, they might make updates on a new branch (assuming they’re using &lt;a href=&quot;https://git-scm.com/&quot;&gt;git for version control&lt;/a&gt;). When complete, they &lt;em&gt;push&lt;/em&gt; these changes to a shared &lt;a href=&quot;/blog/monorepo-vs-polyrepo&quot;&gt;repository&lt;/a&gt; where a continuous integration workflow will automatically install dependencies, run tests, and check for linting errors before merging the changes into the main branch.&lt;/p&gt;
&lt;h2 id=&quot;the-relationship-between-continuous-integration-and-continuous-deliverydeployment&quot;&gt;The Relationship Between Continuous Integration and Continuous Delivery/Deployment&lt;/h2&gt;
&lt;p&gt;Continuous integration is the first part of the CI/CD process. The &lt;em&gt;CD&lt;/em&gt; stands for either &lt;em&gt;continuous delivery&lt;/em&gt; or &lt;em&gt;continuous deployment&lt;/em&gt;. Although these terms are sometimes used interchangeably, they are not quite the same.&lt;/p&gt;
&lt;p&gt;In both cases, code is released in short cycles. However, with continuous delivery, code changes are automatically deployed through the development and &lt;a href=&quot;/blog/unit-vs-integration&quot;&gt;testing stages&lt;/a&gt;, but must be manually reviewed and approved before being batched and released to production.&lt;/p&gt;
&lt;p&gt;With continuous deployment, code changes that successfully pass through all stages of the development process are automatically released to production without human intervention. A failed test along the pipeline is the only event that will prevent a change from reaching production.&lt;/p&gt;
&lt;h3 id=&quot;why-ci-is-important-to-software-development&quot;&gt;Why CI Is Important to Software Development&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;“Continuous integration doesn’t get rid of bugs, but it does make them dramatically easier to find and remove.” – &lt;a href=&quot;http://www.thoughtworks.com/continuous-integration?utm_source=Codeship&amp;amp;utm_medium=CI-Guide&quot; title=&quot;CI explainer at ThoughtWorks&quot;&gt;Martin Fowler&lt;/a&gt;, Chief Scientist, ThoughtWorks&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Before continuous integration became an industry standard, developers’ changes were tested less frequently, often only when it was time to release a new version of the software. This meant the team had to spend unnecessary hours fixing bugs that could have been caught earlier in the process with a robust continuous integration process.&lt;/p&gt;
&lt;p&gt;CI helps developers avoid such problems while increasing productivity. Because code changes are automatically and continuously tested, verified, and built, developers should not have to manually check for integration issues. Because testing in CI is frequent and automated, developers can find and address bugs faster and earlier in the software development life cycle. This promotes a culture that delivers faster, higher-quality releases into production.&lt;/p&gt;
&lt;h2 id=&quot;how-ci-works&quot;&gt;How CI Works&lt;/h2&gt;
&lt;p&gt;CI validates changes upon check-in using an automated build process that also runs validation and integration tests. The continuous integration process aims to detect bugs and errors faster and eliminate the integration issues that occur when developers work in isolation, resulting in higher quality software releases and faster delivery times.&lt;/p&gt;
&lt;h3 id=&quot;a-typical-ci-build-process&quot;&gt;A Typical CI Build Process&lt;/h3&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-integration/r80Ri4R.png&quot; alt=&quot;Earthly integration diagram&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Earthly integration diagram&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;In a typical CI build process, developers push code changes from a branch to a central repository such as GitHub. CI automation servers such as Jenkins and CircleCI continuously monitor the repository to check for code updates.&lt;/p&gt;
&lt;p&gt;Once it detects a change, the automation server triggers the build process to compile and build the code, then run validation and integration tests. CI automation servers interface with compilation tools such as Docker, Bash, and Makefile to create deployable artifacts such as binaries, packages, or Docker images. When continuous deployment is employed, the built application is then deployed and run on subsequent testing or production environments. Other developers can also pull down the resulting image and test locally.&lt;/p&gt;
&lt;p&gt;If the build fails, the development team will typically receive an alert, allowing them to fix any errors that occur.&lt;/p&gt;
&lt;h3 id=&quot;how-has-ci-changed-in-the-past-few-years&quot;&gt;How Has CI Changed in the Past Few Years?&lt;/h3&gt;
&lt;p&gt;CI became popular as an integral part of agile software development but has since developed into one of the pillars of the DevOps process. Guided by key principles such as revision control, software integration, and build automation, it is now an industry standard in software development.&lt;/p&gt;
&lt;p&gt;As DevOps practices &lt;a href=&quot;https://www.novelvista.com/blogs/project-management/3-devops-trends-in-2020&quot; title=&quot;NovelVista blog on DevOps changes in 2020&quot;&gt;continue to evolve&lt;/a&gt;, we see trends moving toward self-service and a more cloud-centric model to give developers more autonomy. Because of COVID-19, CIOs and other IT leaders have recognized the need to adjust and adapt to support more cloud-based workflows and applications. Moving forward, cloud-native approaches, including multi-cloud solutions, will become the standard for hosting, pipelines, storage, and load balancing.&lt;/p&gt;
&lt;p&gt;As part of the self-service trend, developers will no longer have to wait for a separate operations team to dispatch new applications or updates, but will instead be able to build DevOps infrastructure that allows them to deploy updates themselves. Self-service capabilities are already available today for several DevOps processes, including development environments, CI/CD workflows, and audit logging.&lt;/p&gt;
&lt;h2 id=&quot;common-tools-for-ci&quot;&gt;Common Tools for CI&lt;/h2&gt;
&lt;p&gt;Your choice of CI tools will largely depend on your business requirements, the tech stack you already have or plan to implement, and your daily workflow. There are many CI tools and solutions to choose from. Let’s look at four of them.&lt;/p&gt;
&lt;h3 id=&quot;jenkins&quot;&gt;Jenkins&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://www.jenkins.io/&quot;&gt;Jenkins&lt;/a&gt; is the most well-known continuous integration tool and has a reputation for reliability. Written in Java, it’s an open-source cross-platform tool with a large community following that contributes to its development.&lt;/p&gt;
&lt;p&gt;Jenkins works as a standalone CI server or a continuous delivery platform and offers several features to support the entire software development life cycle, including automated builds and testing, code debugging and analysis, and project deployment.&lt;/p&gt;
&lt;p&gt;It can run on any operating system including Windows, OS X, and Unix, and you can easily configure it via a web GUI interface or console commands. Jenkins is highly extensible; thanks to its robust ecosystem of almost 1400 plugins, you can add several features for user interface, platform integration, source code management and builds, and administrative tasks.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Where is it hosted?&lt;/strong&gt; Self-hosted; cloud&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;What platform does it run?&lt;/strong&gt; Containers; virtual machines&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;What is its pricing model?&lt;/strong&gt; Open source&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-integration/xoiqawt.png&quot; alt=&quot;Jenkins CI/CD Tool&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Jenkins CI/CD Tool&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;circleci&quot;&gt;CircleCI&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://circleci.com/&quot;&gt;CircleCI&lt;/a&gt; is an excellent platform for build automation and testing along with a branch-focused deployment process. It integrates seamlessly with several version control systems, container systems, and delivery mechanisms, including GitHub and Bitbucket as well as build tools such as Gradle and Apache Maven. You can host CircleCI on premise or integrate it with AWS, Google Cloud, and other cloud services. It’s highly customizable and performance-optimized for quick builds, and it also provides analytics to measure build performance.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Where is it hosted?&lt;/strong&gt; Self-hosted; cloud&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;What platform does it run?&lt;/strong&gt; Containers; virtual machine&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;What is its pricing model?&lt;/strong&gt; Free entry-level version; Premium starts at $30&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-integration/HmA7mZy.png&quot; title=&quot;Circle CI CI/CD tool&quot; alt=&quot;Circle CI CI/CD tool&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Circle CI CI/CD tool&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;github-actions&quot;&gt;GitHub Actions&lt;/h3&gt;
&lt;p&gt;Introduced in 2018, &lt;a href=&quot;https://github.com/features/actions&quot;&gt;GitHub Actions&lt;/a&gt; is one of the newer tools in the CI/CD tech stack. It is fully integrated within GitHub, making it manageable from a single place.&lt;/p&gt;
&lt;p&gt;Integration with GitHub means you can build, test, and deploy code directly from your GitHub repository. GitHub manages the execution and provides feedback and security for the entire CI process.&lt;/p&gt;
&lt;p&gt;GitHub Actions offers a wide range of automation tasks and actions that allow you to create, share, reuse, and branch software development workflows directly in your GitHub repository. It also supports Docker for multi-container testing and offers several CI templates.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Where is it hosted?&lt;/strong&gt; Self-hosted; cloud&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;What platform does it run?&lt;/strong&gt; Container; virtual machine&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;What is its pricing model?&lt;/strong&gt; Free for public repositories and self-hosted runners. For private repositories, build minutes/month depend on account type and spending limits&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-integration/Gu0ruur.png&quot; title=&quot;GitHub Actions CI/CD tool&quot; alt=&quot;GitHub Actions CI/CD tool&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;GitHub Actions CI/CD tool&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;azure-devops&quot;&gt;Azure DevOps&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://azure.microsoft.com/en-us/services/devops/&quot;&gt;Azure DevOps&lt;/a&gt; by Microsoft is a platform for creating a CI/CD pipeline to Azure. It provides several advanced features and services that support the software development cycle from planning to deployment. Azure DevOps integrates with both Team Foundation Version Control and Git for version control, code repository management, and build automation.&lt;/p&gt;
&lt;p&gt;Azure DevOps also integrates with major languages and platforms, allowing you to build, test and deploy in Java, .Net, Android, or iOS. It also runs parallel on Linux, macOS, and Windows and on both virtual machines and containers.&lt;/p&gt;
&lt;p&gt;One standout feature of Azure DevOps is that it supports automated load testing, which can simulate thousands of users using your app at the same time. This helps your developers uncover bottlenecks and improve throughput before an application is released.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Where is it hosted?&lt;/strong&gt; Self-hosted; cloud&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;What platform does it run?&lt;/strong&gt; Container; virtual machine&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;What is its pricing model?&lt;/strong&gt; Free up to a specific number of builds, but build servers can be reserved at a cost for higher volumes&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-integration/iIfItCx.png&quot; title=&quot;Azure DevOps CI/CD Tool&quot; alt=&quot;Azure DevOps CI/CD Tool&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Azure DevOps CI/CD Tool&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;continuous-integration-best-practices&quot;&gt;Continuous Integration Best Practices&lt;/h2&gt;
&lt;p&gt;To get the most out of your CI process, you’ll need to set it up with the following best practices: consistency between environments, disciplined use of the CI/CD pipeline (no sidestepping it for special cases), prioritizing tests by speed, and the “Build Once” practice.&lt;/p&gt;
&lt;h3 id=&quot;strive-for-consistency-between-environments&quot;&gt;Strive for Consistency Between Environments&lt;/h3&gt;
&lt;p&gt;We’ve all had it happen: code that works perfectly in your development environment throws a hissy fit in production.&lt;/p&gt;
&lt;p&gt;Your CI environment should either match production exactly or be customized in a way that mitigates any bugs that might happen due to the difference in the two environments. The wider the difference between your development or staging and production environments, the less accurate your tests will be in showing how the code will perform in the real world.&lt;/p&gt;
&lt;p&gt;A few ways to make sure that your environments are consistent are as follows:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Using &lt;a href=&quot;https://www.redhat.com/en/topics/devops/what-is-blue-green-deployment&quot;&gt;blue-green deployments&lt;/a&gt;. This release strategy involves running two parallel versions of the production environment and involves using a load balancer to swap production traffic between two environments alternately designated as production (green) and staging (blue).&lt;/li&gt;
&lt;li&gt;Deploy a scaled-down version of your production environment to your development or staging environment. If you’re using this method, ensure that the code is consistent and that differences between the two environments are well-documented.&lt;/li&gt;
&lt;li&gt;Use a clone of the production environment to make sure that your CI environment is an exact match.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;all-deployments-must-go-through-ci&quot;&gt;All Deployments Must Go Through CI&lt;/h3&gt;
&lt;p&gt;CI acts as a watchman to enforce best practices in the development process and ensure that changes are in line with your company’s standards and procedures. A failure during integration is flagged immediately and prevents the affected code from moving forward into other parts of the development process. This protects subsequent environments like production from untrusted or error-prone code.&lt;/p&gt;
&lt;p&gt;For CI to be successful, you’ll need to make sure that the CI/CD pipeline is the only mechanism through which code enters your production environment. This could be via continuous delivery with manual approval processes and batched releases or through automated continuous deployment practices.&lt;/p&gt;
&lt;p&gt;Development teams may feel pressured to make exceptions and circumvent the CI process when problems arise. It’s tempting to bypass the system to mitigate excessive downtime and fix other issues as soon as possible, but adhering to the CI/CD pipeline helps ensure that the changes being made won’t worsen the current problem or introduce new ones.&lt;/p&gt;
&lt;p&gt;Sending all changes through the CI/CD pipeline helps to protect the integrity of your deployments and prevents ad hoc fixes from being erased by subsequent updates.&lt;/p&gt;
&lt;h3 id=&quot;run-your-fastest-testschecks-first&quot;&gt;Run Your Fastest Tests/Checks First&lt;/h3&gt;
&lt;p&gt;The general goal of the CI/CD process is to provide rapid feedback to developers and promote rapid software delivery to users. You want to keep the entire pipeline fast, but the reality is that some parts will be faster than others. If developers have to wait too long to get feedback from testing, they might look for ways around the process.&lt;/p&gt;
&lt;p&gt;Because you want to discover failures as early as possible, prioritize and run the tests that complete quickest first and leave longer running tests until later.&lt;/p&gt;
&lt;p&gt;This usually means running your unit tests first, as those are faster, make up most of your tests, and can give you immediate feedback on bugs and errors introduced by the latest update. After unit testing is complete, run integration tests next to see how different parts of your code interact. Then follow up with system-wide tests such as GUI, performance, load and security tests, and manual acceptance tests.&lt;/p&gt;
&lt;h3 id=&quot;build-only-once-and-promote-the-result-through-the-pipeline&quot;&gt;Build Only Once and Promote the Result Through the Pipeline&lt;/h3&gt;
&lt;p&gt;One aim of CI/CD is to ensure that your end product is robust and won’t produce unexpected results. This is why it’s important to perform your build step only once and then advance resulting binaries through the entire pipeline. Software builds that occur separately at each new stage of the pipeline can introduce inconsistencies, and tests completed in earlier environments become invalid because they may not be targeting the same software that is eventually deployed.&lt;/p&gt;
&lt;p&gt;In the “Build Once” best practice, the build process always occurs as the first step in the pipeline, and the resulting artifact is versioned and uploaded to the central repository where it can be pulled and used in the later stages. This ensures that the build does not change as it moves through the pipeline.&lt;/p&gt;
&lt;h2 id=&quot;whats-next&quot;&gt;What’s Next?&lt;/h2&gt;
&lt;p&gt;Continuous integration speeds up the software development process and helps development teams avoid common pitfalls such as broken application builds, and chaotic release cycles. Rather than catching issues just before (or even after) they’re released, continuous integration allows you to mitigate errors &lt;em&gt;while&lt;/em&gt; you’re working on a feature.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; is a free and open-source build automation tool that works with your existing build systems to create repeatable, containerized, language-agnostic builds. It acts as a layer between language-specific tools such as Gradle and Apache Maven and the CI buildspec and allows for faster iteration on build scripts and easier debugging. You can discuss automation and other topics in the &lt;a href=&quot;https://earthly.dev/slack&quot;&gt;Earthly Community on Slack&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To find out more about how Earthly can help you simplify your CI systems, check us out on &lt;a href=&quot;https://github.com/earthly/earthly&quot; title=&quot;Earthly build automation tool documentation and download&quot;&gt;GitHub&lt;/a&gt;. With CI automation in place, developers can push changes more frequently, get faster feedback, and ensure that every change is integrated, tested, and verified.&lt;/p&gt;</content><author><name>Deborah Ruck</name></author><category term="Articles" /><summary type="html">Continuous integration has become prevalent in software development, but it’s still a complex and wide-ranging topic. In this post, we’ll cover the basics of continuous integration, the differences between CI and CD, and common CI tools. You’ll also find some tips for the best way to set up CI in your environment.</summary></entry><entry><title type="html">DOS Gaming In Docker</title><link href="https://earthly.dev/blog/dos-gaming-in-docker/" rel="alternate" type="text/html" title="DOS Gaming In Docker" /><published>2021-05-12T00:00:00-04:00</published><updated>2021-05-12T00:00:00-04:00</updated><id>https://earthly.dev/blog/dos-gaming-in-docker</id><content type="html" xml:base="https://earthly.dev/blog/dos-gaming-in-docker/">&lt;p&gt;Its been three decades since the height of the DOS era, and look how far we’ve come! A machine that used to cost $2,000 can be emulated - &lt;em&gt;down to the processor!&lt;/em&gt; — in our &lt;a href=&quot;https://bellard.org/jslinux/&quot;&gt;&lt;em&gt;web browsers&lt;/em&gt;&lt;/a&gt; while also checking email or watching a YouTube video. However, amidst these advancements, our old software falls by the wayside and stops working. Games are especially prone to this, since they often relied on incompatible tricks to eke out every ounce of performance from these old machines.&lt;/p&gt;
&lt;p&gt;Many projects have sprung up to help preserve this heritage. &lt;a href=&quot;https://www.dosbox.com/&quot;&gt;DOSBox&lt;/a&gt; provides a modern, compatible environment for old games (and other software), while projects like the &lt;a href=&quot;https://archive.org/details/software&quot;&gt;Internet Archive&lt;/a&gt; provide a massive library of DOS games, freely available to play in your browser. In my experience, they play pretty well!&lt;/p&gt;
&lt;p&gt;However, I still miss those less-connected days of the early 90’s. I remember the thrill of riding my bike to the store to pick up a shareware copy of whatever game was available for $1. I then held a physical disk, with the game on it, ready to install on the nearest accessible computer. The self-contained nature of it all was magical. Nowadays, many &lt;em&gt;web pages&lt;/em&gt; &lt;a href=&quot;https://www.pingdom.com/blog/webpages-are-getting-larger-every-year-and-heres-why-it-matters/&quot;&gt;are bigger than the shareware games I used to buy&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This got me thinking: “Floppies can be &lt;a href=&quot;https://www.kryoflux.com/&quot;&gt;imaged&lt;/a&gt;. That sounds kind of like a Docker image. I wonder… could I make DOS shareware Docker images?”&lt;/p&gt;
&lt;p&gt;Turns out you can!&lt;/p&gt;
&lt;h2 id=&quot;what-you-will-need&quot;&gt;What You Will Need&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/caiiiycuk/js-dos&quot;&gt;JS-DOS 6.22&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;A copy of a Shareware game&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://hub.docker.com/_/node&quot;&gt;NodeJS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.docker.com/get-started&quot;&gt;Docker&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; (Optional, but I think it’s neat!)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;putting-it-together&quot;&gt;Putting It Together&lt;/h2&gt;
&lt;p&gt;First, we will need to acquire JS-DOS. JS-DOS is a wrapper around an Emscripten-compiled version of &lt;a href=&quot;https://www.dosbox.com&quot;&gt;DOSBox&lt;/a&gt;, so it can run in a browser. You can get the latest versions of the files &lt;a href=&quot;https://js-dos.com/#js-dos-622-archives&quot;&gt;here&lt;/a&gt;. Download and place these files into a project directory. Here’s how I’m doing it, using Docker:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode dockerfile&quot;&gt;&lt;code class=&quot;sourceCode dockerfile&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;WORKDIR&lt;/span&gt; site&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;RUN&lt;/span&gt; wget https://js-dos.com/6.22/current/js-dos.js &amp;amp;&amp;amp; \&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    wget https://js-dos.com/6.22/current/wdosbox.js &amp;amp;&amp;amp; \&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    wget https://js-dos.com/6.22/current/wdosbox.wasm.js&lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;RUN&lt;/span&gt; npm install -g serve&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;JS-DOS is nice, but it’s nothing without a game to play in it. For our example purposes, we’ll use one of my childhood favorites: &lt;a href=&quot;https://3drealms.com/catalog/secret-agent_39/&quot;&gt;Secret Agent&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;notice--warning&quot;&gt;
&lt;p&gt;&lt;strong&gt;❗ Warning&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;A couple things to note when you are looking for games:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Make sure that the game you choose is &lt;em&gt;actually&lt;/em&gt; shareware. &lt;a href=&quot;https://www.youtube.com/watch?v=up863eQKGUI&quot;&gt;Don’t copy that floppy!&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Make sure that it is the actual game files, not just the installer.
&lt;ul&gt;
&lt;li&gt;While you &lt;em&gt;can&lt;/em&gt; install and &lt;em&gt;then&lt;/em&gt; run the game via DOSBox, you’ll have to install it on every visit to the webpage. The installation is also fairly slow.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Make sure that it is a &lt;code&gt;zip&lt;/code&gt; file. This is what JS-DOS wants to load for us.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;p&gt;Heres how I add the game to our image:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode dockerfile&quot;&gt;&lt;code class=&quot;sourceCode dockerfile&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;ARG&lt;/span&gt; GAME_URL&lt;/span&gt;
&lt;span id=&quot;cb2-2&quot;&gt;&lt;a href=&quot;#cb2-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;RUN&lt;/span&gt; wget -O game.zip $GAME_URL&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;ℹ️ Note&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;You may note that we don’t preserve the name of the downloaded file here. This is to make our job easier, when we make the game accessible to play later.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;If you built and ran the Dockerfile at this point, you would have an image containing Node, JS-DOS, and a zip file of your beloved game; but no way to play it! To make it playable, we need to create a webpage which loads JS-DOS, loads our game, and provides a canvas for JS-DOS to render its output to. Here is my tiny webpage:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode html&quot;&gt;&lt;code class=&quot;sourceCode html&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;&amp;lt;style&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;text/css&amp;quot;&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;screen&amp;quot;&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      canvas {&lt;/span&gt;
&lt;span id=&quot;cb3-4&quot;&gt;&lt;a href=&quot;#cb3-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          &lt;span class=&quot;kw&quot;&gt;width&lt;/span&gt;: &lt;span class=&quot;dv&quot;&gt;800&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;px&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt; &lt;/span&gt;
&lt;span id=&quot;cb3-5&quot;&gt;&lt;a href=&quot;#cb3-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          &lt;span class=&quot;kw&quot;&gt;height&lt;/span&gt;: &lt;span class=&quot;dv&quot;&gt;600&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;px&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-6&quot;&gt;&lt;a href=&quot;#cb3-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      }&lt;/span&gt;
&lt;span id=&quot;cb3-7&quot;&gt;&lt;a href=&quot;#cb3-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;&amp;lt;/style&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-8&quot;&gt;&lt;a href=&quot;#cb3-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-9&quot;&gt;&lt;a href=&quot;#cb3-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;DOS Game!&lt;span class=&quot;kw&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-10&quot;&gt;&lt;a href=&quot;#cb3-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;&amp;lt;script&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;js-dos.js&amp;quot;&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-11&quot;&gt;&lt;a href=&quot;#cb3-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-12&quot;&gt;&lt;a href=&quot;#cb3-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-13&quot;&gt;&lt;a href=&quot;#cb3-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;&amp;lt;canvas&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;jsdos&amp;quot;&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;800&amp;quot;&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;600&amp;quot;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;&amp;gt;&amp;lt;/canvas&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-14&quot;&gt;&lt;a href=&quot;#cb3-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-15&quot;&gt;&lt;a href=&quot;#cb3-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      &lt;span class=&quot;fu&quot;&gt;Dos&lt;/span&gt;(&lt;span class=&quot;bu&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;getElementById&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;jsdos&amp;quot;&lt;/span&gt;)&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&quot;cb3-16&quot;&gt;&lt;a href=&quot;#cb3-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      })&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;ready&lt;/span&gt;((fs&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; main) &lt;span class=&quot;kw&quot;&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&quot;cb3-17&quot;&gt;&lt;a href=&quot;#cb3-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        fs&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;extract&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;game.zip&amp;quot;&lt;/span&gt;)&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;then&lt;/span&gt;(() &lt;span class=&quot;kw&quot;&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&quot;cb3-18&quot;&gt;&lt;a href=&quot;#cb3-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          &lt;span class=&quot;fu&quot;&gt;main&lt;/span&gt;([&lt;span class=&quot;st&quot;&gt;&amp;quot;-c&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; GAME_ARGS])&lt;/span&gt;
&lt;span id=&quot;cb3-19&quot;&gt;&lt;a href=&quot;#cb3-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        })&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-20&quot;&gt;&lt;a href=&quot;#cb3-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      })&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-21&quot;&gt;&lt;a href=&quot;#cb3-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-22&quot;&gt;&lt;a href=&quot;#cb3-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-23&quot;&gt;&lt;a href=&quot;#cb3-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;ℹ️ Note&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;GAME_ARGS&lt;/code&gt; is the command for DOSBox (which is inside JS-DOS) to start once it is loaded. The CLI arguments should line up with what a regular installation of DOSBox would expect. If your game requires additional arguments, please provide them in a comma-separated list.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Copy this html file into the same directory as your JS-DOS files and your game. Now all you need to do is start a server within our Docker container to serve this webpage. For this, I used &lt;a href=&quot;https://www.npmjs.com/package/serve&quot;&gt;&lt;code&gt;serve&lt;/code&gt;&lt;/a&gt;, because it was quick and easy to script (you may have noticed installing this dependency alongside JS-DOS earlier). Heres how I add the server to the container:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode dockerfile&quot;&gt;&lt;code class=&quot;sourceCode dockerfile&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;ARG&lt;/span&gt; GAME_ARGS&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;COPY&lt;/span&gt; index.html .&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;RUN&lt;/span&gt; sed -i s/GAME_ARGS/$GAME_ARGS/ index.html&lt;/span&gt;
&lt;span id=&quot;cb4-4&quot;&gt;&lt;a href=&quot;#cb4-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-5&quot;&gt;&lt;a href=&quot;#cb4-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;ENTRYPOINT&lt;/span&gt; npx serve -l tcp://0.0.0.0:8000&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And now we have a shareable Docker container, with playable shareware inside! You can now play the game by:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; docker build &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-2&quot;&gt;&lt;a href=&quot;#cb5-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;at&quot;&gt;--build-arg&lt;/span&gt; GAME_URL=https://archive.org/download/msdos_festival_SCORCH15/SCORCH15.ZIP &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-3&quot;&gt;&lt;a href=&quot;#cb5-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;at&quot;&gt;--build-arg&lt;/span&gt; GAME_ARGS=&lt;span class=&quot;dt&quot;&gt;\&amp;quot;&lt;/span&gt;SCORCH.EXE&lt;span class=&quot;dt&quot;&gt;\&amp;quot;&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-4&quot;&gt;&lt;a href=&quot;#cb5-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;at&quot;&gt;-p&lt;/span&gt; 127.0.0.1:8000:8000 &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-5&quot;&gt;&lt;a href=&quot;#cb5-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;at&quot;&gt;-t&lt;/span&gt; mycool:dosgame .&lt;/span&gt;
&lt;span id=&quot;cb5-6&quot;&gt;&lt;a href=&quot;#cb5-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-7&quot;&gt;&lt;a href=&quot;#cb5-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;...&lt;/span&gt; &lt;/span&gt;
&lt;span id=&quot;cb5-8&quot;&gt;&lt;a href=&quot;#cb5-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-9&quot;&gt;&lt;a href=&quot;#cb5-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; docker run &lt;span class=&quot;at&quot;&gt;--rm&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-p&lt;/span&gt; 127.0.0.1:8000:8000 mycool:dosgame&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;going-further&quot;&gt;Going Further&lt;/h2&gt;
&lt;p&gt;Using Earthly, we can even go a step further! Earhly lets us separate some of the concerns within the Dockerfile:&lt;/p&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;ℹ️ About Earthly&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; makes creating Docker images easier. &lt;a href=&quot;https://docs.earthly.dev/basics&quot;&gt;Take it for a spin!&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode dockerfile&quot;&gt;&lt;code class=&quot;sourceCode dockerfile&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;jsdos:&lt;/span&gt;
&lt;span id=&quot;cb6-2&quot;&gt;&lt;a href=&quot;#cb6-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; node:16-alpine&lt;/span&gt;
&lt;span id=&quot;cb6-3&quot;&gt;&lt;a href=&quot;#cb6-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-4&quot;&gt;&lt;a href=&quot;#cb6-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;WORKDIR&lt;/span&gt; site&lt;/span&gt;
&lt;span id=&quot;cb6-5&quot;&gt;&lt;a href=&quot;#cb6-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;RUN&lt;/span&gt; wget https://js-dos.com/6.22/current/js-dos.js &amp;amp;&amp;amp; \&lt;/span&gt;
&lt;span id=&quot;cb6-6&quot;&gt;&lt;a href=&quot;#cb6-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        wget https://js-dos.com/6.22/current/wdosbox.js &amp;amp;&amp;amp; \&lt;/span&gt;
&lt;span id=&quot;cb6-7&quot;&gt;&lt;a href=&quot;#cb6-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        wget https://js-dos.com/6.22/current/wdosbox.wasm.js&lt;/span&gt;
&lt;span id=&quot;cb6-8&quot;&gt;&lt;a href=&quot;#cb6-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;RUN&lt;/span&gt; npm install -g serve&lt;/span&gt;
&lt;span id=&quot;cb6-9&quot;&gt;&lt;a href=&quot;#cb6-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-10&quot;&gt;&lt;a href=&quot;#cb6-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;game:&lt;/span&gt;
&lt;span id=&quot;cb6-11&quot;&gt;&lt;a href=&quot;#cb6-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; +jsdos&lt;/span&gt;
&lt;span id=&quot;cb6-12&quot;&gt;&lt;a href=&quot;#cb6-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-13&quot;&gt;&lt;a href=&quot;#cb6-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;ARG&lt;/span&gt; GAME_URL&lt;/span&gt;
&lt;span id=&quot;cb6-14&quot;&gt;&lt;a href=&quot;#cb6-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;RUN&lt;/span&gt; wget -O game.zip $GAME_URL&lt;/span&gt;
&lt;span id=&quot;cb6-15&quot;&gt;&lt;a href=&quot;#cb6-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-16&quot;&gt;&lt;a href=&quot;#cb6-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;web:&lt;/span&gt;
&lt;span id=&quot;cb6-17&quot;&gt;&lt;a href=&quot;#cb6-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;FROM&lt;/span&gt; +game&lt;/span&gt;
&lt;span id=&quot;cb6-18&quot;&gt;&lt;a href=&quot;#cb6-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-19&quot;&gt;&lt;a href=&quot;#cb6-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;ARG&lt;/span&gt; GAME_ARGS&lt;/span&gt;
&lt;span id=&quot;cb6-20&quot;&gt;&lt;a href=&quot;#cb6-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;COPY&lt;/span&gt; index.html .&lt;/span&gt;
&lt;span id=&quot;cb6-21&quot;&gt;&lt;a href=&quot;#cb6-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;RUN&lt;/span&gt; sed -i s/GAME_ARGS/$GAME_ARGS/ index.html&lt;/span&gt;
&lt;span id=&quot;cb6-22&quot;&gt;&lt;a href=&quot;#cb6-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-23&quot;&gt;&lt;a href=&quot;#cb6-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;ENTRYPOINT&lt;/span&gt; npx serve -l tcp://0.0.0.0:8000&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;But it also lets us build &lt;em&gt;and launch&lt;/em&gt; the game with a single command. It will also end up saving the game for you as an image on your local system! Here is the additional target that I added to accomplish this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb7&quot;&gt;&lt;pre class=&quot;sourceCode dockerfile&quot;&gt;&lt;code class=&quot;sourceCode dockerfile&quot;&gt;&lt;span id=&quot;cb7-1&quot;&gt;&lt;a href=&quot;#cb7-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;play:&lt;/span&gt;
&lt;span id=&quot;cb7-2&quot;&gt;&lt;a href=&quot;#cb7-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    LOCALLY&lt;/span&gt;
&lt;span id=&quot;cb7-3&quot;&gt;&lt;a href=&quot;#cb7-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb7-4&quot;&gt;&lt;a href=&quot;#cb7-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;ARG&lt;/span&gt; GAME_TAG&lt;/span&gt;
&lt;span id=&quot;cb7-5&quot;&gt;&lt;a href=&quot;#cb7-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb7-6&quot;&gt;&lt;a href=&quot;#cb7-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    WITH DOCKER --load jsdos:$GAME_TAG=+web&lt;/span&gt;
&lt;span id=&quot;cb7-7&quot;&gt;&lt;a href=&quot;#cb7-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;kw&quot;&gt;RUN&lt;/span&gt; docker inspect jsdos:$GAME_TAG &amp;gt; /dev/null &amp;amp;&amp;amp; \ &lt;span class=&quot;co&quot;&gt;#Using side-effect to save image locally too&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb7-8&quot;&gt;&lt;a href=&quot;#cb7-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            docker run --rm -p 127.0.0.1:8000:8000 jsdos:$GAME_TAG&lt;/span&gt;
&lt;span id=&quot;cb7-9&quot;&gt;&lt;a href=&quot;#cb7-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    END&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We also have a couple pre-made targets that wrap this all up for you, and all you need to do is have &lt;a href=&quot;https://earthly.dev/get-earthly&quot;&gt;Earthly installed&lt;/a&gt;! Running any of these commands will start the game. Just navigate on over to &lt;a href=&quot;http://localhost:8000&quot;&gt;localhost:8000&lt;/a&gt; and start playing! Additionally, you will find a Docker image on your system named &lt;code&gt;jsdos:$GAME_TAG&lt;/code&gt; for when you want to play later.&lt;/p&gt;
&lt;img src=&quot;/blog/assets/images/dos-gaming-in-docker/doom.png&quot; title=&quot;fig:&quot; alt=&quot;Screenshot of id’s Doom running in a web browser.&quot; /&gt;
&lt;figcaption&gt;
&lt;code&gt;earthly github.com/dchw/earthly-dos-gaming:main+doom&lt;/code&gt;
&lt;/figcaption&gt;
&lt;img src=&quot;/blog/assets/images/dos-gaming-in-docker/agent.png&quot; title=&quot;fig:&quot; alt=&quot;Screenshot of Apogee’s Secret Agent running in a web browser.&quot; /&gt;
&lt;figcaption&gt;
&lt;code&gt;earthly github.com/dchw/earthly-dos-gaming:main+cosmo&lt;/code&gt;
&lt;/figcaption&gt;
&lt;img src=&quot;/blog/assets/images/dos-gaming-in-docker/cosmo.png&quot; title=&quot;fig:&quot; alt=&quot;Screenshot of Apogee’s Cosmos Cosmic Adventure running in a web browser.&quot; /&gt;
&lt;figcaption&gt;
&lt;code&gt;earthly github.com/dchw/earthly-dos-gaming:main+secretagent&lt;/code&gt;
&lt;/figcaption&gt;
&lt;p&gt;You can run your own dos games by running:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;earthly \
    --build-arg GAME_TAG=doom \
    --build-arg GAME_URL=https://archive.org/download/DoomsharewareEpisode/doom.ZIP \
    --build-arg GAME_ARGS=\&amp;quot;DOOM.EXE\&amp;quot; \
    github.com/dchw/earthly-dos-gaming:main+play&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Make sure you replace the tag, URL, and args as appropriate.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;It’s neat that we can make independent, offline bundles, similar to those shareware floppy disks from back in the day. To see the project as a whole, check out the &lt;a href=&quot;https://github.com/earthly/example-dos-gaming&quot;&gt;repository&lt;/a&gt;. Thanks for reading!&lt;/p&gt;</content><author><name>Corey Larson</name></author><category term="Tutorials" /><summary type="html">Distributing shareware from the 90's in modern Docker images.</summary></entry><entry><title type="html">Building a Monorepo with Bazel</title><link href="https://earthly.dev/blog/monorepo-with-bazel/" rel="alternate" type="text/html" title="Building a Monorepo with Bazel" /><published>2021-05-11T00:00:00-04:00</published><updated>2021-05-11T00:00:00-04:00</updated><id>https://earthly.dev/blog/monorepo-with-bazel</id><content type="html" xml:base="https://earthly.dev/blog/monorepo-with-bazel/">&lt;p&gt;A &lt;em&gt;&lt;a href=&quot;/blog/monorepo-vs-polyrepo&quot;&gt;monorepo&lt;/a&gt;&lt;/em&gt; is perhaps what you would expect from the name: a single code repository for your entire codebase.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Monorepo&quot;&gt;Wikipedia&lt;/a&gt; describes it as a decade-old software development strategy for storing all your code in a single repository, but you can also think of it as a higher-level architecture pattern for governing loosely tied applications. For instance, if you have a full-stack web application stored in one repository and an Android client in another, a monorepo would essentially wrap them in the same repository codebase.&lt;/p&gt;
&lt;h2 id=&quot;who-uses-monorepos-and-why&quot;&gt;Who Uses Monorepos and Why?&lt;/h2&gt;
&lt;p&gt;Google is one of the most notable adopters of the monorepo pattern, and &lt;a href=&quot;https://bazel.build/users.html#whos-using-bazel&quot;&gt;companies&lt;/a&gt; like Dropbox, LinkedIn, and Uber use monorepos to manage their large codebases. This is because large-scale projects having little or no dependency on each other can be developed, tested, and built without bisecting them into smaller projects.&lt;/p&gt;
&lt;p&gt;If you’re from a JavaScript or &lt;a href=&quot;https://www.npmjs.com/&quot;&gt;npm&lt;/a&gt; background, you can think of a monorepo as a project having a single &lt;code&gt;package.json&lt;/code&gt; file for managing all your project dependencies. It also allows you to easily share code between multiple environments using isolated modules as published packages. You can configure a single bundler for performing unit tests, integration tests, and other configurations without worrying about language and ecosystem-specific configurations.&lt;/p&gt;
&lt;h2 id=&quot;the-efficiency-of-building-a-monorepo-with-bazel&quot;&gt;The Efficiency of Building a Monorepo with Bazel&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.bazel.build/versions/4.0.0/bazel-overview.html&quot;&gt;Bazel&lt;/a&gt; is an open-source build tool developed by Google to give power and life to your monorepo. It’s similar to other build tools like &lt;a href=&quot;https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html&quot;&gt;Maven&lt;/a&gt;, &lt;a href=&quot;https://gradle.org/&quot;&gt;Gradle&lt;/a&gt;, and &lt;a href=&quot;https://buck.build/&quot;&gt;Buck&lt;/a&gt;, but it has a number of advantages:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Bazel supports multiple languages (Java, JavaScript, Go, C++, to name a few) and platforms (Linux, macOS, and Windows).&lt;/li&gt;
&lt;li&gt;It’s built with &lt;a href=&quot;https://docs.rs/starlark/0.3.1/starlark/&quot;&gt;Starlark&lt;/a&gt;, a high-level language similar to Python that allows it to perform complex operations on binaries, scripts, and data sets.&lt;/li&gt;
&lt;li&gt;Even for large source files, Bazel is blazingly fast at building, as it caches previous work and rebuilds only the code that needs to be.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This article will walk you through the core concepts of Bazel and set you up for building and compiling your own monorepo in JavaScript.&lt;/p&gt;
&lt;h2 id=&quot;bazel-basics&quot;&gt;Bazel Basics&lt;/h2&gt;
&lt;p&gt;First, some vocabulary.&lt;/p&gt;
&lt;h3 id=&quot;workspace&quot;&gt;Workspace&lt;/h3&gt;
&lt;p&gt;Bazel calls your top-level source file a &lt;a href=&quot;https://docs.bazel.build/versions/4.0.0/build-ref.html#workspace&quot;&gt;workspace&lt;/a&gt;, which contains other source files in a nested fashion. Your workspace is what builds your entire software by taking a set of inputs and generating the desired output.&lt;/p&gt;
&lt;h3 id=&quot;packages&quot;&gt;Packages&lt;/h3&gt;
&lt;p&gt;A &lt;a href=&quot;https://docs.bazel.build/versions/4.0.0/build-ref.html#packages&quot;&gt;package&lt;/a&gt; contains all your related files and dependencies and a file named &lt;code&gt;BUILD&lt;/code&gt;. Subdirectories falling under a package are called subpackages.&lt;/p&gt;
&lt;p&gt;Consider the following directory tree:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;src/app/BUILD
src/app/core/input.txt
src/app/tests/BUILD&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It has two packages: &lt;code&gt;app&lt;/code&gt;, and a subpackage, &lt;code&gt;app/tests&lt;/code&gt;, since both contain their own BUILD files. Note that &lt;code&gt;app/core&lt;/code&gt; is not a package but a regular directory inside &lt;code&gt;app&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&quot;targets&quot;&gt;Targets&lt;/h3&gt;
&lt;p&gt;Elements of a package are called &lt;a href=&quot;https://docs.bazel.build/versions/4.0.0/build-ref.html#targets&quot;&gt;targets&lt;/a&gt;, which can be categorized as &lt;em&gt;files&lt;/em&gt; and &lt;em&gt;rules&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Files can either be source files containing the code of a developer or &lt;em&gt;generated files&lt;/em&gt; generated by Bazel according to a specific set of rules. A rule specifies the relationship between a set of inputs and outputs along with the necessary steps to derive the latter from the former.&lt;/p&gt;
&lt;h3 id=&quot;labels&quot;&gt;Labels&lt;/h3&gt;
&lt;p&gt;The name of a target is its &lt;a href=&quot;https://docs.bazel.build/versions/4.0.0/build-ref.html#labels&quot;&gt;label&lt;/a&gt;, which uniquely identifies it and always starts with &lt;code&gt;//&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@repo//app/main:app_binary&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Each label has two parts: a package name (&lt;code&gt;app/main&lt;/code&gt;) and a target name (&lt;code&gt;app_binary&lt;/code&gt;).&lt;/p&gt;
&lt;h3 id=&quot;dependencies&quot;&gt;Dependencies&lt;/h3&gt;
&lt;p&gt;Target X is considered a dependency for target Y, if Y needs X at build or execution time. The dependency relation produces a &lt;a href=&quot;https://en.wikipedia.org/wiki/Directed_acyclic_graph&quot;&gt;Directed Acyclic Graph&lt;/a&gt; (DAG) called a &lt;em&gt;dependency graph&lt;/em&gt;, which is used to classify these dependencies further. You can read more about &lt;a href=&quot;https://docs.bazel.build/versions/4.0.0/build-ref.html#dependencies&quot;&gt;these types and their definitions here&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;build-files&quot;&gt;Build Files&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.bazel.build/versions/4.0.0/build-ref.html#BUILD_files&quot;&gt;Build files&lt;/a&gt; contain the top-level program that describes the set of declared rules. These files are periodically updated with respect to changes in the dependencies being used.&lt;/p&gt;
&lt;h3 id=&quot;bazel-basic-commands&quot;&gt;Bazel Basic Commands&lt;/h3&gt;
&lt;p&gt;You can check if you have Bazel installed on your system by running the &lt;code&gt;version&lt;/code&gt; command.&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ bazel --version
bazel 4.0.0&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The primary &lt;code&gt;build&lt;/code&gt; command builds your project’s targets, and &lt;code&gt;analyze-profile&lt;/code&gt; can analyze your builds. You can also remove output files and close the server using the &lt;code&gt;clean&lt;/code&gt; command. You can get a list of all these basic commands along with their use cases by running:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ bazel help 
Usage: bazel &amp;lt;command&amp;gt; &amp;lt;options&amp;gt; ...

Available commands:
  analyze-profile     Analyzes build profile data.
...&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;how-to-build-a-monorepo-with-bazel&quot;&gt;How to Build a Monorepo with Bazel&lt;/h2&gt;
&lt;p&gt;Once you have the &lt;a href=&quot;https://nodejs.org/en/&quot;&gt;Node.js&lt;/a&gt; installed on your system, you can run the following command to install Bazel globally:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;npm install -g @bazel/bazelisk &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can also install &lt;a href=&quot;https://docs.bazel.build/versions/master/build-javascript.html#installing-ibazel&quot;&gt;iBazel&lt;/a&gt; to enable hot reloading. This lets you see your changes live in real time.&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;npm install --save-dev @bazel/ibazel
npm install --global @bazel/ibazel&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;configuring-the-bazel.rc-file&quot;&gt;Configuring the &lt;code&gt;bazel.rc&lt;/code&gt; File&lt;/h3&gt;
&lt;p&gt;You can write build options in a &lt;a href=&quot;https://docs.bazel.build/versions/master/guide.html#bazelrc&quot;&gt;&lt;code&gt;bazel.rc&lt;/code&gt; file&lt;/a&gt; to apply them on every build. You can use the same settings for your project by creating a &lt;code&gt;tools/bazel.rc&lt;/code&gt; file at the root of your Bazel workspace.&lt;/p&gt;
&lt;p&gt;If you don’t want to share these settings, you can move out the &lt;code&gt;.bazel.rc&lt;/code&gt; file to the root directory and add it to your &lt;code&gt;.gitignore&lt;/code&gt; list instead. You can also personalize these settings locally by moving it in your home directory.&lt;/p&gt;
&lt;p&gt;The following is a generic &lt;code&gt;bazel.rc&lt;/code&gt; file that you can modify according to your needs:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb7&quot;&gt;&lt;pre class=&quot;sourceCode .rc&quot;&gt;&lt;code class=&quot;sourceCode xml&quot;&gt;&lt;span id=&quot;cb7-1&quot;&gt;&lt;a href=&quot;#cb7-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;###############################&lt;/span&gt;
&lt;span id=&quot;cb7-2&quot;&gt;&lt;a href=&quot;#cb7-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;# Directory structure         #&lt;/span&gt;
&lt;span id=&quot;cb7-3&quot;&gt;&lt;a href=&quot;#cb7-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;###############################&lt;/span&gt;
&lt;span id=&quot;cb7-4&quot;&gt;&lt;a href=&quot;#cb7-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb7-5&quot;&gt;&lt;a href=&quot;#cb7-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;# Artifacts are typically placed in a directory called &amp;quot;dist&amp;quot;&lt;/span&gt;
&lt;span id=&quot;cb7-6&quot;&gt;&lt;a href=&quot;#cb7-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;# Be aware that this setup will still create a bazel-out symlink in&lt;/span&gt;
&lt;span id=&quot;cb7-7&quot;&gt;&lt;a href=&quot;#cb7-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;# your project directory, which you must exclude from version control and your&lt;/span&gt;
&lt;span id=&quot;cb7-8&quot;&gt;&lt;a href=&quot;#cb7-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;# editor&amp;#39;s search path.&lt;/span&gt;
&lt;span id=&quot;cb7-9&quot;&gt;&lt;a href=&quot;#cb7-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;build --symlink_prefix=dist/&lt;/span&gt;
&lt;span id=&quot;cb7-10&quot;&gt;&lt;a href=&quot;#cb7-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb7-11&quot;&gt;&lt;a href=&quot;#cb7-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;###############################&lt;/span&gt;
&lt;span id=&quot;cb7-12&quot;&gt;&lt;a href=&quot;#cb7-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;# Output                      #&lt;/span&gt;
&lt;span id=&quot;cb7-13&quot;&gt;&lt;a href=&quot;#cb7-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;###############################&lt;/span&gt;
&lt;span id=&quot;cb7-14&quot;&gt;&lt;a href=&quot;#cb7-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb7-15&quot;&gt;&lt;a href=&quot;#cb7-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;# A more useful default output mode for bazel query, which&lt;/span&gt;
&lt;span id=&quot;cb7-16&quot;&gt;&lt;a href=&quot;#cb7-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;# prints &amp;quot;ng_module rule //foo:bar&amp;quot; instead of just &amp;quot;//foo:bar&amp;quot;.&lt;/span&gt;
&lt;span id=&quot;cb7-17&quot;&gt;&lt;a href=&quot;#cb7-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;query --output=label_kind&lt;/span&gt;
&lt;span id=&quot;cb7-18&quot;&gt;&lt;a href=&quot;#cb7-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb7-19&quot;&gt;&lt;a href=&quot;#cb7-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;# By default, failing tests don&amp;#39;t print any output, it&amp;#39;s logged to a&lt;/span&gt;
&lt;span id=&quot;cb7-20&quot;&gt;&lt;a href=&quot;#cb7-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;# file instead.&lt;/span&gt;
&lt;span id=&quot;cb7-21&quot;&gt;&lt;a href=&quot;#cb7-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;test --test_output=errors&lt;/span&gt;
&lt;span id=&quot;cb7-22&quot;&gt;&lt;a href=&quot;#cb7-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb7-23&quot;&gt;&lt;a href=&quot;#cb7-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;###############################&lt;/span&gt;
&lt;span id=&quot;cb7-24&quot;&gt;&lt;a href=&quot;#cb7-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;# Typescript / Angular / Sass #&lt;/span&gt;
&lt;span id=&quot;cb7-25&quot;&gt;&lt;a href=&quot;#cb7-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;###############################&lt;/span&gt;
&lt;span id=&quot;cb7-26&quot;&gt;&lt;a href=&quot;#cb7-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;# Make TypeScript and Angular compilation fast by keeping a few&lt;/span&gt;
&lt;span id=&quot;cb7-27&quot;&gt;&lt;a href=&quot;#cb7-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;# copies of the compiler running as daemons, and cache SourceFile&lt;/span&gt;
&lt;span id=&quot;cb7-28&quot;&gt;&lt;a href=&quot;#cb7-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;# ASTs to reduce parse time.&lt;/span&gt;
&lt;span id=&quot;cb7-29&quot;&gt;&lt;a href=&quot;#cb7-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;build --strategy=TypeScriptCompile=worker --strategy=AngularTemplateCompile=worker&lt;/span&gt;
&lt;span id=&quot;cb7-30&quot;&gt;&lt;a href=&quot;#cb7-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb7-31&quot;&gt;&lt;a href=&quot;#cb7-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;# Enable debugging tests with --config=debug&lt;/span&gt;
&lt;span id=&quot;cb7-32&quot;&gt;&lt;a href=&quot;#cb7-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;test:debug --test_arg=--node_options=--inspect-brk --test_output=streamed --test_strategy=exclusive --test_timeout=9999 --nocache_test_results&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;adding-the-buildifier-dependency-to-your-project&quot;&gt;Adding the &lt;code&gt;buildifier&lt;/code&gt; Dependency to Your Project&lt;/h3&gt;
&lt;p&gt;Buildifier is a formatting tool that ensures all &lt;code&gt;BUILD&lt;/code&gt; files are formatted in a similar fashion. It creates a standardized formatting for all your &lt;code&gt;BUILD&lt;/code&gt; and &lt;code&gt;.bzl&lt;/code&gt; files. It also has a linter out of the box to help you detect issues in your code and automatically fix them. You can add the &lt;code&gt;buildifier&lt;/code&gt; dependency to your project either using npm:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;npm install --save-dev @bazel/buildifier&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;or Yarn:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;yarn add -D @bazel/buildifier&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You will need the following scripts inside your &lt;code&gt;package.json&lt;/code&gt; file to run the &lt;code&gt;buildifier&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;er&quot;&gt;&amp;quot;scripts&amp;quot;:&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb10-2&quot;&gt;&lt;a href=&quot;#cb10-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;&amp;quot;bazel:format&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;find . -type f &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;( -name &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\&amp;quot;&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;*.bzl&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\&amp;quot;&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; -or -name WORKSPACE -or -name BUILD -or -name BUILD.bazel &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;) ! -path &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\&amp;quot;&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;*/node_modules/*&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\&amp;quot;&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; | xargs buildifier -v --warnings=attr-cfg,attr-license,attr-non-empty,attr-output-default,attr-single-file,constant-glob,ctx-actions,ctx-args,depset-iteration,depset-union,dict-concatenation,duplicated-name,filetype,git-repository,http-archive,integer-division,load,load-on-top,native-build,native-package,out-of-order-load,output-group,package-name,package-on-top,positional-args,redefined-variable,repository-name,same-origin-load,string-iteration,unsorted-dict-items,unused-variable&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb10-3&quot;&gt;&lt;a href=&quot;#cb10-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;&amp;quot;bazel:lint&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;yarn bazel:format --lint=warn&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb10-4&quot;&gt;&lt;a href=&quot;#cb10-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;&amp;quot;bazel:lint-fix&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;yarn bazel:format --lint=fix&amp;quot;&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb10-5&quot;&gt;&lt;a href=&quot;#cb10-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;  &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;buildingcompiling-code&quot;&gt;Building/Compiling Code&lt;/h3&gt;
&lt;p&gt;In this example, you’ll start from a new empty directory and build and compile a simple Node.js application using Bazel. You’ll end up with the following structure:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  WORKSPACE     
  BUILD.bazel    
  es5.babelrc  
  app.js    
  package-lock.json  
  package.json    
  &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Instead of manually configuring everything, you can use the following commands to get started:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb12&quot;&gt;&lt;pre class=&quot;sourceCode sh&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb12-1&quot;&gt;&lt;a href=&quot;#cb12-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;npm&lt;/span&gt; init @bazel bazel_build_nodejs  &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Or if you’re using Yarn:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;yarn create @bazel bazel_build_nodejs  &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The previous commands use &lt;a href=&quot;https://www.npmjs.com/package/@bazel/create&quot;&gt;&lt;code&gt;@bazel/create&lt;/code&gt;&lt;/a&gt; under the hood to set up your monorepo with some minimal configurations. This means that it automatically creates &lt;code&gt;package.json&lt;/code&gt;, &lt;code&gt;WORKSPACE&lt;/code&gt;, and &lt;code&gt;BUILD.bazel&lt;/code&gt; files for you.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;package.json&lt;/code&gt; is exactly how it’s created when you’re initializing any Node.js project using the &lt;code&gt;npm init&lt;/code&gt; command. It contains some development time dependencies and some scripts through which you can run your build.&lt;/p&gt;
&lt;p&gt;Also notice how it automatically adds &lt;code&gt;buildifier&lt;/code&gt; to your project so you can avoid manually setting it up. This is only a starting point though, and you would need to manually set up a &lt;code&gt;buildifier&lt;/code&gt; depending on the requirements of your project.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb14&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb14-1&quot;&gt;&lt;a href=&quot;#cb14-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb14-2&quot;&gt;&lt;a href=&quot;#cb14-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;bazel_build_nodejs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb14-3&quot;&gt;&lt;a href=&quot;#cb14-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;version&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;0.1.0&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb14-4&quot;&gt;&lt;a href=&quot;#cb14-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;private&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb14-5&quot;&gt;&lt;a href=&quot;#cb14-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;devDependencies&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb14-6&quot;&gt;&lt;a href=&quot;#cb14-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;&amp;quot;@bazel/bazelisk&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;latest&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb14-7&quot;&gt;&lt;a href=&quot;#cb14-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;&amp;quot;@bazel/ibazel&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;latest&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb14-8&quot;&gt;&lt;a href=&quot;#cb14-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;&amp;quot;@bazel/buildifier&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;latest&amp;quot;&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb14-9&quot;&gt;&lt;a href=&quot;#cb14-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;fu&quot;&gt;},&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb14-10&quot;&gt;&lt;a href=&quot;#cb14-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;scripts&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb14-11&quot;&gt;&lt;a href=&quot;#cb14-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;&amp;quot;build&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;bazel build //...&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb14-12&quot;&gt;&lt;a href=&quot;#cb14-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;&amp;quot;test&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;bazel test //...&amp;quot;&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb14-13&quot;&gt;&lt;a href=&quot;#cb14-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb14-14&quot;&gt;&lt;a href=&quot;#cb14-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb14-15&quot;&gt;&lt;a href=&quot;#cb14-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let’s install these packages and a few more like &lt;a href=&quot;https://babeljs.io/&quot;&gt;Babel&lt;/a&gt; to &lt;a href=&quot;https://scotch.io/tutorials/javascript-transpilers-what-they-are-why-we-need-them&quot;&gt;transpile&lt;/a&gt; your JavaScript code.&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;npm install @babel/core @babel/cli @babel/preset-env  &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;A &lt;code&gt;package-lock.json&lt;/code&gt; file will also be automatically created for you. Your &lt;code&gt;WORKSPACE.bazel&lt;/code&gt; file should look like this:&lt;/p&gt;
&lt;pre class=&quot;text&quot;&gt;&lt;code&gt;# Bazel workspace created by @bazel/create 3.4.1  
  
# Declares that this directory is the root of a Bazel workspace.  
# See https://docs.bazel.build/versions/master/build-ref.html#workspace  
workspace(  
    # How this workspace would be referenced with absolute labels from another workspace  
    name = &amp;quot;bazel_build_nodejs&amp;quot;,  
    # Map the @npm bazel workspace to the node_modules directory.  
    # This lets Bazel use the same node_modules as other local tooling.  
    managed_directories = {&amp;quot;@npm&amp;quot;: [&amp;quot;node_modules&amp;quot;]},  
)  
  
# Install the nodejs &amp;quot;bootstrap&amp;quot; package  
# This provides the basic tools for running and packaging Node.js programs in Bazel  
load(&amp;quot;@bazel_tools//tools/build_defs/repo:http.bzl&amp;quot;, &amp;quot;http_archive&amp;quot;)  
http_archive(  
    name = &amp;quot;build_bazel_rules_nodejs&amp;quot;,  
    sha256 = &amp;quot;a160d9ac88f2aebda2aa995de3fa3171300c076f06ad1d7c2e1385728b8442fa&amp;quot;,  
    urls = [&amp;quot;https://github.com/bazelbuild/rules_nodejs/releases/download/3.4.1/rules_nodejs-3.4.1.tar.gz&amp;quot;],  
)  
  
# The npm_install rule runs Yarn anytime the package.json or package-lock.json file changes.  
# It also extracts any Bazel rules distributed in an npm package.  
load(&amp;quot;@build_bazel_rules_nodejs//:index.bzl&amp;quot;, &amp;quot;npm_install&amp;quot;)  
npm_install(  
    # Name this npm so that Bazel Label references look like @npm//package  
    name = &amp;quot;npm&amp;quot;,  
    package_json = &amp;quot;//:package.json&amp;quot;,  
    package_lock_json = &amp;quot;//:package-lock.json&amp;quot;,  
)  
  &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It basically tells Bazel where to pull the tools for running your project and fetches all the required rules to create a build. You also need to tell Bazel to use auto-generated rules. Add the following line to the top of your &lt;code&gt;BUILD.bazel&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;load(&amp;quot;@npm//@babel/cli:index.bzl&amp;quot;, &amp;quot;babel&amp;quot;)  &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let’s add a simple console statement inside &lt;code&gt;app.js&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb18&quot;&gt;&lt;pre class=&quot;sourceCode javascript&quot;&gt;&lt;code class=&quot;sourceCode javascript&quot;&gt;&lt;span id=&quot;cb18-1&quot;&gt;&lt;a href=&quot;#cb18-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;#39;NodeJS Built using Bazel!&amp;#39;&lt;/span&gt;)&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;  &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Next add the following code inside &lt;code&gt;es5.babelrc&lt;/code&gt; to configure Babel for transpiling JavaScript code:&lt;/p&gt;
&lt;pre class=&quot;babelrc&quot;&gt;&lt;code&gt;{  
    &amp;quot;sourceMaps&amp;quot;: &amp;quot;inline&amp;quot;,  
    &amp;quot;presets&amp;quot;: [  
      [  
        &amp;quot;@babel/preset-env&amp;quot;,  
        {  
          &amp;quot;modules&amp;quot;: &amp;quot;systemjs&amp;quot;  
        }  
      ]  
    ]  
  }  &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Finally, you need to tell Bazel how to take JavaScript inputs and convert them to transpiled or &lt;a href=&quot;https://johnpapa.net/es5-es2015-typescript/&quot;&gt;ES5&lt;/a&gt; output. Add the following code inside &lt;code&gt;BUILD.bazel&lt;/code&gt; file after the previous load statement:&lt;/p&gt;
&lt;pre class=&quot;bazel&quot;&gt;&lt;code&gt;babel(  
    name = &amp;quot;compile&amp;quot;,  
    data = [  
        &amp;quot;app.js&amp;quot;,  
        &amp;quot;es5.babelrc&amp;quot;,  
        &amp;quot;@npm//@babel/preset-env&amp;quot;,  
    ],  
    outs = [&amp;quot;app.es5.js&amp;quot;],  
    args = [  
        &amp;quot;app.js&amp;quot;,  
        &amp;quot;--config-file&amp;quot;,  
        &amp;quot;./$(execpath es5.babelrc)&amp;quot;,  
        &amp;quot;--out-file&amp;quot;,  
        &amp;quot;$(execpath app.es5.js)&amp;quot;,  
    ],  
)  &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Run the following command to build and compile your JavaScript code:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;npm run build  &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In case you run into an error, try renaming your &lt;code&gt;WORKSPACE.bazel&lt;/code&gt; file to simply &lt;code&gt;WORKSPACE&lt;/code&gt;. If all goes well, you should see something similar to the following screenshot on your terminal:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/monorepo-with-bazel/RhmR1Xx.png&quot; alt=&quot;Terminal log of the build command&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Terminal log of the build command&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;You will see &lt;code&gt;bazel-out&lt;/code&gt; and a &lt;code&gt;dist&lt;/code&gt; directory where your output files will be present.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/blog/assets/images/monorepo-with-bazel/Ffu5zoQ.png&quot; height=&quot;400&quot; alt=&quot;Output directories&quot; /&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;p&gt;If you check inside &lt;code&gt;dist/bin/app.es5.js&lt;/code&gt;, you should see your transpiled ES5 JavaScript code as shown:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb22&quot;&gt;&lt;pre class=&quot;sourceCode javascript&quot;&gt;&lt;code class=&quot;sourceCode javascript&quot;&gt;&lt;span id=&quot;cb22-1&quot;&gt;&lt;a href=&quot;#cb22-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;System&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;register&lt;/span&gt;([]&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;function&lt;/span&gt; (_export&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; _context) {  &lt;/span&gt;
&lt;span id=&quot;cb22-2&quot;&gt;&lt;a href=&quot;#cb22-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;st&quot;&gt;&amp;quot;use strict&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb22-3&quot;&gt;&lt;a href=&quot;#cb22-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;/span&gt;
&lt;span id=&quot;cb22-4&quot;&gt;&lt;a href=&quot;#cb22-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; {  &lt;/span&gt;
&lt;span id=&quot;cb22-5&quot;&gt;&lt;a href=&quot;#cb22-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;setters&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;:&lt;/span&gt; []&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb22-6&quot;&gt;&lt;a href=&quot;#cb22-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;function&lt;/span&gt; () {  &lt;/span&gt;
&lt;span id=&quot;cb22-7&quot;&gt;&lt;a href=&quot;#cb22-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      &lt;span class=&quot;bu&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;#39;NodeJS Built using Bazel!&amp;#39;&lt;/span&gt;)&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb22-8&quot;&gt;&lt;a href=&quot;#cb22-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    }  &lt;/span&gt;
&lt;span id=&quot;cb22-9&quot;&gt;&lt;a href=&quot;#cb22-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  }&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb22-10&quot;&gt;&lt;a href=&quot;#cb22-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;})&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;  &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;setting-up-continuous-integration&quot;&gt;Setting Up Continuous Integration&lt;/h3&gt;
&lt;p&gt;Bazel recommends using container environments like the &lt;a href=&quot;https://hub.docker.com/r/angular/ngcontainer/&quot;&gt;ngcontainer Docker image&lt;/a&gt; for continuous integration (CI). You can easily add specific CI settings using the &lt;code&gt;build:ci&lt;/code&gt; or &lt;code&gt;test:ci&lt;/code&gt; prefixes to your &lt;code&gt;bazel.rc&lt;/code&gt; file.&lt;/p&gt;
&lt;p&gt;If you’re using &lt;a href=&quot;/blog/continuous-integration#circleci&quot;&gt;CircleCI&lt;/a&gt;, you can use &lt;a href=&quot;https://github.com/angular/angular-bazel-example/blob/master/.circleci/config.yml&quot;&gt;this example&lt;/a&gt; as a reference. If you’re using GitLab, you can set up CI in minutes using the following scripts:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;variables:  
  BAZEL_DIGEST_VERSION: &amp;quot;f670e9aec235aa23a5f068566352c5850a67eb93de8d7a2350240c68fcec3b25&amp;quot; # Bazel 3.4.1  
  
build:  
  image:  
    name: gcr.io/cloud-marketplace-containers/google/bazel@sha256:$BAZEL_DIGEST_VERSION  
    entrypoint: [&amp;quot;&amp;quot;]  
  stage: build  
  script:  
    - bazel --output_base output build //main/...  
  artifacts:  
    paths:  
      - bazel-bin/main/hello-world  
  cache:  
    key: $BAZEL_DIGEST_VERSION  
    paths:  
      - output  &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The above scripts define the build outputs and cache directory and also ensures immutability. Luckily the GitLab team has a &lt;a href=&quot;https://about.gitlab.com/blog/2020/09/01/using-bazel-to-speed-up-gitlab-ci-builds/&quot;&gt;dedicated article&lt;/a&gt; on this for the best reference.&lt;/p&gt;
&lt;h2 id=&quot;downsides-of-bazel-and-the-monorepo-pattern&quot;&gt;Downsides of Bazel and the Monorepo Pattern&lt;/h2&gt;
&lt;p&gt;The monorepo pattern is trendy these days, but there are some trade-offs you should be aware of. For a large and diverse team working on a monorepo, it might not be a great idea to expose every ounce of that codebase to novice developers.&lt;/p&gt;
&lt;p&gt;Besides someone messing things up accidentally, keeping open access to all your config files, API keys, and so on might pose an issue from a security standpoint. On similar lines, you can understand why open-source projects aren’t living inside monorepos yet.&lt;/p&gt;
&lt;p&gt;While Bazel definitely does some magic to ease out this pain for developers, it doesn’t have a large open-source community backing it yet. Having all your source code in one place could slow down the general process of approving pull requests and running the build scripts every now and then.&lt;/p&gt;
&lt;p&gt;Bazel also promotes a strict demarcation between your dependencies and source code, while modern languages and frameworks have dedicated directories for bookkeeping dependencies. For instance, an npm project will always have its dependencies in a &lt;code&gt;node_modules&lt;/code&gt; directory inside the root directory. Diverging away from that pattern can present a steep learning curve, or at minimum an uncomfortable change.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Due to better structured configurational files and multiple language support, Bazel is a viable option for your large multi-language project deployed on multiple platforms. It’s fast, and you can even optimize your slow builds &lt;a href=&quot;https://docs.bazel.build/versions/master/remote-caching.html&quot;&gt;using your own build cache&lt;/a&gt;. Google has tried and tested Bazel’s core features to validate its stability, and their extensive documentation is some compensation for the small community.&lt;/p&gt;
&lt;p&gt;If you’d like to explore further, you can build your own React or Angular app using Bazel to see how it treats different environments of the same language. You can also try out their &lt;a href=&quot;https://docs.bazel.build/versions/0.17.2/build-javascript.html#tutorials&quot;&gt;tutorials for different languages&lt;/a&gt; to get a bigger picture of how Bazel works. And if today’s the day you’re welcoming Bazel into your project, definitely take a moment to familiarize yourself with its documented &lt;a href=&quot;https://docs.bazel.build/versions/master/best-practices.html&quot;&gt;best practices&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;If the benefits of Bazel look promising but the downsides prevent you from adopting it, then take a look at &lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt;. It supports monorepo and poly repos and has a gentler learning curve.&lt;/p&gt;</content><author><name>Siddhant Varma</name></author><category term="Tutorials" /><summary type="html">A monorepo is perhaps what you would expect from the name: a single code repository for your entire codebase.</summary></entry><entry><title type="html">Understanding Docker Networking</title><link href="https://earthly.dev/blog/docker-networking/" rel="alternate" type="text/html" title="Understanding Docker Networking" /><published>2021-05-05T00:00:00-04:00</published><updated>2021-05-05T00:00:00-04:00</updated><id>https://earthly.dev/blog/docker-networking</id><content type="html" xml:base="https://earthly.dev/blog/docker-networking/">&lt;p&gt;Docker is the de facto model for building and running containers at scale in most enterprise organizations today. At a very high level, Docker is a combination of CLI and a daemon process that solves common software problems like installing, publishing, removing, and managing containers. It’s perfect for microservices, where you have many services handling a typical business functionality; Docker makes the packaging easier, enabling you to encapsulate those services in containers.&lt;/p&gt;
&lt;p&gt;Once the application is inside a container, it’s easier to scale and even runs on different cloud platforms, like AWS, GCP, and Azure. In this article, let’s focus on the &lt;a href=&quot;https://docs.docker.com/network/&quot;&gt;networking aspect of Docker&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;what-is-a-docker-network&quot;&gt;What Is a Docker Network?&lt;/h2&gt;
&lt;p&gt;Networking is about communication among processes, and Docker’s networking is no different. Docker networking is primarily used to establish communication between Docker containers and the outside world via the host machine where the Docker daemon is running.&lt;/p&gt;
&lt;p&gt;Docker supports different types of networks, each fit for certain use cases. We’ll be exploring the network drivers supported by Docker in general, along with some coding examples.&lt;/p&gt;
&lt;p&gt;Docker networking differs from virtual machine (VM) or physical machine networking in a few ways:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Virtual machines are more flexible in some ways as they can support configurations like &lt;a href=&quot;https://superuser.com/questions/227505/what-is-the-difference-between-nat-bridged-host-only-networking&quot;&gt;NAT and host networking&lt;/a&gt;. Docker typically uses a bridge network, and while it can support host networking, that option is &lt;a href=&quot;https://docs.docker.com/network/host/&quot;&gt;only available on Linux&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;When using Docker containers, network isolation is achieved using a network namespace, not an entirely separate networking stack.&lt;/li&gt;
&lt;li&gt;You can run hundreds of containers on a single-node Docker host, so it’s required that the host can support networking at this scale. VMs usually don’t run into these network limits as they typically run fewer processes per VM.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;what-are-docker-network-drivers&quot;&gt;What Are Docker Network Drivers?&lt;/h2&gt;
&lt;p&gt;Docker handles communication between containers by creating a default bridge network, so you often don’t have to deal with networking and can instead focus on creating and running containers. This default bridge network works in most cases, but it’s not the only option you have.&lt;/p&gt;
&lt;p&gt;Docker allows you to create three different types of network drivers out-of-the-box: bridge, host, and none. However, they may not fit every use case, so we’ll also explore user-defined networks such as overlay and macvlan. Let’s take a closer look at each one.&lt;/p&gt;
&lt;h3 id=&quot;the-bridge-driver&quot;&gt;The Bridge Driver&lt;/h3&gt;
&lt;p&gt;This is the default. Whenever you start Docker, a bridge network gets created and all newly started containers will connect automatically to the default bridge network.&lt;/p&gt;
&lt;p&gt;You can use this whenever you want your containers running in isolation to connect and communicate with each other. Since containers run in isolation, the bridge network solves the port conflict problem. Containers running in the same bridge network can communicate with each other, and Docker &lt;a href=&quot;https://docs.docker.com/network/iptables/&quot;&gt;uses iptables&lt;/a&gt; on the host machine to prevent access outside of the bridge.&lt;/p&gt;
&lt;!-- markdownlint-disable MD029 --&gt;
&lt;p&gt;Let’s look at some examples of how a bridge network driver works.&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Check the available network by running the &lt;code&gt;docker network ls&lt;/code&gt; command&lt;/li&gt;
&lt;li&gt;Start two &lt;a href=&quot;https://hub.docker.com/_/busybox&quot;&gt;busybox&lt;/a&gt; containers named &lt;code&gt;busybox1&lt;/code&gt; and &lt;code&gt;busybox2&lt;/code&gt; in detached mode by passing the &lt;code&gt;-dit&lt;/code&gt; flag.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; docker network ls           &lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;NETWORK&lt;/span&gt; ID     NAME      DRIVER    SCOPE&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;5077a7b25ae6&lt;/span&gt;   bridge    bridge    local&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;7e25f334b07f&lt;/span&gt;   host      host      local&lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;475e50be0fe0&lt;/span&gt;   none      null      local&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;docker run -dit --name busybox1 busybox /bin/sh
docker run -dit --name busybox2 busybox /bin/sh&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot; type=&quot;1&quot;&gt;
&lt;li&gt;Run the &lt;code&gt;docker ps&lt;/code&gt; command to verify that containers are up and running.&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker ps
CONTAINER ID   IMAGE     COMMAND     CREATED          STATUS          PORTS     NAMES
9e6464e82c4c   busybox   &amp;quot;/bin/sh&amp;quot;   5 seconds ago    Up 5 seconds              busybox2
7fea14032748   busybox   &amp;quot;/bin/sh&amp;quot;   26 seconds ago   Up 26 seconds             busybox1&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot; type=&quot;1&quot;&gt;
&lt;li&gt;Verify that the containers are attached to the bridge network.&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker network inspect bridge                                                       
[
    {
        &amp;quot;Name&amp;quot;: &amp;quot;bridge&amp;quot;,
        &amp;quot;Id&amp;quot;: &amp;quot;5077a7b25ae67abd46cff0fde160303476c8a9e2e1d52ad01ba2b4bf04acc0e0&amp;quot;,
        &amp;quot;Created&amp;quot;: &amp;quot;2021-03-05T03:25:58.232446444Z&amp;quot;,
        &amp;quot;Scope&amp;quot;: &amp;quot;local&amp;quot;,
        &amp;quot;Driver&amp;quot;: &amp;quot;bridge&amp;quot;,
        &amp;quot;EnableIPv6&amp;quot;: false,
        &amp;quot;IPAM&amp;quot;: {
            &amp;quot;Driver&amp;quot;: &amp;quot;default&amp;quot;,
            &amp;quot;Options&amp;quot;: null,
            &amp;quot;Config&amp;quot;: [
                {
                    &amp;quot;Subnet&amp;quot;: &amp;quot;172.17.0.0/16&amp;quot;,
                    &amp;quot;Gateway&amp;quot;: &amp;quot;172.17.0.1&amp;quot;
                }
            ]
        },
        &amp;quot;Internal&amp;quot;: false,
        &amp;quot;Attachable&amp;quot;: false,
        &amp;quot;Ingress&amp;quot;: false,
        &amp;quot;ConfigFrom&amp;quot;: {
            &amp;quot;Network&amp;quot;: &amp;quot;&amp;quot;
        },
        &amp;quot;ConfigOnly&amp;quot;: false,
        &amp;quot;Containers&amp;quot;: {
            &amp;quot;7fea140327487b57c3cf31d7502cfaf701e4ea4314621f0c726309e396105885&amp;quot;: {
                &amp;quot;Name&amp;quot;: &amp;quot;busybox1&amp;quot;,
                &amp;quot;EndpointID&amp;quot;: &amp;quot;05f216032784786c3315e30b3d54d50a25c1efc7d2030dc664716dda38056326&amp;quot;,
                &amp;quot;MacAddress&amp;quot;: &amp;quot;02:42:ac:11:00:02&amp;quot;,
                &amp;quot;IPv4Address&amp;quot;: &amp;quot;172.17.0.2/16&amp;quot;,
                &amp;quot;IPv6Address&amp;quot;: &amp;quot;&amp;quot;
            },
            &amp;quot;9e6464e82c4ca647b9fb60a85ca25e71370330982ea497d51c1238d073148f63&amp;quot;: {
                &amp;quot;Name&amp;quot;: &amp;quot;busybox2&amp;quot;,
                &amp;quot;EndpointID&amp;quot;: &amp;quot;3dcc24e927246c44a2063b5be30b5f5e1787dcd4d53864c6ff2bb3c561519115&amp;quot;,
                &amp;quot;MacAddress&amp;quot;: &amp;quot;02:42:ac:11:00:03&amp;quot;,
                &amp;quot;IPv4Address&amp;quot;: &amp;quot;172.17.0.3/16&amp;quot;,
                &amp;quot;IPv6Address&amp;quot;: &amp;quot;&amp;quot;
            }
        },
        &amp;quot;Options&amp;quot;: {
            &amp;quot;com.docker.network.bridge.default_bridge&amp;quot;: &amp;quot;true&amp;quot;,
            &amp;quot;com.docker.network.bridge.enable_icc&amp;quot;: &amp;quot;true&amp;quot;,
            &amp;quot;com.docker.network.bridge.enable_ip_masquerade&amp;quot;: &amp;quot;true&amp;quot;,
            &amp;quot;com.docker.network.bridge.host_binding_ipv4&amp;quot;: &amp;quot;0.0.0.0&amp;quot;,
            &amp;quot;com.docker.network.bridge.name&amp;quot;: &amp;quot;docker0&amp;quot;,
            &amp;quot;com.docker.network.driver.mtu&amp;quot;: &amp;quot;1500&amp;quot;
        },
        &amp;quot;Labels&amp;quot;: {}
    }
]
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;5&quot; type=&quot;1&quot;&gt;
&lt;li&gt;Under the container’s key, you can observe that two containers (&lt;code&gt;busybox1&lt;/code&gt; and &lt;code&gt;busybox2&lt;/code&gt;) are listed with information about IP addresses. Since containers are running in the background, attach to the &lt;code&gt;busybox1&lt;/code&gt; container and try to ping to &lt;code&gt;busybox2&lt;/code&gt; with its IP address.&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker attach busybox1
/ # whoami
root
/ # hostname -i
172.17.0.2
/ # ping 172.17.0.3
PING 172.17.0.3 (172.17.0.3): 56 data bytes
64 bytes from 172.17.0.3: seq=0 ttl=64 time=2.083 ms
64 bytes from 172.17.0.3: seq=1 ttl=64 time=0.144 ms
/ # ping busybox2
ping: bad address &amp;#39;busybox2&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;6&quot; type=&quot;1&quot;&gt;
&lt;li&gt;Observe that the ping works by passing the IP address of &lt;code&gt;busybox2&lt;/code&gt; but fails when the container name is passed instead.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The downside with the bridge driver is that it’s not recommended for production; the containers communicate via IP address instead of automatic service discovery to resolve an IP address to the container name. Every time you run a container, a different IP address gets assigned to it. It may work well for local development or CI/CD, but it’s definitely not a sustainable approach for applications running in production.&lt;/p&gt;
&lt;p&gt;Another reason not to use it in production is that it will allow unrelated containers to communicate with each other, which could be a security risk. I’ll cover how you can create custom bridge networks later.&lt;/p&gt;
&lt;h3 id=&quot;the-host-driver&quot;&gt;The Host Driver&lt;/h3&gt;
&lt;p&gt;As the name suggests, host drivers use the networking provided by the host machine. And it removes network isolation between the container and the host machine where Docker is running. For example, If you run a container that binds to port 80 and uses host networking, the container’s application is available on port 80 on the host’s IP address. You can use the host network if you don’t want to rely on Docker’s networking but instead rely on the host machine networking.&lt;/p&gt;
&lt;p&gt;One limitation with the host driver is that it doesn’t work on Docker desktop: you need a Linux host to use it. This article focuses on Docker desktop, but I’ll show you the commands required to work with the Linux host.&lt;/p&gt;
&lt;p&gt;The following command will start an NGINX image and listen to port 80 on the host machine:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;docker run --rm -d --network host --name my_nginx nginx
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can access NGINX by hitting the &lt;code&gt;http://localhost:80/ url&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The downside with the host network is that you can’t run multiple containers on the same host having the same port. Ports are shared by all containers on the host machine network.&lt;/p&gt;
&lt;h3 id=&quot;the-none-driver&quot;&gt;The None Driver&lt;/h3&gt;
&lt;p&gt;The none network driver does not attach containers to any network. Containers do not access the external network or communicate with other containers. You can use it when you want to disable the networking on a container.&lt;/p&gt;
&lt;h3 id=&quot;the-overlay-driver&quot;&gt;The Overlay Driver&lt;/h3&gt;
&lt;p&gt;The Overlay driver is for multi-host network communication, as with &lt;a href=&quot;https://docs.docker.com/engine/swarm/&quot;&gt;Docker Swarm&lt;/a&gt; or &lt;a href=&quot;https://kubernetes.io/&quot;&gt;Kubernetes&lt;/a&gt;. It allows containers across the host to communicate with each other without worrying about the setup. Think of an overlay network as a distributed virtualized network that’s built on top of an existing computer network.&lt;/p&gt;
&lt;p&gt;To create an overlay network for Docker Swarm services, use the following command:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;docker network create -d overlay my-overlay-network&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;To create an overlay network so that standalone containers can communicate with each other, use this command:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;docker network create -d overlay --attachable my-attachable-overlay&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;the-macvlan-driver&quot;&gt;The Macvlan Driver&lt;/h3&gt;
&lt;p&gt;This driver connects Docker containers directly to the physical host network. As per &lt;a href=&quot;https://docs.docker.com/network/#network-drivers&quot;&gt;the Docker documentation&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“Macvlan networks allow you to assign a MAC address to a container, making it appear as a physical device on your network. The Docker daemon routes traffic to containers by their MAC addresses. Using the &lt;code&gt;macvlan&lt;/code&gt; driver is sometimes the best choice when dealing with legacy applications that expect to be directly connected to the physical network, rather than routed through the Docker host’s network stack.”&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Macvlan networks are best for legacy applications that need to be modernized by containerizing them and running them on the cloud because they need to be attached to a physical network for performance reasons. &lt;a href=&quot;https://github.com/docker/for-mac/issues/3926&quot;&gt;A macvlan network is also not supported on Docker desktop for macOS&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;basic-docker-networking-commands&quot;&gt;Basic Docker Networking Commands&lt;/h2&gt;
&lt;p&gt;To see which commands list, create, connect, disconnect, inspect, or remove a Docker network, use the &lt;code&gt;docker network help&lt;/code&gt; command.&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker network help

Usage:  docker network COMMAND

Manage networks

Commands:
  connect     Connect a container to a network
  create      Create a network
  disconnect  Disconnect a container from a network
  inspect     Display detailed information on one or more networks
  ls          List networks
  prune       Remove all unused networks
  rm          Remove one or more networks&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let’s run through some examples of each command, starting with &lt;code&gt;docker network connect&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&quot;connecting-a-container-to-a-network&quot;&gt;Connecting a Container to a Network&lt;/h3&gt;
&lt;p&gt;Let’s try to connect a container to the &lt;code&gt;mynetwork&lt;/code&gt; we have created. First, we would need a running container that can connect to &lt;code&gt;mynetwork&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker run -it ubuntu bash   
root@0f8d7a833f42:/# &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now we have an Ubuntu Linux image and started a login shell as root inside it. We have the container running in interactive mode with the help of the &lt;code&gt;-it&lt;/code&gt; flags.&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker ps     
CONTAINER ID   IMAGE     COMMAND   CREATED         STATUS         PORTS     NAMES
0f8d7a833f42   ubuntu    &amp;quot;bash&amp;quot;    9 seconds ago   Up 7 seconds             wizardly_greider&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Run the &lt;code&gt;docker network connect 0f8d7a833f42&lt;/code&gt; command to connect the container named &lt;code&gt;wizardly_greider&lt;/code&gt; with &lt;code&gt;mynetwork&lt;/code&gt;. To verify that this container is connected to &lt;code&gt;mynetwork&lt;/code&gt;, use the &lt;code&gt;docker inspect&lt;/code&gt; command.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb12&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb12-1&quot;&gt;&lt;a href=&quot;#cb12-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;er&quot;&gt;&amp;quot;mynetwork&amp;quot;:&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-2&quot;&gt;&lt;a href=&quot;#cb12-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                    &lt;span class=&quot;dt&quot;&gt;&amp;quot;IPAMConfig&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;{},&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-3&quot;&gt;&lt;a href=&quot;#cb12-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                    &lt;span class=&quot;dt&quot;&gt;&amp;quot;Links&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-4&quot;&gt;&lt;a href=&quot;#cb12-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                    &lt;span class=&quot;dt&quot;&gt;&amp;quot;Aliases&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-5&quot;&gt;&lt;a href=&quot;#cb12-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                        &lt;span class=&quot;st&quot;&gt;&amp;quot;0f8d7a833f42&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-6&quot;&gt;&lt;a href=&quot;#cb12-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                    &lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-7&quot;&gt;&lt;a href=&quot;#cb12-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                    &lt;span class=&quot;dt&quot;&gt;&amp;quot;NetworkID&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;97a158252c995d3632560852c62bd140984769c8714b1f990c8133a5c8ae65d3&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-8&quot;&gt;&lt;a href=&quot;#cb12-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                    &lt;span class=&quot;dt&quot;&gt;&amp;quot;EndpointID&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;db21f395ca781523c115706b11063ebe879cf5ef246c24fd128fe621a582cade&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-9&quot;&gt;&lt;a href=&quot;#cb12-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                    &lt;span class=&quot;dt&quot;&gt;&amp;quot;Gateway&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;172.20.0.1&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-10&quot;&gt;&lt;a href=&quot;#cb12-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                    &lt;span class=&quot;dt&quot;&gt;&amp;quot;IPAddress&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;172.20.0.2&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-11&quot;&gt;&lt;a href=&quot;#cb12-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                    &lt;span class=&quot;dt&quot;&gt;&amp;quot;IPPrefixLen&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-12&quot;&gt;&lt;a href=&quot;#cb12-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                    &lt;span class=&quot;dt&quot;&gt;&amp;quot;IPv6Gateway&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-13&quot;&gt;&lt;a href=&quot;#cb12-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                    &lt;span class=&quot;dt&quot;&gt;&amp;quot;GlobalIPv6Address&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-14&quot;&gt;&lt;a href=&quot;#cb12-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                    &lt;span class=&quot;dt&quot;&gt;&amp;quot;GlobalIPv6PrefixLen&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-15&quot;&gt;&lt;a href=&quot;#cb12-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                    &lt;span class=&quot;dt&quot;&gt;&amp;quot;MacAddress&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;02:42:ac:14:00:02&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-16&quot;&gt;&lt;a href=&quot;#cb12-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                    &lt;span class=&quot;dt&quot;&gt;&amp;quot;DriverOpts&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;{}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-17&quot;&gt;&lt;a href=&quot;#cb12-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;creating-a-network&quot;&gt;Creating a Network&lt;/h3&gt;
&lt;p&gt;You can use &lt;code&gt;docker network create mynetwork&lt;/code&gt; to create a Docker network. Here, we’ve created a network named &lt;code&gt;mynetwork&lt;/code&gt;. Let’s run &lt;code&gt;docker network ls&lt;/code&gt; to verify that the network is created successfully.&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker network ls
NETWORK ID     NAME        DRIVER    SCOPE
b995772ac197   bridge      bridge    local
7e25f334b07f   host        host      local
97a158252c99   mynetwork   bridge    local
475e50be0fe0   none        null      local&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now we have a new custom network named &lt;code&gt;mynetwork&lt;/code&gt;, and its type is bridge.&lt;/p&gt;
&lt;h3 id=&quot;disconnecting-a-container-from-the-network&quot;&gt;Disconnecting a Container from the Network&lt;/h3&gt;
&lt;p&gt;This command disconnects a Docker container from the custom &lt;code&gt;mynetwork&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;docker network disconnect mynetwork 0f8d7a833f42&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;inspecting-the-network&quot;&gt;Inspecting the Network&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;docker network inspect&lt;/code&gt; command displays detailed information on one or more networks.&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker network inspect mynetwork
[
    {
        &amp;quot;Name&amp;quot;: &amp;quot;mynetwork&amp;quot;,
        &amp;quot;Id&amp;quot;: &amp;quot;97a158252c995d3632560852c62bd140984769c8714b1f990c8133a5c8ae65d3&amp;quot;,
        &amp;quot;Created&amp;quot;: &amp;quot;2021-03-02T17:36:30.090173896Z&amp;quot;,
        &amp;quot;Scope&amp;quot;: &amp;quot;local&amp;quot;,
        &amp;quot;Driver&amp;quot;: &amp;quot;bridge&amp;quot;,
        &amp;quot;EnableIPv6&amp;quot;: false,
        &amp;quot;IPAM&amp;quot;: {
            &amp;quot;Driver&amp;quot;: &amp;quot;default&amp;quot;,
            &amp;quot;Options&amp;quot;: {},
            &amp;quot;Config&amp;quot;: [
                {
                    &amp;quot;Subnet&amp;quot;: &amp;quot;172.20.0.0/16&amp;quot;,
                    &amp;quot;Gateway&amp;quot;: &amp;quot;172.20.0.1&amp;quot;
                }
            ]
        },
        &amp;quot;Internal&amp;quot;: false,
        &amp;quot;Attachable&amp;quot;: false,
        &amp;quot;Ingress&amp;quot;: false,
        &amp;quot;ConfigFrom&amp;quot;: {
            &amp;quot;Network&amp;quot;: &amp;quot;&amp;quot;
        },
        &amp;quot;ConfigOnly&amp;quot;: false,
        &amp;quot;Containers&amp;quot;: {
            &amp;quot;0f8d7a833f4283202e905e621e6fd5b29a8e3d4eccc6be6ea0f209f5cb3ca81c&amp;quot;: {
                &amp;quot;Name&amp;quot;: &amp;quot;wizardly_greider&amp;quot;,
                &amp;quot;EndpointID&amp;quot;: &amp;quot;db21f395ca781523c115706b11063ebe879cf5ef246c24fd128fe621a582cade&amp;quot;,
                &amp;quot;MacAddress&amp;quot;: &amp;quot;02:42:ac:14:00:02&amp;quot;,
                &amp;quot;IPv4Address&amp;quot;: &amp;quot;172.20.0.2/16&amp;quot;,
                &amp;quot;IPv6Address&amp;quot;: &amp;quot;&amp;quot;
            }
        },
        &amp;quot;Options&amp;quot;: {},
        &amp;quot;Labels&amp;quot;: {}
    }
]
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;list-available-networks&quot;&gt;List Available Networks&lt;/h3&gt;
&lt;p&gt;Docker installation comes with three networks: none, bridge, and host. You can verify this by running the command &lt;code&gt;docker network ls&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;docker network ls
NETWORK ID     NAME      DRIVER    SCOPE
b995772ac197   bridge    bridge    local
7e25f334b07f   host      host      local
475e50be0fe0   none      null      local&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;removing-a-network&quot;&gt;Removing a Network&lt;/h3&gt;
&lt;p&gt;The following are the Docker commands to remove a specific or all available networks:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker network rm mynetwork
mynetwork
$ docker network ls
NETWORK ID     NAME      DRIVER    SCOPE
b995772ac197   bridge    bridge    local
7e25f334b07f   host      host      local
475e50be0fe0   none      null      local&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker network prune                            
WARNING! This will remove all custom networks not used by at least one container.
Are you sure you want to continue? [y/N] &lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;public-networking&quot;&gt;Public Networking&lt;/h2&gt;
&lt;p&gt;Let’s talk about how to publish a container port and IP addresses to the outside world. When you start a container using the &lt;code&gt;docker run&lt;/code&gt; command, none of its ports are exposed. Your Docker container can connect to the outside world, but the outside world cannot connect to the container. To make the ports accessible for external use or with other containers not on the same network, you will have to use the &lt;code&gt;-P&lt;/code&gt; (publish all available ports) or &lt;code&gt;-p&lt;/code&gt; (publish specific ports) flag.&lt;/p&gt;
&lt;p&gt;For example, here we’ve mapped the TCP port 80 of the container to port 8080 on the Docker host:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;docker run -it --rm nginx -p 8080:80&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Here, we’ve mapped container TCP port 80 to port 8080 on the Docker host for connections to host IP 192.168.1.100:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;docker run -p 192.168.1.100:8085:80 nginx&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can verify this by running the following curl command:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ curl 192.168.1.100:8085
&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html&amp;gt;
&amp;lt;head&amp;gt;
&amp;lt;title&amp;gt;Welcome to nginx!&amp;lt;/title&amp;gt;
&amp;lt;style&amp;gt;
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
&amp;lt;/style&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
&amp;lt;h1&amp;gt;Welcome to nginx!&amp;lt;/h1&amp;gt;
&amp;lt;p&amp;gt;If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.&amp;lt;/p&amp;gt;

&amp;lt;p&amp;gt;For online documentation and support please refer to
&amp;lt;a href=&amp;quot;http://nginx.org/&amp;quot;&amp;gt;nginx.org&amp;lt;/a&amp;gt;.&amp;lt;br/&amp;gt;
Commercial support is available at
&amp;lt;a href=&amp;quot;http://nginx.com/&amp;quot;&amp;gt;nginx.com&amp;lt;/a&amp;gt;.&amp;lt;/p&amp;gt;

&amp;lt;p&amp;gt;&amp;lt;em&amp;gt;Thank you for using nginx.&amp;lt;/em&amp;gt;&amp;lt;/p&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let me briefly mention DNS configuration for containers. Docker provides your containers with the ability to make basic name resolutions:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker exec busybox2 ping www.google.com
PING www.google.com (216.58.216.196): 56 data bytes
64 bytes from 216.58.216.196: seq=0 ttl=37 time=9.672 ms
64 bytes from 216.58.216.196: seq=1 ttl=37 time=6.110 ms
$ ping www.google.com
PING www.google.com (216.58.216.196): 56 data bytes
64 bytes from 216.58.216.196: icmp_seq=0 ttl=118 time=4.722 ms&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Docker containers inherit DNS settings from the host when using a bridge network, so the container will resolve DNS names just like the host by default. To add custom host records to your container, you’ll need to use the &lt;a href=&quot;https://docs.docker.com/config/containers/container-networking/#dns-services&quot;&gt;relevant &lt;code&gt;--dns*&lt;/code&gt; flags outlined here&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;docker-compose-networking&quot;&gt;Docker Compose Networking&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;/blog/youre-using-docker-compose-wrong&quot;&gt;Docker Compose&lt;/a&gt; is a tool for running multi-container applications on Docker, which are defined using the compose YAML file. You can start your applications with a single command: &lt;code&gt;docker-compose up&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;By default, Docker Compose creates a single network for each container defined in the compose file. All the containers defined in the compose file connect and communicate through the default network.&lt;/p&gt;
&lt;p&gt;If you’re not sure about the commands supported with Docker Compose, you can run the following:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker compose help
Docker Compose

Usage:
  docker compose [command]

Available Commands:
  build       Build or rebuild services
  convert     Converts the compose file to a cloud format (default: cloudformation)
  down        Stop and remove containers, networks
  logs        View output from containers
  ls          List running compose projects
  ps          List containers
  pull        Pull service images
  push        Push service images
  run         Run a one-off command on a service.
  up          Create and start containers

Flags:
  -h, --help   help for compose

Global Flags:
      --config DIRECTORY   Location of the client config files DIRECTORY (default &amp;quot;/Users/ashish/.docker&amp;quot;)
  -c, --context string     context
  -D, --debug              Enable debug output in the logs
  -H, --host string        Daemon socket(s) to connect to

Use &amp;quot;docker compose [command] --help&amp;quot; for more information about a command.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let’s understand this with an example. In the following &lt;code&gt;docker-compose.yaml&lt;/code&gt; file, we have a WordPress and a MySQL image.&lt;/p&gt;
&lt;p&gt;When deploying this setup, &lt;code&gt;docker-compose&lt;/code&gt; maps the WordPress container port 80 to port 80 of the host as specified in the compose file. We haven’t defined any custom network, so it should create one for you. Run &lt;code&gt;docker-compose up -d&lt;/code&gt; to bring up the services defined in the YAML file:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;version: &amp;#39;3.7&amp;#39;
services:
  db:
    image: mysql:8.0.19
    command: &amp;#39;--default-authentication-plugin=mysql_native_password&amp;#39;
    restart: always
    volumes:
      - db_data:/var/lib/mysql
    restart: always
    environment:
      - MYSQL_ROOT_PASSWORD=somewordpress
      - MYSQL_DATABASE=wordpress
      - MYSQL_USER=wordpress
      - MYSQL_PASSWORD=wordpress
  wordpress:
    image: wordpress:latest
    ports:
      - 80:80
    restart: always
    environment:
      - WORDPRESS_DB_HOST=db
      - WORDPRESS_DB_USER=wordpress
      - WORDPRESS_DB_PASSWORD=wordpress
      - WORDPRESS_DB_NAME=wordpress
volumes:
  db_data:&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As you can see in the following output, a network named &lt;code&gt;downloads_default&lt;/code&gt; is created for you:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker-compose up -d
Creating network &amp;quot;downloads_default&amp;quot; with the default driver
Creating volume &amp;quot;downloads_db_data&amp;quot; with default driver
Pulling db (mysql:8.0.19)...&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Verify that we have two containers up and running with the &lt;code&gt;docker ps&lt;/code&gt; command:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker ps
CONTAINER ID   IMAGE              COMMAND                  CREATED         STATUS         PORTS                 NAMES
f68265cd6219   wordpress:latest   &amp;quot;docker-entrypoint.s…&amp;quot;   6 minutes ago   Up 6 minutes   0.0.0.0:80-&amp;gt;80/tcp    downloads_wordpress_1
2838f5586c73   mysql:8.0.19       &amp;quot;docker-entrypoint.s…&amp;quot;   6 minutes ago   Up 6 minutes   3306/tcp, 33060/tcp   downloads_db_1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Navigate to &lt;code&gt;http://localhost:80&lt;/code&gt; in your web browser to access WordPress.&lt;/p&gt;
&lt;p&gt;Now let’s inspect this network with the &lt;code&gt;docker network inspect&lt;/code&gt; command. The following is the output:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker network inspect downloads_default
[
    {
        &amp;quot;Name&amp;quot;: &amp;quot;downloads_default&amp;quot;,
        &amp;quot;Id&amp;quot;: &amp;quot;717ea814aae357ceca3972342a64335a0c910455abf160ed820018b8d6690383&amp;quot;,
        &amp;quot;Created&amp;quot;: &amp;quot;2021-03-05T03:43:42.541707419Z&amp;quot;,
        &amp;quot;Scope&amp;quot;: &amp;quot;local&amp;quot;,
        &amp;quot;Driver&amp;quot;: &amp;quot;bridge&amp;quot;,
        &amp;quot;EnableIPv6&amp;quot;: false,
        &amp;quot;IPAM&amp;quot;: {
            &amp;quot;Driver&amp;quot;: &amp;quot;default&amp;quot;,
            &amp;quot;Options&amp;quot;: null,
            &amp;quot;Config&amp;quot;: [
                {
                    &amp;quot;Subnet&amp;quot;: &amp;quot;172.18.0.0/16&amp;quot;,
                    &amp;quot;Gateway&amp;quot;: &amp;quot;172.18.0.1&amp;quot;
                }
            ]
        },
        &amp;quot;Internal&amp;quot;: false,
        &amp;quot;Attachable&amp;quot;: true,
        &amp;quot;Ingress&amp;quot;: false,
        &amp;quot;ConfigFrom&amp;quot;: {
            &amp;quot;Network&amp;quot;: &amp;quot;&amp;quot;
        },
        &amp;quot;ConfigOnly&amp;quot;: false,
        &amp;quot;Containers&amp;quot;: {
            &amp;quot;2838f5586c735894051498c8ed0e5e103209cd22ee5718cbb29e8c6d169c9bf8&amp;quot;: {
                &amp;quot;Name&amp;quot;: &amp;quot;downloads_db_1&amp;quot;,
                &amp;quot;EndpointID&amp;quot;: &amp;quot;10033e064387892253d69ac5813be6bc820a95df1a3e19f84eff99a8d55af1bd&amp;quot;,
                &amp;quot;MacAddress&amp;quot;: &amp;quot;02:42:ac:12:00:02&amp;quot;,
                &amp;quot;IPv4Address&amp;quot;: &amp;quot;172.18.0.2/16&amp;quot;,
                &amp;quot;IPv6Address&amp;quot;: &amp;quot;&amp;quot;
            },
            &amp;quot;f68265cd6219fb60491c7ebbdae2d7f4c5ea4a74aec9987f5a5082c13b1ec025&amp;quot;: {
                &amp;quot;Name&amp;quot;: &amp;quot;downloads_wordpress_1&amp;quot;,
                &amp;quot;EndpointID&amp;quot;: &amp;quot;a4a673479ab3d812713955d461cc4d7032aba3806b49f50dd783a8083588aec5&amp;quot;,
                &amp;quot;MacAddress&amp;quot;: &amp;quot;02:42:ac:12:00:03&amp;quot;,
                &amp;quot;IPv4Address&amp;quot;: &amp;quot;172.18.0.3/16&amp;quot;,
                &amp;quot;IPv6Address&amp;quot;: &amp;quot;&amp;quot;
            }
        },
        &amp;quot;Options&amp;quot;: {},
        &amp;quot;Labels&amp;quot;: {
            &amp;quot;com.docker.compose.network&amp;quot;: &amp;quot;default&amp;quot;,
            &amp;quot;com.docker.compose.project&amp;quot;: &amp;quot;downloads&amp;quot;,
            &amp;quot;com.docker.compose.version&amp;quot;: &amp;quot;1.27.4&amp;quot;
        }
    }
]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In the container sections, you can see that two containers (&lt;code&gt;downloads_db_1&lt;/code&gt; and &lt;code&gt;downloads_wordpress_1&lt;/code&gt;) are attached to the default &lt;code&gt;downloads_default&lt;/code&gt; network driver, which is the bridge type. Run the following commands to clean up everything:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker-compose down
Stopping downloads_wordpress_1 ... done
Stopping downloads_db_1        ... done
Removing downloads_wordpress_1 ... done
Removing downloads_db_1        ... done
Removing network downloads_default&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can observe that the network created by Compose is deleted, too:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker-compose down -v
Removing network downloads_default
WARNING: Network downloads_default not found.
Removing volume downloads_db_data&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The volume created earlier is deleted, and since the network is already deleted after running the previous command, it shows a warning that the default network is not found. That’s fine.&lt;/p&gt;
&lt;p&gt;The example we’ve looked at so far covers the default network created by Compose, but what if we want to create our custom network and connect services to it? You will define the user-defined networks using the Compose file. The following is the &lt;code&gt;docker-compose&lt;/code&gt; YAML file:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;version: &amp;#39;3.7&amp;#39;
services:
  db:
    image: mysql:8.0.19
    command: &amp;#39;--default-authentication-plugin=mysql_native_password&amp;#39;
    restart: always
    volumes:
      - db_data:/var/lib/mysql
    restart: always
    networks:
      - mynetwork
    environment:
      - MYSQL_ROOT_PASSWORD=somewordpress
      - MYSQL_DATABASE=wordpress
      - MYSQL_USER=wordpress
      - MYSQL_PASSWORD=wordpress
  wordpress:
    image: wordpress:latest
    ports:
      - 80:80
    networks:
      - mynetwork
    restart: always
    environment:
      - WORDPRESS_DB_HOST=db
      - WORDPRESS_DB_USER=wordpress
      - WORDPRESS_DB_PASSWORD=wordpress
      - WORDPRESS_DB_NAME=wordpress
volumes:
  db_data:
networks:
  mynetwork:&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I’ve defined a user-defined network under the top-level networks section at the end of the file and called the network &lt;code&gt;mynetwork&lt;/code&gt;. It’s a bridge type, meaning it’s a network on the host machine separated from the rest of the host network stack. Following each service, I added the network key to specify that these services should connect to &lt;code&gt;mynetwork&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Let’s bring up the services again after the changing the Docker Compose YAML file:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker-compose up -d                    
Creating network &amp;quot;downloads_mynetwork&amp;quot; with the default driver
Creating volume &amp;quot;downloads_db_data&amp;quot; with default driver
Creating downloads_wordpress_1 ... done
Creating downloads_db_1        ... done&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As you can see, Docker Compose has created the new custom &lt;code&gt;mynetwork&lt;/code&gt;, started the containers, and connected them to the custom network. You can inspect it by using the Docker inspect command:&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;&lt;code&gt;$ docker network inspect downloads_mynetwork
[
    {
        &amp;quot;Name&amp;quot;: &amp;quot;downloads_mynetwork&amp;quot;,
        &amp;quot;Id&amp;quot;: &amp;quot;cb24ed3832dfdd34ca6fdcfcf0065c8e0df6b9b72f7b29a2aaada74970835dd1&amp;quot;,
        &amp;quot;Created&amp;quot;: &amp;quot;2021-03-05T04:23:14.354570267Z&amp;quot;,
        &amp;quot;Scope&amp;quot;: &amp;quot;local&amp;quot;,
        &amp;quot;Driver&amp;quot;: &amp;quot;bridge&amp;quot;,
        &amp;quot;EnableIPv6&amp;quot;: false,
        &amp;quot;IPAM&amp;quot;: {
            &amp;quot;Driver&amp;quot;: &amp;quot;default&amp;quot;,
            &amp;quot;Options&amp;quot;: null,
            &amp;quot;Config&amp;quot;: [
                {
                    &amp;quot;Subnet&amp;quot;: &amp;quot;172.19.0.0/16&amp;quot;,
                    &amp;quot;Gateway&amp;quot;: &amp;quot;172.19.0.1&amp;quot;
                }
            ]
        },
        &amp;quot;Internal&amp;quot;: false,
        &amp;quot;Attachable&amp;quot;: true,
        &amp;quot;Ingress&amp;quot;: false,
        &amp;quot;ConfigFrom&amp;quot;: {
            &amp;quot;Network&amp;quot;: &amp;quot;&amp;quot;
        },
        &amp;quot;ConfigOnly&amp;quot;: false,
        &amp;quot;Containers&amp;quot;: {
            &amp;quot;334bd5bf1689b067fa24705af0b6ab444976b288d25846349ce5b8f6914d8c19&amp;quot;: {
                &amp;quot;Name&amp;quot;: &amp;quot;downloads_wordpress_1&amp;quot;,
                &amp;quot;EndpointID&amp;quot;: &amp;quot;10674d2ddd9feb67c98e3c08fcf451f32bda58e96c9c256aee70a0487f6a4496&amp;quot;,
                &amp;quot;MacAddress&amp;quot;: &amp;quot;02:42:ac:13:00:03&amp;quot;,
                &amp;quot;IPv4Address&amp;quot;: &amp;quot;172.19.0.3/16&amp;quot;,
                &amp;quot;IPv6Address&amp;quot;: &amp;quot;&amp;quot;
            },
            &amp;quot;9ffc94adab6896620648a1d08d215ba3d9423fee934b905b7bc2a44dd30bd74c&amp;quot;: {
                &amp;quot;Name&amp;quot;: &amp;quot;downloads_db_1&amp;quot;,
                &amp;quot;EndpointID&amp;quot;: &amp;quot;927943a0202bfb69692bc172a5c26e05676df6961236596eba3c3464cacbd1ab&amp;quot;,
                &amp;quot;MacAddress&amp;quot;: &amp;quot;02:42:ac:13:00:02&amp;quot;,
                &amp;quot;IPv4Address&amp;quot;: &amp;quot;172.19.0.2/16&amp;quot;,
                &amp;quot;IPv6Address&amp;quot;: &amp;quot;&amp;quot;
            }
        },
        &amp;quot;Options&amp;quot;: {},
        &amp;quot;Labels&amp;quot;: {
            &amp;quot;com.docker.compose.network&amp;quot;: &amp;quot;mynetwork&amp;quot;,
            &amp;quot;com.docker.compose.project&amp;quot;: &amp;quot;downloads&amp;quot;,
            &amp;quot;com.docker.compose.version&amp;quot;: &amp;quot;1.27.4&amp;quot;
        }
    }
]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Inspecting the network, you can see there are now two containers connected to the custom network.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;In this article, we’ve covered the what and how of Docker networking in detail, starting with Docker’s network drivers available out-of-the-box and then some advanced concepts such as overlay and macvlan. We ran through some examples of the most common Docker network commands, and then discussed some common use cases and general pitfalls of the available network drivers. We also covered port publishing, which allows the outside world to connect with containers, and how Docker resolves DNS names. Finally, we explored Docker Compose networking with some examples.&lt;/p&gt;
&lt;p&gt;That should provide you with a decent overview of how Docker networking provides different modes of network drivers so that your containers can communicate on a single or multi-host setup. With this knowledge, you can pick and choose a network driver that fits your use case.&lt;/p&gt;</content><author><name>Ashish Choudhary</name></author><category term="Tutorials" /><summary type="html">Docker is the de facto model for building and running containers at scale in most enterprise organizations today. At a very high level, Docker is a combination of CLI and a daemon process that solves common software problems like installing, publishing, removing, and managing containers. It’s perfect for microservices, where you have many services handling a typical business functionality; Docker makes the packaging easier, enabling you to encapsulate those services in containers.</summary></entry><entry><title type="html">Green Vs. Brown Programming Languages</title><link href="https://earthly.dev/blog/brown-green-language/" rel="alternate" type="text/html" title="Green Vs. Brown Programming Languages" /><published>2021-04-22T00:00:00-04:00</published><updated>2021-04-22T00:00:00-04:00</updated><id>https://earthly.dev/blog/brown-green-language</id><content type="html" xml:base="https://earthly.dev/blog/brown-green-language/">&lt;h2 id=&quot;the-data&quot;&gt;The Data&lt;/h2&gt;
&lt;p&gt;The Stack Overflow Developer Survey&lt;a href=&quot;#fn1&quot; class=&quot;footnote-ref&quot; id=&quot;fnref1&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; results are a great source of information about how developers work. I was looking at the 2020 results for some ideas on what programming languages we should add to our &lt;a href=&quot;https://docs.earthly.dev/basics/part-1-a-simple-earthfile&quot;&gt;documentation&lt;/a&gt; on containerized builds, and I noticed something interesting about the types of programming languages people like. It’s something that doesn’t seem to come up in various discussions of programming language preferences.&lt;/p&gt;
&lt;p&gt;The survey results have rankings for &lt;strong&gt;The Most Dreaded Programming Languages&lt;/strong&gt; and &lt;strong&gt;The Most Loved Programming Langauge&lt;/strong&gt;. Both rankings come from this question:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Which programming, scripting, and markup languages have you done extensive development work in over the past year, and which do you want to work in over the next year? (If you both worked with the language and want to continue to do so, please check both boxes in that row.)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;A dreaded language is one you work with extensively in the current year but don’t want to continue to use. A loved language you use extensively and wish to continue using. The results are interesting because they reflect the opinions of people who are using the languages extensively. There should be no I-heard-X-is-cool effect, where people rank highly things they don’t use because they heard it is the new hotness. The inverse should also be true: People who put something on the &lt;strong&gt;Dreaded&lt;/strong&gt; list are using it. They are not dreading a language because they heard it was complex, but because they have to work it and feel real pain.&lt;/p&gt;
&lt;div class=&quot;notice--warning notice--big&quot;&gt;
&lt;p&gt;&lt;strong&gt;The TOP 15 Dreaded Programming Languages:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;VBA, Objective-C, Perl, Assembly, C, PHP, Ruby, C++, Java, R, Haskell, Scala, HTML, Shell, and SQL.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;notice--success notice--big&quot;&gt;
&lt;p&gt;&lt;strong&gt;The TOP 15 Loved Programming Languages:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Rust, TypeScript, Python, Kotlin, Go, Julia, Dart, C#, Swift, JavaScript, SQL, Shell, HTML, Scala, and Haskell.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;There is a pattern in this list. Can you see what it is?&lt;/p&gt;
&lt;h2 id=&quot;code-written-before-i-joined-is-the-worst&quot;&gt;Code Written Before I Joined Is the Worst&lt;/h2&gt;
&lt;p&gt;Old code is the worst. Find me a file in a codebase that has been under active development for more than three years, and it will be hard to follow. What starts as a straightforward file access layer develops special cases and performance optimizations and various branches controlled by configuration options. Real-world code evolves to fits its niche, and as it does so, it becomes more complex and harder to understand. The reason for this is simple, and I first heard about it from Joel Spolsky.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The reason that [ developers ] think the old code is a mess is because of a cardinal, fundamental law of programming: &lt;strong&gt;It’s harder to read code than to write it.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Joel Spolsky - &lt;a href=&quot;https://www.joelonsoftware.com/2000/04/06/things-you-should-never-do-part-i/&quot;&gt;Things you should never do&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Let’s call this Joel’s Law. A lot of things follow from this premise. Why do most developers think the code they inherited is a mess and want to throw it out and start again? It’s because writing something new is cognitively less demanding than the hard work of understanding an existing codebase, at least initially. Why are many rewrites doomed to fail? Because much of what makes the code seem messy are vital little improvements that accreted over time. Without some plan for simplifying them, you will end up back where you started.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/brown-green-language/dt140812.gif&quot; alt=&quot;Scott Adams Understood&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Scott Adams Understood&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;It’s easy to understand code as you are writing it. You are executing it and refining it as you go. But it’s hard to understand code just by reading it after the fact. If you return to old code you wrote and find it hard to follow, it could be because you have grown as a developer and would write it better today. But its also possible that the code is inherently complex, and you are interpreting the pain of understanding that complexity as a code quality problem. Could this be why growing PR backlogs are a persistent problem? PR Reviews are a read-only activity, and they are hard to do well if you don’t already have a working model of the code in your head.&lt;/p&gt;
&lt;h2 id=&quot;this-is-why-you-dread-it&quot;&gt;This is Why You Dread It&lt;/h2&gt;
&lt;p&gt;If much real-world code is unfairly considered a mess, could programming languages also be unfairly judged? If you build new things in Go but have to maintain a sprawling 20-year-old C++ codebase, can you rank them fairly? I think this is actually what the survey question is measuring: dreaded languages are likely to be used in existing brown-field projects. Loved languages are more often used in new green-field projects. Let’s test this.&lt;a href=&quot;#fn2&quot; class=&quot;footnote-ref&quot; id=&quot;fnref2&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;measuring-brown-vs.-green-languages&quot;&gt;Measuring Brown vs. Green Languages&lt;/h2&gt;
&lt;p&gt;The TIOBE index claims to measure “the number of skilled engineers, courses and jobs worldwide” for programming languages. There are probably some problems with how they measure this, but it’s accurate enough for our purposes. We use the July 2016 TIOBE &lt;a href=&quot;https://web.archive.org/web/20160801213334/https://www.tiobe.com/tiobe-index/&quot;&gt;index&lt;/a&gt;, the oldest available in way back machine, as a proxy for a language having accumulated lots of code to maintain. If something was big in 2016, it’s more likely people are maintaining code written in it than if it wasn’t popular in 2016.&lt;/p&gt;
&lt;p&gt;The top 20 programming languages on their list as of July 2016 are Java, C, C++, Python, C#, PHP, JavaScript, VB.NET, Perl, Assembly, Ruby, Pascal, Swift, Objective-C, MATLAB, R, SQL, COBOL, and Groovy. We can use this as our list of languages more likely to be used in maintenance work. Let’s call them brown languages. Languages not in the top 20 in 2016 are more likely to be used in new projects. We will refer to these as green languages.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/blog/assets/images/brown-green-language/graph1.svg&quot; alt=&quot;Out of 22 Languages in the combined dreaded/loved list, 63% are Brown&quot; /&gt; &lt;!-- ```
import matplotlib.pyplot as plt

labels = 'Brown', 'Green'
dreaded_sizes = [10, 2]
overall_languages = [14, 8]
overall_total = 22
dreaded_total = 12
loved_sizes = [6, 7]
loved_total = 13
explode = (0.1, 0)
colors = [&quot;burlywood&quot;, &quot;green&quot;]

fig, ax1 = plt.subplots()
ax1.set_title('Green Vs Brown')
ax1.pie(overall_languages, explode=explode, labels=labels, 
        autopct=lambda p: '{:.0f}'.format(p * overall_total / 100),
        shadow=True, 
        startangle=90, 
        colors=colors)
ax1.axis('equal') 

``` --&gt;&lt;/p&gt;
&lt;figcaption&gt;
Out of 22 Languages in the combined dreaded/loved list, 63% are Brown
&lt;/figcaption&gt;
&lt;div class=&quot;notice--warning notice--big&quot;&gt;
&lt;p&gt;&lt;strong&gt;Brown Language:&lt;/strong&gt; A language that you are more likely to use in existing software maintenance (i.e. brown-field projects).&lt;/p&gt;
&lt;p&gt;Java, C, C++, C#, Python, PHP, JavaScript, Swift, Perl, Ruby, Assembly, R, Objective-C, SQL&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;notice--success notice--big&quot;&gt;
&lt;p&gt;&lt;strong&gt;Green Language:&lt;/strong&gt; A language that you are more likely to use in a new project (i.e. a green-field project).&lt;/p&gt;
&lt;p&gt;Go, Rust, TypeScript, Kotlin, Julia, Dart, Scala, and Haskell&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;TIOBE and StackOverflow have different ideas of what a programming language is. To overcome this, we have to normalize the two lists by removing HTML/CSS, Shell Scripts, and VBA.&lt;a href=&quot;#fn3&quot; class=&quot;footnote-ref&quot; id=&quot;fnref3&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;Removed Language:&lt;/strong&gt; Not measured the same by TIOBE and StackOverflow&lt;/p&gt;
&lt;p&gt;VBA, Shell, HTML/CSS&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;There are many nuances that a simple green / brown split misses - I expect that more green-field projects start with Swift than with Objective-C, but it does seem sufficient to capture what we need. There are far more brown languages in this list than green, but that is what I would expect given that year-on-year turn-over in programming languages is relatively low.&lt;/p&gt;
&lt;p&gt;Now we can answer the question: Do people love and dread the languages they state or are they just dreading legacy code? Or to put it another way: If Java and Ruby appeared today, without piles of old rails apps and old enterprise Java applications to maintain, would they still be dreaded or would they be more likely to show up on the loved list?&lt;/p&gt;
&lt;h2 id=&quot;the-dreaded-brown-programming-languages&quot;&gt;The Dreaded Brown Programming Languages&lt;/h2&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/brown-green-language/graph2.svg&quot; alt=&quot;Dreaded Languages: 83% Brown&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Dreaded Languages: 83% Brown&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;!-- ```
import matplotlib.pyplot as plt

labels = 'Brown', 'Green'
dreaded_sizes = [10, 2]
overall_languages = [14, 8]
overall_total = 22
dreaded_total = 12
loved_sizes = [6, 7]
loved_total = 13
explode = (0.1, 0)
colors = [&quot;burlywood&quot;, &quot;green&quot;]

# Graph one
fig, ax1 = plt.subplots()
ax1.set_title('Dreaded Languages')
ax1.pie(dreaded_sizes, explode=explode, labels=labels, 
        autopct=lambda p: '{:.0f}'.format(p * dreaded_total / 100),
        shadow=True, 
        startangle=90, 
        colors=colors)
ax1.axis('equal') 

```
&lt;figcaption&gt;
Dreaded Languages: 83% Brown
&lt;/figcaption&gt; --&gt;
&lt;p&gt;The Top Dreaded languages are almost all are brown languages. 68% of the languages in our complete list are brown, while 83% of the dreaded languages are brown, which is higher than we would expect by chance.&lt;/p&gt;
&lt;h2 id=&quot;the-loved-green-programming-languages&quot;&gt;The Loved Green Programming Languages&lt;/h2&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/brown-green-language/graph3.svg&quot; alt=&quot;Loved Languages 54% Green&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Loved Languages 54% Green&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;!-- ```
import matplotlib.pyplot as plt

labels = 'Brown', 'Green'
dreaded_sizes = [10, 2]
loved_sizes = [5, 8]
explode = (0.1, 0)
colors = [&quot;burlywood&quot;, &quot;green&quot;]
total = 13

# Graph two
fig, ax2 = plt.subplots()
ax2.set_title('Loved Languages')
ax2.pie(loved_sizes, explode=explode, labels=labels, 
        autopct=lambda p: '{:.0f}'.format(p * total / 100),
        shadow=True, 
        startangle=90, 
        colors=colors)
ax2.axis('equal') 

```
&lt;figcaption&gt;
Loved Languages 54% Green
&lt;/figcaption&gt; --&gt;
&lt;p&gt;In the top loved languages, 54% are green. Only 36% of the languages in our list are green, and every single green language showed up somewhere in the loved list.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Another flaw in the human character is that everybody wants to build and nobody wants to do maintenance.&lt;/p&gt;
&lt;p&gt;― Kurt Vonnegut&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This probably isn’t quite enough evidence to say for sure that having to use a language in a maintenance project causes dread, but it certainly looks like it is a factor. Many of the languages people love are too new or too historically unpopular to have many big big-ball-of-mud projects to maintain.&lt;/p&gt;
&lt;p&gt;In other words, Rust, Kotlin, and the other green languages may still be in a honeymoon phase. People’s love for working with them may have as much to do with not working in 20-year-old codebases as it does with the particular languages.&lt;/p&gt;
&lt;h2 id=&quot;overcoming-bias&quot;&gt;Overcoming Bias&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/brown-green-language/angel-devil-wide-800-cd95144df.png&quot; srcset=&quot;/blog/generated/assets/images/brown-green-language/angel-devil-wide-400-cd95144df.png 400w, /blog/generated/assets/images/brown-green-language/angel-devil-wide-600-cd95144df.png 600w, /blog/generated/assets/images/brown-green-language/angel-devil-wide-800-cd95144df.png 800w, /blog/generated/assets/images/brown-green-language/angel-devil-wide-1000-cd95144df.png 1000w&quot;&gt;&lt;/p&gt;
&lt;p&gt;Some newer or historically less popular programming languages might be better than older or more mainstream languages, but our ability to judge seems quite biased. In particular, developers are giving a halo to languages that are newer or were not used commonly in the past, and they are giving horns to languages that have been around longer. I think this is because nobody likes maintaining someone else’s code. And also, because of Joel’s Law: reading real-world is code hard. Building something new is fun, and new languages are used for that more often.&lt;/p&gt;
&lt;h2 id=&quot;the-lifecycle-of-programming-language-hype&quot;&gt;The Lifecycle of Programming Language Hype&lt;/h2&gt;
&lt;p&gt;I originally started digging into these numbers to establish a ranking for what languages were most used and loved by software developers. I was going to use this to guide adding more examples to our &lt;a href=&quot;https://docs.earthly.dev/&quot;&gt;docs&lt;/a&gt; and our &lt;a href=&quot;https://github.com/earthly/earthly/tree/main/examples&quot;&gt;build examples&lt;/a&gt;. What I came away with instead was the idea of a programming language life cycle: loved programming languages get used a lot, which leads to code maintenance, which causes people to dislike them, which leads to people looking for greener pastures and trying out a newer language. Popular frameworks probably follow this lifecycle as well.&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/brown-green-language/hype-wide-800-26e17264b.png&quot; alt=&quot;A graph showing hype decreasing overtime for a langauge&quot; srcset=&quot;/blog/generated/assets/images/brown-green-language/hype-wide-400-26e17264b.png 400w, /blog/generated/assets/images/brown-green-language/hype-wide-600-26e17264b.png 600w, /blog/generated/assets/images/brown-green-language/hype-wide-800-26e17264b.png 800w, /blog/generated/assets/images/brown-green-language/hype-wide-1000-26e17264b.png 1000w&quot;&gt;&lt;/p&gt;
&lt;figcaption&gt;
The lifecycle of programming language hype
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;I don’t have data for this, but I distinctly remember Ruby being the hottest language back in 2007, and although it does have more competition today, Ruby is a better language now than it was then. Yet now it is dreaded. Part of the difference, it seems to me, is that now people have 14 years’ worth of rails apps to maintain. That makes Ruby is a lot less fun than when it was all new projects. So watch out Rust and Kotlin and Julia and Go: you too will eventually lose your halo.&lt;a href=&quot;#fn4&quot; class=&quot;footnote-ref&quot; id=&quot;fnref4&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;4&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;
&lt;section class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&quot;fn1&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;2020 &lt;a href=&quot;https://insights.stackoverflow.com/survey/2020&quot;&gt;Graphical&lt;/a&gt; and &lt;a href=&quot;https://drive.google.com/file/d/1dfGerWeWkcyQ9GX9x20rdSGj7WtEpzBB/view&quot;&gt;Raw&lt;/a&gt; results.&lt;a href=&quot;#fnref1&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn2&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;I came up with the criteria first. I didn’t hunt for data to back up my original idea.&lt;/p&gt;
&lt;p&gt;I did consider using language creation date to determine green vs. brown status, but some languages have been around for some time but only found usage relatively recently.&lt;/p&gt;
&lt;p&gt;TIOBE is measured like &lt;a href=&quot;https://www.tiobe.com/tiobe-index/programming-languages-definition/&quot;&gt;this&lt;/a&gt; and their historical data is only available if you pay, so I am using the Wayback Machine.&lt;a href=&quot;#fnref2&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn3&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;TIOBE doesn’t include HTML/CSS because it doesn’t consider them turing complete and therefore not a programming language. &lt;a href=&quot;/blog/understanding-bash&quot;&gt;Shell scripts&lt;/a&gt; are measured separately by TIOBE, and VBA is not in the list of languages measured at all, as far as I can see.&lt;a href=&quot;#fnref3&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn4&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;Not all brown languages are dreaded however: Python, C#, Swift, JavaScript and SQL remain loved and I would love to hear if anyone has theories on why. Also &lt;a href=&quot;/blog/top-5-scala-blogs&quot;&gt;Scala&lt;/a&gt; and Haskell, two languages I have a soft spot for, are the only green languages on the dreaded list. Is this just noise or is there something else going on there?&lt;a href=&quot;#fnref4&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;</content><author><name>Adam Gordon Bell</name></author><category term="Articles" /><summary type="html">I've noticed something interesting about the types of programming languages people like. It's something that doesn't seem to come up in various discussions of programming language preferences.</summary></entry><entry><title type="html">Building a Real-Time Application in the Phoenix Framework with Elixir</title><link href="https://earthly.dev/blog/real-time-phoenix-elixir/" rel="alternate" type="text/html" title="Building a Real-Time Application in the Phoenix Framework with Elixir" /><published>2021-04-21T00:00:00-04:00</published><updated>2021-04-21T00:00:00-04:00</updated><id>https://earthly.dev/blog/real-time-phoenix-elixir</id><content type="html" xml:base="https://earthly.dev/blog/real-time-phoenix-elixir/">&lt;p&gt;The Elixir language, along with the &lt;a href=&quot;https://phoenixframework.org/&quot;&gt;Phoenix framework&lt;/a&gt;, has been growing in popularity at a quick pace, and with good reason. Phoenix offers productivity levels comparable to frameworks like Ruby on Rails while being one of the &lt;a href=&quot;https://github.com/mroth/phoenix-showdown/blob/master/RESULTS_v3.md&quot;&gt;fastest web frameworks&lt;/a&gt; available.&lt;/p&gt;
&lt;p&gt;If you’re currently working with a web framework like Ruby on Rails or even Laravel, you should definitely give Phoenix some attention due to the performance gains it promises. Additionally, Phoenix also has the capability to build highly responsive real-time applications.&lt;/p&gt;
&lt;h2 id=&quot;introducing-phoenix-liveview&quot;&gt;Introducing Phoenix LiveView&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/phoenixframework/phoenix_live_view&quot;&gt;Phoenix LiveView&lt;/a&gt; is a relatively new library added to the Phoenix stack. Developers can build rich, real-time user experience with purely server-rendered HTML.&lt;/p&gt;
&lt;p&gt;Phoenix LiveView adds bi-directional communication via WebSockets between the server and the client, without needing dedicated JavaScript code on the frontend. This allows you to implement real-time functionality on your applications with ease.&lt;/p&gt;
&lt;h2 id=&quot;explaining-todays-tutorial&quot;&gt;Explaining Today’s Tutorial&lt;/h2&gt;
&lt;p&gt;For this tutorial, we are going to be building a crowdfunding application that will leverage the real-time capabilities of Phoenix LiveView. Our application will allow users to support a funding goal in real-time and see the funding goal update as other users also commit to a specific amount. We’ll call it Phoenix Fund.&lt;/p&gt;
&lt;p&gt;The goal of this application is not to build a fully-featured crowdfunding platform but to get your feet wet with LiveView:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;How LiveView views works and renders&lt;/li&gt;
&lt;li&gt;How Phoenix leverages WebSockets for communication&lt;/li&gt;
&lt;li&gt;How to implement real-time updates on your application&lt;/li&gt;
&lt;li&gt;How the LiveView life cycle works&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Here’s a sample of how the final application will work:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/real-time-phoenix-elixir/q0L1xth.gif&quot; alt=&quot;The Crowdfunding App&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;The Crowdfunding App&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;prebuild-setup&quot;&gt;Prebuild Setup&lt;/h2&gt;
&lt;p&gt;For this tutorial, make sure you have a good working Elixir environment. The easiest way to do this is to follow the &lt;a href=&quot;https://elixir-lang.org/install.html&quot;&gt;official Elixir instructions&lt;/a&gt;, which will give you a couple of options for:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Local installation on Linux, Windows, and macOS&lt;/li&gt;
&lt;li&gt;Dockerized versions of Elixir&lt;/li&gt;
&lt;li&gt;Package manager versions setups&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I would recommend focusing on the local install for this tutorial, as it might be the easiest one to get started. Additionally, you will need to have &lt;a href=&quot;https://www.npmjs.com/&quot;&gt;npm&lt;/a&gt; installed locally and a running version of PostgreSQL.&lt;/p&gt;
&lt;h3 id=&quot;npm&quot;&gt;npm&lt;/h3&gt;
&lt;p&gt;You can easily install Node.js from their &lt;a href=&quot;https://nodejs.org/en/&quot;&gt;official instructions&lt;/a&gt;, but in most cases, it’s possible your system might already have Node preinstalled.&lt;/p&gt;
&lt;h3 id=&quot;postgres&quot;&gt;Postgres&lt;/h3&gt;
&lt;!-- markdownlint-disable MD029 --&gt;
&lt;p&gt;&lt;a href=&quot;https://www.postgresql.org/&quot;&gt;Postgres&lt;/a&gt; can be a little tricky to install depending on the operating system you’re using. For this tutorial, you can leverage Docker and get a local version running by taking the following steps:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Create a folder to persist the DB data.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; mkdir &lt;span class=&quot;va&quot;&gt;${HOME}&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;/phoenix-postgres-data/&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;2&quot; type=&quot;1&quot;&gt;
&lt;li&gt;Run a Docker container with the Postgres image.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; docker run &lt;span class=&quot;at&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-2&quot;&gt;&lt;a href=&quot;#cb2-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;at&quot;&gt;--name&lt;/span&gt; phoenix-psql &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-3&quot;&gt;&lt;a href=&quot;#cb2-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;at&quot;&gt;-e&lt;/span&gt; POSTGRES_PASSWORD=Phoenix1234 &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-4&quot;&gt;&lt;a href=&quot;#cb2-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;at&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;${HOME}&lt;/span&gt;/phoenix-postgres-data/:/var/lib/postgresql/data &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-5&quot;&gt;&lt;a href=&quot;#cb2-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;at&quot;&gt;-p&lt;/span&gt; 5432:5432 &lt;span class=&quot;dt&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-6&quot;&gt;&lt;a href=&quot;#cb2-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; postgres&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;3&quot; type=&quot;1&quot;&gt;
&lt;li&gt;Validate that the container is running.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; docker &lt;span class=&quot;fu&quot;&gt;ps&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;CONTAINER&lt;/span&gt; ID   IMAGE      COMMAND                  CREATED         STATUS        PORTS                                  NAMES&lt;/span&gt;
&lt;span id=&quot;cb3-4&quot;&gt;&lt;a href=&quot;#cb3-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;11cbe1d2bc2f&lt;/span&gt;   postgres   &lt;span class=&quot;st&quot;&gt;&amp;quot;docker-entrypoint.s…&amp;quot;&lt;/span&gt;   6 seconds ago   Up 5 seconds  5432/tcp, 0.0.0.0:5432-&lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt;5432/tcp       phoenix-psql&lt;/span&gt;
&lt;span id=&quot;cb3-5&quot;&gt;&lt;a href=&quot;#cb3-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;I&lt;/span&gt; can&lt;/span&gt;
&lt;span id=&quot;cb3-6&quot;&gt;&lt;a href=&quot;#cb3-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;that&lt;/span&gt; was&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;4&quot; type=&quot;1&quot;&gt;
&lt;li&gt;Validate PostgreSQL is up and running.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; docker &lt;span class=&quot;bu&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-it&lt;/span&gt; phoenix-psql bash&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;root@11cbe1d2bc2f:/#&lt;/span&gt; psql &lt;span class=&quot;at&quot;&gt;-h&lt;/span&gt; localhost &lt;span class=&quot;at&quot;&gt;-U&lt;/span&gt; postgres&lt;/span&gt;
&lt;span id=&quot;cb4-4&quot;&gt;&lt;a href=&quot;#cb4-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-5&quot;&gt;&lt;a href=&quot;#cb4-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;psql&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;13.2&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;Debian&lt;/span&gt; 13.2-1.pgdg100+1&lt;span class=&quot;kw&quot;&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-6&quot;&gt;&lt;a href=&quot;#cb4-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;Type&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;help&amp;quot;&lt;/span&gt; for help.&lt;/span&gt;
&lt;span id=&quot;cb4-7&quot;&gt;&lt;a href=&quot;#cb4-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-8&quot;&gt;&lt;a href=&quot;#cb4-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;va&quot;&gt;postgres&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;# &lt;span class=&quot;ex&quot;&gt;\l&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-9&quot;&gt;&lt;a href=&quot;#cb4-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                                 &lt;span class=&quot;ex&quot;&gt;List&lt;/span&gt; of databases&lt;/span&gt;
&lt;span id=&quot;cb4-10&quot;&gt;&lt;a href=&quot;#cb4-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;   &lt;span class=&quot;ex&quot;&gt;Name&lt;/span&gt;    &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt;  &lt;span class=&quot;ex&quot;&gt;Owner&lt;/span&gt;   &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;Encoding&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt;  &lt;span class=&quot;ex&quot;&gt;Collate&lt;/span&gt;   &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt;   &lt;span class=&quot;ex&quot;&gt;Ctype&lt;/span&gt;    &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt;   &lt;span class=&quot;ex&quot;&gt;Access&lt;/span&gt; privileges   &lt;/span&gt;
&lt;span id=&quot;cb4-11&quot;&gt;&lt;a href=&quot;#cb4-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;-----------+----------+----------+------------+------------+-----------------------&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-12&quot;&gt;&lt;a href=&quot;#cb4-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;ex&quot;&gt;postgres&lt;/span&gt;  &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;postgres&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;UTF8&lt;/span&gt;     &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;en_US.utf8&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;en_US.utf8&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;...&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;setting-up-phoenix&quot;&gt;Setting Up Phoenix&lt;/h2&gt;
&lt;p&gt;Now that you have the necessary dependencies, go ahead and install the Phoenix application generator and create your first Phoenix app. The Phoenix generator is distributed as a &lt;code&gt;mix archive&lt;/code&gt; and can be installed by running the following command:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; mix &lt;span class=&quot;ex&quot;&gt;archive.&lt;/span&gt; install hex phx_new 1.5.8&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;mix-archives&quot;&gt;Mix Archives&lt;/h3&gt;
&lt;p&gt;Mix archives are essentially &lt;code&gt;.zip&lt;/code&gt; files of an Elixir project following the &lt;a href=&quot;http://erlang.org/doc/man/code.html&quot;&gt;Erlang Archive Format&lt;/a&gt;. Simply put, archives give us a way to distribute projects and use them as a regular command tool.&lt;/p&gt;
&lt;h3 id=&quot;creating-a-new-project&quot;&gt;Creating a New Project&lt;/h3&gt;
&lt;p&gt;Now that the Phoenix archive is installed locally if you run &lt;code&gt;mix help&lt;/code&gt;, you should see a new set of mix commands available in your system:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx                   &lt;span class=&quot;co&quot;&gt;# Prints Phoenix help information&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-2&quot;&gt;&lt;a href=&quot;#cb6-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx.digest            &lt;span class=&quot;co&quot;&gt;# Digests and compresses static files&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-3&quot;&gt;&lt;a href=&quot;#cb6-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx.digest.clean      &lt;span class=&quot;co&quot;&gt;# Removes old versions of static assets&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-4&quot;&gt;&lt;a href=&quot;#cb6-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx.gen.cert          &lt;span class=&quot;co&quot;&gt;# Generates a self-signed certificate for HTTPS testing&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-5&quot;&gt;&lt;a href=&quot;#cb6-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx.gen.channel       &lt;span class=&quot;co&quot;&gt;# Generates a Phoenix channel&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-6&quot;&gt;&lt;a href=&quot;#cb6-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx.gen.context       &lt;span class=&quot;co&quot;&gt;# Generates a context with functions around an Ecto schema&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-7&quot;&gt;&lt;a href=&quot;#cb6-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx.gen.embedded      &lt;span class=&quot;co&quot;&gt;# Generates an embedded Ecto schema file&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-8&quot;&gt;&lt;a href=&quot;#cb6-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx.gen.html          &lt;span class=&quot;co&quot;&gt;# Generates controller, views, and context for an HTML resource&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-9&quot;&gt;&lt;a href=&quot;#cb6-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx.gen.json          &lt;span class=&quot;co&quot;&gt;# Generates controller, views, and context for a JSON resource&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-10&quot;&gt;&lt;a href=&quot;#cb6-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx.gen.live          &lt;span class=&quot;co&quot;&gt;# Generates LiveView, templates, and context for a resource&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-11&quot;&gt;&lt;a href=&quot;#cb6-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx.gen.presence      &lt;span class=&quot;co&quot;&gt;# Generates a Presence tracker&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-12&quot;&gt;&lt;a href=&quot;#cb6-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx.gen.schema        &lt;span class=&quot;co&quot;&gt;# Generates an Ecto schema and migration file&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-13&quot;&gt;&lt;a href=&quot;#cb6-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx.gen.secret        &lt;span class=&quot;co&quot;&gt;# Generates a secret&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-14&quot;&gt;&lt;a href=&quot;#cb6-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx.new               &lt;span class=&quot;co&quot;&gt;# Creates a new Phoenix v1.5.4 application&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-15&quot;&gt;&lt;a href=&quot;#cb6-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx.new.ecto          &lt;span class=&quot;co&quot;&gt;# Creates a new Ecto project within an umbrella project&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-16&quot;&gt;&lt;a href=&quot;#cb6-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx.new.web           &lt;span class=&quot;co&quot;&gt;# Creates a new Phoenix web project within an umbrella project&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-17&quot;&gt;&lt;a href=&quot;#cb6-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx.routes            &lt;span class=&quot;co&quot;&gt;# Prints all routes&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-18&quot;&gt;&lt;a href=&quot;#cb6-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx.server            &lt;span class=&quot;co&quot;&gt;# Starts applications and their servers&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Running &lt;code&gt;mix phx.new&lt;/code&gt; from any directory will create a new Phoenix application. But before you dive in, it’s crucial that you understand the options available when making a Phoenix project. Let’s take a look by running the following command:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb7&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb7-1&quot;&gt;&lt;a href=&quot;#cb7-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; mix &lt;span class=&quot;bu&quot;&gt;help&lt;/span&gt; phx.new&lt;/span&gt;
&lt;span id=&quot;cb7-2&quot;&gt;&lt;a href=&quot;#cb7-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb7-3&quot;&gt;&lt;a href=&quot;#cb7-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;...&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb7-4&quot;&gt;&lt;a href=&quot;#cb7-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb7-5&quot;&gt;&lt;a href=&quot;#cb7-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;•&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--live&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-&lt;/span&gt; include Phoenix.LiveView to make it easier than ever to build&lt;/span&gt;
&lt;span id=&quot;cb7-6&quot;&gt;&lt;a href=&quot;#cb7-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ex&quot;&gt;interactive,&lt;/span&gt; real-time applications&lt;/span&gt;
&lt;span id=&quot;cb7-7&quot;&gt;&lt;a href=&quot;#cb7-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;•&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--umbrella&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-&lt;/span&gt; generate an umbrella project, with one application for&lt;/span&gt;
&lt;span id=&quot;cb7-8&quot;&gt;&lt;a href=&quot;#cb7-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ex&quot;&gt;your&lt;/span&gt; domain and a second application for the web interface&lt;/span&gt;
&lt;span id=&quot;cb7-9&quot;&gt;&lt;a href=&quot;#cb7-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;•&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--app&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-&lt;/span&gt; the name of the OTP application&lt;/span&gt;
&lt;span id=&quot;cb7-10&quot;&gt;&lt;a href=&quot;#cb7-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;•&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--module&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-&lt;/span&gt; the name of the base module in the generated skeleton&lt;/span&gt;
&lt;span id=&quot;cb7-11&quot;&gt;&lt;a href=&quot;#cb7-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;•&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--database&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-&lt;/span&gt; specify the database adapter for Ecto. One of:&lt;/span&gt;
&lt;span id=&quot;cb7-12&quot;&gt;&lt;a href=&quot;#cb7-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ex&quot;&gt;•&lt;/span&gt; postgres &lt;span class=&quot;at&quot;&gt;-&lt;/span&gt; via https://github.com/elixir-ecto/postgrex&lt;/span&gt;
&lt;span id=&quot;cb7-13&quot;&gt;&lt;a href=&quot;#cb7-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ex&quot;&gt;•&lt;/span&gt; mysql &lt;span class=&quot;at&quot;&gt;-&lt;/span&gt; via https://github.com/elixir-ecto/myxql&lt;/span&gt;
&lt;span id=&quot;cb7-14&quot;&gt;&lt;a href=&quot;#cb7-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ex&quot;&gt;•&lt;/span&gt; mssql &lt;span class=&quot;at&quot;&gt;-&lt;/span&gt; via https://github.com/livehelpnow/tds&lt;/span&gt;
&lt;span id=&quot;cb7-15&quot;&gt;&lt;a href=&quot;#cb7-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb7-16&quot;&gt;&lt;a href=&quot;#cb7-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ex&quot;&gt;Please&lt;/span&gt; check the driver docs for more information and requirements.&lt;/span&gt;
&lt;span id=&quot;cb7-17&quot;&gt;&lt;a href=&quot;#cb7-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ex&quot;&gt;Defaults&lt;/span&gt; to &lt;span class=&quot;st&quot;&gt;&amp;quot;postgres&amp;quot;&lt;/span&gt;.&lt;/span&gt;
&lt;span id=&quot;cb7-18&quot;&gt;&lt;a href=&quot;#cb7-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb7-19&quot;&gt;&lt;a href=&quot;#cb7-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;•&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--no-webpack&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-&lt;/span&gt; do not generate webpack files for static asset building.&lt;/span&gt;
&lt;span id=&quot;cb7-20&quot;&gt;&lt;a href=&quot;#cb7-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ex&quot;&gt;When&lt;/span&gt; choosing this option, you will need to manually handle JavaScript&lt;/span&gt;
&lt;span id=&quot;cb7-21&quot;&gt;&lt;a href=&quot;#cb7-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ex&quot;&gt;dependencies&lt;/span&gt; if building HTML apps&lt;/span&gt;
&lt;span id=&quot;cb7-22&quot;&gt;&lt;a href=&quot;#cb7-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;•&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--no-ecto&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-&lt;/span&gt; do not generate Ecto files&lt;/span&gt;
&lt;span id=&quot;cb7-23&quot;&gt;&lt;a href=&quot;#cb7-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;•&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--no-html&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-&lt;/span&gt; do not generate HTML views&lt;/span&gt;
&lt;span id=&quot;cb7-24&quot;&gt;&lt;a href=&quot;#cb7-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;•&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--no-gettext&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-&lt;/span&gt; do not generate gettext files&lt;/span&gt;
&lt;span id=&quot;cb7-25&quot;&gt;&lt;a href=&quot;#cb7-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;•&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--no-dashboard&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-&lt;/span&gt; do not include Phoenix.LiveDashboard&lt;/span&gt;
&lt;span id=&quot;cb7-26&quot;&gt;&lt;a href=&quot;#cb7-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;•&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--binary-id&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-&lt;/span&gt; use binary_id as primary key type in Ecto schemas&lt;/span&gt;
&lt;span id=&quot;cb7-27&quot;&gt;&lt;a href=&quot;#cb7-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ex&quot;&gt;•&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--verbose&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-&lt;/span&gt; use verbose output&lt;/span&gt;
&lt;span id=&quot;cb7-28&quot;&gt;&lt;a href=&quot;#cb7-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;/span&gt;
&lt;span id=&quot;cb7-29&quot;&gt;&lt;a href=&quot;#cb7-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;...&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let’s pay attention to the first option, &lt;code&gt;--live&lt;/code&gt;. As mentioned at the beginning of this tutorial, you’ll be building a fundraising application, so make sure to set up your Phoenix application to allow for real-time functionality from the get-go:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb8&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb8-1&quot;&gt;&lt;a href=&quot;#cb8-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; mix &lt;span class=&quot;ex&quot;&gt;phx.new&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--live&lt;/span&gt; phoenix_fund&lt;/span&gt;
&lt;span id=&quot;cb8-2&quot;&gt;&lt;a href=&quot;#cb8-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-3&quot;&gt;&lt;a href=&quot;#cb8-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;...&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-4&quot;&gt;&lt;a href=&quot;#cb8-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;*&lt;/span&gt; creating phoenix_fund/lib/phoenix_fund_web/router.ex&lt;/span&gt;
&lt;span id=&quot;cb8-5&quot;&gt;&lt;a href=&quot;#cb8-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;*&lt;/span&gt; creating phoenix_fund/lib/phoenix_fund_web/telemetry.ex&lt;/span&gt;
&lt;span id=&quot;cb8-6&quot;&gt;&lt;a href=&quot;#cb8-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;*&lt;/span&gt; creating phoenix_fund/lib/phoenix_fund_web.ex&lt;/span&gt;
&lt;span id=&quot;cb8-7&quot;&gt;&lt;a href=&quot;#cb8-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;*&lt;/span&gt; creating phoenix_fund/mix.exs&lt;/span&gt;
&lt;span id=&quot;cb8-8&quot;&gt;&lt;a href=&quot;#cb8-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;*&lt;/span&gt; creating phoenix_fund/README.md&lt;/span&gt;
&lt;span id=&quot;cb8-9&quot;&gt;&lt;a href=&quot;#cb8-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;...&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-10&quot;&gt;&lt;a href=&quot;#cb8-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-11&quot;&gt;&lt;a href=&quot;#cb8-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;*&lt;/span&gt; creating phoenix_fund/assets/static/robots.txt&lt;/span&gt;
&lt;span id=&quot;cb8-12&quot;&gt;&lt;a href=&quot;#cb8-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-13&quot;&gt;&lt;a href=&quot;#cb8-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;Fetch&lt;/span&gt; and install dependencies&lt;span class=&quot;pp&quot;&gt;?&lt;/span&gt; [Yn] &lt;/span&gt;
&lt;span id=&quot;cb8-14&quot;&gt;&lt;a href=&quot;#cb8-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;*&lt;/span&gt; running mix deps.get&lt;/span&gt;
&lt;span id=&quot;cb8-15&quot;&gt;&lt;a href=&quot;#cb8-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;*&lt;/span&gt; running mix deps.compile&lt;/span&gt;
&lt;span id=&quot;cb8-16&quot;&gt;&lt;a href=&quot;#cb8-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;*&lt;/span&gt; running cd assets &lt;span class=&quot;kw&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;npm&lt;/span&gt; install &lt;span class=&quot;kw&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;node&lt;/span&gt; node_modules/webpack/bin/webpack.js &lt;span class=&quot;at&quot;&gt;--mode&lt;/span&gt; development&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;mix phx.new&lt;/code&gt; will create the basic skeleton for your new Phoenix LiveView app and download all the dependencies on the Elixir and Node.js side of things.&lt;/p&gt;
&lt;p&gt;Next, provision your database and start the local Phoenix server:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb9&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb9-1&quot;&gt;&lt;a href=&quot;#cb9-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; mix &lt;span class=&quot;ex&quot;&gt;ecto.create&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;mix&lt;/span&gt; phx.server&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If everything is working correctly, you should be able to visit &lt;a href=&quot;http://localhost:4000&quot;&gt;localhost:4000&lt;/a&gt; and see the default Phoenix livewire homepage:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/real-time-phoenix-elixir/0N5VpNv.png&quot; alt=&quot;Out of the box installation&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Out of the box installation&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Now the app generated has the default Phoenix styling and setup, but let’s add a little polish for this exercise. You’re going to add &lt;a href=&quot;https://tailwindcss.com/&quot;&gt;TailwindCSS&lt;/a&gt; and some premade boilerplate CSS.&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;First, add the following dependencies to your &lt;code&gt;assets/package.json&lt;/code&gt; file, to install Tailwind and the necessary node libraries:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;er&quot;&gt;...&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-2&quot;&gt;&lt;a href=&quot;#cb10-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;er&quot;&gt;&amp;quot;devDependencies&amp;quot;:&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-3&quot;&gt;&lt;a href=&quot;#cb10-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;er&quot;&gt;...&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-4&quot;&gt;&lt;a href=&quot;#cb10-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;postcss&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;^8.1.10&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-5&quot;&gt;&lt;a href=&quot;#cb10-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;postcss-import&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;^13.0.0&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-6&quot;&gt;&lt;a href=&quot;#cb10-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;postcss-loader&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;^4.1.0&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-7&quot;&gt;&lt;a href=&quot;#cb10-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;postcss-nested&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;^4.2.1&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-8&quot;&gt;&lt;a href=&quot;#cb10-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;dt&quot;&gt;&amp;quot;tailwindcss&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;^2.0.1&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-9&quot;&gt;&lt;a href=&quot;#cb10-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;er&quot;&gt;...&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-10&quot;&gt;&lt;a href=&quot;#cb10-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;2&quot; type=&quot;1&quot;&gt;
&lt;li&gt;Next, make sure to install your new dependencies:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;npm&lt;/span&gt; install&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;3&quot; type=&quot;1&quot;&gt;
&lt;li&gt;Copy &lt;a href=&quot;https://gist.github.com/amacgregor/1369927cb4555803fa359c5ad9104fa9&quot;&gt;the webpack and Tailwind configuration from here&lt;/a&gt; into your assets directory:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;assets/tailwind.config.js
assets/webpack.config.js
assets/postcss.config.js&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot; type=&quot;1&quot;&gt;
&lt;li&gt;Copy &lt;a href=&quot;https://gist.github.com/amacgregor/66c7fd76b55332c77bbdb21c5f62940b&quot;&gt;these CSS files&lt;/a&gt; into the following locations:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;assets/css/app.css
assets/csss/custom.css&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;5&quot; type=&quot;1&quot;&gt;
&lt;li&gt;Finally change your application to use regular CSS instead of Sass by updating the &lt;code&gt;assets/js/app.js&lt;/code&gt; to:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;import &amp;quot;../css/app.css&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;adding-your-auction-route&quot;&gt;Adding Your Auction Route&lt;/h2&gt;
&lt;p&gt;Now that you have a project up with the base styling, you can start working on adding the routes and logic to show the auctions. Open your &lt;code&gt;lib/phoenix_fund_web/router.ex&lt;/code&gt; file and look for the following chunk of code:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb15&quot;&gt;&lt;pre class=&quot;sourceCode elixir&quot;&gt;&lt;code class=&quot;sourceCode elixir&quot;&gt;&lt;span id=&quot;cb15-1&quot;&gt;&lt;a href=&quot;#cb15-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  scope &lt;span class=&quot;st&quot;&gt;&amp;quot;/&amp;quot;&lt;/span&gt;, &lt;span class=&quot;cn&quot;&gt;PhoenixFundWeb&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-2&quot;&gt;&lt;a href=&quot;#cb15-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    pipe_through &lt;span class=&quot;va&quot;&gt;:browser&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-3&quot;&gt;&lt;a href=&quot;#cb15-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-4&quot;&gt;&lt;a href=&quot;#cb15-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    live &lt;span class=&quot;st&quot;&gt;&amp;quot;/&amp;quot;&lt;/span&gt;, &lt;span class=&quot;cn&quot;&gt;PageLive&lt;/span&gt;, &lt;span class=&quot;va&quot;&gt;:index&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-5&quot;&gt;&lt;a href=&quot;#cb15-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is the scaffold code that was generated when you generated the application. You want to add a new route for your actions, and you can do that easily by using the &lt;code&gt;live&lt;/code&gt; macro:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb16&quot;&gt;&lt;pre class=&quot;sourceCode elixir&quot;&gt;&lt;code class=&quot;sourceCode elixir&quot;&gt;&lt;span id=&quot;cb16-1&quot;&gt;&lt;a href=&quot;#cb16-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;op&quot;&gt;...&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-2&quot;&gt;&lt;a href=&quot;#cb16-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; live &lt;span class=&quot;st&quot;&gt;&amp;quot;/auction&amp;quot;&lt;/span&gt;, &lt;span class=&quot;cn&quot;&gt;AuctionLive&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It’s important to highlight that &lt;code&gt;AuctionLive&lt;/code&gt; is not a Phoenix controller. Rather, it’s a long-running LiveView process in charge of managing and tracking the state for that particular route.&lt;/p&gt;
&lt;p&gt;Go ahead and define your new module under &lt;code&gt;lib/phoenix_fund_web/live/auction_live.ex&lt;/code&gt;. By convention, the LiveView modules are placed under the &lt;code&gt;live&lt;/code&gt; directory.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb17&quot;&gt;&lt;pre class=&quot;sourceCode elixir&quot;&gt;&lt;code class=&quot;sourceCode elixir&quot;&gt;&lt;span id=&quot;cb17-1&quot;&gt;&lt;a href=&quot;#cb17-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;defmodule&lt;/span&gt; &lt;span class=&quot;cn&quot;&gt;PhoenixFundWeb&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;cn&quot;&gt;AuctionLive&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt; &lt;/span&gt;
&lt;span id=&quot;cb17-2&quot;&gt;&lt;a href=&quot;#cb17-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;im&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;cn&quot;&gt;PhoenixFundWeb&lt;/span&gt;, &lt;span class=&quot;va&quot;&gt;:live_view&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb17-3&quot;&gt;&lt;a href=&quot;#cb17-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;/span&gt;
&lt;span id=&quot;cb17-4&quot;&gt;&lt;a href=&quot;#cb17-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; mount(params, session, socket) &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb17-5&quot;&gt;&lt;a href=&quot;#cb17-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  {&lt;span class=&quot;va&quot;&gt;:ok&lt;/span&gt;, assign(socket, &lt;span class=&quot;va&quot;&gt;:raised&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;)}&lt;/span&gt;
&lt;span id=&quot;cb17-6&quot;&gt;&lt;a href=&quot;#cb17-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb17-7&quot;&gt;&lt;a href=&quot;#cb17-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is the core of a LiveView module. &lt;code&gt;mount/3&lt;/code&gt; is the entry point for each LiveView, and it will be invoked twice:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Once on the initial page load&lt;/li&gt;
&lt;li&gt;Once to establish a live socket&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It expects three parameters:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;params&lt;/code&gt;: A map of string keys with the query params&lt;/li&gt;
&lt;li&gt;&lt;code&gt;session&lt;/code&gt;: The connection session&lt;/li&gt;
&lt;li&gt;&lt;code&gt;socket&lt;/code&gt;: The LiveView socket struct&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In your &lt;code&gt;mount/3&lt;/code&gt; function, assign the initial status for your LiveView so it can be rendered. Next, define a &lt;code&gt;render/1&lt;/code&gt; function that will render your LiveView HTML.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb18&quot;&gt;&lt;pre class=&quot;sourceCode elixir&quot;&gt;&lt;code class=&quot;sourceCode elixir&quot;&gt;&lt;span id=&quot;cb18-1&quot;&gt;&lt;a href=&quot;#cb18-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;defmodule&lt;/span&gt; &lt;span class=&quot;cn&quot;&gt;PhoenixFundWeb&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;cn&quot;&gt;AuctionLive&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt; &lt;/span&gt;
&lt;span id=&quot;cb18-2&quot;&gt;&lt;a href=&quot;#cb18-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;...&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-3&quot;&gt;&lt;a href=&quot;#cb18-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; render(assigns) &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-4&quot;&gt;&lt;a href=&quot;#cb18-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;op&quot;&gt;~&lt;/span&gt;L&lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-5&quot;&gt;&lt;a href=&quot;#cb18-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;       &amp;lt;h1&amp;gt;Cabinet of Curiosities&amp;lt;/h1&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-6&quot;&gt;&lt;a href=&quot;#cb18-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;       &amp;lt;div id=&amp;quot;auction&amp;quot;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-7&quot;&gt;&lt;a href=&quot;#cb18-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;           &amp;lt;div class=&amp;quot;meter&amp;quot;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-8&quot;&gt;&lt;a href=&quot;#cb18-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;             &amp;lt;span style=&amp;quot;width: &amp;lt;%= @raised %&amp;gt;%&amp;quot;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-9&quot;&gt;&lt;a href=&quot;#cb18-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;               $&amp;lt;%= @raised %&amp;gt; USD&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-10&quot;&gt;&lt;a href=&quot;#cb18-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;             &amp;lt;/span&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-11&quot;&gt;&lt;a href=&quot;#cb18-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;           &amp;lt;/div&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-12&quot;&gt;&lt;a href=&quot;#cb18-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;        &amp;lt;/div&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-13&quot;&gt;&lt;a href=&quot;#cb18-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-14&quot;&gt;&lt;a href=&quot;#cb18-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-15&quot;&gt;&lt;a href=&quot;#cb18-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For now, you’ll provide the HTML directly on your function. Note that the &lt;code&gt;~L&lt;/code&gt; is a special syntax called a sigil; it’s used to represent Live EEx content.&lt;/p&gt;
&lt;p&gt;Start your Phoenix server and let’s try to load &lt;a href=&quot;http://localhost:4000/auction&quot;&gt;/auction&lt;/a&gt;. If everything was set up correctly, you should see the following:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/real-time-phoenix-elixir/6gnnM9k.png&quot; alt=&quot;Auction View&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Auction View&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Excellent! Your new route is now being rendered by your LiveView. Now it’s time to make it do something useful by adding a couple of buttons to allow people to donate.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb19&quot;&gt;&lt;pre class=&quot;sourceCode elixir&quot;&gt;&lt;code class=&quot;sourceCode elixir&quot;&gt;&lt;span id=&quot;cb19-1&quot;&gt;&lt;a href=&quot;#cb19-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;```elixir &lt;/span&gt;
&lt;span id=&quot;cb19-2&quot;&gt;&lt;a href=&quot;#cb19-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;defmodule&lt;/span&gt; &lt;span class=&quot;cn&quot;&gt;PhoenixFundWeb&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;cn&quot;&gt;AuctionLive&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt; &lt;/span&gt;
&lt;span id=&quot;cb19-3&quot;&gt;&lt;a href=&quot;#cb19-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;...&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-4&quot;&gt;&lt;a href=&quot;#cb19-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; render(assigns) &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-5&quot;&gt;&lt;a href=&quot;#cb19-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;op&quot;&gt;~&lt;/span&gt;L&lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-6&quot;&gt;&lt;a href=&quot;#cb19-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;       &amp;lt;h1&amp;gt;Cabinet of Curiosities&amp;lt;/h1&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-7&quot;&gt;&lt;a href=&quot;#cb19-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;       &amp;lt;div id=&amp;quot;auction&amp;quot;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-8&quot;&gt;&lt;a href=&quot;#cb19-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;           &amp;lt;div class=&amp;quot;meter&amp;quot;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-9&quot;&gt;&lt;a href=&quot;#cb19-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;             &amp;lt;span style=&amp;quot;width: &amp;lt;%= @raised %&amp;gt;%&amp;quot;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-10&quot;&gt;&lt;a href=&quot;#cb19-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;               $&amp;lt;%= @raised %&amp;gt; USD&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-11&quot;&gt;&lt;a href=&quot;#cb19-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;             &amp;lt;/span&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-12&quot;&gt;&lt;a href=&quot;#cb19-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;           &amp;lt;/div&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-13&quot;&gt;&lt;a href=&quot;#cb19-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;           &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-14&quot;&gt;&lt;a href=&quot;#cb19-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;        &amp;lt;button phx-click=&amp;quot;donate-1&amp;quot;&amp;gt; $1 &amp;lt;/button&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-15&quot;&gt;&lt;a href=&quot;#cb19-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;           &amp;lt;button phx-click=&amp;quot;donate-5&amp;quot;&amp;gt; $5 &amp;lt;/button&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-16&quot;&gt;&lt;a href=&quot;#cb19-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;           &amp;lt;button phx-click=&amp;quot;donate-10&amp;quot;&amp;gt; $10 &amp;lt;/button&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-17&quot;&gt;&lt;a href=&quot;#cb19-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;           &amp;lt;button phx-click=&amp;quot;donate-100&amp;quot;&amp;gt; $100 &amp;lt;/button&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-18&quot;&gt;&lt;a href=&quot;#cb19-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;        &amp;lt;/div&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-19&quot;&gt;&lt;a href=&quot;#cb19-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-20&quot;&gt;&lt;a href=&quot;#cb19-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-21&quot;&gt;&lt;a href=&quot;#cb19-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The page should look as follows:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/real-time-phoenix-elixir/kI2Zchu.png&quot; alt=&quot;Buttons added&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Buttons added&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;However, if you try to click any of your new buttons, you’re going to get an error like so:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
[error] GenServer #PID&amp;lt;0.935.0&amp;gt; terminating
** (FunctionClauseError) no function clause matching in PhoenixFundWeb.AuctionLive.handle_event/3
    (phoenix_fund 0.1.0) lib/phoenix_fund_web/live/auction_live.ex:26: PhoenixFundWeb.AuctionLive.handle_event(&amp;quot;donate-5&amp;quot;, %{&amp;quot;value&amp;quot; =&amp;gt; &amp;quot;&amp;quot;}, #Phoenix.LiveView.Socket&amp;lt;assigns: %{flash: %{}, live_action: nil, live_module: PhoenixFundWeb.AuctionLive, raised: 34}, changed: %{}, endpoint: PhoenixFundWeb.Endpoint, id: &amp;quot;phx-FmnbLK6vHaXG9gIk&amp;quot;, parent_pid: nil, root_pid: #PID&amp;lt;0.935.0&amp;gt;, router: PhoenixFundWeb.Router, view: PhoenixFundWeb.AuctionLive, ...&amp;gt;)
    (phoenix_live_view 0.13.0) lib/phoenix_live_view/channel.ex:102: Phoenix.LiveView.Channel.handle_info/2
    (stdlib 3.14) gen_server.erl:689: :gen_server.try_dispatch/4
    (stdlib 3.14) gen_server.erl:765: :gen_server.handle_msg/6
    (stdlib 3.14) proc_lib.erl:226: :proc_lib.init_p_do_apply/3
Last message: %Phoenix.Socket.Message{event: &amp;quot;event&amp;quot;, join_ref: &amp;quot;4&amp;quot;, payload: %{&amp;quot;event&amp;quot; =&amp;gt; &amp;quot;donate-5&amp;quot;, &amp;quot;type&amp;quot; =&amp;gt; &amp;quot;click&amp;quot;, &amp;quot;value&amp;quot; =&amp;gt; %{&amp;quot;value&amp;quot; =&amp;gt; &amp;quot;&amp;quot;}}, ref: &amp;quot;39&amp;quot;, topic: &amp;quot;lv:phx-FmnbLK6vHaXG9gIk&amp;quot;}
State: %{components: {%{}, %{}, 0}, join_ref: &amp;quot;4&amp;quot;, serializer: Phoenix.Socket.V2.JSONSerializer, socket: #Phoenix.LiveView.Socket&amp;lt;assigns: %{flash: %{}, live_action: nil, live_module: PhoenixFundWeb.AuctionLive, raised: 34}, changed: %{}, endpoint: PhoenixFundWeb.Endpoint, id: &amp;quot;phx-FmnbLK6vHaXG9gIk&amp;quot;, parent_pid: nil, root_pid: #PID&amp;lt;0.935.0&amp;gt;, router: PhoenixFundWeb.Router, view: PhoenixFundWeb.AuctionLive, ...&amp;gt;, topic: &amp;quot;lv:phx-FmnbLK6vHaXG9gIk&amp;quot;, transport_pid: #PID&amp;lt;0.929.0&amp;gt;}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;handling-events&quot;&gt;Handling Events&lt;/h2&gt;
&lt;p&gt;As you can see from the error, the Auction LiveView doesn’t currently know how to handle an event. As part of your button code, you added &lt;code&gt;phx-click&lt;/code&gt;; this is a &lt;strong&gt;binding&lt;/strong&gt; that sends a particular event like &lt;code&gt;donate-1&lt;/code&gt; back to your LiveView.&lt;/p&gt;
&lt;p&gt;Your next step is adding a new definition of &lt;code&gt;handle_event/3&lt;/code&gt; for each one of your events. Go ahead and add the first function definition to the handle of the $1 donation button event:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb21&quot;&gt;&lt;pre class=&quot;sourceCode elixir&quot;&gt;&lt;code class=&quot;sourceCode elixir&quot;&gt;&lt;span id=&quot;cb21-1&quot;&gt;&lt;a href=&quot;#cb21-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;defmodule&lt;/span&gt; &lt;span class=&quot;cn&quot;&gt;PhoenixFundWeb&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;cn&quot;&gt;AuctionLive&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt; &lt;/span&gt;
&lt;span id=&quot;cb21-2&quot;&gt;&lt;a href=&quot;#cb21-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;...&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb21-3&quot;&gt;&lt;a href=&quot;#cb21-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; handle_event(&lt;span class=&quot;st&quot;&gt;&amp;quot;donate-1&amp;quot;&lt;/span&gt;, _, socket) &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb21-4&quot;&gt;&lt;a href=&quot;#cb21-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    raised &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; socket&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;assigns&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;raised &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb21-5&quot;&gt;&lt;a href=&quot;#cb21-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    {&lt;span class=&quot;va&quot;&gt;:noreply&lt;/span&gt;, assign(socket, &lt;span class=&quot;va&quot;&gt;:raised&lt;/span&gt;, raised)}&lt;/span&gt;
&lt;span id=&quot;cb21-6&quot;&gt;&lt;a href=&quot;#cb21-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb21-7&quot;&gt;&lt;a href=&quot;#cb21-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code&gt;handle_event/3&lt;/code&gt; function takes three parameters:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The name of the event, in this case &lt;code&gt;donate-1&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;metadata&lt;/code&gt; about the event, that you can safely ignore for now&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;socket&lt;/code&gt;, which, if you remember, holds the state of your LiveView process&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Inside your &lt;code&gt;handle_event/3&lt;/code&gt;, you’re doing two things:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Retrieving the current &lt;code&gt;raised&lt;/code&gt; value from the &lt;code&gt;socket.assigns&lt;/code&gt; and increment it by &lt;code&gt;1&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Assigning the new value back to the socket&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If you reload your page and click on the $1 donation button, you should see the value correctly incrementing.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/real-time-phoenix-elixir/WA1gHtv.gif&quot; alt=&quot;Button working&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Button working&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Make sure to add the following code to handle the remaining events:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb22&quot;&gt;&lt;pre class=&quot;sourceCode elixir&quot;&gt;&lt;code class=&quot;sourceCode elixir&quot;&gt;&lt;span id=&quot;cb22-1&quot;&gt;&lt;a href=&quot;#cb22-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;defmodule&lt;/span&gt; &lt;span class=&quot;cn&quot;&gt;PhoenixFundWeb&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;cn&quot;&gt;AuctionLive&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt; &lt;/span&gt;
&lt;span id=&quot;cb22-2&quot;&gt;&lt;a href=&quot;#cb22-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;...&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb22-3&quot;&gt;&lt;a href=&quot;#cb22-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; handle_event(&lt;span class=&quot;st&quot;&gt;&amp;quot;donate-5&amp;quot;&lt;/span&gt;, _, socket) &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb22-4&quot;&gt;&lt;a href=&quot;#cb22-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    raised &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; socket&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;assigns&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;raised &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb22-5&quot;&gt;&lt;a href=&quot;#cb22-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    {&lt;span class=&quot;va&quot;&gt;:noreply&lt;/span&gt;, assign(socket, &lt;span class=&quot;va&quot;&gt;:raised&lt;/span&gt;, raised)}&lt;/span&gt;
&lt;span id=&quot;cb22-6&quot;&gt;&lt;a href=&quot;#cb22-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb22-7&quot;&gt;&lt;a href=&quot;#cb22-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb22-8&quot;&gt;&lt;a href=&quot;#cb22-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; handle_event(&lt;span class=&quot;st&quot;&gt;&amp;quot;donate-10&amp;quot;&lt;/span&gt;, _, socket) &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb22-9&quot;&gt;&lt;a href=&quot;#cb22-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    raised &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; socket&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;assigns&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;raised &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;10&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb22-10&quot;&gt;&lt;a href=&quot;#cb22-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    {&lt;span class=&quot;va&quot;&gt;:noreply&lt;/span&gt;, assign(socket, &lt;span class=&quot;va&quot;&gt;:raised&lt;/span&gt;, raised)}&lt;/span&gt;
&lt;span id=&quot;cb22-11&quot;&gt;&lt;a href=&quot;#cb22-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb22-12&quot;&gt;&lt;a href=&quot;#cb22-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb22-13&quot;&gt;&lt;a href=&quot;#cb22-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; handle_event(&lt;span class=&quot;st&quot;&gt;&amp;quot;donate-100&amp;quot;&lt;/span&gt;, _, socket) &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb22-14&quot;&gt;&lt;a href=&quot;#cb22-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    raised &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; socket&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;assigns&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;raised &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb22-15&quot;&gt;&lt;a href=&quot;#cb22-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    {&lt;span class=&quot;va&quot;&gt;:noreply&lt;/span&gt;, assign(socket, &lt;span class=&quot;va&quot;&gt;:raised&lt;/span&gt;, raised)}&lt;/span&gt;
&lt;span id=&quot;cb22-16&quot;&gt;&lt;a href=&quot;#cb22-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb22-17&quot;&gt;&lt;a href=&quot;#cb22-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;understanding-the-liveview-life-cycle&quot;&gt;Understanding the LiveView Life Cycle&lt;/h2&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/real-time-phoenix-elixir/rk4dJHg.png&quot; alt=&quot;LiveView Life Cycle&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;LiveView Life Cycle&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Let’s recap what you’ve done so far to better understand the LiveView life cycle:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Your application receives a request for a LiveView route.&lt;/li&gt;
&lt;li&gt;Your app will invoke that view &lt;code&gt;mount/2&lt;/code&gt; function and set the initial socket state.&lt;/li&gt;
&lt;li&gt;Next, it will call &lt;code&gt;render/1&lt;/code&gt; to render the static HTML to send back to the client.&lt;/li&gt;
&lt;li&gt;Opening a LiveView socket will pass the rendered HTML.&lt;/li&gt;
&lt;li&gt;The socket will remain open to receive events and handle updates on the LiveView process state.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;It is in this life cycle where one of the more powerful and interesting features of LiveView lies. As mentioned, LiveView is listening to your socket for updates but &lt;em&gt;it will only rerender the portions of the page that needed updating&lt;/em&gt;. In the case of this tutorial, the meter is the only piece that gets an update.&lt;/p&gt;
&lt;p&gt;This is one of the key features that makes Phoenix and LiveView extremely well suited for real-time applications.&lt;/p&gt;
&lt;h2 id=&quot;broadcasting-with-pubsub&quot;&gt;Broadcasting with PubSub&lt;/h2&gt;
&lt;p&gt;So far, you’ve built an app that can leverage Phoenix LiveView to allow users to donate in real time, but so far, there’s a caveat: updates are not shared across users or even tabs. Wouldn’t it be nice to get the donations to show in real time for everyone who has the page open?&lt;/p&gt;
&lt;p&gt;Next, you’ll leverage &lt;a href=&quot;https://github.com/phoenixframework/phoenix_pubsub&quot;&gt;PubSub&lt;/a&gt; to broadcast real-time updates to all LiveView clients, not just the one that triggers the event.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“Publish-subscribe is a messaging pattern where senders of messages, called publishers, do not program the messages to be sent directly to specific receivers, called subscribers, but instead categorize published messages into classes without knowledge of which subscribers, if any, there may be. Similarly, subscribers express interest in one or more classes and only receive messages that are of interest, without knowledge of which publishers, if any, there are.” –&lt;a href=&quot;https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern&quot;&gt;Wikipedia&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;In short, PubSub is a messaging pattern that will allow us to implement real-time asynchronous communication with any clients listening for events in our application. In the case of this tutorial, that will be every user with a fundraising page open.&lt;/p&gt;
&lt;h3 id=&quot;configure-phoenix-pubsub&quot;&gt;Configure Phoenix PubSub&lt;/h3&gt;
&lt;p&gt;First, you need to configure your app endpoint to use the &lt;code&gt;Phoenix.PubSub.PG2&lt;/code&gt; adapter. Add the following configuration to your &lt;code&gt;lib/phoenix_fund/application.ex&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb23&quot;&gt;&lt;pre class=&quot;sourceCode elixir&quot;&gt;&lt;code class=&quot;sourceCode elixir&quot;&gt;&lt;span id=&quot;cb23-1&quot;&gt;&lt;a href=&quot;#cb23-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;{&lt;span class=&quot;cn&quot;&gt;Phoenix&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;cn&quot;&gt;PubSub&lt;/span&gt;, [&lt;span class=&quot;va&quot;&gt;name:&lt;/span&gt; &lt;span class=&quot;cn&quot;&gt;PhoenixFund&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;cn&quot;&gt;PubSub&lt;/span&gt;, &lt;span class=&quot;va&quot;&gt;adapter:&lt;/span&gt; &lt;span class=&quot;cn&quot;&gt;Phoenix&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;cn&quot;&gt;PubSub&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;cn&quot;&gt;PG2&lt;/span&gt;]},&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;subscribing-to-a-topic&quot;&gt;Subscribing to a Topic&lt;/h3&gt;
&lt;p&gt;Next, tell your LiveView process to subscribe to a specific topic when the LiveView mounts. You can leverage &lt;code&gt;Phoenix.PubSub.subscribe/3&lt;/code&gt; for that:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb24&quot;&gt;&lt;pre class=&quot;sourceCode elixir&quot;&gt;&lt;code class=&quot;sourceCode elixir&quot;&gt;&lt;span id=&quot;cb24-1&quot;&gt;&lt;a href=&quot;#cb24-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;defmodule&lt;/span&gt; &lt;span class=&quot;cn&quot;&gt;PhoenixFundWeb&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;cn&quot;&gt;AuctionLive&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb24-2&quot;&gt;&lt;a href=&quot;#cb24-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;im&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;cn&quot;&gt;PhoenixFundWeb&lt;/span&gt;, &lt;span class=&quot;va&quot;&gt;:live_view&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb24-3&quot;&gt;&lt;a href=&quot;#cb24-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;/span&gt;
&lt;span id=&quot;cb24-4&quot;&gt;&lt;a href=&quot;#cb24-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;ot&quot;&gt;@topic&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;auction&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb24-5&quot;&gt;&lt;a href=&quot;#cb24-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb24-6&quot;&gt;&lt;a href=&quot;#cb24-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; mount(params, session, socket) &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb24-7&quot;&gt;&lt;a href=&quot;#cb24-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;   &lt;span class=&quot;cn&quot;&gt;PhoenixFundWeb&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;cn&quot;&gt;Endpoint&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;subscribe(&lt;span class=&quot;ot&quot;&gt;@topic&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb24-8&quot;&gt;&lt;a href=&quot;#cb24-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    {&lt;span class=&quot;va&quot;&gt;:ok&lt;/span&gt;, assign(socket, &lt;span class=&quot;va&quot;&gt;:raised&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;)}&lt;/span&gt;
&lt;span id=&quot;cb24-9&quot;&gt;&lt;a href=&quot;#cb24-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb24-10&quot;&gt;&lt;a href=&quot;#cb24-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;...&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb24-11&quot;&gt;&lt;a href=&quot;#cb24-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You’ll use a generic &lt;code&gt;auction&lt;/code&gt; topic, as you’re only dealing with a single auction.&lt;/p&gt;
&lt;h3 id=&quot;broadcasting-to-all-subscribers&quot;&gt;Broadcasting to All Subscribers&lt;/h3&gt;
&lt;p&gt;Your next step is to modify each of your &lt;code&gt;handle_event/3&lt;/code&gt; definitions to broadcast. The updated code looks like:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb25&quot;&gt;&lt;pre class=&quot;sourceCode elixir&quot;&gt;&lt;code class=&quot;sourceCode elixir&quot;&gt;&lt;span id=&quot;cb25-1&quot;&gt;&lt;a href=&quot;#cb25-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; handle_event(&lt;span class=&quot;st&quot;&gt;&amp;quot;donate-1&amp;quot;&lt;/span&gt;, _, socket) &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-2&quot;&gt;&lt;a href=&quot;#cb25-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    raised &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; socket&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;assigns&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;raised &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-3&quot;&gt;&lt;a href=&quot;#cb25-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cn&quot;&gt;PhoenixFundWeb&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;cn&quot;&gt;Endpoint&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;broadcast_from(self(), &lt;span class=&quot;ot&quot;&gt;@topic&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;donate_event&amp;quot;&lt;/span&gt;, raised)&lt;/span&gt;
&lt;span id=&quot;cb25-4&quot;&gt;&lt;a href=&quot;#cb25-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    {&lt;span class=&quot;va&quot;&gt;:noreply&lt;/span&gt;, assign(socket, &lt;span class=&quot;va&quot;&gt;:raised&lt;/span&gt;, raised)}&lt;/span&gt;
&lt;span id=&quot;cb25-5&quot;&gt;&lt;a href=&quot;#cb25-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-6&quot;&gt;&lt;a href=&quot;#cb25-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-7&quot;&gt;&lt;a href=&quot;#cb25-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; handle_event(&lt;span class=&quot;st&quot;&gt;&amp;quot;donate-5&amp;quot;&lt;/span&gt;, _, socket) &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-8&quot;&gt;&lt;a href=&quot;#cb25-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    raised &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; socket&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;assigns&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;raised &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-9&quot;&gt;&lt;a href=&quot;#cb25-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cn&quot;&gt;PhoenixFundWeb&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;cn&quot;&gt;Endpoint&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;broadcast_from(self(), &lt;span class=&quot;ot&quot;&gt;@topic&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;donate_event&amp;quot;&lt;/span&gt;, raised)&lt;/span&gt;
&lt;span id=&quot;cb25-10&quot;&gt;&lt;a href=&quot;#cb25-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    {&lt;span class=&quot;va&quot;&gt;:noreply&lt;/span&gt;, assign(socket, &lt;span class=&quot;va&quot;&gt;:raised&lt;/span&gt;, raised)}&lt;/span&gt;
&lt;span id=&quot;cb25-11&quot;&gt;&lt;a href=&quot;#cb25-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-12&quot;&gt;&lt;a href=&quot;#cb25-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-13&quot;&gt;&lt;a href=&quot;#cb25-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; handle_event(&lt;span class=&quot;st&quot;&gt;&amp;quot;donate-10&amp;quot;&lt;/span&gt;, _, socket) &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-14&quot;&gt;&lt;a href=&quot;#cb25-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    raised &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; socket&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;assigns&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;raised &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;10&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-15&quot;&gt;&lt;a href=&quot;#cb25-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cn&quot;&gt;PhoenixFundWeb&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;cn&quot;&gt;Endpoint&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;broadcast_from(self(), &lt;span class=&quot;ot&quot;&gt;@topic&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;donate_event&amp;quot;&lt;/span&gt;, raised)&lt;/span&gt;
&lt;span id=&quot;cb25-16&quot;&gt;&lt;a href=&quot;#cb25-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    {&lt;span class=&quot;va&quot;&gt;:noreply&lt;/span&gt;, assign(socket, &lt;span class=&quot;va&quot;&gt;:raised&lt;/span&gt;, raised)}&lt;/span&gt;
&lt;span id=&quot;cb25-17&quot;&gt;&lt;a href=&quot;#cb25-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-18&quot;&gt;&lt;a href=&quot;#cb25-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-19&quot;&gt;&lt;a href=&quot;#cb25-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; handle_event(&lt;span class=&quot;st&quot;&gt;&amp;quot;donate-100&amp;quot;&lt;/span&gt;, _, socket) &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-20&quot;&gt;&lt;a href=&quot;#cb25-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    raised &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; socket&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;assigns&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;raised &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb25-21&quot;&gt;&lt;a href=&quot;#cb25-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cn&quot;&gt;PhoenixFundWeb&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;cn&quot;&gt;Endpoint&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;broadcast_from(self(), &lt;span class=&quot;ot&quot;&gt;@topic&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;donate_event&amp;quot;&lt;/span&gt;, raised)&lt;/span&gt;
&lt;span id=&quot;cb25-22&quot;&gt;&lt;a href=&quot;#cb25-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    {&lt;span class=&quot;va&quot;&gt;:noreply&lt;/span&gt;, assign(socket, &lt;span class=&quot;va&quot;&gt;:raised&lt;/span&gt;, raised)}&lt;/span&gt;
&lt;span id=&quot;cb25-23&quot;&gt;&lt;a href=&quot;#cb25-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You’re using the &lt;code&gt;Phoenix.PubSub.broadcast_from/4&lt;/code&gt; function, which allows you to broadcast a message describing a new socket state to all the LiveView clients that are subscribed to a topic. Notice that you’re not triggering the click event on the other clients, just letting them know that the socket state has changed.&lt;/p&gt;
&lt;p&gt;Finally, now that you’re broadcasting the socket updates, you need to tell your LiveView process how to handle the incoming broadcasts. For this, add a &lt;code&gt;handle_info/2&lt;/code&gt; that will pattern match against the broadcast struct:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb26&quot;&gt;&lt;pre class=&quot;sourceCode elixir&quot;&gt;&lt;code class=&quot;sourceCode elixir&quot;&gt;&lt;span id=&quot;cb26-1&quot;&gt;&lt;a href=&quot;#cb26-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; handle_info(%{&lt;span class=&quot;va&quot;&gt;topic:&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;@topic&lt;/span&gt;, &lt;span class=&quot;va&quot;&gt;payload:&lt;/span&gt; raised}, socket) &lt;span class=&quot;kw&quot;&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb26-2&quot;&gt;&lt;a href=&quot;#cb26-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    {&lt;span class=&quot;va&quot;&gt;:noreply&lt;/span&gt;, assign(socket, &lt;span class=&quot;va&quot;&gt;:raised&lt;/span&gt;, raised)}&lt;/span&gt;
&lt;span id=&quot;cb26-3&quot;&gt;&lt;a href=&quot;#cb26-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;kw&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you start up your application and open two browser windows side by side, you should see the donation meter updating on all windows as soon anyone clicks any of the donation buttons.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/real-time-phoenix-elixir/tiqB8O5.gif&quot; alt=&quot;Broadcast in real time&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Broadcast in real time&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;in-summary&quot;&gt;In Summary&lt;/h2&gt;
&lt;p&gt;As you’ve learned, Phoenix offers a powerful set of libraries, making it relatively easy to create real-time applications with very little code and, even more surprisingly, no JavaScript at all. With LiveView, you can create fully fledged real-time features using only server-side code, and when you add Phoenix PubSub, you can open those same features to all app users in real time.&lt;/p&gt;
&lt;p&gt;Of course, we’ve only begun to scratch the surface here of what you can do with Phoenix, LiveView, and PubSub. If you want to keep going with this project, I would recommend tackling adding persistence next, and the ability to create multiple auctions with &lt;a href=&quot;https://hexdocs.pm/ecto/getting-started.html&quot;&gt;Ecto&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Both Ecto and the Phoenix project use &lt;a href=&quot;https://earthly.dev&quot;&gt;Earthly&lt;/a&gt; for defining their continuous integration process, so examining &lt;a href=&quot;https://github.com/elixir-ecto/ecto/blob/master/Earthfile&quot;&gt;those&lt;/a&gt; &lt;a href=&quot;https://github.com/phoenixframework/phoenix/blob/master/Earthfile&quot;&gt;projects&lt;/a&gt; can be a great way to learn more about Earthly.&lt;/p&gt;
&lt;h3 id=&quot;additional-resources&quot;&gt;Additional Resources&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://pragmaticstudio.com/phoenix-liveview&quot;&gt;The Pragmatic Studio: Phoenix LiveView Course&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://pragprog.com/titles/liveview/programming-phoenix-liveview/&quot;&gt;&lt;em&gt;Programming Phoenix LiveView&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/amacgregor/phoenix_fund&quot;&gt;Full source code&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Allan MacGregor</name></author><category term="Tutorials" /><summary type="html">The Elixir language, along with the Phoenix framework, has been growing in popularity at a quick pace, and with good reason. Phoenix offers productivity levels comparable to frameworks like Ruby on Rails while being one of the fastest web frameworks available.</summary></entry><entry><title type="html">Welcoming Wes McKinney as an advisor to Earthly</title><link href="https://earthly.dev/blog/wes-mckinney/" rel="alternate" type="text/html" title="Welcoming Wes McKinney as an advisor to Earthly" /><published>2021-04-15T00:00:00-04:00</published><updated>2020-04-15T00:00:00-04:00</updated><id>https://earthly.dev/blog/wes-mckinney</id><content type="html" xml:base="https://earthly.dev/blog/wes-mckinney/">&lt;p&gt;In our journey to bring repeatable builds to the world, we have had the pleasure to talk to a number of industry veterans about the challenges surrounding CIs today. One person that was particularly excited about our mission is &lt;a href=&quot;https://en.wikipedia.org/wiki/Wes_McKinney&quot;&gt;Wes McKinney&lt;/a&gt;, the author of &lt;a href=&quot;https://www.oreilly.com/library/view/python-for-data/9781449323592/&quot;&gt;Python for Data Analysis&lt;/a&gt;, the creator of the very popular &lt;a href=&quot;https://github.com/pandas-dev/pandas&quot;&gt;pandas&lt;/a&gt; Python package, co-creator of &lt;a href=&quot;https://arrow.apache.org/&quot;&gt;Apache Arrow&lt;/a&gt;, and CEO of &lt;a href=&quot;https://ursacomputing.com/&quot;&gt;Ursa Computing&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Wes immediately recognized the issues of modern builds, including the need for better and more scalable tooling for monorepos, the need for reducing duplication, and the need to improve build speeds through the use of distributed compute and distributed caching.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I’ve seen the many ways that a large project’s CI/CD systems can hit a scalability wall and bring down the productivity of the whole development team. In Apache Arrow, with its many programming languages and the need to test a wide variety of integrations in a reproducible way, we created a complex homegrown CI framework to meet our needs. Building and maintaining this system has almost been a full-time job. When I learned about Earthly, I was excited to see innovative work happening in containerized build and testing automation. I’m hopeful that complex projects like ours will be able to save time in the future by building on better off-the-shelf tools like Earthly.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p style=&quot;text-align: right&quot;&gt;
– Wes McKinney
&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/blog/assets/images/wes-mckinney/Wes_McKinney_Headshot.jpg&quot; alt=&quot;Wes McKinney&quot; width=&quot;250px&quot; style=&quot;float: left; margin: 30px;&quot;&gt;&lt;/p&gt;
&lt;p&gt;Wes will be helping us better understand the challenges of software builds in data engineering communities and also will help Earthly be successful in these circles.&lt;/p&gt;
&lt;p&gt;We are grateful and proud to have Wes McKinney onboard as an advisor. The world of software engineering is vast and industry veterans such as Wes allow us to tune our technology to the needs of the various communities out there. The more we connect with great minds in tech, the more Earthly gets better for everyone else.&lt;/p&gt;
&lt;p&gt;If you are an Earthly user, please join me in welcoming Wes to the Earthly family! &lt;a href=&quot;https://twitter.com/wesmckinn&quot;&gt;Follow Wes on Twitter&lt;/a&gt; and let him know why you’re excited about Earthly. If you aren’t a user yet, you’re missing out! ;-) Come give Earthly a try at &lt;a href=&quot;https://earthly.dev&quot;&gt;earthly.dev&lt;/a&gt;.&lt;/p&gt;</content><author><name>Vlad A. Ionescu</name></author><category term="News" /><category term="advisor" /><category term="data-engineering" /><summary type="html">&quot;When I learned about Earthly, I was excited to see innovative work happening in containerized build and testing automation.&quot;</summary></entry><entry><title type="html">Addressing Slow Performance in Jenkins</title><link href="https://earthly.dev/blog/slow-performance-in-jenkins/" rel="alternate" type="text/html" title="Addressing Slow Performance in Jenkins" /><published>2021-04-12T00:00:00-04:00</published><updated>2021-04-12T00:00:00-04:00</updated><id>https://earthly.dev/blog/slow-performance-in-jenkins</id><content type="html" xml:base="https://earthly.dev/blog/slow-performance-in-jenkins/">&lt;p&gt;There’s nothing more frustrating than a sluggish continuous integration system. It slows down feedback loops and prevents code from reaching production quickly. While quick fixes like using a bigger CI server can buy you time, you ultimately have to invest in maintaining the performance of your continuous integration workflow.&lt;/p&gt;
&lt;p&gt;Jenkins is one of the most popular CI/CD tools out there, but its users often &lt;a href=&quot;https://issues.jenkins.io/browse/JENKINS-56243?page=com.atlassian.jira.plugin.system.issuetabpanels%3Aall-tabpanel&quot;&gt;experience lagging and responsiveness issues over time&lt;/a&gt;. In this guide, I’ll share an overview of some of the biggest Jenkins performance issues and some tips for significantly improving performance without necessarily upgrading your hardware.&lt;/p&gt;
&lt;h2 id=&quot;why-is-jenkins-such-a-popular-option-for-cicd&quot;&gt;Why Is Jenkins Such a Popular Option for CI/CD?&lt;/h2&gt;
&lt;p&gt;Jenkins is a Java-based, open-source tool that is leveraged by &lt;a href=&quot;https://www.businesswire.com/news/home/20181024005509/en/Jenkins-Community-Achieves-Record-Growth-Driven-by-Major-Innovation&quot;&gt;tens of thousands&lt;/a&gt; of developers on hundreds of thousands of installations, making it the most popular automation server. This widespread use means that it’s easy to find support and tips for Jenkins, but that’s not the only reason it’s so widely used.&lt;/p&gt;
&lt;p&gt;Jenkins brought a lot of interesting paradigms to CI workflows, including:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Faster deployment.&lt;/strong&gt; Gone are the days when a build was tested and deployed once after all the developers committed their code. With Jenkins’ automated CI/CD pipeline, whenever a developer commits code, it’s built and tested throughout the day across multiple cycles.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;a href=&quot;https://www.jenkins.io/doc/book/scaling/architecting-for-scale/&quot;&gt;Scalable master-agent architecture&lt;/a&gt;.&lt;/strong&gt; When it comes to managing distributed builds at scale, Jenkins can be a good choice. Jenkins’ primary server is the master that schedules build jobs and assigns them to agents (formerly, slaves) for execution. This pattern allows you to run Jenkins on one or hundreds of servers to speed up your builds.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Thousands of plugins:&lt;/strong&gt; Being an open-source platform, Jenkins provides a plethora of plugins for continuous integration built by other developers. This allows you to extend the base functionality without writing or maintaining much extra code in-house.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;overcoming-common-jenkins-performance-issues&quot;&gt;Overcoming Common Jenkins Performance Issues&lt;/h2&gt;
&lt;p&gt;Over time, increased build frequency, multiple jobs running in parallel, and increasing build complexity can lead to performance issues in Jenkins. Your experience will likely vary based on your use case, but some common issues include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;“Hangups” where the build seems “stuck” on a specific step each time it runs.&lt;/li&gt;
&lt;li&gt;Hitting memory limits on individual machines or the master node.&lt;/li&gt;
&lt;li&gt;CPU bottlenecks that slow down specific parts of a build.&lt;/li&gt;
&lt;li&gt;Bugs or inefficient code in plugins or scripts.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Since these issues can be caused by a wide variety of root causes, it’s hard to generalize the solutions, but there are a few things that Jenkins users might want to look into. Here are some of the most universal ways you can improve your Jenkins build performance and limit the frequency of issues like those above.&lt;/p&gt;
&lt;h3 id=&quot;avoid-complex-groovy-script-in-your-pipelines&quot;&gt;1. Avoid Complex Groovy Script In Your Pipelines&lt;/h3&gt;
&lt;p&gt;The &lt;a href=&quot;https://www.jenkins.io/doc/book/managing/script-console/&quot;&gt;Jenkins Groovy script console&lt;/a&gt; is executed on the master node and directly uses master resources such as CPU and memory. Therefore, it’s recommended that you reduce the number as well as the complexity of Groovy scripts in your pipelines and instead favor plugins that can be run on each agent directly.&lt;/p&gt;
&lt;p&gt;The most common Groovy methods to avoid in Jenkins are JsonSlurper, Jenkins.getInstance, and HttpRequest. Jenkins has more suggestions for &lt;a href=&quot;https://www.jenkins.io/blog/2017/02/01/pipeline-scalability-best-practice/&quot;&gt;scalable pipeline code and the operations to avoid on its blog&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;keep-builds-minimal-at-the-master-node&quot;&gt;2. Keep Builds Minimal at the Master Node&lt;/h3&gt;
&lt;p&gt;Jenkins’ master node sits at the epicenter of the whole CI/CD process, where the application runs. Hence, the number of builds on the master node significantly affects resource usage. Keeping fewer builds on the master node will leave enough CPU and memory for agent nodes to schedule and trigger jobs.&lt;/p&gt;
&lt;p&gt;You can use the “&lt;a href=&quot;https://stackoverflow.com/questions/13946929/ci-with-jenkins-how-to-force-building-happen-on-slaves-instead-of-master&quot;&gt;Restrict where project can be run&lt;/a&gt;” option in your job. While Jenkins will still run &lt;a href=&quot;https://support.cloudbees.com/hc/en-us/articles/360012808951-Pipeline-Difference-between-flyweight-and-heavyweight-Executors&quot;&gt;a flyweight executor&lt;/a&gt; on the master node, your heavyweight executors will run on the agent nodes.&lt;/p&gt;
&lt;p&gt;Think of the master node as the brain of your Jenkins. Unlike agents, the master node can’t be purged or replaced. So, to ensure optimum CI/CD functioning, consider doing some performance tuning on your Jenkins and free up the master node from unnecessary tasks. This will leave you with ample memory and CPU for effective scheduling and build triggers over agents.&lt;/p&gt;
&lt;h3 id=&quot;dont-bloat-the-jenkins-master-installation&quot;&gt;3. Don’t Bloat the Jenkins Master Installation&lt;/h3&gt;
&lt;p&gt;DevOps professionals often work across multiple teams and projects for CI/CD-related tasks. If that’s your situation, take care not to burden a single Jenkins master. Instead, create multiple masters. Multiple masters will ensure project-specific resource allocation to masters, and you’ll also avoid plugin collision.&lt;/p&gt;
&lt;p&gt;Moreover, rather than setting up a long build that might fail anywhere in the cycle, remember to break your build into multiple smaller jobs.&lt;/p&gt;
&lt;h3 id=&quot;make-agent-management-effortless&quot;&gt;4. Make Agent Management Effortless&lt;/h3&gt;
&lt;p&gt;While setting up Jenkins, it’s important to set up the agents correctly. You want to make sure that when the time comes, you can add new agents or replace existing ones easily. To achieve this, consider creating a virtual machine image for the agent. You might also consider running Jenkins inside a &lt;a href=&quot;https://devopscube.com/docker-containers-as-build-slaves-jenkins/&quot;&gt;Docker container&lt;/a&gt; in a scalable cluster like Kubernetes or &lt;a href=&quot;/blog/how-to-setup-and-use-amazons-elastic-container-registry&quot;&gt;Amazon EKS&lt;/a&gt; where scaling agents is simple.&lt;/p&gt;
&lt;p&gt;It’s also a good idea to make agents generic and versatile; an agent should run multiple different jobs and utilize resources to the fullest extent.&lt;/p&gt;
&lt;h3 id=&quot;remove-older-builds&quot;&gt;5. Remove Older Builds&lt;/h3&gt;
&lt;p&gt;After a while, Jenkins builds can pile up, and disk consumption may get out of hand. Developers often overlook Jenkins’ &lt;a href=&quot;https://plugins.jenkins.io/discard-old-build/&quot;&gt;Discard Old Builds&lt;/a&gt; option. Set metrics, such as the number of builds and days to keep builds and artifacts are under the Jenkins Log Rotation menu.&lt;/p&gt;
&lt;p&gt;Rather than letting old builds accumulate and consume a file system, developers can enable &lt;em&gt;Discard Old Builds&lt;/em&gt; and enjoy automated resource usage cleanup once a Jenkins job finishes. You can also use the &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/g1_gc.html&quot;&gt;G1 garbage collector&lt;/a&gt; instead of Java 8’s default &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/parallel.html&quot;&gt;Parallel GC&lt;/a&gt; since the former is a server-style garbage collector with a lower GC pause time.&lt;/p&gt;
&lt;p&gt;Builds can also be removed &lt;a href=&quot;https://superuser.com/a/1418896/92661&quot;&gt;manually&lt;/a&gt; via the Jenkins command line or using a &lt;a href=&quot;https://opensource.com/article/17/11/how-use-cron-linux&quot;&gt;cron job&lt;/a&gt; that periodically cleans up old builds. You can find other options for discarding old build data &lt;a href=&quot;https://support.cloudbees.com/hc/en-us/articles/215549798-Deleting-Old-Builds-Best-Strategy-for-Cleanup-and-disk-space-management&quot;&gt;in this reference post&lt;/a&gt;.&lt;/p&gt;
&lt;h4 id=&quot;prevent-resource-collision-in-parallel-jobs&quot;&gt;Prevent Resource Collision in Parallel Jobs&lt;/h4&gt;
&lt;p&gt;Jobs running in parallel might want exclusive access to ports or resources. This may cause a collision, fail a build and further slow down your Jenkins pipeline. For example, if you run multiple builds in parallel, there’s a high chance they might collide while accessing a resource, say, Postgres’s database port 5432.&lt;/p&gt;
&lt;p&gt;Jenkins offers the &lt;a href=&quot;https://plugins.jenkins.io/throttle-concurrents/&quot;&gt;Throttle Concurrent Builds&lt;/a&gt; plugin to help regulate the number of concurrent builds on Jenkins nodes:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;// Throttle a single operation
throttle([&amp;#39;test_1&amp;#39;]) {
    node() {
        sh &amp;quot;sleep 100&amp;quot;
        echo &amp;quot;Done&amp;quot;
    }
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You’ll need to do some testing to see how many parallel builds your system can handle, but knowing how to set this limit and modify it will help you get started.&lt;/p&gt;
&lt;h3 id=&quot;lower-heap-size&quot;&gt;6. Lower Heap Size&lt;/h3&gt;
&lt;p&gt;Do you want to create CI/CD pipelines that are performance-oriented and never fail with a memory leak or out-of-memory errors? Pay attention to the &lt;em&gt;heap size&lt;/em&gt;. As the number of Jenkins builds grows, the default heap size can be a limiting factor leading to out-of-memory errors if not attended to.&lt;/p&gt;
&lt;p&gt;A majority of modern Java applications start with the maximum heap size configuration during startup. For Jenkins to run smoothly, lower the maximum heap size property to a maximum of &lt;a href=&quot;https://docs.cloudbees.com/docs/admin-resources/latest/jvm-troubleshooting/#_heap_size&quot;&gt;4 GB&lt;/a&gt; for starters. You can increase the heap size over time, depending on the Jenkins builds.&lt;/p&gt;
&lt;p&gt;To set the heap size to 4 GB:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Refer to &lt;code&gt;/etc/default/jenkins&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Pass &lt;code&gt;JAVA_ARGS=&quot;-Xmx4096m&quot;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;avoid-plugin-overload&quot;&gt;7. Avoid Plugin Overload&lt;/h3&gt;
&lt;p&gt;With over a thousand plugins available, Jenkins offers its users many capabilities for empowering their CI/CD pipelines. However, keep performance in mind when adding plugins and external services to your pipeline. Integrating Jenkins with external services will often slow down the Jenkins UI and lead to adverse effects, like dropped agents or disconnections.&lt;/p&gt;
&lt;p&gt;In order to determine if a plugin is causing your builds to slow down, you can try running your builds with all or some plugins disabled. Gradually add each back to determine which is causing the bottleneck. Once you find the plugin (or combination of plugins) causing the performance issue, you have a few options:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;strong&gt;Find a replacement plugin&lt;/strong&gt; by searching the &lt;a href=&quot;https://plugins.jenkins.io/&quot;&gt;Jenkins Plugin Index&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;See if Jenkins has added native support&lt;/strong&gt; for this feature by checking &lt;a href=&quot;https://www.jenkins.io/changelog/&quot;&gt;the changelog&lt;/a&gt;. You may have to upgrade Jenkins to get the latest features, but this is generally a good idea for performance anyway.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Replace the plugin with a custom script&lt;/strong&gt; bearing in mind that this could introduce new performance issues. Still, if you install a complex plugin, but only use one or two small features, a script might be more efficient.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Remove the plugin&lt;/strong&gt; if you can live without it. Sometimes this is a worthwhile tradeoff.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;tracking-jenkins-performance&quot;&gt;Tracking Jenkins Performance&lt;/h2&gt;
&lt;p&gt;As you start tuning your Jenkins performance, you might be interested in adding a plugin to help monitor and improve performance. For example, you can leverage the &lt;a href=&quot;https://plugins.jenkins.io/monitoring/&quot;&gt;Jenkins Monitoring plugin&lt;/a&gt; to get deep insights into your CI/CD pipeline, including:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Errors and logs&lt;/li&gt;
&lt;li&gt;Charts for CPU, memory, and average system load&lt;/li&gt;
&lt;li&gt;Reports on HTTP sessions and HTTP response time&lt;/li&gt;
&lt;li&gt;Detailed statistics for build time and build steps&lt;/li&gt;
&lt;li&gt;Aggregated heap histogram for all nodes&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;https://i.imgur.com/mE6fSdy.png&quot; alt=&quot;Jenkins Performance Monitoring Tool&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Jenkins Performance Monitoring Tool&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;This can help you assess the effectiveness of your performance tweaks and guide you as you continue to improve your Jenkins installation.&lt;/p&gt;
&lt;h2 id=&quot;wrapping-it-up&quot;&gt;Wrapping It Up&lt;/h2&gt;
&lt;p&gt;Jenkins’ responsiveness issues are common, especially when dealing with heavier builds. Broken Jenkins CI/CD pipelines can stall your development teams and create unnecessary dependencies. The tips discussed in this article should help you boost the performance of your Jenkins CI/CD pipeline significantly.&lt;/p&gt;
&lt;p&gt;Looking to make your builds more repeatable? &lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; replaces clunky &lt;a href=&quot;/blog/understanding-bash&quot;&gt;bash scripts&lt;/a&gt; and makefiles by giving you a single understandable, consistent definition for your CI/CD builds and it works great with Jekyll. Learn more &lt;a href=&quot;https://earthly.dev/&quot;&gt;at Earthly.dev&lt;/a&gt;.&lt;/p&gt;</content><author><name>Milan Bhardwaj</name></author><category term="Tutorials" /><summary type="html">There’s nothing more frustrating than a sluggish continuous integration system. It slows down feedback loops and prevents code from reaching production quickly. While quick fixes like using a bigger CI server can buy you time, you ultimately have to invest in maintaining the performance of your continuous integration workflow.</summary></entry><entry><title type="html">Understanding Bash</title><link href="https://earthly.dev/blog/understanding-bash/" rel="alternate" type="text/html" title="Understanding Bash" /><published>2021-04-01T00:00:00-04:00</published><updated>2021-04-01T00:00:00-04:00</updated><id>https://earthly.dev/blog/understanding-bash</id><content type="html" xml:base="https://earthly.dev/blog/understanding-bash/">&lt;p&gt;Bash scripts give you the ability to turn a tedious series of commands into an easily runnable and repeatable script. With many real-world use cases, like using a bash script to run a continuous deployment process, create a series of files in a folder, or download the contents of several URLs, it’s worth your time to make sure bash scripting is in your programming toolbox.&lt;/p&gt;
&lt;p&gt;When you’re done with this article, you’ll not only be able to write bash scripts, but you’ll be able to write them using today’s accepted best practices.&lt;/p&gt;
&lt;h2 id=&quot;use-the-right-shebang&quot;&gt;Use the Right Shebang&lt;/h2&gt;
&lt;p&gt;The very first thing you’ll see at the top of every (well-written) bash script is what’s called a &lt;a href=&quot;https://www.in-ulm.de/~mascheck/various/shebang/&quot;&gt;&lt;em&gt;shebang&lt;/em&gt;&lt;/a&gt;. I’ll walk you through a couple of them here.&lt;/p&gt;
&lt;h3 id=&quot;binbash&quot;&gt;#!/bin/bash&lt;/h3&gt;
&lt;p&gt;The most common shebang is the one referring to the &lt;code&gt;bash&lt;/code&gt; executable:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#!/bin/bash&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Essentially it tells your terminal that when you run the script it should use &lt;code&gt;bash&lt;/code&gt; to execute it. It can be vital since you may be using a different shell in your machine (&lt;code&gt;zsh&lt;/code&gt;, &lt;code&gt;fish&lt;/code&gt;, &lt;code&gt;sh&lt;/code&gt;, etc.), but you designed the script to work specifically with bash. In many cases, it doesn’t matter what shell you’re using, but there can be some very noteworthy differences in how they work, leading a script to work in &lt;code&gt;bash&lt;/code&gt; but not &lt;code&gt;sh&lt;/code&gt;, for example.&lt;/p&gt;
&lt;h3 id=&quot;userbinenv-bash&quot;&gt;#!/user/bin/env bash&lt;/h3&gt;
&lt;p&gt;If you use the previous shebang, it’s crucial that you give the executable’s absolute path. You should be aware of this since there is an alternative, where you use the &lt;code&gt;bash&lt;/code&gt; executable found in the &lt;code&gt;$PATH&lt;/code&gt;. You can do so by writing:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#!/user/bin/env bash&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Some people like to customize their systems, either their personal system or production servers, resulting in the &lt;code&gt;bash&lt;/code&gt; executable not being located in &lt;code&gt;/bin/bash&lt;/code&gt; every time. Use the above line if you can’t be sure that the &lt;code&gt;bash&lt;/code&gt; executable will be located in the same path when this script is run.&lt;/p&gt;
&lt;h2 id=&quot;understand-common-sets&quot;&gt;Understand Common Sets&lt;/h2&gt;
&lt;p&gt;When you run a bash script, it will always run in a new &lt;em&gt;subshell&lt;/em&gt;. This means that any unique configurations you have in your current setup will not be used within the script execution. It also means that you can customize the environment that the script is running in without worrying about how your terminal will be affected.&lt;/p&gt;
&lt;p&gt;One way to change this environment is to use the &lt;code&gt;set&lt;/code&gt; command. I’ll go over the four most common ones and where they’re useful. I’ll show the short form for these sets in the examples throughout this article, but keep in mind that there are also long-form versions. I’ll mention those briefly.&lt;/p&gt;
&lt;h3 id=&quot;set--u&quot;&gt;set -u&lt;/h3&gt;
&lt;p&gt;By default, bash doesn’t do a lot of error handling. That’s left up to you. So if you want to have your script exit at a certain point, you have to define it. For example, you may have the following script:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#!/bin/bash&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;$TEST&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; Hello World&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you run the script as shown above, it’ll give you the following output:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;Hello&lt;/span&gt; World&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;See how it doesn’t complain that the &lt;code&gt;$TEST&lt;/code&gt; variable is not set? You can change that. Setting the &lt;code&gt;set -u&lt;/code&gt; (short form of &lt;code&gt;set -o nounset&lt;/code&gt;) command initially, you’re telling bash that you want it to fail if a variable is not set.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Script:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#!/bin/bash&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-2&quot;&gt;&lt;a href=&quot;#cb5-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-u&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-3&quot;&gt;&lt;a href=&quot;#cb5-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;$TEST&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-4&quot;&gt;&lt;a href=&quot;#cb5-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; Hello World&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Output:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;line&lt;/span&gt; 3: TEST: unbound variable&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Without &lt;code&gt;set -u&lt;/code&gt;, bash will use an empty string instead of the unset variable. When running &lt;code&gt;echo $TEST&lt;/code&gt;, that isn’t too dangerous. However, you may be running a command like &lt;code&gt;rm -rf /$TEST&lt;/code&gt; to define a path you want to delete. In this case, without &lt;code&gt;set -u&lt;/code&gt;, you would end up deleting your entire file system (which there’s no way to recover by default).&lt;/p&gt;
&lt;h3 id=&quot;set--x&quot;&gt;set -x&lt;/h3&gt;
&lt;p&gt;You’ll likely at some point have a big script where it’s tough to keep track of not just which commands are running what, but also which commands are outputting what. This is where &lt;code&gt;set -x&lt;/code&gt; comes to the rescue. Alternatively, you can write this as its long form, &lt;code&gt;set -o xtrace&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;When using &lt;code&gt;set -x&lt;/code&gt;, you get the following script and output.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Script:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb7&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb7-1&quot;&gt;&lt;a href=&quot;#cb7-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#!/bin/bash&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb7-2&quot;&gt;&lt;a href=&quot;#cb7-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-x&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb7-3&quot;&gt;&lt;a href=&quot;#cb7-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; Hi&lt;/span&gt;
&lt;span id=&quot;cb7-4&quot;&gt;&lt;a href=&quot;#cb7-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; Hello World&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Output:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb8&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb8-1&quot;&gt;&lt;a href=&quot;#cb8-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;+&lt;/span&gt; echo Hi&lt;/span&gt;
&lt;span id=&quot;cb8-2&quot;&gt;&lt;a href=&quot;#cb8-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;Hi&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-3&quot;&gt;&lt;a href=&quot;#cb8-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;+&lt;/span&gt; echo Hello World&lt;/span&gt;
&lt;span id=&quot;cb8-4&quot;&gt;&lt;a href=&quot;#cb8-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;Hello&lt;/span&gt; World&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;set--e&quot;&gt;set -e&lt;/h3&gt;
&lt;p&gt;Sometimes you want to make sure that the entire script fails if one of the commands fails. This is not the default behavior in bash. You can see &lt;a href=&quot;https://www.gnu.org/software/bash/manual/html_node/The-Set-Builtin.html&quot;&gt;here&lt;/a&gt; that without any set options, bash is running without much error handling.&lt;/p&gt;
&lt;p&gt;To make sure the script fails, you should use &lt;code&gt;set -e&lt;/code&gt; (also known as &lt;code&gt;set -o errexit&lt;/code&gt;), probably the most common one.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Script:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb9&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb9-1&quot;&gt;&lt;a href=&quot;#cb9-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#!/bin/bash&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb9-2&quot;&gt;&lt;a href=&quot;#cb9-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-e&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb9-3&quot;&gt;&lt;a href=&quot;#cb9-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;foo&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb9-4&quot;&gt;&lt;a href=&quot;#cb9-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; Hello World&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Output:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;line&lt;/span&gt; 3: foo: command not found&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;set--eo-pipefail&quot;&gt;set -eo pipefail&lt;/h3&gt;
&lt;p&gt;Finally, we can make the script fail if a command in a pipeline fails. Usually, bash only looks for the exit code from the last command in a pipeline. If that’s 0, it’ll continue just fine. Exit code 0 is what we want, since in bash that means success.&lt;/p&gt;
&lt;p&gt;Let’s use the following script as an example:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#!/bin/bash&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-2&quot;&gt;&lt;a href=&quot;#cb11-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;foo&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; Hello World&lt;/span&gt;
&lt;span id=&quot;cb11-3&quot;&gt;&lt;a href=&quot;#cb11-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; Hi&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;set -eo pipefail&lt;/code&gt; will turn the output from:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb12&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb12-1&quot;&gt;&lt;a href=&quot;#cb12-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;Hello&lt;/span&gt; World&lt;/span&gt;
&lt;span id=&quot;cb12-2&quot;&gt;&lt;a href=&quot;#cb12-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;line&lt;/span&gt; 2: foo: command not found&lt;/span&gt;
&lt;span id=&quot;cb12-3&quot;&gt;&lt;a href=&quot;#cb12-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;Hi&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;into:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb13&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb13-1&quot;&gt;&lt;a href=&quot;#cb13-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;Hello&lt;/span&gt; World&lt;/span&gt;
&lt;span id=&quot;cb13-2&quot;&gt;&lt;a href=&quot;#cb13-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;line&lt;/span&gt; 2: foo: command not found&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The reason you may want the script to fail if a pipeline fails is the same as earlier with &lt;code&gt;set -u&lt;/code&gt;. Let’s modify the scenario a bit. You have the following in your script:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb14&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb14-1&quot;&gt;&lt;a href=&quot;#cb14-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;va&quot;&gt;FILE_PATH&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;cat&lt;/span&gt; /tmp/path.txt &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;s/_/-/g)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb14-2&quot;&gt;&lt;a href=&quot;#cb14-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;rm -rf /$FILE_PATH&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;Note: &lt;code&gt;sed&lt;/code&gt; is a search-and-replace command. In this case it replaces underscores with dashes.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The intention is that &lt;code&gt;/tmp/path.txt&lt;/code&gt; contains &lt;code&gt;tmp_file.txt&lt;/code&gt;. Assume that the file &lt;code&gt;/tmp-file.txt&lt;/code&gt; exists on the system. In this case the script will work perfectly and delete &lt;code&gt;/tmp-file.txt&lt;/code&gt;. But what if &lt;code&gt;/tmp/path.txt&lt;/code&gt; doesn’t exist? &lt;code&gt;cat /tmp/path.txt&lt;/code&gt; will fail, but the script won’t. Now you’ve deleted your entire filesystem, but &lt;code&gt;set -eo pipefail&lt;/code&gt; will prevent this.&lt;/p&gt;
&lt;h3 id=&quot;sets-in-summary&quot;&gt;Sets in Summary&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&quot;header&quot;&gt;
&lt;th&gt;Set&lt;/th&gt;
&lt;th&gt;Long form&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td&gt;set -u&lt;/td&gt;
&lt;td&gt;set -o nounset&lt;/td&gt;
&lt;td&gt;Exits script on undefined variables&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td&gt;set -x&lt;/td&gt;
&lt;td&gt;set -o xtrace&lt;/td&gt;
&lt;td&gt;Shows command currently executing&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td&gt;set -e&lt;/td&gt;
&lt;td&gt;set -o errexit&lt;/td&gt;
&lt;td&gt;Exits script on error&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td&gt;set -eo pipefail&lt;/td&gt;
&lt;td&gt;set -eo pipefail&lt;/td&gt;
&lt;td&gt;Exits script on pipeline fail&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&quot;use-error-checking-tools&quot;&gt;Use Error Checking Tools&lt;/h2&gt;
&lt;p&gt;Although you may be familiar with all the best practices, it can be tough to remember them all when your script is coming to life. Luckily there are tools available to help, like &lt;a href=&quot;https://www.shellcheck.net/#&quot;&gt;ShellCheck&lt;/a&gt;. ShellCheck has both a browser version and a command-line tool, but for this article, let’s work with the command-line version. You can find &lt;a href=&quot;https://github.com/koalaman/shellcheck#installing&quot;&gt;installation instructions here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;We’ll use the following script as an example:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb15&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb15-1&quot;&gt;&lt;a href=&quot;#cb15-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;What&amp;#39;s your name?&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-2&quot;&gt;&lt;a href=&quot;#cb15-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;read&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;NAME&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-3&quot;&gt;&lt;a href=&quot;#cb15-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; Hello &lt;span class=&quot;va&quot;&gt;$NAME&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;By saving this in a script in a file called &lt;code&gt;greeting.sh&lt;/code&gt; and running &lt;code&gt;shellcheck greeting.sh&lt;/code&gt;, you get the following output in your terminal:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;In greeting.sh line 1:
echo &amp;quot;What&amp;#39;s your name?&amp;quot;
^-- SC2148: Tips depend on target shell and yours is unknown. Add a shebang or a &amp;#39;shell&amp;#39; directive.


In greeting.sh line 2:
read NAME
^--^ SC2162: read without -r will mangle backslashes.


In greeting.sh line 3:
echo Hello $NAME
           ^---^ SC2086: Double quote to prevent globbing and word splitting.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As you can see, &lt;code&gt;shellcheck&lt;/code&gt; doesn’t just tell you what you need to change, but also why it needs to be changed. This is a valuable resource, not just for improving your scripts, but also to get better at writing them in the first place.&lt;/p&gt;
&lt;p&gt;With these tips, you’ll end up with the following script:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb17&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb17-1&quot;&gt;&lt;a href=&quot;#cb17-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#!/bin/bash&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb17-2&quot;&gt;&lt;a href=&quot;#cb17-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;What&amp;#39;s your name?&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb17-3&quot;&gt;&lt;a href=&quot;#cb17-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;read&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;NAME&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb17-4&quot;&gt;&lt;a href=&quot;#cb17-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;echo&lt;/span&gt; Hello &lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$NAME&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;understand-variable-naming-and-declaration&quot;&gt;Understand Variable Naming and Declaration&lt;/h2&gt;
&lt;p&gt;As you saw earlier, we tried to use the &lt;code&gt;$TEST&lt;/code&gt; variable. Variables can open up a whole world of opportunities, but they can also be tricky to work with. Let’s go over some of the common scenarios for working with variables.&lt;/p&gt;
&lt;h3 id=&quot;assigning-variables&quot;&gt;Assigning Variables&lt;/h3&gt;
&lt;p&gt;Assigning a variable in bash is reasonably straightforward, using the &lt;code&gt;=&lt;/code&gt; symbol. Here’s an example of assigning “Hello World” to a &lt;code&gt;$TEST&lt;/code&gt; variable:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb18&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb18-1&quot;&gt;&lt;a href=&quot;#cb18-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; MSG=&lt;span class=&quot;st&quot;&gt;&amp;quot;Hello world!&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-2&quot;&gt;&lt;a href=&quot;#cb18-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;va&quot;&gt;$MSG&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-3&quot;&gt;&lt;a href=&quot;#cb18-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;Hello&lt;/span&gt; world!&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;using-variables-inside-strings&quot;&gt;Using Variables Inside Strings&lt;/h3&gt;
&lt;p&gt;There are multiple ways to use a variable that you’ve assigned a value. As an example, we’ve assigned &lt;code&gt;foo=uname&lt;/code&gt;.&lt;/p&gt;
&lt;h4 id=&quot;double-quotes&quot;&gt;Double Quotes&lt;/h4&gt;
&lt;p&gt;If you want to echo the contents of a variable, then use double quotes. It will expand what’s inside the variable and print that to the screen.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb19&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb19-1&quot;&gt;&lt;a href=&quot;#cb19-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; foo=&lt;span class=&quot;st&quot;&gt;&amp;quot;uname&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-2&quot;&gt;&lt;a href=&quot;#cb19-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$foo&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-3&quot;&gt;&lt;a href=&quot;#cb19-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;uname&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&quot;single-quotes&quot;&gt;Single Quotes&lt;/h4&gt;
&lt;p&gt;In some cases, you don’t want to output a variable’s contents, but maybe write an explanation of what that variable is used for. To avoid expansion, use single quotes:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb20&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb20-1&quot;&gt;&lt;a href=&quot;#cb20-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; foo=&lt;span class=&quot;st&quot;&gt;&amp;quot;uname&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb20-2&quot;&gt;&lt;a href=&quot;#cb20-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;#39;$foo&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb20-3&quot;&gt;&lt;a href=&quot;#cb20-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;va&quot;&gt;$foo&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This also means that you don’t have to manually escape the &lt;code&gt;$&lt;/code&gt; symbol, which you otherwise would need to in the case of double quotes.&lt;/p&gt;
&lt;h4 id=&quot;backticks&quot;&gt;Backticks&lt;/h4&gt;
&lt;p&gt;The third option for using a variable is backticks. Use this when you want the contents of the variable to be run as a shell command:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb21&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb21-1&quot;&gt;&lt;a href=&quot;#cb21-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; foo=&lt;span class=&quot;st&quot;&gt;&amp;quot;uname&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb21-2&quot;&gt;&lt;a href=&quot;#cb21-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;kw&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$foo&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;`&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb21-3&quot;&gt;&lt;a href=&quot;#cb21-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;Linux&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;using-curly-brackets&quot;&gt;Using Curly Brackets&lt;/h3&gt;
&lt;p&gt;You can get away with merely referring to a variable by writing &lt;code&gt;$FOO&lt;/code&gt;. However, you may want to refer to a variable inside a string or concatenate it with another. Take a look at the following example:&lt;/p&gt;
&lt;!-- markdownlint-disable MD014 --&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb22&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb22-1&quot;&gt;&lt;a href=&quot;#cb22-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; FOO=&lt;span class=&quot;st&quot;&gt;&amp;quot;Hel&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb22-2&quot;&gt;&lt;a href=&quot;#cb22-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$FOOlo&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; World&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb22-3&quot;&gt;&lt;a href=&quot;#cb22-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;Hello&lt;/span&gt; World&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, bash would try to find the variable &lt;code&gt;$FOOlo&lt;/code&gt;, but we just wanted to print “Hello world.” To make this work, you will have to do the following:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb23&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb23-1&quot;&gt;&lt;a href=&quot;#cb23-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; FOO=&lt;span class=&quot;st&quot;&gt;&amp;quot;Hel&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb23-2&quot;&gt;&lt;a href=&quot;#cb23-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; echo &lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;${FOO}&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;lo World&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb23-3&quot;&gt;&lt;a href=&quot;#cb23-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;Hello&lt;/span&gt; World&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is most likely useful when you want to use a variable to define a path, like &lt;code&gt;/opt/${ENVIRONMENT}_build.txt&lt;/code&gt;. Without curly brackets, the script would try to look up &lt;code&gt;$ENVIRONMENT_build&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&quot;properly-set-permissions&quot;&gt;Properly Set Permissions&lt;/h2&gt;
&lt;p&gt;One of the pitfalls that I remember running into time and time again when I started making bash scripts was remembering that &lt;a href=&quot;https://www.guru99.com/file-permissions.html&quot;&gt;permissions&lt;/a&gt; had to be set right. See, when you make a file with, for example, &lt;code&gt;touch&lt;/code&gt;, it gives read/write permissions to the owner and read rights to everyone else. This means that you’ll get a &lt;code&gt;permission denied&lt;/code&gt; error when you try to run the script.&lt;/p&gt;
&lt;p&gt;Luckily this is easily fixed. Run &lt;code&gt;chmod +x script.sh&lt;/code&gt;, and now everyone is allowed to run the script.&lt;/p&gt;
&lt;p&gt;However, do be aware that changing permissions can impose security risks. Read more about &lt;a href=&quot;https://www.linux.com/training-tutorials/understanding-linux-file-permissions/&quot;&gt;Linux file permissions&lt;/a&gt; before you start changing permissions blindly.&lt;/p&gt;
&lt;h2 id=&quot;ensure-readability&quot;&gt;Ensure Readability&lt;/h2&gt;
&lt;p&gt;One of the biggest pitfalls that newcomers run into is forgetting about readability. It’s easy to get caught up in wanting to have a working script, and maybe you’re even used to running everything manually in the terminal, where you want to type as little as possible.&lt;/p&gt;
&lt;p&gt;When it comes to scripts, you want to make sure that you can still easily remember what’s happening six months down the line. An easy way to do this is by using more extended options (&lt;code&gt;--quiet&lt;/code&gt; instead of &lt;code&gt;-q&lt;/code&gt;), using longer variable names (&lt;code&gt;MESSAGE&lt;/code&gt; instead of &lt;code&gt;MSG&lt;/code&gt;), and writing comments.&lt;/p&gt;
&lt;p&gt;You can write commands using a hash mark, after which you can write your comment, like so:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Below line will echo &amp;quot;Hello World!&amp;quot;
echo &amp;quot;Hello World!&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;understand-your-script-in-relation-to-cli&quot;&gt;Understand Your Script in Relation to CLI&lt;/h2&gt;
&lt;p&gt;When reading this article, you may have noticed that many code examples are being run straight in the terminal rather than written as a bash script. There’s a good reason for that! You can write everything you write in a bash script directly in the terminal.&lt;/p&gt;
&lt;p&gt;There is one significant difference between executing a script and typing the commands in your terminal. When you run a script, it’ll start up a new, clean shell in which the script will run. This means that no variables set in your terminal will interfere with your script.&lt;/p&gt;
&lt;p&gt;For example, if you set &lt;code&gt;TEST=&quot;hello&quot;&lt;/code&gt; in your shell and run &lt;code&gt;echo $TEST&lt;/code&gt; inside a script, it will print nothing to your screen.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;At this point, you should be ready to venture into the exciting world of bash scripting. You’ve learned about common shebangs, what &lt;code&gt;set&lt;/code&gt; does, and how it can improve the error handling of your scripts, as well as understanding some general pitfalls developers run into with bash.&lt;/p&gt;
&lt;p&gt;So go ahead and automate those annoying commands you’ve been typing out every day. Tired of manually going into your browser and finding the git repo you’re working on? Make a script to parse the remote git URL and open it automatically. Maybe you have to rename a bunch of files. Make a script that can loop through them and rename them. The world is your oyster.&lt;/p&gt;</content><author><name>Kasper Siig</name></author><category term="Tutorials" /><summary type="html">Bash scripts give you the ability to turn a tedious series of commands into an easily runnable and repeatable script. With many real-world use cases, like using a bash script to run a continuous deployment process, create a series of files in a folder, or download the contents of several URLs, it’s worth your time to make sure bash scripting is in your programming toolbox.</summary></entry></feed>
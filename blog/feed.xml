<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.1.1">Jekyll</generator><link href="https://earthly.dev/blog/feed.xml" rel="self" type="application/atom+xml" /><link href="https://earthly.dev/blog/" rel="alternate" type="text/html" /><updated>2021-08-19T14:49:50-04:00</updated><id>https://earthly.dev/blog/feed.xml</id><title type="html">Earthly Blog</title><subtitle>Build automation for the container era.</subtitle><entry><title type="html">Example Post</title><link href="https://earthly.dev/blog/example/" rel="alternate" type="text/html" title="Example Post" /><published>2029-01-01T00:00:00-05:00</published><updated>2029-01-01T00:00:00-05:00</updated><id>https://earthly.dev/blog/example</id><content type="html" xml:base="https://earthly.dev/blog/example/">&lt;!-- vale off --&gt;
&lt;p&gt;This post is in the future, and won’t show up in the published site&lt;/p&gt;
&lt;h2 id=&quot;image-without-figure&quot;&gt;Image without figure&lt;/h2&gt;
&lt;p&gt;An image with the alt text hidden.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/blog/assets/images/example/alex-draw.png&quot; alt=&quot;some alt text&quot; /&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;p&gt;An image with alt text printed below.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/example/alex-draw.png&quot; alt=&quot;some alt text&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;some alt text&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;image-with-explicit-figure&quot;&gt;Image with explicit figure&lt;/h2&gt;
&lt;figure class&gt;
&lt;img src=&quot;/blog/assets/images/example/alex-draw.png&quot;
       alt=&quot;handddrawn cartoon for a person talking to a computer server&quot;&gt;
&lt;figcaption&gt;
&lt;p&gt;Alex likes to draw and add a caption&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;image-with-implicit-figure&quot;&gt;Image with implicit figure&lt;/h2&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/example/alex-draw.png&quot; alt=&quot;This is my alt text and my figure. The alt text is used as the default figure if not specified.&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;This is my alt text and my figure. The alt text is used as the default figure if not specified.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;image-wide&quot;&gt;Image Wide&lt;/h2&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/example/alex-draw.png&quot; alt=&quot;This should be wide&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;This should be wide&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/div&gt;
&lt;h3 id=&quot;graph-using-matplotlib&quot;&gt;graph using matplotlib&lt;/h3&gt;
&lt;figure&gt;
&lt;img src=&quot;_site/assets/images/15298945686075526262.svg&quot; /&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;code-blocks-with-syntax-highlighting&quot;&gt;Code blocks (with syntax highlighting)&lt;/h3&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode go&quot;&gt;&lt;code class=&quot;sourceCode go&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    syntax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;proto3&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;kw&quot;&gt;package&lt;/span&gt; simplekeyvalue&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    option go_package &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;kvapi&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;co&quot;&gt;// The key/value API contains two procedures for storing and retrieving data&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-6&quot;&gt;&lt;a href=&quot;#cb1-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    service KeyValue &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-7&quot;&gt;&lt;a href=&quot;#cb1-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      rpc Set &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;SetRequest&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; returns &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;SetReply&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-8&quot;&gt;&lt;a href=&quot;#cb1-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      rpc Get &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;GetRequest&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; returns &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;GetReply&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-9&quot;&gt;&lt;a href=&quot;#cb1-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;raw-code-blocks&quot;&gt;Raw code blocks&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;
{{ raw template code}}
&lt;/code&gt;&lt;/pre&gt;
&lt;figcaption&gt;
Use &lt;code&gt;raw&lt;/code&gt; and &lt;code&gt;endraw&lt;/code&gt; for code that overlaps with the liquid templates
&lt;/figcaption&gt;
&lt;h2 id=&quot;fensed-code-blocks&quot;&gt;Fensed code blocks&lt;/h2&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode scala&quot;&gt;&lt;code class=&quot;sourceCode scala&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;object&lt;/span&gt; Main &lt;span class=&quot;kw&quot;&gt;extends&lt;/span&gt; App &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;Hello, World!&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;code-with-captions&quot;&gt;Code with Captions&lt;/h3&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode scala&quot;&gt;&lt;code class=&quot;sourceCode scala&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;object&lt;/span&gt; Main &lt;span class=&quot;kw&quot;&gt;extends&lt;/span&gt; App &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;fu&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;Hello, World!&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figcaption&gt;
Main.scala
&lt;/figcaption&gt;
&lt;div class=&quot;notice&quot;&gt;
&lt;p&gt;&lt;strong&gt;Notice&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Markdown here&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;one&lt;/li&gt;
&lt;li&gt;two&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;ℹ️ Notice Info&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Markdown here&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;one&lt;/li&gt;
&lt;li&gt;two&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;notice--warning&quot;&gt;
&lt;p&gt;&lt;strong&gt;Warning&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Markdown here&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;one&lt;/li&gt;
&lt;li&gt;two&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;notice--success&quot;&gt;
&lt;p&gt;&lt;strong&gt;Success&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Markdown here&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;more-example-image-layouts&quot;&gt;More example Image layouts&lt;/h3&gt;
&lt;!-- vale HouseStyle.Spelling = NO --&gt;
&lt;p&gt;&lt;img src=&quot;/blog/assets/images/authors/coreylarson.jpg&quot; class=&quot;align-center&quot; alt=&quot;align center&quot; /&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/blog/assets/images/authors/coreylarson.jpg&quot; class=&quot;align-right&quot; alt=&quot;alighn right&quot; /&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/blog/assets/images/authors/coreylarson.jpg&quot; class=&quot;align-left&quot; alt=&quot;align left&quot; /&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa.&lt;/p&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. &lt;img src=&quot;/blog/assets/images/example/alex-draw.png&quot; class=&quot;align-right&quot; width=&quot;300&quot; alt=&quot;pic with only 100px width&quot; /&gt;&lt;br /&gt;
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. &lt;!-- vale HouseStyle.Spelling = YES --&gt; ### More Example Usage&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://mmistakes.github.io/minimal-mistakes/docs/quick-start-guide/&quot;&gt;Theme Guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Sample &lt;a href=&quot;https://mmistakes.github.io/minimal-mistakes/year-archive/&quot;&gt;Rendered Posts&lt;/a&gt; and &lt;a href=&quot;https://github.com/mmistakes/minimal-mistakes/tree/d6444412c63aea5e47241ef536509fb1bfef4830/docs/_posts&quot;&gt;Raw mardown&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Markdown stuff (pandoc): &lt;a href=&quot;https://laurentrdc.github.io/pandoc-plot/&quot;&gt;Graphs&lt;/a&gt; and &lt;a href=&quot;https://pandoc.org/MANUAL.html#pandocs-markdown&quot;&gt;markdown&lt;/a&gt; &lt;!-- vale on --&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Adam Gordon Bell</name></author><category term="News" /><summary type="html">This post is in the future, and won’t show up in the published site Image without figure An image with the alt text hidden. An image with alt text printed below. some alt text Image with explicit figure Alex likes to draw and add a caption Image with implicit figure This is my alt text and my figure. The alt text is used as the default figure if not specified. Image Wide This should be wide graph using matplotlib Code blocks (with syntax highlighting) syntax = &amp;quot;proto3&amp;quot;; package simplekeyvalue; option go_package = &amp;quot;kvapi&amp;quot;; // The key/value API contains two procedures for storing and retrieving data service KeyValue { rpc Set (SetRequest) returns (SetReply) {} rpc Get (GetRequest) returns (GetReply) {} } Raw code blocks {{ raw template code}} Use raw and endraw for code that overlaps with the liquid templates Fensed code blocks object Main extends App { println(&amp;quot;Hello, World!&amp;quot;) } Code with Captions object Main extends App { println(&amp;quot;Hello, World!&amp;quot;) } Main.scala Notice Markdown here one two ℹ️ Notice Info Markdown here one two Warning Markdown here one two Success Markdown here More example Image layouts Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Massa enim nec dui nunc mattis enim ut. Cursus euismod quis viverra nibh cras. Posuere ac ut consequat semper viverra nam libero. Lectus nulla at volutpat diam ut venenatis tellus in. Nunc eget lorem dolor sed viverra ipsum. Lectus arcu bibendum at varius vel pharetra vel turpis. Cursus sit amet dictum sit amet justo donec. Eget nullam non nisi est sit amet facilisis. Scelerisque felis imperdiet proin fermentum leo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque. Nulla facilisi morbi tempus iaculis urna id. Diam maecenas sed enim ut sem. Porttitor leo a diam sollicitudin. Neque gravida in fermentum et sollicitudin ac orci. Aliquet risus feugiat in ante metus. Vitae et leo duis ut diam quam nulla porttitor massa. ### More Example Usage Theme Guide Sample Rendered Posts and Raw mardown Markdown stuff (pandoc): Graphs and markdown</summary></entry><entry><title type="html">10+ Best Continuous Delivery Tools</title><link href="https://earthly.dev/blog/10-continous-delivery/" rel="alternate" type="text/html" title="10+ Best Continuous Delivery Tools" /><published>2022-08-10T00:00:00-04:00</published><updated>2022-08-10T00:00:00-04:00</updated><id>https://earthly.dev/blog/10-continous-delivery</id><content type="html" xml:base="https://earthly.dev/blog/10-continous-delivery/">&lt;h2 id=&quot;draft.dev-article-checklist&quot;&gt;Draft.dev Article Checklist&lt;/h2&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;input type=&quot;checkbox&quot; disabled=&quot;&quot; /&gt;
Add in Author page&lt;/li&gt;
&lt;li&gt;&lt;input type=&quot;checkbox&quot; disabled=&quot;&quot; /&gt;
Create header image in Canva&lt;/li&gt;
&lt;li&gt;&lt;input type=&quot;checkbox&quot; disabled=&quot;&quot; /&gt;
Optional: Find ways to break up content with quotes or images&lt;/li&gt;
&lt;li&gt;&lt;input type=&quot;checkbox&quot; disabled=&quot;&quot; /&gt;
Verify look of article locally&lt;/li&gt;
&lt;li&gt;&lt;input type=&quot;checkbox&quot; disabled=&quot;&quot; /&gt;
Run mark down linter (&lt;code&gt;earthly +blog-lint-apply&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;&lt;input type=&quot;checkbox&quot; disabled=&quot;&quot; /&gt;
Add keywords for internal links to front-matter&lt;/li&gt;
&lt;li&gt;&lt;input type=&quot;checkbox&quot; disabled=&quot;&quot; /&gt;
Run &lt;code&gt;earthly +link-opportunity&lt;/code&gt; and find 1-5 places to incorporate links&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Chinedu Imoh</name></author><category term="Tutorials" /><summary type="html">Draft.dev Article Checklist Add in Author page Create header image in Canva Optional: Find ways to break up content with quotes or images Verify look of article locally Run mark down linter (earthly +blog-lint-apply) Add keywords for internal links to front-matter Run earthly +link-opportunity and find 1-5 places to incorporate links</summary></entry><entry><title type="html">Plotting Precipitation with Python, Pandas and Matplotlib</title><link href="https://earthly.dev/blog/plotting-rainfall-data-with-python-and-matplotlib/" rel="alternate" type="text/html" title="Plotting Precipitation with Python, Pandas and Matplotlib" /><published>2021-08-18T00:00:00-04:00</published><updated>2021-08-18T00:00:00-04:00</updated><id>https://earthly.dev/blog/plotting-rainfall-data-with-python-and-matplotlib</id><content type="html" xml:base="https://earthly.dev/blog/plotting-rainfall-data-with-python-and-matplotlib/">&lt;h2 id=&quot;where-did-all-the-rain-go&quot;&gt;Where Did All The Rain Go?&lt;/h2&gt;
&lt;p&gt;It’s been a really dry summer here in Victoria BC (and the rest of the province). I couldn’t remember the last time it had rained, which got me looking at historical weather data. Before I knew it, rather than simply look up how many days it’s been since it last rained (42 and counting!), I was plotting cumulative annual rainfall.&lt;/p&gt;
&lt;h2 id=&quot;get-some-data&quot;&gt;Get Some Data&lt;/h2&gt;
&lt;p&gt;I ended up on Environment Canada’s &lt;a href=&quot;https://climate.weather.gc.ca/historical_data/search_historic_data_e.html&quot;&gt;historic data search page&lt;/a&gt;, and ended up with a table of daily weather recorded at Victoria International Airport, climate ID 1018621 (which is closer to Sidney BC, but I digress). On the right hand side of that page, there was an option to download the data as CSV. Upon clicking the &lt;code&gt;Download Data&lt;/code&gt; button, my web browser was redirected to:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://climate.weather.gc.ca/climate_data/bulk_data_e.html?format=csv&amp;amp;stationID=51337&amp;amp;Year=2021&amp;amp;Month=7&amp;amp;Day=1&amp;amp;time=&amp;amp;timeframe=2&amp;amp;submit=Download+Data&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The website gave me an option to change the range of data to download; however if you squint enough, the above URL looks like an API. Furthermore, the month and day values didn’t seem to affect anything – since this was annual data, only the year was used.&lt;/p&gt;
&lt;p&gt;It’s also interesting to note that the &lt;code&gt;station ID&lt;/code&gt; is different from the &lt;code&gt;Climate ID&lt;/code&gt; even though Environment Canada defines “the climate ID is a 7 digit number assigned by the Meteorological Service of Canada to a site where official weather observations are taken, and serves as a permanent, unique identifier.” Perhaps there was a &lt;a href=&quot;/blog/thought-leaders/&quot;&gt;thought leader&lt;/a&gt; who was suffering from past trauma where a client’s definition of a “permanent unique identifier” didn’t match up with a relational databases’ definition of a unique identifier, and insisted on creating a lookup table for these different IDs. Again, I digress, back to downloading data.&lt;/p&gt;
&lt;p&gt;I wrote a &lt;a href=&quot;/blog/understanding-bash&quot;&gt;bash&lt;/a&gt; while loop to download this data:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#!/bin/sh&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-2&quot;&gt;&lt;a href=&quot;#cb2-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-e&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-3&quot;&gt;&lt;a href=&quot;#cb2-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; year &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;seq&lt;/span&gt; 2013 2021&lt;span class=&quot;va&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cf&quot;&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-4&quot;&gt;&lt;a href=&quot;#cb2-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ex&quot;&gt;curl&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;https://climate.weather.gc.ca/climate_data/bulk_data_e.html?format=csv&amp;amp;stationID=51337&amp;amp;Year=&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;${year}&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;amp;timeframe=2&amp;quot;&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; victoria-weather-&lt;span class=&quot;va&quot;&gt;$year&lt;/span&gt;.csv&lt;/span&gt;
&lt;span id=&quot;cb2-5&quot;&gt;&lt;a href=&quot;#cb2-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;done&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;parsing-the-data&quot;&gt;Parsing the Data&lt;/h2&gt;
&lt;h3 id=&quot;using-the-standard-csv.reader-parser&quot;&gt;Using the Standard &lt;code&gt;csv.reader&lt;/code&gt; Parser&lt;/h3&gt;
&lt;p&gt;Python offers a standard library for parsing &lt;code&gt;.csv&lt;/code&gt; files, aptly named &lt;code&gt;csv&lt;/code&gt;. The &lt;code&gt;csv&lt;/code&gt; library is fairly low-level and provides a &lt;code&gt;csv.reader&lt;/code&gt; which can be used to iterate over rows:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; csv&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;open&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;#39;data/victoria-weather-2020.csv&amp;#39;&lt;/span&gt;) &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; fp:&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    reader &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; csv.reader(fp)&lt;/span&gt;
&lt;span id=&quot;cb3-4&quot;&gt;&lt;a href=&quot;#cb3-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; row &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; reader:&lt;/span&gt;
&lt;span id=&quot;cb3-5&quot;&gt;&lt;a href=&quot;#cb3-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;bu&quot;&gt;print&lt;/span&gt;(row)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will output something such as&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[&amp;#39;\ufeff&amp;quot;Longitude (x)&amp;quot;&amp;#39;, &amp;#39;Latitude (y)&amp;#39;, &amp;#39;Station Name&amp;#39;, &amp;#39;Climate ID&amp;#39;, &amp;#39;Date/Time&amp;#39;, &amp;#39;Year&amp;#39;, &amp;#39;Month&amp;#39;, &amp;#39;Day&amp;#39;, &amp;#39;Data Quality&amp;#39;, &amp;#39;Max Temp (°C)&amp;#39;, &amp;#39;Max Temp Flag&amp;#39;, &amp;#39;Min Temp (°C)&amp;#39;, &amp;#39;Min Temp Flag&amp;#39;, &amp;#39;Mean Temp (°C)&amp;#39;, &amp;#39;Mean Temp Flag&amp;#39;, &amp;#39;Heat Deg Days (°C)&amp;#39;, &amp;#39;Heat Deg Days Flag&amp;#39;, &amp;#39;Cool Deg Days (°C)&amp;#39;, &amp;#39;Cool Deg Days Flag&amp;#39;, &amp;#39;Total Rain (mm)&amp;#39;, &amp;#39;Total Rain Flag&amp;#39;, &amp;#39;Total Snow (cm)&amp;#39;, &amp;#39;Total Snow Flag&amp;#39;, &amp;#39;Total Precip (mm)&amp;#39;, &amp;#39;Total Precip Flag&amp;#39;, &amp;#39;Snow on Grnd (cm)&amp;#39;, &amp;#39;Snow on Grnd Flag&amp;#39;, &amp;#39;Dir of Max Gust (10s deg)&amp;#39;, &amp;#39;Dir of Max Gust Flag&amp;#39;, &amp;#39;Spd of Max Gust (km/h)&amp;#39;, &amp;#39;Spd of Max Gust Flag&amp;#39;]
[&amp;#39;-123.43&amp;#39;, &amp;#39;48.65&amp;#39;, &amp;#39;VICTORIA INTL A&amp;#39;, &amp;#39;1018621&amp;#39;, &amp;#39;2020-01-01&amp;#39;, &amp;#39;2020&amp;#39;, &amp;#39;01&amp;#39;, &amp;#39;01&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;12.9&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;5.5&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;9.2&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;8.8&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;T&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;T&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;26&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;59&amp;#39;, &amp;#39;&amp;#39;]
[&amp;#39;-123.43&amp;#39;, &amp;#39;48.65&amp;#39;, &amp;#39;VICTORIA INTL A&amp;#39;, &amp;#39;1018621&amp;#39;, &amp;#39;2020-01-02&amp;#39;, &amp;#39;2020&amp;#39;, &amp;#39;01&amp;#39;, &amp;#39;02&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;6.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.9&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;3.5&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14.5&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14.6&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14.6&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;45&amp;#39;, &amp;#39;&amp;#39;]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The downside of using the standard python &lt;code&gt;csv.reader&lt;/code&gt; parser, is it simply returns all cells as strings, and doesn’t differentiate between cell headers and cell contents. Furthermore, the underlying data seems to have some sort of unicode character that’s not being correctly handled.&lt;/p&gt;
&lt;h3 id=&quot;using-the-standard-csv.dictreader-parser&quot;&gt;Using the Standard &lt;code&gt;csv.DictReader&lt;/code&gt; Parser&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;csv&lt;/code&gt; library provides a &lt;code&gt;csv.DictReader&lt;/code&gt; class which will use the first row as cell headers, and rather than returning the row as a list; instead it will return it as a dictionary:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{&amp;#39;\ufeff&amp;quot;Longitude (x)&amp;quot;&amp;#39;: &amp;#39;-123.43&amp;#39;, &amp;#39;Latitude (y)&amp;#39;: &amp;#39;48.65&amp;#39;, &amp;#39;Station Name&amp;#39;: &amp;#39;VICTORIA INTL A&amp;#39;, &amp;#39;Climate ID&amp;#39;: &amp;#39;1018621&amp;#39;, &amp;#39;Date/Time&amp;#39;: &amp;#39;2020-01-01&amp;#39;, &amp;#39;Year&amp;#39;: &amp;#39;2020&amp;#39;, &amp;#39;Month&amp;#39;: &amp;#39;01&amp;#39;, &amp;#39;Day&amp;#39;: &amp;#39;01&amp;#39;, &amp;#39;Data Quality&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Max Temp (°C)&amp;#39;: &amp;#39;12.9&amp;#39;, &amp;#39;Max Temp Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Min Temp (°C)&amp;#39;: &amp;#39;5.5&amp;#39;, &amp;#39;Min Temp Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Mean Temp (°C)&amp;#39;: &amp;#39;9.2&amp;#39;, &amp;#39;Mean Temp Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Heat Deg Days (°C)&amp;#39;: &amp;#39;8.8&amp;#39;, &amp;#39;Heat Deg Days Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Cool Deg Days (°C)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Cool Deg Days Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Total Rain (mm)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Total Rain Flag&amp;#39;: &amp;#39;T&amp;#39;, &amp;#39;Total Snow (cm)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Total Snow Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Total Precip (mm)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Total Precip Flag&amp;#39;: &amp;#39;T&amp;#39;, &amp;#39;Snow on Grnd (cm)&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Snow on Grnd Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Dir of Max Gust (10s deg)&amp;#39;: &amp;#39;26&amp;#39;, &amp;#39;Dir of Max Gust Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Spd of Max Gust (km/h)&amp;#39;: &amp;#39;59&amp;#39;, &amp;#39;Spd of Max Gust Flag&amp;#39;: &amp;#39;&amp;#39;}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;However, the &lt;code&gt;DictReader&lt;/code&gt; doesn’t parse the cell contents and returns everything simply as strings – leaving all type parsing to the user. Again we see the incorrectly handled unicode character appear – this time within the key of every row.&lt;/p&gt;
&lt;h3 id=&quot;using-the-pandas-library&quot;&gt;Using the Pandas Library&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;pandas&lt;/code&gt; library is a third-party python library which provides tools for data analysis and manipulation. We will be using the &lt;code&gt;pandas.read_csv&lt;/code&gt; function to parse our data:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; pandas&lt;/span&gt;
&lt;span id=&quot;cb6-2&quot;&gt;&lt;a href=&quot;#cb6-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-3&quot;&gt;&lt;a href=&quot;#cb6-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;weather &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; pandas.read_csv(&lt;span class=&quot;st&quot;&gt;&amp;#39;data/victoria-weather-2020.csv&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb6-4&quot;&gt;&lt;a href=&quot;#cb6-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;print&lt;/span&gt;(weather)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will produce output such as:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;     Longitude (x)  Latitude (y)     Station Name  Climate ID   Date/Time  Year  Month  Day  ...  Total Precip (mm)  Total Precip Flag Snow on Grnd (cm)  Snow on Grnd Flag Dir of Max Gust (10s deg)  Dir of Max Gust Flag Spd of Max Gust (km/h)  Spd of Max Gust Flag
0          -123.43         48.65  VICTORIA INTL A     1018621  2020-01-01  2020      1    1  ...                0.0                  T               NaN                NaN                      26.0                   NaN                   59.0                   NaN
1          -123.43         48.65  VICTORIA INTL A     1018621  2020-01-02  2020      1    2  ...               14.6                NaN               NaN                NaN                      14.0                   NaN                   45.0                   NaN
2          -123.43         48.65  VICTORIA INTL A     1018621  2020-01-03  2020      1    3  ...               11.2                NaN               NaN                NaN                      15.0                   NaN                   39.0                   NaN
..             ...           ...              ...         ...         ...   ...    ...  ...  ...                ...                ...               ...                ...                       ...                   ...                    ...                   ...
363        -123.43         48.65  VICTORIA INTL A     1018621  2020-12-29  2020     12   29  ...                8.7                NaN               NaN                NaN                       NaN                     M                    NaN                     M
364        -123.43         48.65  VICTORIA INTL A     1018621  2020-12-30  2020     12   30  ...               20.4                NaN               NaN                NaN                      14.0                   NaN                   61.0                   NaN
365        -123.43         48.65  VICTORIA INTL A     1018621  2020-12-31  2020     12   31  ...                7.2                NaN               NaN                NaN                      14.0                   NaN                   33.0                   NaN

[366 rows x 31 columns]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Notice how the columns have been automatically parsed to an appropriate data type, as well as the column headers are detected. Row numbers are additionally displayed, as well as the data is displayed as a table. This is possible due to the fact that the &lt;code&gt;read_csv&lt;/code&gt; function returns a &lt;code&gt;pandas.core.frame.DataFrame&lt;/code&gt; data type which among other things, implements the &lt;code&gt;__str__&lt;/code&gt; method which is used to render the string which is passed to the &lt;code&gt;print&lt;/code&gt; function.&lt;/p&gt;
&lt;h2 id=&quot;merging-multiple-datasets&quot;&gt;Merging Multiple Datasets&lt;/h2&gt;
&lt;p&gt;My dataset is split across multiple &lt;code&gt;csv&lt;/code&gt; files, with each file containing a dataset for a specific year. My first task is to merge them together. All the datasets are located under the &lt;code&gt;data&lt;/code&gt; directory, and are named &lt;code&gt;victoria-weather-YYYY.csv&lt;/code&gt; (where &lt;code&gt;YYYY&lt;/code&gt; is the year).&lt;/p&gt;
&lt;p&gt;Let’s write a function to parse all the data:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb8&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb8-1&quot;&gt;&lt;a href=&quot;#cb8-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; re&lt;/span&gt;
&lt;span id=&quot;cb8-2&quot;&gt;&lt;a href=&quot;#cb8-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; os&lt;/span&gt;
&lt;span id=&quot;cb8-3&quot;&gt;&lt;a href=&quot;#cb8-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; pandas&lt;/span&gt;
&lt;span id=&quot;cb8-4&quot;&gt;&lt;a href=&quot;#cb8-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-5&quot;&gt;&lt;a href=&quot;#cb8-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; get_data(weather_dir):&lt;/span&gt;
&lt;span id=&quot;cb8-6&quot;&gt;&lt;a href=&quot;#cb8-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    p &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; re.&lt;span class=&quot;bu&quot;&gt;compile&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;#39;victoria-weather-[0-9]+.csv&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb8-7&quot;&gt;&lt;a href=&quot;#cb8-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    data &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb8-8&quot;&gt;&lt;a href=&quot;#cb8-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; filename &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;sorted&lt;/span&gt;(os.listdir(weather_dir)):&lt;/span&gt;
&lt;span id=&quot;cb8-9&quot;&gt;&lt;a href=&quot;#cb8-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; p.match(filename):&lt;/span&gt;
&lt;span id=&quot;cb8-10&quot;&gt;&lt;a href=&quot;#cb8-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            path &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; os.path.join(weather_dir, filename)&lt;/span&gt;
&lt;span id=&quot;cb8-11&quot;&gt;&lt;a href=&quot;#cb8-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            yearly_data &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; pandas.read_csv(path)&lt;/span&gt;
&lt;span id=&quot;cb8-12&quot;&gt;&lt;a href=&quot;#cb8-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            data.append(yearly_data)&lt;/span&gt;
&lt;span id=&quot;cb8-13&quot;&gt;&lt;a href=&quot;#cb8-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; pandas.concat(data)&lt;/span&gt;
&lt;span id=&quot;cb8-14&quot;&gt;&lt;a href=&quot;#cb8-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-15&quot;&gt;&lt;a href=&quot;#cb8-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;weather &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; get_data(&lt;span class=&quot;st&quot;&gt;&amp;#39;data&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb8-16&quot;&gt;&lt;a href=&quot;#cb8-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;print&lt;/span&gt;(weather)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This function 1) uses a regular expression to ensure we only parse files which match the expected form, which prevents our program from crashing if any other files existed in the directory, 2) parses each file separately using the &lt;code&gt;read_csv&lt;/code&gt; function, 3) saves the returned data frame into the &lt;code&gt;data&lt;/code&gt; list, then finally 4) concatenates the data using the &lt;code&gt;concat&lt;/code&gt; function. This code should output a single data frame containing all the data spanning a decade:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;     Longitude (x)  Latitude (y)     Station Name  Climate ID   Date/Time  Year  Month  Day  Data Quality  ...  Total Snow Flag Total Precip (mm)  Total Precip Flag Snow on Grnd (cm)  Snow on Grnd Flag Dir of Max Gust (10s deg)  Dir of Max Gust Flag Spd of Max Gust (km/h)  Spd of Max Gust Flag
0          -123.43         48.65  VICTORIA INTL A     1018621  2014-01-01  2014      1    1           NaN  ...              NaN               1.6                NaN               NaN                NaN                       NaN                   NaN                    &amp;lt;31                   NaN
1          -123.43         48.65  VICTORIA INTL A     1018621  2014-01-02  2014      1    2           NaN  ...              NaN               6.6                NaN               NaN                NaN                      21.0                   NaN                     37                   NaN
2          -123.43         48.65  VICTORIA INTL A     1018621  2014-01-03  2014      1    3           NaN  ...              NaN               0.0                NaN               NaN                NaN                      31.0                   NaN                     41                   NaN
3          -123.43         48.65  VICTORIA INTL A     1018621  2014-01-04  2014      1    4           NaN  ...              NaN               0.0                NaN               NaN                NaN                       NaN                   NaN                    &amp;lt;31                   NaN
4          -123.43         48.65  VICTORIA INTL A     1018621  2014-01-05  2014      1    5           NaN  ...              NaN               0.0                NaN               NaN                NaN                       NaN                   NaN                    &amp;lt;31                   NaN
..             ...           ...              ...         ...         ...   ...    ...  ...           ...  ...              ...               ...                ...               ...                ...                       ...                   ...                    ...                   ...
198        -123.43         48.65  VICTORIA INTL A     1018621  2021-07-18  2021      7   18           NaN  ...              NaN               0.0                NaN               NaN                NaN                       NaN                   NaN                    NaN                     M
199        -123.43         48.65  VICTORIA INTL A     1018621  2021-07-19  2021      7   19           NaN  ...              NaN               0.0                NaN               NaN                NaN                      25.0                   NaN                   37.0                   NaN
200        -123.43         48.65  VICTORIA INTL A     1018621  2021-07-20  2021      7   20           NaN  ...              NaN               0.0                NaN               NaN                NaN                      29.0                   NaN                   36.0                   NaN
201        -123.43         48.65  VICTORIA INTL A     1018621  2021-07-21  2021      7   21           NaN  ...              NaN               0.0                NaN               NaN                NaN                      28.0                   NaN                   33.0                   NaN
202        -123.43         48.65  VICTORIA INTL A     1018621  2021-07-22  2021      7   22           NaN  ...              NaN               0.0                NaN               NaN                NaN                       NaN                     M                    NaN                     M

[2760 rows x 31 columns]&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;raindrops-keep-falling-on-my-plots&quot;&gt;Raindrops Keep Falling on my Plots&lt;/h2&gt;
&lt;p&gt;Let’s plot the rainfall! We will use the &lt;code&gt;matplotlib&lt;/code&gt; library for visualizing this data.&lt;/p&gt;
&lt;p&gt;We can extract a single column of the data frame using the column name, e.g. &lt;code&gt;weather['Total Precip (mm)']&lt;/code&gt;. This will return a &lt;code&gt;pandas.core.series.Series&lt;/code&gt; data type, which is similar to a list; however requires each element in the series to be the same data type. This allows pandas to keep all elements in contiguous memory, which allows faster SIMD-based operations.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;For another example of comparing generic data types against specific native types, checkout out our post on the &lt;a href=&quot;/blog/python-timsort-merge&quot;&gt;various tricks&lt;/a&gt; that python’s timsort uses to achieve better performance.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;A pandas series can be converted into a &lt;a href=&quot;/blog/python-concatenate-lists&quot;&gt;python list&lt;/a&gt; using the &lt;code&gt;.to_list()&lt;/code&gt; method; e.g. &lt;code&gt;weather['Total Precip (mm)'].to_list()&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;plotting-the-data-interactively&quot;&gt;Plotting the Data Interactively&lt;/h3&gt;
&lt;p&gt;Here’s a quick example of plotting this data interactively:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb10-2&quot;&gt;&lt;a href=&quot;#cb10-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-3&quot;&gt;&lt;a href=&quot;#cb10-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Precip (mm)&amp;#39;&lt;/span&gt;].to_list()&lt;/span&gt;
&lt;span id=&quot;cb10-4&quot;&gt;&lt;a href=&quot;#cb10-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;plt.plot(rainfall)&lt;/span&gt;
&lt;span id=&quot;cb10-5&quot;&gt;&lt;a href=&quot;#cb10-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;plt.show()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will display a new window, containing a plot of the data:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-interactive-660-bb671d45d.webp 660w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-interactive-660-7bc7f4e71.png 660w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-interactive-660-7bc7f4e71.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC daily precipitation interactive plot
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;It &lt;em&gt;should&lt;/em&gt; be possible to omit the &lt;code&gt;.to_list()&lt;/code&gt; call, which would then pass the pandas series data type directly to the matplotlib &lt;code&gt;plot&lt;/code&gt; function rather than passing a standard python list; however, there’s a bug in matplotlib (or pandas), which produces the following erroneous plot:&lt;/p&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-interactive-bug-660-3a2b6a8f5.webp 660w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-interactive-bug-660-5252d6866.png 660w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-interactive-bug-660-5252d6866.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;p&gt;Notice how this plot has some bizarre lines that criss-cross the plot, and that the data points stop at roughly 350 rather than past 2500? At a quick glance, this might be an instance of &lt;a href=&quot;https://github.com/matplotlib/matplotlib/issues/16266&quot;&gt;this bug&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;saving-the-plot-programmatically&quot;&gt;Saving the Plot Programmatically&lt;/h3&gt;
&lt;p&gt;Lets revise the previous code to render the plot as a png instead of using an interactive window:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb11-2&quot;&gt;&lt;a href=&quot;#cb11-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-3&quot;&gt;&lt;a href=&quot;#cb11-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# create a new figure that is 10x7 inches&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-4&quot;&gt;&lt;a href=&quot;#cb11-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# which is rendered as 100 pixels per inch&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-5&quot;&gt;&lt;a href=&quot;#cb11-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# (matplotlib incorrectly refers to this as dots-per-inch, which is a printer term)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-6&quot;&gt;&lt;a href=&quot;#cb11-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; plt.figure(figsize&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;(&lt;span class=&quot;fl&quot;&gt;10.0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;7.0&lt;/span&gt;), dpi&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb11-7&quot;&gt;&lt;a href=&quot;#cb11-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-8&quot;&gt;&lt;a href=&quot;#cb11-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# define axes on the figure to take up the entire figure canvas&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-9&quot;&gt;&lt;a href=&quot;#cb11-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; fig.add_axes([&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;
&lt;span id=&quot;cb11-10&quot;&gt;&lt;a href=&quot;#cb11-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-11&quot;&gt;&lt;a href=&quot;#cb11-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# plot the rainfall amounts against the axes&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-12&quot;&gt;&lt;a href=&quot;#cb11-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.plot(rainfall)&lt;/span&gt;
&lt;span id=&quot;cb11-13&quot;&gt;&lt;a href=&quot;#cb11-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-14&quot;&gt;&lt;a href=&quot;#cb11-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# label the axes and title the plot&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-15&quot;&gt;&lt;a href=&quot;#cb11-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_xlabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;days since start of dataset&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb11-16&quot;&gt;&lt;a href=&quot;#cb11-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_ylabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;precipitation (mm)&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb11-17&quot;&gt;&lt;a href=&quot;#cb11-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_title(&lt;span class=&quot;st&quot;&gt;&amp;#39;Victoria BC daily precipitation&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb11-18&quot;&gt;&lt;a href=&quot;#cb11-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-19&quot;&gt;&lt;a href=&quot;#cb11-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# save the plot to disk&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-20&quot;&gt;&lt;a href=&quot;#cb11-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig.savefig(&lt;span class=&quot;st&quot;&gt;&amp;#39;daily-precipitation.png&amp;#39;&lt;/span&gt;, bbox_inches&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Which will produce:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-800-12093d32c.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-800-16e97b528.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-800-16e97b528.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC daily precipitation
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;h3 id=&quot;fixing-the-x-axis-label-to-display-the-date&quot;&gt;Fixing the X Axis Label to Display the Date&lt;/h3&gt;
&lt;p&gt;The previous plots didn’t make use of the &lt;code&gt;Date/Time&lt;/code&gt; column from our weather data &lt;code&gt;csv&lt;/code&gt; files; instead it was simply displaying the index of the list element. We need to instruct pandas to parse those columns as dates using the &lt;code&gt;parse_dates&lt;/code&gt; field. We will additionally define a date parsing function &lt;code&gt;yyyymmdd_parser&lt;/code&gt; which will be used to parse the date; without this function, pandas will attempt to guess the format of the date, which is a best-effort strategy and may not always work.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb12&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb12-1&quot;&gt;&lt;a href=&quot;#cb12-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; re&lt;/span&gt;
&lt;span id=&quot;cb12-2&quot;&gt;&lt;a href=&quot;#cb12-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; os&lt;/span&gt;
&lt;span id=&quot;cb12-3&quot;&gt;&lt;a href=&quot;#cb12-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; pandas&lt;/span&gt;
&lt;span id=&quot;cb12-4&quot;&gt;&lt;a href=&quot;#cb12-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; datetime&lt;/span&gt;
&lt;span id=&quot;cb12-5&quot;&gt;&lt;a href=&quot;#cb12-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb12-6&quot;&gt;&lt;a href=&quot;#cb12-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-7&quot;&gt;&lt;a href=&quot;#cb12-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# Our new date parser&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-8&quot;&gt;&lt;a href=&quot;#cb12-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; yyyymmdd_parser(s):&lt;/span&gt;
&lt;span id=&quot;cb12-9&quot;&gt;&lt;a href=&quot;#cb12-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; datetime.datetime.strptime(s, &lt;span class=&quot;st&quot;&gt;&amp;#39;%Y-%m-&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb12-10&quot;&gt;&lt;a href=&quot;#cb12-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-11&quot;&gt;&lt;a href=&quot;#cb12-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; get_data(weather_dir):&lt;/span&gt;
&lt;span id=&quot;cb12-12&quot;&gt;&lt;a href=&quot;#cb12-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    p &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; re.&lt;span class=&quot;bu&quot;&gt;compile&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;#39;victoria-weather-[0-9]+.csv&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb12-13&quot;&gt;&lt;a href=&quot;#cb12-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    data &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb12-14&quot;&gt;&lt;a href=&quot;#cb12-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; filename &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;sorted&lt;/span&gt;(os.listdir(weather_dir)):&lt;/span&gt;
&lt;span id=&quot;cb12-15&quot;&gt;&lt;a href=&quot;#cb12-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; p.match(filename):&lt;/span&gt;
&lt;span id=&quot;cb12-16&quot;&gt;&lt;a href=&quot;#cb12-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            path &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; os.path.join(weather_dir, filename)&lt;/span&gt;
&lt;span id=&quot;cb12-17&quot;&gt;&lt;a href=&quot;#cb12-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            &lt;span class=&quot;co&quot;&gt;# We identify which column contains the date, along with the date parser to use.&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-18&quot;&gt;&lt;a href=&quot;#cb12-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            yearly_data &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; pandas.read_csv(path, parse_dates&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;[&lt;span class=&quot;st&quot;&gt;&amp;#39;Date/Time&amp;#39;&lt;/span&gt;], date_parser&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;yyyymmdd_parser)&lt;/span&gt;
&lt;span id=&quot;cb12-19&quot;&gt;&lt;a href=&quot;#cb12-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            data.append(yearly_data)&lt;/span&gt;
&lt;span id=&quot;cb12-20&quot;&gt;&lt;a href=&quot;#cb12-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; pandas.concat(data)&lt;/span&gt;
&lt;span id=&quot;cb12-21&quot;&gt;&lt;a href=&quot;#cb12-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-22&quot;&gt;&lt;a href=&quot;#cb12-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;weather &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; get_data(&lt;span class=&quot;st&quot;&gt;&amp;#39;data&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb12-23&quot;&gt;&lt;a href=&quot;#cb12-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-24&quot;&gt;&lt;a href=&quot;#cb12-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Precip (mm)&amp;#39;&lt;/span&gt;].to_list()&lt;/span&gt;
&lt;span id=&quot;cb12-25&quot;&gt;&lt;a href=&quot;#cb12-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-26&quot;&gt;&lt;a href=&quot;#cb12-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# We will convert all dates into the native python datetime format, which works&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-27&quot;&gt;&lt;a href=&quot;#cb12-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# better with matplotlib.&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-28&quot;&gt;&lt;a href=&quot;#cb12-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;date &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; [x.to_pydatetime() &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; x &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Date/Time&amp;#39;&lt;/span&gt;]]&lt;/span&gt;
&lt;span id=&quot;cb12-29&quot;&gt;&lt;a href=&quot;#cb12-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-30&quot;&gt;&lt;a href=&quot;#cb12-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; plt.figure(figsize&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;(&lt;span class=&quot;fl&quot;&gt;10.0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;7.0&lt;/span&gt;))&lt;/span&gt;
&lt;span id=&quot;cb12-31&quot;&gt;&lt;a href=&quot;#cb12-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; fig.add_axes([&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;
&lt;span id=&quot;cb12-32&quot;&gt;&lt;a href=&quot;#cb12-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-33&quot;&gt;&lt;a href=&quot;#cb12-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# We will pass in both the date and rainfall amounts which contain the x and y values respectively&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-34&quot;&gt;&lt;a href=&quot;#cb12-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.plot(date, rainfall)&lt;/span&gt;
&lt;span id=&quot;cb12-35&quot;&gt;&lt;a href=&quot;#cb12-35&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-36&quot;&gt;&lt;a href=&quot;#cb12-36&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_xlabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;date&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb12-37&quot;&gt;&lt;a href=&quot;#cb12-37&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_ylabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;precipitation (mm)&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb12-38&quot;&gt;&lt;a href=&quot;#cb12-38&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_title(&lt;span class=&quot;st&quot;&gt;&amp;#39;Victoria BC daily precipitation&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb12-39&quot;&gt;&lt;a href=&quot;#cb12-39&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig.savefig(&lt;span class=&quot;st&quot;&gt;&amp;#39;daily-precipitation-with-dates.png&amp;#39;&lt;/span&gt;, bbox_inches&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-with-dates-800-8e46ac732.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-with-dates-800-d8ad2d229.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-with-dates-800-d8ad2d229.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC daily precipitation with dates
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;While it’s interesting to get this data plotted, it’s not obviously easy to compare one years data against another.&lt;/p&gt;
&lt;h2 id=&quot;comparing-annual-data&quot;&gt;Comparing Annual Data&lt;/h2&gt;
&lt;p&gt;Let’s slice up the data and plot it against different years.&lt;/p&gt;
&lt;h3 id=&quot;splitting-up-the-data-by-year&quot;&gt;Splitting up the Data by Year&lt;/h3&gt;
&lt;p&gt;We will create a new function that splits up the data by year, and calculates a new field that is days since January 1st of the current year:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb13&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb13-1&quot;&gt;&lt;a href=&quot;#cb13-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; get_days_since_jan1(date):&lt;/span&gt;
&lt;span id=&quot;cb13-2&quot;&gt;&lt;a href=&quot;#cb13-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; date.timetuple().tm_yday &lt;span class=&quot;op&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-3&quot;&gt;&lt;a href=&quot;#cb13-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-4&quot;&gt;&lt;a href=&quot;#cb13-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; split_data_by_year(weather):&lt;/span&gt;
&lt;span id=&quot;cb13-5&quot;&gt;&lt;a href=&quot;#cb13-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    yearly_rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb13-6&quot;&gt;&lt;a href=&quot;#cb13-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    yearly_days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb13-7&quot;&gt;&lt;a href=&quot;#cb13-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    current_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-8&quot;&gt;&lt;a href=&quot;#cb13-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    by_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb13-9&quot;&gt;&lt;a href=&quot;#cb13-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; i, row &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; weather.iterrows():&lt;/span&gt;
&lt;span id=&quot;cb13-10&quot;&gt;&lt;a href=&quot;#cb13-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        date &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; row[&lt;span class=&quot;st&quot;&gt;&amp;#39;Date/Time&amp;#39;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb13-11&quot;&gt;&lt;a href=&quot;#cb13-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; row[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Precip (mm)&amp;#39;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb13-12&quot;&gt;&lt;a href=&quot;#cb13-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-13&quot;&gt;&lt;a href=&quot;#cb13-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; current_year &lt;span class=&quot;kw&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id=&quot;cb13-14&quot;&gt;&lt;a href=&quot;#cb13-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            current_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; date.year&lt;/span&gt;
&lt;span id=&quot;cb13-15&quot;&gt;&lt;a href=&quot;#cb13-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;elif&lt;/span&gt; current_year &lt;span class=&quot;op&quot;&gt;!=&lt;/span&gt; date.year:&lt;/span&gt;
&lt;span id=&quot;cb13-16&quot;&gt;&lt;a href=&quot;#cb13-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            by_year.append((current_year, pandas.DataFrame({&lt;/span&gt;
&lt;span id=&quot;cb13-17&quot;&gt;&lt;a href=&quot;#cb13-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                &lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;: yearly_days_since_jan1,&lt;/span&gt;
&lt;span id=&quot;cb13-18&quot;&gt;&lt;a href=&quot;#cb13-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                &lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;: yearly_rainfall,&lt;/span&gt;
&lt;span id=&quot;cb13-19&quot;&gt;&lt;a href=&quot;#cb13-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                })))&lt;/span&gt;
&lt;span id=&quot;cb13-20&quot;&gt;&lt;a href=&quot;#cb13-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            yearly_days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb13-21&quot;&gt;&lt;a href=&quot;#cb13-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            yearly_rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb13-22&quot;&gt;&lt;a href=&quot;#cb13-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            current_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; date.year&lt;/span&gt;
&lt;span id=&quot;cb13-23&quot;&gt;&lt;a href=&quot;#cb13-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-24&quot;&gt;&lt;a href=&quot;#cb13-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        yearly_rainfall.append(rainfall)&lt;/span&gt;
&lt;span id=&quot;cb13-25&quot;&gt;&lt;a href=&quot;#cb13-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        yearly_days_since_jan1.append(get_days_since_jan1(date))&lt;/span&gt;
&lt;span id=&quot;cb13-26&quot;&gt;&lt;a href=&quot;#cb13-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-27&quot;&gt;&lt;a href=&quot;#cb13-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; current_year &lt;span class=&quot;kw&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id=&quot;cb13-28&quot;&gt;&lt;a href=&quot;#cb13-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        by_year.append((current_year, pandas.DataFrame({&lt;/span&gt;
&lt;span id=&quot;cb13-29&quot;&gt;&lt;a href=&quot;#cb13-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            &lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;: yearly_days_since_jan1,&lt;/span&gt;
&lt;span id=&quot;cb13-30&quot;&gt;&lt;a href=&quot;#cb13-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            &lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;: yearly_rainfall,&lt;/span&gt;
&lt;span id=&quot;cb13-31&quot;&gt;&lt;a href=&quot;#cb13-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            })))&lt;/span&gt;
&lt;span id=&quot;cb13-32&quot;&gt;&lt;a href=&quot;#cb13-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-33&quot;&gt;&lt;a href=&quot;#cb13-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; by_year&lt;/span&gt;
&lt;span id=&quot;cb13-34&quot;&gt;&lt;a href=&quot;#cb13-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-35&quot;&gt;&lt;a href=&quot;#cb13-35&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;rainfall_by_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; slice_data_by_year(weather)&lt;/span&gt;
&lt;span id=&quot;cb13-36&quot;&gt;&lt;a href=&quot;#cb13-36&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;print&lt;/span&gt;(rainfall_by_year)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will then output something similar to:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[(2014,      days_since_jan1  rainfall
0                 0       1.6
1                 1       6.6
..              ...       ...
363             363       0.0
364             364       0.0
[365 rows x 2 columns]),

(2015,      days_since_jan1  rainfall
0                 0       0.0
1                 1       4.8
..              ...       ...
363             363       0.0
364             364       0.0
[366 rows x 2 columns]),

...&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;plotting-the-data-by-year&quot;&gt;Plotting the Data by Year&lt;/h3&gt;
&lt;p&gt;Rather than call &lt;code&gt;ax.plot&lt;/code&gt; a single time; in this example we will call it from inside a for loop once for each year in our data set. We pass the year as a label value, which will then be displayed on the legend.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb15&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb15-1&quot;&gt;&lt;a href=&quot;#cb15-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb15-2&quot;&gt;&lt;a href=&quot;#cb15-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-3&quot;&gt;&lt;a href=&quot;#cb15-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; plt.figure(figsize&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;(&lt;span class=&quot;fl&quot;&gt;10.0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;7.0&lt;/span&gt;), dpi&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb15-4&quot;&gt;&lt;a href=&quot;#cb15-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; fig.add_axes([&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;
&lt;span id=&quot;cb15-5&quot;&gt;&lt;a href=&quot;#cb15-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-6&quot;&gt;&lt;a href=&quot;#cb15-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; year, annual_data &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; rainfall_by_year:&lt;/span&gt;
&lt;span id=&quot;cb15-7&quot;&gt;&lt;a href=&quot;#cb15-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;].to_list()&lt;/span&gt;
&lt;span id=&quot;cb15-8&quot;&gt;&lt;a href=&quot;#cb15-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;].to_list()&lt;/span&gt;
&lt;span id=&quot;cb15-9&quot;&gt;&lt;a href=&quot;#cb15-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    ax.plot(days_since_jan1, rainfall, label&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;year)&lt;/span&gt;
&lt;span id=&quot;cb15-10&quot;&gt;&lt;a href=&quot;#cb15-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-11&quot;&gt;&lt;a href=&quot;#cb15-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# label the axes and title the plot&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-12&quot;&gt;&lt;a href=&quot;#cb15-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_xlabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;days since jan 1st&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb15-13&quot;&gt;&lt;a href=&quot;#cb15-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_ylabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;precipitation (mm)&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb15-14&quot;&gt;&lt;a href=&quot;#cb15-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_title(&lt;span class=&quot;st&quot;&gt;&amp;#39;Victoria BC daily precipitation since Jan 1st&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb15-15&quot;&gt;&lt;a href=&quot;#cb15-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-16&quot;&gt;&lt;a href=&quot;#cb15-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.legend()&lt;/span&gt;
&lt;span id=&quot;cb15-17&quot;&gt;&lt;a href=&quot;#cb15-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-18&quot;&gt;&lt;a href=&quot;#cb15-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# save the plot to disk&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-19&quot;&gt;&lt;a href=&quot;#cb15-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig.savefig(&lt;span class=&quot;st&quot;&gt;&amp;#39;daily-precipitation-by-year.png&amp;#39;&lt;/span&gt;, bbox_inches&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will produce the following plot:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-by-year-800-6e1e40fd1.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-by-year-800-d2636209c.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/daily-precipitation-by-year-800-d2636209c.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC daily precipitation with dates
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;Well that’s interesting, but still rather hard to compare one year against another. We can fix that by plotting the yearly cumulative sum.&lt;/p&gt;
&lt;h3 id=&quot;plotting-cumulative-annual-rainfall-by-year&quot;&gt;Plotting Cumulative Annual Rainfall by Year&lt;/h3&gt;
&lt;p&gt;One potential way to plot the cumulative annual rainfall would be to modify the &lt;code&gt;split_data_by_year&lt;/code&gt; function to keep a yearly running total for the rainfall; however, pandas implements a &lt;code&gt;cumsum&lt;/code&gt; function which can perform the calculation for us:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb16&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb16-1&quot;&gt;&lt;a href=&quot;#cb16-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb16-2&quot;&gt;&lt;a href=&quot;#cb16-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-3&quot;&gt;&lt;a href=&quot;#cb16-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; plt.figure(figsize&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;(&lt;span class=&quot;fl&quot;&gt;10.0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;7.0&lt;/span&gt;), dpi&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb16-4&quot;&gt;&lt;a href=&quot;#cb16-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; fig.add_axes([&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;
&lt;span id=&quot;cb16-5&quot;&gt;&lt;a href=&quot;#cb16-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-6&quot;&gt;&lt;a href=&quot;#cb16-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; year, annual_data &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; rainfall_by_year:&lt;/span&gt;
&lt;span id=&quot;cb16-7&quot;&gt;&lt;a href=&quot;#cb16-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;].to_list()&lt;/span&gt;
&lt;span id=&quot;cb16-8&quot;&gt;&lt;a href=&quot;#cb16-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;].cumsum().to_list()&lt;/span&gt;
&lt;span id=&quot;cb16-9&quot;&gt;&lt;a href=&quot;#cb16-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    ax.plot(days_since_jan1, rainfall, label&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;year)&lt;/span&gt;
&lt;span id=&quot;cb16-10&quot;&gt;&lt;a href=&quot;#cb16-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-11&quot;&gt;&lt;a href=&quot;#cb16-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# label the axes and title the plot&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-12&quot;&gt;&lt;a href=&quot;#cb16-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_xlabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;days since jan 1st&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb16-13&quot;&gt;&lt;a href=&quot;#cb16-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_ylabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;precipitation (mm)&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb16-14&quot;&gt;&lt;a href=&quot;#cb16-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_title(&lt;span class=&quot;st&quot;&gt;&amp;#39;Victoria BC cumulative annual precipitation&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb16-15&quot;&gt;&lt;a href=&quot;#cb16-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-16&quot;&gt;&lt;a href=&quot;#cb16-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.legend()&lt;/span&gt;
&lt;span id=&quot;cb16-17&quot;&gt;&lt;a href=&quot;#cb16-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-18&quot;&gt;&lt;a href=&quot;#cb16-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# save the plot to disk&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb16-19&quot;&gt;&lt;a href=&quot;#cb16-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig.savefig(&lt;span class=&quot;st&quot;&gt;&amp;#39;cumulative-annual-precipitation.png&amp;#39;&lt;/span&gt;, bbox_inches&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Finally, a clear image starts to appear:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-800-10424472a.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-800-42450ace6.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-800-42450ace6.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC cumulative annual precipitation
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;h3 id=&quot;accounting-for-missing-data&quot;&gt;Accounting for Missing Data&lt;/h3&gt;
&lt;p&gt;If you look closely at the previous plot, there’s a few gaps in the data. This occurred due to the fact that the initial data set contains an empty string &lt;code&gt;&quot;&quot;&lt;/code&gt; in places where either no data is available, or where the data is zero. Since it’s not obvious which case applies, pandas will parse this empty string as &lt;code&gt;nan&lt;/code&gt; (not-a-number).&lt;/p&gt;
&lt;p&gt;In our case, the Environment Canada data encodes no snow as &lt;code&gt;&quot;&quot;&lt;/code&gt; rather than &lt;code&gt;0&lt;/code&gt; cm. We will instruct pandas to fill in these gaps with a default value of &lt;code&gt;0&lt;/code&gt;, using the &lt;code&gt;fillna()&lt;/code&gt; method:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb17&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb17-1&quot;&gt;&lt;a href=&quot;#cb17-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Precip (mm)&amp;#39;&lt;/span&gt;] &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Precip (mm)&amp;#39;&lt;/span&gt;].fillna(&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb17-2&quot;&gt;&lt;a href=&quot;#cb17-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Snow (cm)&amp;#39;&lt;/span&gt;] &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; weather[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Snow (cm)&amp;#39;&lt;/span&gt;].fillna(&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will produce a plot without gaps:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-no-gaps-800-60cdfabc8.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-no-gaps-800-d82f716e2.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-no-gaps-800-d82f716e2.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC cumulative annual precipitation
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;h3 id=&quot;reordering-the-legend-and-fixing-the-x-axis&quot;&gt;Reordering the Legend and Fixing the X Axis&lt;/h3&gt;
&lt;p&gt;The previous plot is difficult to see which colours correspond to which years (especially hard if you are colour blind). We will re-order the legend from wettest to driest years, with 2021 being dead-last.&lt;/p&gt;
&lt;p&gt;To sort the data, we will create a new function &lt;code&gt;get_total_rainfall&lt;/code&gt;, which returns a new value for python’s &lt;code&gt;sorted&lt;/code&gt; function to use when sorting values. We return a tuple so that the year can be used to differentiate between cases where the annual precipitation is identical.&lt;/p&gt;
&lt;p&gt;Additionally, let’s fix the x-axis to display the name of the month, rather than an integer value.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb18&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb18-1&quot;&gt;&lt;a href=&quot;#cb18-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib&lt;/span&gt;
&lt;span id=&quot;cb18-2&quot;&gt;&lt;a href=&quot;#cb18-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb18-3&quot;&gt;&lt;a href=&quot;#cb18-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-4&quot;&gt;&lt;a href=&quot;#cb18-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; plt.figure(figsize&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;(&lt;span class=&quot;fl&quot;&gt;10.0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;7.0&lt;/span&gt;), dpi&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb18-5&quot;&gt;&lt;a href=&quot;#cb18-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; fig.add_axes([&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;
&lt;span id=&quot;cb18-6&quot;&gt;&lt;a href=&quot;#cb18-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-7&quot;&gt;&lt;a href=&quot;#cb18-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; get_total_rainfall(val):&lt;/span&gt;
&lt;span id=&quot;cb18-8&quot;&gt;&lt;a href=&quot;#cb18-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    year, annual_data &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; val&lt;/span&gt;
&lt;span id=&quot;cb18-9&quot;&gt;&lt;a href=&quot;#cb18-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    total_rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;].cumsum().to_list()[&lt;span class=&quot;op&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb18-10&quot;&gt;&lt;a href=&quot;#cb18-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; (total_rainfall, year)&lt;/span&gt;
&lt;span id=&quot;cb18-11&quot;&gt;&lt;a href=&quot;#cb18-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-12&quot;&gt;&lt;a href=&quot;#cb18-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; year, annual_data &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bu&quot;&gt;sorted&lt;/span&gt;(rainfall_by_year, key&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;get_total_rainfall, reverse&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;True&lt;/span&gt;):&lt;/span&gt;
&lt;span id=&quot;cb18-13&quot;&gt;&lt;a href=&quot;#cb18-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;].to_list()&lt;/span&gt;
&lt;span id=&quot;cb18-14&quot;&gt;&lt;a href=&quot;#cb18-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; annual_data[&lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;].cumsum().to_list()&lt;/span&gt;
&lt;span id=&quot;cb18-15&quot;&gt;&lt;a href=&quot;#cb18-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    ax.plot(days_since_jan1, rainfall, label&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;year)&lt;/span&gt;
&lt;span id=&quot;cb18-16&quot;&gt;&lt;a href=&quot;#cb18-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-17&quot;&gt;&lt;a href=&quot;#cb18-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# format x axis values as month names rather than days since jan 1st&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-18&quot;&gt;&lt;a href=&quot;#cb18-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; format_days_since_jan1(days, pos&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;):&lt;/span&gt;
&lt;span id=&quot;cb18-19&quot;&gt;&lt;a href=&quot;#cb18-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    date &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; datetime.date(&lt;span class=&quot;dv&quot;&gt;2020&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; datetime.timedelta(days)&lt;/span&gt;
&lt;span id=&quot;cb18-20&quot;&gt;&lt;a href=&quot;#cb18-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; date.strftime(&lt;span class=&quot;st&quot;&gt;&amp;#39;%b&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb18-21&quot;&gt;&lt;a href=&quot;#cb18-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.xaxis.set_major_formatter(matplotlib.ticker.FuncFormatter(format_days_since_jan1))&lt;/span&gt;
&lt;span id=&quot;cb18-22&quot;&gt;&lt;a href=&quot;#cb18-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-23&quot;&gt;&lt;a href=&quot;#cb18-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# label the axes and title the plot&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-24&quot;&gt;&lt;a href=&quot;#cb18-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_xlabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;calendar date&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb18-25&quot;&gt;&lt;a href=&quot;#cb18-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_ylabel(&lt;span class=&quot;st&quot;&gt;&amp;#39;precipitation (mm)&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb18-26&quot;&gt;&lt;a href=&quot;#cb18-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.set_title(&lt;span class=&quot;st&quot;&gt;&amp;#39;Victoria BC cumulative annual precipitation&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb18-27&quot;&gt;&lt;a href=&quot;#cb18-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-28&quot;&gt;&lt;a href=&quot;#cb18-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.legend()&lt;/span&gt;
&lt;span id=&quot;cb18-29&quot;&gt;&lt;a href=&quot;#cb18-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-30&quot;&gt;&lt;a href=&quot;#cb18-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# save the plot to disk&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb18-31&quot;&gt;&lt;a href=&quot;#cb18-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig.savefig(&lt;span class=&quot;st&quot;&gt;&amp;#39;cumulative-annual-precipitation-sorted-legend.png&amp;#39;&lt;/span&gt;, bbox_inches&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And here we have it, 2021 has been a really dry year here in Victoria:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-sorted-legend-800-2250e68fc.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-sorted-legend-800-4f2dc358d.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-sorted-legend-800-4f2dc358d.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC cumulative annual precipitation v2
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;h2 id=&quot;accounting-for-snow&quot;&gt;Accounting for Snow&lt;/h2&gt;
&lt;p&gt;The previous plots have an error – they were only plotting rainfall, and not accounting for snowfall. It’s difficult to directly convert snowfall into an equivalent amount of precipitation due to the variety of snow crystal sizes – some snow is wet, while other snow is fairly dry. On the west-coast (wet-coast as some call it); when we do get snow, it tends to be fairly wet. We will assume that 13mm of snow is equivalent to 1mm of rain &lt;a href=&quot;#fn1&quot; class=&quot;footnote-ref&quot; id=&quot;fnref1&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Let’s revise our &lt;code&gt;split_data_by_year&lt;/code&gt; function to calculate this.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb19&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb19-1&quot;&gt;&lt;a href=&quot;#cb19-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;def&lt;/span&gt; split_data_by_year(weather):&lt;/span&gt;
&lt;span id=&quot;cb19-2&quot;&gt;&lt;a href=&quot;#cb19-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    yearly_rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb19-3&quot;&gt;&lt;a href=&quot;#cb19-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    yearly_days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb19-4&quot;&gt;&lt;a href=&quot;#cb19-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    current_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-5&quot;&gt;&lt;a href=&quot;#cb19-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    by_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb19-6&quot;&gt;&lt;a href=&quot;#cb19-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; i, row &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; weather.iterrows():&lt;/span&gt;
&lt;span id=&quot;cb19-7&quot;&gt;&lt;a href=&quot;#cb19-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        date &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; row[&lt;span class=&quot;st&quot;&gt;&amp;#39;Date/Time&amp;#39;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb19-8&quot;&gt;&lt;a href=&quot;#cb19-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; row[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Precip (mm)&amp;#39;&lt;/span&gt;]&lt;/span&gt;
&lt;span id=&quot;cb19-9&quot;&gt;&lt;a href=&quot;#cb19-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-10&quot;&gt;&lt;a href=&quot;#cb19-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;co&quot;&gt;# 1cm snow = 10mm snow; 13mm of snow = 1mm of rain&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-11&quot;&gt;&lt;a href=&quot;#cb19-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        snowfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; row[&lt;span class=&quot;st&quot;&gt;&amp;#39;Total Snow (cm)&amp;#39;&lt;/span&gt;] &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;fl&quot;&gt;10.0&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;fl&quot;&gt;13.0&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-12&quot;&gt;&lt;a href=&quot;#cb19-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        rainfall &lt;span class=&quot;op&quot;&gt;+=&lt;/span&gt; snowfall&lt;/span&gt;
&lt;span id=&quot;cb19-13&quot;&gt;&lt;a href=&quot;#cb19-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-14&quot;&gt;&lt;a href=&quot;#cb19-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; current_year &lt;span class=&quot;kw&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id=&quot;cb19-15&quot;&gt;&lt;a href=&quot;#cb19-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            current_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; date.year&lt;/span&gt;
&lt;span id=&quot;cb19-16&quot;&gt;&lt;a href=&quot;#cb19-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;elif&lt;/span&gt; current_year &lt;span class=&quot;op&quot;&gt;!=&lt;/span&gt; date.year:&lt;/span&gt;
&lt;span id=&quot;cb19-17&quot;&gt;&lt;a href=&quot;#cb19-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            by_year.append((current_year, pandas.DataFrame({&lt;/span&gt;
&lt;span id=&quot;cb19-18&quot;&gt;&lt;a href=&quot;#cb19-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                &lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;: yearly_days_since_jan1,&lt;/span&gt;
&lt;span id=&quot;cb19-19&quot;&gt;&lt;a href=&quot;#cb19-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                &lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;: yearly_rainfall,&lt;/span&gt;
&lt;span id=&quot;cb19-20&quot;&gt;&lt;a href=&quot;#cb19-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;                })))&lt;/span&gt;
&lt;span id=&quot;cb19-21&quot;&gt;&lt;a href=&quot;#cb19-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            yearly_days_since_jan1 &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb19-22&quot;&gt;&lt;a href=&quot;#cb19-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            yearly_rainfall &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id=&quot;cb19-23&quot;&gt;&lt;a href=&quot;#cb19-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            current_year &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; date.year&lt;/span&gt;
&lt;span id=&quot;cb19-24&quot;&gt;&lt;a href=&quot;#cb19-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-25&quot;&gt;&lt;a href=&quot;#cb19-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        yearly_rainfall.append(rainfall)&lt;/span&gt;
&lt;span id=&quot;cb19-26&quot;&gt;&lt;a href=&quot;#cb19-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        yearly_days_since_jan1.append(get_days_since_jan1(date))&lt;/span&gt;
&lt;span id=&quot;cb19-27&quot;&gt;&lt;a href=&quot;#cb19-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-28&quot;&gt;&lt;a href=&quot;#cb19-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; current_year &lt;span class=&quot;kw&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id=&quot;cb19-29&quot;&gt;&lt;a href=&quot;#cb19-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        by_year.append((current_year, pandas.DataFrame({&lt;/span&gt;
&lt;span id=&quot;cb19-30&quot;&gt;&lt;a href=&quot;#cb19-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            &lt;span class=&quot;st&quot;&gt;&amp;#39;days_since_jan1&amp;#39;&lt;/span&gt;: yearly_days_since_jan1,&lt;/span&gt;
&lt;span id=&quot;cb19-31&quot;&gt;&lt;a href=&quot;#cb19-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            &lt;span class=&quot;st&quot;&gt;&amp;#39;rainfall&amp;#39;&lt;/span&gt;: yearly_rainfall,&lt;/span&gt;
&lt;span id=&quot;cb19-32&quot;&gt;&lt;a href=&quot;#cb19-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            })))&lt;/span&gt;
&lt;span id=&quot;cb19-33&quot;&gt;&lt;a href=&quot;#cb19-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb19-34&quot;&gt;&lt;a href=&quot;#cb19-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; by_year&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you look closely, once we adjust for snow, it turned out that 2017 was a wetter year compared to 2014:&lt;/p&gt;
&lt;div class=&quot;wide&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-with-snow-800-e85637744.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-with-snow-800-bc4754e2f.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img src=&quot;/blog/generated/assets/images/plotting-rainfall-data-with-python-and-matplotlib/cumulative-annual-precipitation-with-snow-800-bc4754e2f.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;figcaption&gt;
Victoria BC cumulative annual precipitation including snow
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;None of that however changes the fact that it’s been a very dry year, and my garden is browner than ever. On the other hand, my tomatoes have been loving the heat.&lt;/p&gt;
&lt;p&gt;If you would like to try generating the above graphs, all the code (and data) can be found under &lt;a href=&quot;https://github.com/earthly/example-plotting-precipitation&quot;&gt;github.com/earthly/example-plotting-precipitation&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;notice--info notice--big&quot;&gt;
&lt;p&gt;
&lt;strong&gt;While you’re here:&lt;/strong&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today.
&lt;/p&gt;
&lt;/div&gt;
&lt;section class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&quot;fn1&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;https://www.nssl.noaa.gov/education/svrwx101/winter/faq/&lt;a href=&quot;#fnref1&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;</content><author><name>Alex Couture-Beil</name></author><category term="Tutorials" /><summary type="html">Where Did All The Rain Go? It’s been a really dry summer here in Victoria BC (and the rest of the province). I couldn’t remember the last time it had rained, which got me looking at historical weather data. Before I knew it, rather than simply look up how many days it’s been since it last rained (42 and counting!), I was plotting cumulative annual rainfall. Get Some Data I ended up on Environment Canada’s historic data search page, and ended up with a table of daily weather recorded at Victoria International Airport, climate ID 1018621 (which is closer to Sidney BC, but I digress). On the right hand side of that page, there was an option to download the data as CSV. Upon clicking the Download Data button, my web browser was redirected to: https://climate.weather.gc.ca/climate_data/bulk_data_e.html?format=csv&amp;amp;stationID=51337&amp;amp;Year=2021&amp;amp;Month=7&amp;amp;Day=1&amp;amp;time=&amp;amp;timeframe=2&amp;amp;submit=Download+Data The website gave me an option to change the range of data to download; however if you squint enough, the above URL looks like an API. Furthermore, the month and day values didn’t seem to affect anything – since this was annual data, only the year was used. It’s also interesting to note that the station ID is different from the Climate ID even though Environment Canada defines “the climate ID is a 7 digit number assigned by the Meteorological Service of Canada to a site where official weather observations are taken, and serves as a permanent, unique identifier.” Perhaps there was a thought leader who was suffering from past trauma where a client’s definition of a “permanent unique identifier” didn’t match up with a relational databases’ definition of a unique identifier, and insisted on creating a lookup table for these different IDs. Again, I digress, back to downloading data. I wrote a bash while loop to download this data: #!/bin/sh set -e for year in $(seq 2013 2021); do curl &amp;quot;https://climate.weather.gc.ca/climate_data/bulk_data_e.html?format=csv&amp;amp;stationID=51337&amp;amp;Year=${year}&amp;amp;timeframe=2&amp;quot; &amp;gt; victoria-weather-$year.csv done Parsing the Data Using the Standard csv.reader Parser Python offers a standard library for parsing .csv files, aptly named csv. The csv library is fairly low-level and provides a csv.reader which can be used to iterate over rows: import csv with open(&amp;#39;data/victoria-weather-2020.csv&amp;#39;) as fp: reader = csv.reader(fp) for row in reader: print(row) This will output something such as [&amp;#39;\ufeff&amp;quot;Longitude (x)&amp;quot;&amp;#39;, &amp;#39;Latitude (y)&amp;#39;, &amp;#39;Station Name&amp;#39;, &amp;#39;Climate ID&amp;#39;, &amp;#39;Date/Time&amp;#39;, &amp;#39;Year&amp;#39;, &amp;#39;Month&amp;#39;, &amp;#39;Day&amp;#39;, &amp;#39;Data Quality&amp;#39;, &amp;#39;Max Temp (°C)&amp;#39;, &amp;#39;Max Temp Flag&amp;#39;, &amp;#39;Min Temp (°C)&amp;#39;, &amp;#39;Min Temp Flag&amp;#39;, &amp;#39;Mean Temp (°C)&amp;#39;, &amp;#39;Mean Temp Flag&amp;#39;, &amp;#39;Heat Deg Days (°C)&amp;#39;, &amp;#39;Heat Deg Days Flag&amp;#39;, &amp;#39;Cool Deg Days (°C)&amp;#39;, &amp;#39;Cool Deg Days Flag&amp;#39;, &amp;#39;Total Rain (mm)&amp;#39;, &amp;#39;Total Rain Flag&amp;#39;, &amp;#39;Total Snow (cm)&amp;#39;, &amp;#39;Total Snow Flag&amp;#39;, &amp;#39;Total Precip (mm)&amp;#39;, &amp;#39;Total Precip Flag&amp;#39;, &amp;#39;Snow on Grnd (cm)&amp;#39;, &amp;#39;Snow on Grnd Flag&amp;#39;, &amp;#39;Dir of Max Gust (10s deg)&amp;#39;, &amp;#39;Dir of Max Gust Flag&amp;#39;, &amp;#39;Spd of Max Gust (km/h)&amp;#39;, &amp;#39;Spd of Max Gust Flag&amp;#39;] [&amp;#39;-123.43&amp;#39;, &amp;#39;48.65&amp;#39;, &amp;#39;VICTORIA INTL A&amp;#39;, &amp;#39;1018621&amp;#39;, &amp;#39;2020-01-01&amp;#39;, &amp;#39;2020&amp;#39;, &amp;#39;01&amp;#39;, &amp;#39;01&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;12.9&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;5.5&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;9.2&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;8.8&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;T&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;T&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;26&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;59&amp;#39;, &amp;#39;&amp;#39;] [&amp;#39;-123.43&amp;#39;, &amp;#39;48.65&amp;#39;, &amp;#39;VICTORIA INTL A&amp;#39;, &amp;#39;1018621&amp;#39;, &amp;#39;2020-01-02&amp;#39;, &amp;#39;2020&amp;#39;, &amp;#39;01&amp;#39;, &amp;#39;02&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;6.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.9&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;3.5&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14.5&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14.6&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;0.0&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14.6&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;14&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;45&amp;#39;, &amp;#39;&amp;#39;] The downside of using the standard python csv.reader parser, is it simply returns all cells as strings, and doesn’t differentiate between cell headers and cell contents. Furthermore, the underlying data seems to have some sort of unicode character that’s not being correctly handled. Using the Standard csv.DictReader Parser The csv library provides a csv.DictReader class which will use the first row as cell headers, and rather than returning the row as a list; instead it will return it as a dictionary: {&amp;#39;\ufeff&amp;quot;Longitude (x)&amp;quot;&amp;#39;: &amp;#39;-123.43&amp;#39;, &amp;#39;Latitude (y)&amp;#39;: &amp;#39;48.65&amp;#39;, &amp;#39;Station Name&amp;#39;: &amp;#39;VICTORIA INTL A&amp;#39;, &amp;#39;Climate ID&amp;#39;: &amp;#39;1018621&amp;#39;, &amp;#39;Date/Time&amp;#39;: &amp;#39;2020-01-01&amp;#39;, &amp;#39;Year&amp;#39;: &amp;#39;2020&amp;#39;, &amp;#39;Month&amp;#39;: &amp;#39;01&amp;#39;, &amp;#39;Day&amp;#39;: &amp;#39;01&amp;#39;, &amp;#39;Data Quality&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Max Temp (°C)&amp;#39;: &amp;#39;12.9&amp;#39;, &amp;#39;Max Temp Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Min Temp (°C)&amp;#39;: &amp;#39;5.5&amp;#39;, &amp;#39;Min Temp Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Mean Temp (°C)&amp;#39;: &amp;#39;9.2&amp;#39;, &amp;#39;Mean Temp Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Heat Deg Days (°C)&amp;#39;: &amp;#39;8.8&amp;#39;, &amp;#39;Heat Deg Days Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Cool Deg Days (°C)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Cool Deg Days Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Total Rain (mm)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Total Rain Flag&amp;#39;: &amp;#39;T&amp;#39;, &amp;#39;Total Snow (cm)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Total Snow Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Total Precip (mm)&amp;#39;: &amp;#39;0.0&amp;#39;, &amp;#39;Total Precip Flag&amp;#39;: &amp;#39;T&amp;#39;, &amp;#39;Snow on Grnd (cm)&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Snow on Grnd Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Dir of Max Gust (10s deg)&amp;#39;: &amp;#39;26&amp;#39;, &amp;#39;Dir of Max Gust Flag&amp;#39;: &amp;#39;&amp;#39;, &amp;#39;Spd of Max Gust (km/h)&amp;#39;: &amp;#39;59&amp;#39;, &amp;#39;Spd of Max Gust Flag&amp;#39;: &amp;#39;&amp;#39;} However, the DictReader doesn’t parse the cell contents and returns everything simply as strings – leaving all type parsing to the user. Again we see the incorrectly handled unicode character appear – this time within the key of every row. Using the Pandas Library The pandas library is a third-party python library which provides tools for data analysis and manipulation. We will be using the pandas.read_csv function to parse our data: import pandas weather = pandas.read_csv(&amp;#39;data/victoria-weather-2020.csv&amp;#39;) print(weather) This will produce output such as: Longitude (x) Latitude (y) Station Name Climate ID Date/Time Year Month Day ... Total Precip (mm) Total Precip Flag Snow on Grnd (cm) Snow on Grnd Flag Dir of Max Gust (10s deg) Dir of Max Gust Flag Spd of Max Gust (km/h) Spd of Max Gust Flag 0 -123.43 48.65 VICTORIA INTL A 1018621 2020-01-01 2020 1 1 ... 0.0 T NaN NaN 26.0 NaN 59.0 NaN 1 -123.43 48.65 VICTORIA INTL A 1018621 2020-01-02 2020 1 2 ... 14.6 NaN NaN NaN 14.0 NaN 45.0 NaN 2 -123.43 48.65 VICTORIA INTL A 1018621 2020-01-03 2020 1 3 ... 11.2 NaN NaN NaN 15.0 NaN 39.0 NaN .. ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... 363 -123.43 48.65 VICTORIA INTL A 1018621 2020-12-29 2020 12 29 ... 8.7 NaN NaN NaN NaN M NaN M 364 -123.43 48.65 VICTORIA INTL A 1018621 2020-12-30 2020 12 30 ... 20.4 NaN NaN NaN 14.0 NaN 61.0 NaN 365 -123.43 48.65 VICTORIA INTL A 1018621 2020-12-31 2020 12 31 ... 7.2 NaN NaN NaN 14.0 NaN 33.0 NaN [366 rows x 31 columns] Notice how the columns have been automatically parsed to an appropriate data type, as well as the column headers are detected. Row numbers are additionally displayed, as well as the data is displayed as a table. This is possible due to the fact that the read_csv function returns a pandas.core.frame.DataFrame data type which among other things, implements the __str__ method which is used to render the string which is passed to the print function. Merging Multiple Datasets My dataset is split across multiple csv files, with each file containing a dataset for a specific year. My first task is to merge them together. All the datasets are located under the data directory, and are named victoria-weather-YYYY.csv (where YYYY is the year). Let’s write a function to parse all the data: import re import os import pandas def get_data(weather_dir): p = re.compile(&amp;#39;victoria-weather-[0-9]+.csv&amp;#39;) data = [] for filename in sorted(os.listdir(weather_dir)): if p.match(filename): path = os.path.join(weather_dir, filename) yearly_data = pandas.read_csv(path) data.append(yearly_data) return pandas.concat(data) weather = get_data(&amp;#39;data&amp;#39;) print(weather) This function 1) uses a regular expression to ensure we only parse files which match the expected form, which prevents our program from crashing if any other files existed in the directory, 2) parses each file separately using the read_csv function, 3) saves the returned data frame into the data list, then finally 4) concatenates the data using the concat function. This code should output a single data frame containing all the data spanning a decade: Longitude (x) Latitude (y) Station Name Climate ID Date/Time Year Month Day Data Quality ... Total Snow Flag Total Precip (mm) Total Precip Flag Snow on Grnd (cm) Snow on Grnd Flag Dir of Max Gust (10s deg) Dir of Max Gust Flag Spd of Max Gust (km/h) Spd of Max Gust Flag 0 -123.43 48.65 VICTORIA INTL A 1018621 2014-01-01 2014 1 1 NaN ... NaN 1.6 NaN NaN NaN NaN NaN &amp;lt;31 NaN 1 -123.43 48.65 VICTORIA INTL A 1018621 2014-01-02 2014 1 2 NaN ... NaN 6.6 NaN NaN NaN 21.0 NaN 37 NaN 2 -123.43 48.65 VICTORIA INTL A 1018621 2014-01-03 2014 1 3 NaN ... NaN 0.0 NaN NaN NaN 31.0 NaN 41 NaN 3 -123.43 48.65 VICTORIA INTL A 1018621 2014-01-04 2014 1 4 NaN ... NaN 0.0 NaN NaN NaN NaN NaN &amp;lt;31 NaN 4 -123.43 48.65 VICTORIA INTL A 1018621 2014-01-05 2014 1 5 NaN ... NaN 0.0 NaN NaN NaN NaN NaN &amp;lt;31 NaN .. ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... 198 -123.43 48.65 VICTORIA INTL A 1018621 2021-07-18 2021 7 18 NaN ... NaN 0.0 NaN NaN NaN NaN NaN NaN M 199 -123.43 48.65 VICTORIA INTL A 1018621 2021-07-19 2021 7 19 NaN ... NaN 0.0 NaN NaN NaN 25.0 NaN 37.0 NaN 200 -123.43 48.65 VICTORIA INTL A 1018621 2021-07-20 2021 7 20 NaN ... NaN 0.0 NaN NaN NaN 29.0 NaN 36.0 NaN 201 -123.43 48.65 VICTORIA INTL A 1018621 2021-07-21 2021 7 21 NaN ... NaN 0.0 NaN NaN NaN 28.0 NaN 33.0 NaN 202 -123.43 48.65 VICTORIA INTL A 1018621 2021-07-22 2021 7 22 NaN ... NaN 0.0 NaN NaN NaN NaN M NaN M [2760 rows x 31 columns] Raindrops Keep Falling on my Plots Let’s plot the rainfall! We will use the matplotlib library for visualizing this data. We can extract a single column of the data frame using the column name, e.g. weather['Total Precip (mm)']. This will return a pandas.core.series.Series data type, which is similar to a list; however requires each element in the series to be the same data type. This allows pandas to keep all elements in contiguous memory, which allows faster SIMD-based operations. For another example of comparing generic data types against specific native types, checkout out our post on the various tricks that python’s timsort uses to achieve better performance. A pandas series can be converted into a python list using the .to_list() method; e.g. weather['Total Precip (mm)'].to_list() Plotting the Data Interactively Here’s a quick example of plotting this data interactively: import matplotlib.pyplot as plt rainfall = weather[&amp;#39;Total Precip (mm)&amp;#39;].to_list() plt.plot(rainfall) plt.show() This will display a new window, containing a plot of the data: Victoria BC daily precipitation interactive plot It should be possible to omit the .to_list() call, which would then pass the pandas series data type directly to the matplotlib plot function rather than passing a standard python list; however, there’s a bug in matplotlib (or pandas), which produces the following erroneous plot: Notice how this plot has some bizarre lines that criss-cross the plot, and that the data points stop at roughly 350 rather than past 2500? At a quick glance, this might be an instance of this bug. Saving the Plot Programmatically Lets revise the previous code to render the plot as a png instead of using an interactive window: import matplotlib.pyplot as plt # create a new figure that is 10x7 inches # which is rendered as 100 pixels per inch # (matplotlib incorrectly refers to this as dots-per-inch, which is a printer term) fig = plt.figure(figsize=(10.0, 7.0), dpi=100) # define axes on the figure to take up the entire figure canvas ax = fig.add_axes([0, 0, 1, 1]) # plot the rainfall amounts against the axes ax.plot(rainfall) # label the axes and title the plot ax.set_xlabel(&amp;#39;days since start of dataset&amp;#39;) ax.set_ylabel(&amp;#39;precipitation (mm)&amp;#39;) ax.set_title(&amp;#39;Victoria BC daily precipitation&amp;#39;) # save the plot to disk fig.savefig(&amp;#39;daily-precipitation.png&amp;#39;, bbox_inches=&amp;#39;tight&amp;#39;) Which will produce: Victoria BC daily precipitation Fixing the X Axis Label to Display the Date The previous plots didn’t make use of the Date/Time column from our weather data csv files; instead it was simply displaying the index of the list element. We need to instruct pandas to parse those columns as dates using the parse_dates field. We will additionally define a date parsing function yyyymmdd_parser which will be used to parse the date; without this function, pandas will attempt to guess the format of the date, which is a best-effort strategy and may not always work. import re import os import pandas import datetime import matplotlib.pyplot as plt # Our new date parser def yyyymmdd_parser(s): return datetime.datetime.strptime(s, &amp;#39;%Y-%m-%d&amp;#39;) def get_data(weather_dir): p = re.compile(&amp;#39;victoria-weather-[0-9]+.csv&amp;#39;) data = [] for filename in sorted(os.listdir(weather_dir)): if p.match(filename): path = os.path.join(weather_dir, filename) # We identify which column contains the date, along with the date parser to use. yearly_data = pandas.read_csv(path, parse_dates=[&amp;#39;Date/Time&amp;#39;], date_parser=yyyymmdd_parser) data.append(yearly_data) return pandas.concat(data) weather = get_data(&amp;#39;data&amp;#39;) rainfall = weather[&amp;#39;Total Precip (mm)&amp;#39;].to_list() # We will convert all dates into the native python datetime format, which works # better with matplotlib. date = [x.to_pydatetime() for x in weather[&amp;#39;Date/Time&amp;#39;]] fig = plt.figure(figsize=(10.0, 7.0)) ax = fig.add_axes([0,0,1,1]) # We will pass in both the date and rainfall amounts which contain the x and y values respectively ax.plot(date, rainfall) ax.set_xlabel(&amp;#39;date&amp;#39;) ax.set_ylabel(&amp;#39;precipitation (mm)&amp;#39;) ax.set_title(&amp;#39;Victoria BC daily precipitation&amp;#39;) fig.savefig(&amp;#39;daily-precipitation-with-dates.png&amp;#39;, bbox_inches=&amp;#39;tight&amp;#39;) Victoria BC daily precipitation with dates While it’s interesting to get this data plotted, it’s not obviously easy to compare one years data against another. Comparing Annual Data Let’s slice up the data and plot it against different years. Splitting up the Data by Year We will create a new function that splits up the data by year, and calculates a new field that is days since January 1st of the current year: def get_days_since_jan1(date): return date.timetuple().tm_yday - 1 def split_data_by_year(weather): yearly_rainfall = [] yearly_days_since_jan1 = [] current_year = None by_year = [] for i, row in weather.iterrows(): date = row[&amp;#39;Date/Time&amp;#39;] rainfall = row[&amp;#39;Total Precip (mm)&amp;#39;] if current_year is None: current_year = date.year elif current_year != date.year: by_year.append((current_year, pandas.DataFrame({ &amp;#39;days_since_jan1&amp;#39;: yearly_days_since_jan1, &amp;#39;rainfall&amp;#39;: yearly_rainfall, }))) yearly_days_since_jan1 = [] yearly_rainfall = [] current_year = date.year yearly_rainfall.append(rainfall) yearly_days_since_jan1.append(get_days_since_jan1(date)) if current_year is not None: by_year.append((current_year, pandas.DataFrame({ &amp;#39;days_since_jan1&amp;#39;: yearly_days_since_jan1, &amp;#39;rainfall&amp;#39;: yearly_rainfall, }))) return by_year rainfall_by_year = slice_data_by_year(weather) print(rainfall_by_year) This will then output something similar to: [(2014, days_since_jan1 rainfall 0 0 1.6 1 1 6.6 .. ... ... 363 363 0.0 364 364 0.0 [365 rows x 2 columns]), (2015, days_since_jan1 rainfall 0 0 0.0 1 1 4.8 .. ... ... 363 363 0.0 364 364 0.0 [366 rows x 2 columns]), ... Plotting the Data by Year Rather than call ax.plot a single time; in this example we will call it from inside a for loop once for each year in our data set. We pass the year as a label value, which will then be displayed on the legend. import matplotlib.pyplot as plt fig = plt.figure(figsize=(10.0, 7.0), dpi=100) ax = fig.add_axes([0, 0, 1, 1]) for year, annual_data in rainfall_by_year: days_since_jan1 = annual_data[&amp;#39;days_since_jan1&amp;#39;].to_list() rainfall = annual_data[&amp;#39;rainfall&amp;#39;].to_list() ax.plot(days_since_jan1, rainfall, label=year) # label the axes and title the plot ax.set_xlabel(&amp;#39;days since jan 1st&amp;#39;) ax.set_ylabel(&amp;#39;precipitation (mm)&amp;#39;) ax.set_title(&amp;#39;Victoria BC daily precipitation since Jan 1st&amp;#39;) ax.legend() # save the plot to disk fig.savefig(&amp;#39;daily-precipitation-by-year.png&amp;#39;, bbox_inches=&amp;#39;tight&amp;#39;) This will produce the following plot: Victoria BC daily precipitation with dates Well that’s interesting, but still rather hard to compare one year against another. We can fix that by plotting the yearly cumulative sum. Plotting Cumulative Annual Rainfall by Year One potential way to plot the cumulative annual rainfall would be to modify the split_data_by_year function to keep a yearly running total for the rainfall; however, pandas implements a cumsum function which can perform the calculation for us: import matplotlib.pyplot as plt fig = plt.figure(figsize=(10.0, 7.0), dpi=100) ax = fig.add_axes([0, 0, 1, 1]) for year, annual_data in rainfall_by_year: days_since_jan1 = annual_data[&amp;#39;days_since_jan1&amp;#39;].to_list() rainfall = annual_data[&amp;#39;rainfall&amp;#39;].cumsum().to_list() ax.plot(days_since_jan1, rainfall, label=year) # label the axes and title the plot ax.set_xlabel(&amp;#39;days since jan 1st&amp;#39;) ax.set_ylabel(&amp;#39;precipitation (mm)&amp;#39;) ax.set_title(&amp;#39;Victoria BC cumulative annual precipitation&amp;#39;) ax.legend() # save the plot to disk fig.savefig(&amp;#39;cumulative-annual-precipitation.png&amp;#39;, bbox_inches=&amp;#39;tight&amp;#39;) Finally, a clear image starts to appear: Victoria BC cumulative annual precipitation Accounting for Missing Data If you look closely at the previous plot, there’s a few gaps in the data. This occurred due to the fact that the initial data set contains an empty string &quot;&quot; in places where either no data is available, or where the data is zero. Since it’s not obvious which case applies, pandas will parse this empty string as nan (not-a-number). In our case, the Environment Canada data encodes no snow as &quot;&quot; rather than 0 cm. We will instruct pandas to fill in these gaps with a default value of 0, using the fillna() method: weather[&amp;#39;Total Precip (mm)&amp;#39;] = weather[&amp;#39;Total Precip (mm)&amp;#39;].fillna(0) weather[&amp;#39;Total Snow (cm)&amp;#39;] = weather[&amp;#39;Total Snow (cm)&amp;#39;].fillna(0) This will produce a plot without gaps: Victoria BC cumulative annual precipitation Reordering the Legend and Fixing the X Axis The previous plot is difficult to see which colours correspond to which years (especially hard if you are colour blind). We will re-order the legend from wettest to driest years, with 2021 being dead-last. To sort the data, we will create a new function get_total_rainfall, which returns a new value for python’s sorted function to use when sorting values. We return a tuple so that the year can be used to differentiate between cases where the annual precipitation is identical. Additionally, let’s fix the x-axis to display the name of the month, rather than an integer value. import matplotlib import matplotlib.pyplot as plt fig = plt.figure(figsize=(10.0, 7.0), dpi=100) ax = fig.add_axes([0, 0, 1, 1]) def get_total_rainfall(val): year, annual_data = val total_rainfall = annual_data[&amp;#39;rainfall&amp;#39;].cumsum().to_list()[-1] return (total_rainfall, year) for year, annual_data in sorted(rainfall_by_year, key=get_total_rainfall, reverse=True): days_since_jan1 = annual_data[&amp;#39;days_since_jan1&amp;#39;].to_list() rainfall = annual_data[&amp;#39;rainfall&amp;#39;].cumsum().to_list() ax.plot(days_since_jan1, rainfall, label=year) # format x axis values as month names rather than days since jan 1st def format_days_since_jan1(days, pos=None): date = datetime.date(2020, 1, 1) + datetime.timedelta(days) return date.strftime(&amp;#39;%b&amp;#39;) ax.xaxis.set_major_formatter(matplotlib.ticker.FuncFormatter(format_days_since_jan1)) # label the axes and title the plot ax.set_xlabel(&amp;#39;calendar date&amp;#39;) ax.set_ylabel(&amp;#39;precipitation (mm)&amp;#39;) ax.set_title(&amp;#39;Victoria BC cumulative annual precipitation&amp;#39;) ax.legend() # save the plot to disk fig.savefig(&amp;#39;cumulative-annual-precipitation-sorted-legend.png&amp;#39;, bbox_inches=&amp;#39;tight&amp;#39;) And here we have it, 2021 has been a really dry year here in Victoria: Victoria BC cumulative annual precipitation v2 Accounting for Snow The previous plots have an error – they were only plotting rainfall, and not accounting for snowfall. It’s difficult to directly convert snowfall into an equivalent amount of precipitation due to the variety of snow crystal sizes – some snow is wet, while other snow is fairly dry. On the west-coast (wet-coast as some call it); when we do get snow, it tends to be fairly wet. We will assume that 13mm of snow is equivalent to 1mm of rain 1. Let’s revise our split_data_by_year function to calculate this. def split_data_by_year(weather): yearly_rainfall = [] yearly_days_since_jan1 = [] current_year = None by_year = [] for i, row in weather.iterrows(): date = row[&amp;#39;Date/Time&amp;#39;] rainfall = row[&amp;#39;Total Precip (mm)&amp;#39;] # 1cm snow = 10mm snow; 13mm of snow = 1mm of rain snowfall = row[&amp;#39;Total Snow (cm)&amp;#39;] * 10.0 / 13.0 rainfall += snowfall if current_year is None: current_year = date.year elif current_year != date.year: by_year.append((current_year, pandas.DataFrame({ &amp;#39;days_since_jan1&amp;#39;: yearly_days_since_jan1, &amp;#39;rainfall&amp;#39;: yearly_rainfall, }))) yearly_days_since_jan1 = [] yearly_rainfall = [] current_year = date.year yearly_rainfall.append(rainfall) yearly_days_since_jan1.append(get_days_since_jan1(date)) if current_year is not None: by_year.append((current_year, pandas.DataFrame({ &amp;#39;days_since_jan1&amp;#39;: yearly_days_since_jan1, &amp;#39;rainfall&amp;#39;: yearly_rainfall, }))) return by_year If you look closely, once we adjust for snow, it turned out that 2017 was a wetter year compared to 2014: Victoria BC cumulative annual precipitation including snow None of that however changes the fact that it’s been a very dry year, and my garden is browner than ever. On the other hand, my tomatoes have been loving the heat. If you would like to try generating the above graphs, all the code (and data) can be found under github.com/earthly/example-plotting-precipitation. While you’re here: Earthly is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today. https://www.nssl.noaa.gov/education/svrwx101/winter/faq/↩︎</summary></entry><entry><title type="html">How to Convert from JSON to CSV at The Command Line</title><link href="https://earthly.dev/blog/convert-to-from-json/" rel="alternate" type="text/html" title="How to Convert from JSON to CSV at The Command Line" /><published>2021-08-12T00:00:00-04:00</published><updated>2021-08-12T00:00:00-04:00</updated><id>https://earthly.dev/blog/convert-to-from-json</id><content type="html" xml:base="https://earthly.dev/blog/convert-to-from-json/">&lt;p&gt;How do you convert JSON values to CSV and back at the command line? I’ve done this task on many occasions and been stung by the edge cases frequently enough that &lt;strong&gt;it’s time for me to share my favorite tools for this conversion process.&lt;/strong&gt; But first, some background.&lt;/p&gt;
&lt;h2 id=&quot;background-you-probably-want-a-csv-conversion-tool&quot;&gt;Background: You Probably Want a CSV Conversion Tool&lt;/h2&gt;
&lt;p&gt;The CSV format seems simple at first glance: You have a fixed number of fields per row and each field is separated by a comma.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1997,Ford,E350\n&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;However, if you need to use commas in the value, then the fields must be delimited with &lt;code&gt;&quot;&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1997,Ford,E350,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;Super, luxurious truck&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;\n&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can use this same trick to delimit a line break, and use double double-quotes if you need to include &lt;code&gt;&quot;&lt;/code&gt; in your values or headings.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1997,Ford,E350,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;Go get one &amp;quot;&amp;quot;now&amp;quot;&amp;quot;\n&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;they are going fast&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;\n&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Things get more complex from there, and even the &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc4180&quot;&gt;CSV standard&lt;/a&gt; does not specify how to handle all the edge cases and some formatting options are non-compatible. Wikipedia puts it this way:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The CSV file format is not fully standardized. Separating fields with commas is the foundation, but commas in the data or embedded line breaks have to be handled specially. Some implementations disallow such content while others surround the field with quotation marks, which yet again creates the need for escaping these if they are present in the data.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So although it seems like CSV conversion can be done by hand in python, or your language of choice, using an existing tool that is known to handle the edges cases well it the way to go.&lt;/p&gt;
&lt;p&gt;With that in mind, let’s review some tools for converting from JSON to CSV at the command line.&lt;/p&gt;
&lt;h2 id=&quot;convert-json-to-csv-via-the-command-line&quot;&gt;Convert JSON to CSV via the Command Line&lt;/h2&gt;
&lt;p&gt;The simplest way to do this JSON to CSV conversion is with &lt;code&gt;dasel&lt;/code&gt;. &lt;code&gt;dasel&lt;/code&gt; is a tool for DAta SELection. Think of it as a &lt;code&gt;jq&lt;/code&gt; that supports selection on formats besides just JSON.&lt;/p&gt;
&lt;p&gt;It’s easy to install (&lt;code&gt;brew install dasel&lt;/code&gt;), and it works great as a format converter.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;   &lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;    &lt;/span&gt;
&lt;span id=&quot;cb4-4&quot;&gt;&lt;a href=&quot;#cb4-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-5&quot;&gt;&lt;a href=&quot;#cb4-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;#f00&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-6&quot;&gt;&lt;a href=&quot;#cb4-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-7&quot;&gt;&lt;a href=&quot;#cb4-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-8&quot;&gt;&lt;a href=&quot;#cb4-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;   &lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb4-9&quot;&gt;&lt;a href=&quot;#cb4-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-10&quot;&gt;&lt;a href=&quot;#cb4-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;#0f0&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-11&quot;&gt;&lt;a href=&quot;#cb4-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-12&quot;&gt;&lt;a href=&quot;#cb4-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-13&quot;&gt;&lt;a href=&quot;#cb4-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;dt&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;   &lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;cb4-14&quot;&gt;&lt;a href=&quot;#cb4-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-15&quot;&gt;&lt;a href=&quot;#cb4-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;#00f&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-16&quot;&gt;&lt;a href=&quot;#cb4-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-17&quot;&gt;&lt;a href=&quot;#cb4-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-18&quot;&gt;&lt;a href=&quot;#cb4-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figcaption&gt;
simple.json
&lt;/figcaption&gt;
&lt;p&gt;The conversion is easy:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; dasel &lt;span class=&quot;at&quot;&gt;-r&lt;/span&gt; json &lt;span class=&quot;at&quot;&gt;-w&lt;/span&gt; csv &lt;span class=&quot;op&quot;&gt;&amp;lt;&lt;/span&gt; sample.json &lt;/span&gt;
&lt;span id=&quot;cb5-2&quot;&gt;&lt;a href=&quot;#cb5-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;color,id,value&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-3&quot;&gt;&lt;a href=&quot;#cb5-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;red&lt;/span&gt;,1,#f00&lt;/span&gt;
&lt;span id=&quot;cb5-4&quot;&gt;&lt;a href=&quot;#cb5-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;green,2,#0f0&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-5&quot;&gt;&lt;a href=&quot;#cb5-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;blue,3,#00f&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figcaption&gt;
converting with &lt;code&gt;dasel&lt;/code&gt;
&lt;/figcaption&gt;
&lt;p&gt;&lt;code&gt;dasel&lt;/code&gt; handles newlines and values containing commas as well.&lt;/p&gt;
&lt;h2 id=&quot;convert-json-to-csv-via-the-command-line-using-jq&quot;&gt;Convert JSON to CSV via the Command Line using JQ&lt;/h2&gt;
&lt;p&gt;If you don’t want to install &lt;code&gt;dasel&lt;/code&gt; or if you just love &lt;code&gt;jq&lt;/code&gt; (&lt;code&gt;brew install jq&lt;/code&gt;) then this solution may work well for you. Before I discovered &lt;code&gt;dasel&lt;/code&gt; this was the main approach I used:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; cat simple.json&lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;#39;(map(keys) | add | unique) as $cols | map(. as $row | $cols | map($row[.])) as $rows | $cols, $rows[] | @csv&amp;#39;&lt;/span&gt; &lt;/span&gt;
&lt;span id=&quot;cb6-2&quot;&gt;&lt;a href=&quot;#cb6-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-3&quot;&gt;&lt;a href=&quot;#cb6-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,1,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#f00&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-4&quot;&gt;&lt;a href=&quot;#cb6-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,2,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#0f0&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-5&quot;&gt;&lt;a href=&quot;#cb6-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,3,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#00f&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figcaption&gt;
Convert any JSON to CSV with JQ
&lt;/figcaption&gt;
&lt;p&gt;A full explanation for how this works is beyond the scope of this article, but the idea is to use &lt;code&gt;(map(keys) | add | unique)&lt;/code&gt; to get the column names and then gather the values for those columns into &lt;code&gt;$row&lt;/code&gt; and use the &lt;code&gt;@csv&lt;/code&gt; filter to convert the array of rows in a CSV format.&lt;/p&gt;
&lt;h2 id=&quot;convert-json-to-csv-via-the-command-line-and-choose-ordering-column&quot;&gt;Convert JSON to CSV via the Command Line and Choose Ordering Column&lt;/h2&gt;
&lt;p&gt;The downside to the previous two approaches is that you can’t specify which columns to exclude nor their order. Both &lt;code&gt;jq&lt;/code&gt; and &lt;code&gt;dazel&lt;/code&gt; support a query language for customizing the output, but if you don’t want to dive into CSS selectors, the &lt;code&gt;jsonv&lt;/code&gt; tool is a great alternative.&lt;/p&gt;
&lt;p&gt;To convert, we will use &lt;code&gt;jsonv&lt;/code&gt; and pipe it our JSON file. Then, we will specify the columns to include, and we redirect its output to a file.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb7&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb7-1&quot;&gt;&lt;a href=&quot;#cb7-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;cat&lt;/span&gt; simple.json &lt;span class=&quot;kw&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;jsonv&lt;/span&gt; id,color,value &lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; simple.csv&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This gives us a simple CSV file:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb8&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb8-1&quot;&gt;&lt;a href=&quot;#cb8-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; cat simple.csv&lt;/span&gt;
&lt;span id=&quot;cb8-2&quot;&gt;&lt;a href=&quot;#cb8-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#f00&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-3&quot;&gt;&lt;a href=&quot;#cb8-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;2,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#0f0&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-4&quot;&gt;&lt;a href=&quot;#cb8-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;3,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#00f&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-5&quot;&gt;&lt;a href=&quot;#cb8-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;4,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;cyan&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#0ff&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-6&quot;&gt;&lt;a href=&quot;#cb8-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;5,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;magenta&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#f0f&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-7&quot;&gt;&lt;a href=&quot;#cb8-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;6,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;yellow&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#ff0&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-8&quot;&gt;&lt;a href=&quot;#cb8-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;7,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;black&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#000&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;jsonv&lt;/code&gt; handles more complex examples as well. Under the hood, it uses &lt;code&gt;gnuawk&lt;/code&gt; (&lt;code&gt;gawk&lt;/code&gt;). You can install it using curl:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl -Ls https://raw.github.com/archan937/jsonv.sh/master/install.sh | bash&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can install &lt;code&gt;gawk&lt;/code&gt; using brew (&lt;code&gt;brew install gawk&lt;/code&gt;) or your package manager of choice.&lt;/p&gt;
&lt;h2 id=&quot;convert-csv-to-json-at-the-command-line&quot;&gt;Convert CSV to JSON at The Command Line&lt;/h2&gt;
&lt;p&gt;For converting CSV to JSON, we can use &lt;code&gt;dasel&lt;/code&gt; again. The read (&lt;code&gt;-r&lt;/code&gt;) and write (&lt;code&gt;-w&lt;/code&gt;) options mean that it’s easy to convert from any of its supported file formats (JSON, YAML, TOML, XML, and CSV).&lt;/p&gt;
&lt;p&gt;We can get our original JSON document back from CSV like this:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; cat sample.csv&lt;/span&gt;
&lt;span id=&quot;cb10-2&quot;&gt;&lt;a href=&quot;#cb10-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;ID,&lt;/span&gt; color, value&lt;/span&gt;
&lt;span id=&quot;cb10-3&quot;&gt;&lt;a href=&quot;#cb10-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;1,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#f00&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-4&quot;&gt;&lt;a href=&quot;#cb10-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;2,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#0f0&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-5&quot;&gt;&lt;a href=&quot;#cb10-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;3,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#00f&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;er&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;dasel&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;csv&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;-w&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;json&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;er&quot;&gt;sample.csv&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-2&quot;&gt;&lt;a href=&quot;#cb11-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-3&quot;&gt;&lt;a href=&quot;#cb11-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;ID&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-4&quot;&gt;&lt;a href=&quot;#cb11-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-5&quot;&gt;&lt;a href=&quot;#cb11-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;#f00&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-6&quot;&gt;&lt;a href=&quot;#cb11-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-7&quot;&gt;&lt;a href=&quot;#cb11-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-8&quot;&gt;&lt;a href=&quot;#cb11-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;ID&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-9&quot;&gt;&lt;a href=&quot;#cb11-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-10&quot;&gt;&lt;a href=&quot;#cb11-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;#0f0&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-11&quot;&gt;&lt;a href=&quot;#cb11-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-12&quot;&gt;&lt;a href=&quot;#cb11-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-13&quot;&gt;&lt;a href=&quot;#cb11-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;ID&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;3&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-14&quot;&gt;&lt;a href=&quot;#cb11-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-15&quot;&gt;&lt;a href=&quot;#cb11-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;#00f&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-16&quot;&gt;&lt;a href=&quot;#cb11-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;convert-csv-to-json-command-line-with-csvtojson&quot;&gt;Convert CSV to JSON Command Line with &lt;code&gt;csvtojson&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;Another option is to grab the npm tool &lt;code&gt;csvtojson&lt;/code&gt; (&lt;code&gt;npm i --save csvtojson&lt;/code&gt;). If you don’t already have npm and Node.js installed then installing &lt;code&gt;dasel&lt;/code&gt; is a simple solution. Once installed, you can convert to CSV by sending input to &lt;code&gt;csvtojson&lt;/code&gt; over standard in:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb12&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb12-1&quot;&gt;&lt;a href=&quot;#cb12-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;csvtojson&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;lt;&lt;/span&gt; sample.csv&lt;/span&gt;
&lt;span id=&quot;cb12-2&quot;&gt;&lt;a href=&quot;#cb12-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-3&quot;&gt;&lt;a href=&quot;#cb12-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;ID&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#f00&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;}&lt;/span&gt;,&lt;/span&gt;
&lt;span id=&quot;cb12-4&quot;&gt;&lt;a href=&quot;#cb12-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;ID&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#0f0&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;}&lt;/span&gt;,&lt;/span&gt;
&lt;span id=&quot;cb12-5&quot;&gt;&lt;a href=&quot;#cb12-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;ID&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;3&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;#00f&amp;quot;&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb12-6&quot;&gt;&lt;a href=&quot;#cb12-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;You now have the knowledge and the tools you need to convert JSON to CSV and CSV to JSON. &lt;a href=&quot;https://stedolan.github.io/jq/&quot;&gt;&lt;code&gt;jq&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://github.com/TomWright/dasel&quot;&gt;&lt;code&gt;dasel&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://www.npmjs.com/package/csvtojson&quot;&gt;&lt;code&gt;csvtojson&lt;/code&gt;&lt;/a&gt; and &lt;a href=&quot;https://github.com/archan937/jsonv.sh&quot;&gt;&lt;code&gt;jsonv&lt;/code&gt;&lt;/a&gt; are handy command line tools that can be used on Linux, MacOS and Windows under WSL 2.&lt;/p&gt;
&lt;div class=&quot;notice--info notice--big&quot;&gt;
&lt;p&gt;
&lt;strong&gt;While you’re here:&lt;/strong&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today.
&lt;/p&gt;
&lt;/div&gt;</content><author><name>Adam Gordon Bell</name></author><category term="Tutorials" /><summary type="html">How do you convert JSON values to CSV and back at the command line? I’ve done this task on many occasions and been stung by the edge cases frequently enough that it’s time for me to share my favorite tools for this conversion process. But first, some background. Background: You Probably Want a CSV Conversion Tool The CSV format seems simple at first glance: You have a fixed number of fields per row and each field is separated by a comma. 1997,Ford,E350\n However, if you need to use commas in the value, then the fields must be delimited with &quot;: 1997,Ford,E350,&amp;quot;Super, luxurious truck&amp;quot;\n You can use this same trick to delimit a line break, and use double double-quotes if you need to include &quot; in your values or headings. 1997,Ford,E350,&amp;quot;Go get one &amp;quot;&amp;quot;now&amp;quot;&amp;quot;\n they are going fast&amp;quot;\n Things get more complex from there, and even the CSV standard does not specify how to handle all the edge cases and some formatting options are non-compatible. Wikipedia puts it this way: The CSV file format is not fully standardized. Separating fields with commas is the foundation, but commas in the data or embedded line breaks have to be handled specially. Some implementations disallow such content while others surround the field with quotation marks, which yet again creates the need for escaping these if they are present in the data. So although it seems like CSV conversion can be done by hand in python, or your language of choice, using an existing tool that is known to handle the edges cases well it the way to go. With that in mind, let’s review some tools for converting from JSON to CSV at the command line. Convert JSON to CSV via the Command Line The simplest way to do this JSON to CSV conversion is with dasel. dasel is a tool for DAta SELection. Think of it as a jq that supports selection on formats besides just JSON. It’s easy to install (brew install dasel), and it works great as a format converter. [ { &amp;quot;id&amp;quot; : 1, &amp;quot;color&amp;quot;: &amp;quot;red&amp;quot;, &amp;quot;value&amp;quot;: &amp;quot;#f00&amp;quot; }, { &amp;quot;id&amp;quot; : 2, &amp;quot;color&amp;quot;: &amp;quot;green&amp;quot;, &amp;quot;value&amp;quot;: &amp;quot;#0f0&amp;quot; }, { &amp;quot;id&amp;quot; : 3, &amp;quot;color&amp;quot;: &amp;quot;blue&amp;quot;, &amp;quot;value&amp;quot;: &amp;quot;#00f&amp;quot; } ] simple.json The conversion is easy: $ dasel -r json -w csv &amp;lt; sample.json color,id,value red,1,#f00 green,2,#0f0 blue,3,#00f converting with dasel dasel handles newlines and values containing commas as well. Convert JSON to CSV via the Command Line using JQ If you don’t want to install dasel or if you just love jq (brew install jq) then this solution may work well for you. Before I discovered dasel this was the main approach I used: $ cat simple.json| jq -r &amp;#39;(map(keys) | add | unique) as $cols | map(. as $row | $cols | map($row[.])) as $rows | $cols, $rows[] | @csv&amp;#39; &amp;quot;color&amp;quot;,&amp;quot;id&amp;quot;,&amp;quot;value&amp;quot; &amp;quot;red&amp;quot;,1,&amp;quot;#f00&amp;quot; &amp;quot;green&amp;quot;,2,&amp;quot;#0f0&amp;quot; &amp;quot;blue&amp;quot;,3,&amp;quot;#00f&amp;quot; Convert any JSON to CSV with JQ A full explanation for how this works is beyond the scope of this article, but the idea is to use (map(keys) | add | unique) to get the column names and then gather the values for those columns into $row and use the @csv filter to convert the array of rows in a CSV format. Convert JSON to CSV via the Command Line and Choose Ordering Column The downside to the previous two approaches is that you can’t specify which columns to exclude nor their order. Both jq and dazel support a query language for customizing the output, but if you don’t want to dive into CSS selectors, the jsonv tool is a great alternative. To convert, we will use jsonv and pipe it our JSON file. Then, we will specify the columns to include, and we redirect its output to a file. cat simple.json | jsonv id,color,value &amp;gt; simple.csv This gives us a simple CSV file: $ cat simple.csv 1,&amp;quot;red&amp;quot;,&amp;quot;#f00&amp;quot; 2,&amp;quot;green&amp;quot;,&amp;quot;#0f0&amp;quot; 3,&amp;quot;blue&amp;quot;,&amp;quot;#00f&amp;quot; 4,&amp;quot;cyan&amp;quot;,&amp;quot;#0ff&amp;quot; 5,&amp;quot;magenta&amp;quot;,&amp;quot;#f0f&amp;quot; 6,&amp;quot;yellow&amp;quot;,&amp;quot;#ff0&amp;quot; 7,&amp;quot;black&amp;quot;,&amp;quot;#000&amp;quot; jsonv handles more complex examples as well. Under the hood, it uses gnuawk (gawk). You can install it using curl: curl -Ls https://raw.github.com/archan937/jsonv.sh/master/install.sh | bash You can install gawk using brew (brew install gawk) or your package manager of choice. Convert CSV to JSON at The Command Line For converting CSV to JSON, we can use dasel again. The read (-r) and write (-w) options mean that it’s easy to convert from any of its supported file formats (JSON, YAML, TOML, XML, and CSV). We can get our original JSON document back from CSV like this: $ cat sample.csv ID, color, value 1,&amp;quot;red&amp;quot;,&amp;quot;#f00&amp;quot; 2,&amp;quot;green&amp;quot;,&amp;quot;#0f0&amp;quot; 3,&amp;quot;blue&amp;quot;,&amp;quot;#00f&amp;quot; $ dasel -r csv -w json &amp;lt; sample.csv { &amp;quot;ID&amp;quot;: &amp;quot;1&amp;quot;, &amp;quot;color&amp;quot;: &amp;quot;red&amp;quot;, &amp;quot;value&amp;quot;: &amp;quot;#f00&amp;quot; } { &amp;quot;ID&amp;quot;: &amp;quot;2&amp;quot;, &amp;quot;color&amp;quot;: &amp;quot;green&amp;quot;, &amp;quot;value&amp;quot;: &amp;quot;#0f0&amp;quot; } { &amp;quot;ID&amp;quot;: &amp;quot;3&amp;quot;, &amp;quot;color&amp;quot;: &amp;quot;blue&amp;quot;, &amp;quot;value&amp;quot;: &amp;quot;#00f&amp;quot; } Convert CSV to JSON Command Line with csvtojson Another option is to grab the npm tool csvtojson (npm i --save csvtojson). If you don’t already have npm and Node.js installed then installing dasel is a simple solution. Once installed, you can convert to CSV by sending input to csvtojson over standard in: csvtojson &amp;lt; sample.csv [ {&amp;quot;ID&amp;quot;:&amp;quot;1&amp;quot;,&amp;quot;color&amp;quot;:&amp;quot;red&amp;quot;,&amp;quot;value&amp;quot;:&amp;quot;#f00&amp;quot;}, {&amp;quot;ID&amp;quot;:&amp;quot;2&amp;quot;,&amp;quot;color&amp;quot;:&amp;quot;green&amp;quot;,&amp;quot;value&amp;quot;:&amp;quot;#0f0&amp;quot;}, {&amp;quot;ID&amp;quot;:&amp;quot;3&amp;quot;,&amp;quot;color&amp;quot;:&amp;quot;blue&amp;quot;,&amp;quot;value&amp;quot;:&amp;quot;#00f&amp;quot;} ] Conclusion You now have the knowledge and the tools you need to convert JSON to CSV and CSV to JSON. jq, dasel, csvtojson and jsonv are handy command line tools that can be used on Linux, MacOS and Windows under WSL 2. While you’re here: Earthly is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today.</summary></entry><entry><title type="html">Idiots And Maniacs</title><link href="https://earthly.dev/blog/idiots-and-maniacs/" rel="alternate" type="text/html" title="Idiots And Maniacs" /><published>2021-07-30T00:00:00-04:00</published><updated>2021-07-30T00:00:00-04:00</updated><id>https://earthly.dev/blog/idiots-and-maniacs</id><content type="html" xml:base="https://earthly.dev/blog/idiots-and-maniacs/">&lt;h2 id=&quot;observability&quot;&gt;Observability&lt;/h2&gt;
&lt;p&gt;If you do software-as-a-service development and you have paying customers, you at some point learn about the need for operational monitoring and observability. Personally, I went through a process something like this:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Service has some basic &lt;a href=&quot;/blog/understanding-docker-logging-and-log-files&quot;&gt;logging&lt;/a&gt; and an uptime alert.&lt;/li&gt;
&lt;li&gt;Service has a health-check endpoint, is deployed in triplicate behind a load balancer.&lt;/li&gt;
&lt;li&gt;Logs are real-time shipped to Splunk / ELK Stack.&lt;/li&gt;
&lt;li&gt;Metrics set up in Datadog / Prometheus with paging.&lt;/li&gt;
&lt;li&gt;Distributed Tracing set up for debugging across services.&lt;/li&gt;
&lt;li&gt;And so on.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Each step requires more work to set up and has some additional benefits. I moved through each step by necessity as my service handled more requests and became more important to customers.&lt;/p&gt;
&lt;p&gt;If you had shown step-1-me what a simple REST service looks like in step 5, I would have been shocked. The metrics counters and distributed tracing spans, and various operational concerns make the service more complex. I would have thought that whoever wrote the service was obsessed with operational issues, to the detriment of solving the problems at hand. I would have thought the service author was an observability maniac.&lt;/p&gt;
&lt;p&gt;On the other hand, if step-5-me were to get paged because a service written by step-1-me was down, he would not be happy. He would have a hard time figuring out what was wrong, and he’d be pretty sure the service author was an idiot who had never been paged in the middle of the night.&lt;/p&gt;
&lt;p&gt;It reminds me a lot of driving when it first snows here in Peterborough.&lt;/p&gt;
&lt;h2 id=&quot;driving&quot;&gt;Driving&lt;/h2&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/idiots-and-maniacs/9580-800-b155e3159.webp 800w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/idiots-and-maniacs/9580-800-0cb86c200.png 800w&quot; type=&quot;image/png&quot;&gt;&lt;img width=&quot;1200px&quot; src=&quot;/blog/generated/assets/images/idiots-and-maniacs/9580-800-0cb86c200.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;p&gt;In the winter, in Peterborough, we get snow. It’s just a fact of life, and people learn how to drive in snowy conditions. But on the first substantial snowfall of the year, people struggle to remember how to drive.&lt;/p&gt;
&lt;p&gt;Some will drive way below the speed limit and slow down traffic for everyone. They are idiots in the snow. Others get frustrated by the slow drivers and go too fast for the road conditions. Don’t they know there is snow on the road?&lt;/p&gt;
&lt;p&gt;Everyone driving slower than me is an idiot, but everyone going faster than me is a maniac.&lt;/p&gt;
&lt;p&gt;So it is with software development. Everyone who takes an idea further than I have is a maniac, and people who haven’t taken it as far as me are idiots.&lt;/p&gt;
&lt;h2 id=&quot;testing&quot;&gt;Testing&lt;/h2&gt;
&lt;p&gt;There was a time when I thought all code should have 80% unit test code coverage as a minimum. Anything less was practically unethical, and if you didn’t think so, then you hadn’t read Clean Code™️ enough times.&lt;/p&gt;
&lt;div class=&quot;align-right&quot;&gt;
&lt;p&gt;&lt;picture&gt;&lt;source srcset=&quot;/blog/generated/assets/images/idiots-and-maniacs/9770-400-5e5247841.webp 400w&quot; type=&quot;image/webp&quot;&gt;&lt;source srcset=&quot;/blog/generated/assets/images/idiots-and-maniacs/9770-400-1cc7b22be.png 400w&quot; type=&quot;image/png&quot;&gt;&lt;img width=&quot;300px&quot; src=&quot;/blog/generated/assets/images/idiots-and-maniacs/9770-400-1cc7b22be.png&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;On the other hand, Richard Hipp – who tests to 100% code coverage at the machine code level, covering every branch by running billions of tests each release&lt;a href=&quot;#fn1&quot; class=&quot;footnote-ref&quot; id=&quot;fnref1&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; – is a testing maniac.&lt;/p&gt;
&lt;p&gt;I hope you see where I’m going. This idiot to maniac gradient feels right, but it makes no sense&lt;a href=&quot;#fn2&quot; class=&quot;footnote-ref&quot; id=&quot;fnref2&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;. How can I be the only the person driving the right speed? Wherever you find yourself along the spectrum is more a reflection of the context in which you work than anything else.&lt;/p&gt;
&lt;h2 id=&quot;more-examples&quot;&gt;More Examples&lt;/h2&gt;
&lt;p&gt;Here are some made-up and exaggerated examples:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Typescript Developer:&lt;/strong&gt; JavaScript developers are &lt;strong&gt;idiots&lt;/strong&gt;. Don’t they know how many bugs the type system could have caught for them.&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Typescript Developer:&lt;/strong&gt; Elm developers are obsessed with types. They are &lt;strong&gt;maniacs&lt;/strong&gt; about using types to catch things at compile time.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Go Developer:&lt;/strong&gt; The JVM is such a heavyweight runtime and uses so much memory.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Go Developer:&lt;/strong&gt; Rust is so complex! Who wants to manage memory manually. Use a GC, you &lt;strong&gt;maniacs&lt;/strong&gt;!&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kotlin Developer:&lt;/strong&gt; Java is so verbose and ugly. Welcome to 2021. Kotlin has a lot of sugar and type improvements that make writing correct code simpler.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kotlin Developer:&lt;/strong&gt; Scala is for &lt;strong&gt;maniacs&lt;/strong&gt;. There is so much syntactic sugar and type stuff that it’s not worth learning about.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I’m not trying to pick on any of these languages - Typescript, Go, and Kotlin are exceptionally well suited to their niche. But contexts vary&lt;a href=&quot;#fn3&quot; class=&quot;footnote-ref&quot; id=&quot;fnref3&quot; role=&quot;doc-noteref&quot;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt;, and it takes mental effort to see that people making other trade-offs sometimes have good reasons for it.&lt;/p&gt;
&lt;p&gt;That doesn’t mean that other people are never wrong, though. People choose the wrong tool for the job all the time. For example, if I were doing SQLite’s level of testing for a low-reliability, low-traffic, state-less web service when a couple of integration tests would do, then that’d be a mistake, but you’d have to know the context to make that call.&lt;/p&gt;
&lt;div class=&quot;notice--info notice--big&quot;&gt;
&lt;p&gt;
&lt;strong&gt;While you’re here:&lt;/strong&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today.
&lt;/p&gt;
&lt;/div&gt;
&lt;section class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&quot;fn1&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;Richard is the creator of SQLite. See my &lt;a href=&quot;https://corecursive.com/066-sqlite-with-richard-hipp/#billions-of-tests&quot;&gt;interview&lt;/a&gt; with him for a discussion of his testing approach.&lt;a href=&quot;#fnref1&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn2&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;&lt;strong&gt;Article Update:&lt;/strong&gt; Apparently I’ve unintentionally stolen this idiot to maniac spectrum idea from &lt;a href=&quot;https://www.youtube.com/watch?v=XWPCE2tTLZQ&quot;&gt;George Carlin&lt;/a&gt;. Thanks to tjones21xx on Reddit for pointing this out. All credit for this idea goes to Carlin.&lt;a href=&quot;#fnref2&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn3&quot; role=&quot;doc-endnote&quot;&gt;&lt;p&gt;Personal and team familiarity can also be part of the context. PHP may not seem to be the best choice for building a command-line tool, but if it’s a small tool used by a team of PHP developers, then it might be the best choice.&lt;a href=&quot;#fnref3&quot; class=&quot;footnote-back&quot; role=&quot;doc-backlink&quot;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;</content><author><name>Adam Gordon Bell</name></author><category term="Articles" /><summary type="html">Observability If you do software-as-a-service development and you have paying customers, you at some point learn about the need for operational monitoring and observability. Personally, I went through a process something like this: Service has some basic logging and an uptime alert. Service has a health-check endpoint, is deployed in triplicate behind a load balancer. Logs are real-time shipped to Splunk / ELK Stack. Metrics set up in Datadog / Prometheus with paging. Distributed Tracing set up for debugging across services. And so on. Each step requires more work to set up and has some additional benefits. I moved through each step by necessity as my service handled more requests and became more important to customers. If you had shown step-1-me what a simple REST service looks like in step 5, I would have been shocked. The metrics counters and distributed tracing spans, and various operational concerns make the service more complex. I would have thought that whoever wrote the service was obsessed with operational issues, to the detriment of solving the problems at hand. I would have thought the service author was an observability maniac. On the other hand, if step-5-me were to get paged because a service written by step-1-me was down, he would not be happy. He would have a hard time figuring out what was wrong, and he’d be pretty sure the service author was an idiot who had never been paged in the middle of the night. It reminds me a lot of driving when it first snows here in Peterborough. Driving In the winter, in Peterborough, we get snow. It’s just a fact of life, and people learn how to drive in snowy conditions. But on the first substantial snowfall of the year, people struggle to remember how to drive. Some will drive way below the speed limit and slow down traffic for everyone. They are idiots in the snow. Others get frustrated by the slow drivers and go too fast for the road conditions. Don’t they know there is snow on the road? Everyone driving slower than me is an idiot, but everyone going faster than me is a maniac. So it is with software development. Everyone who takes an idea further than I have is a maniac, and people who haven’t taken it as far as me are idiots. Testing There was a time when I thought all code should have 80% unit test code coverage as a minimum. Anything less was practically unethical, and if you didn’t think so, then you hadn’t read Clean Code™️ enough times. On the other hand, Richard Hipp – who tests to 100% code coverage at the machine code level, covering every branch by running billions of tests each release1 – is a testing maniac. I hope you see where I’m going. This idiot to maniac gradient feels right, but it makes no sense2. How can I be the only the person driving the right speed? Wherever you find yourself along the spectrum is more a reflection of the context in which you work than anything else. More Examples Here are some made-up and exaggerated examples: Typescript Developer: JavaScript developers are idiots. Don’t they know how many bugs the type system could have caught for them. Typescript Developer: Elm developers are obsessed with types. They are maniacs about using types to catch things at compile time. Go Developer: The JVM is such a heavyweight runtime and uses so much memory. Go Developer: Rust is so complex! Who wants to manage memory manually. Use a GC, you maniacs! Kotlin Developer: Java is so verbose and ugly. Welcome to 2021. Kotlin has a lot of sugar and type improvements that make writing correct code simpler. Kotlin Developer: Scala is for maniacs. There is so much syntactic sugar and type stuff that it’s not worth learning about. I’m not trying to pick on any of these languages - Typescript, Go, and Kotlin are exceptionally well suited to their niche. But contexts vary3, and it takes mental effort to see that people making other trade-offs sometimes have good reasons for it. That doesn’t mean that other people are never wrong, though. People choose the wrong tool for the job all the time. For example, if I were doing SQLite’s level of testing for a low-reliability, low-traffic, state-less web service when a couple of integration tests would do, then that’d be a mistake, but you’d have to know the context to make that call. While you’re here: Earthly is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today. Richard is the creator of SQLite. See my interview with him for a discussion of his testing approach.↩︎ Article Update: Apparently I’ve unintentionally stolen this idiot to maniac spectrum idea from George Carlin. Thanks to tjones21xx on Reddit for pointing this out. All credit for this idea goes to Carlin.↩︎ Personal and team familiarity can also be part of the context. PHP may not seem to be the best choice for building a command-line tool, but if it’s a small tool used by a team of PHP developers, then it might be the best choice.↩︎</summary></entry><entry><title type="html">Building in Visual Studio Code with a Makefile</title><link href="https://earthly.dev/blog/vscode-make/" rel="alternate" type="text/html" title="Building in Visual Studio Code with a Makefile" /><published>2021-07-28T00:00:00-04:00</published><updated>2021-07-28T00:00:00-04:00</updated><id>https://earthly.dev/blog/vscode-make</id><content type="html" xml:base="https://earthly.dev/blog/vscode-make/">&lt;p&gt;Microsoft announced &lt;a href=&quot;https://devblogs.microsoft.com/cppblog/now-announcing-makefile-support-in-visual-studio-code/&quot;&gt;recently&lt;/a&gt; a new Visual Studio Code extension to handle Makefiles. This extension provides a set of commands to the editor that will facilitate working with projects that rely on a Makefile to speed up the build.&lt;/p&gt;
&lt;p&gt;In this tutorial, you’ll set up a simple C++ project that depends on a well-known Python library to produce some sample charts. This is not a deep tutorial about &lt;a href=&quot;/blog/g++-makefile/&quot;&gt;make and Makefiles&lt;/a&gt;, but to get the most out of the extension you will need to have some concepts clear.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Make&lt;/em&gt; is one of the most used tools to build software projects, for good reason:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;You can get an implementation for almost any major operating system (POSIX/Windows/MacOS)&lt;/li&gt;
&lt;li&gt;It’s technology agnostic. You can use it to build projects on any programming language (here’s an example for &lt;a href=&quot;https://medium.com/lithictech/makefile-javascript-26731fb26867&quot;&gt;JavaScript&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Its task runner capabilities provide a multipurpose tool for almost any task.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A &lt;em&gt;Makefile&lt;/em&gt; is a simple text file that defines rules to be executed. The usual purpose for Makefile in C++ projects is to recompile and link necessary files based on the modifications done to dependencies. However, Makefile and make are far more useful than that. The rules defined in a Makefile combine concepts like:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Shell scripting&lt;/li&gt;
&lt;li&gt;Regular expressions&lt;/li&gt;
&lt;li&gt;Target notation&lt;/li&gt;
&lt;li&gt;Project structure&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To illustrate this power, the &lt;a href=&quot;https://github.com/nickmancol/vscode_makefile&quot;&gt;sample project&lt;/a&gt; contains a single C++ source code file. The source code for the example is pretty simple —- it flips a coin as many times as the &lt;code&gt;iters&lt;/code&gt; argument is passed, and then prints the number of heads and tails counted from each flip.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode cpp&quot;&gt;&lt;code class=&quot;sourceCode cpp&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;cstdlib&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;assert.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-6&quot;&gt;&lt;a href=&quot;#cb1-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;time.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;pp&quot;&gt;  &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-7&quot;&gt;&lt;a href=&quot;#cb1-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-8&quot;&gt;&lt;a href=&quot;#cb1-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; flip_coins&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; iters&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-9&quot;&gt;&lt;a href=&quot;#cb1-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  srand &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;time&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;NULL&lt;span class=&quot;op&quot;&gt;));&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-10&quot;&gt;&lt;a href=&quot;#cb1-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; heads&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; tails &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-11&quot;&gt;&lt;a href=&quot;#cb1-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-12&quot;&gt;&lt;a href=&quot;#cb1-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; i&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;i &lt;span class=&quot;op&quot;&gt;&amp;lt;&lt;/span&gt; iters&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;i&lt;span class=&quot;op&quot;&gt;++){&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-13&quot;&gt;&lt;a href=&quot;#cb1-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;   &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;rand&lt;span class=&quot;op&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;?&lt;/span&gt; heads&lt;span class=&quot;op&quot;&gt;++&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;:&lt;/span&gt; tails&lt;span class=&quot;op&quot;&gt;++;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-14&quot;&gt;&lt;a href=&quot;#cb1-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-15&quot;&gt;&lt;a href=&quot;#cb1-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  printf&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; Heads, &lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; Tails&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;heads&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; tails&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-16&quot;&gt;&lt;a href=&quot;#cb1-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;  &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; abs&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;tails&lt;span class=&quot;op&quot;&gt;-&lt;/span&gt;heads&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-17&quot;&gt;&lt;a href=&quot;#cb1-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-18&quot;&gt;&lt;a href=&quot;#cb1-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-19&quot;&gt;&lt;a href=&quot;#cb1-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; main&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; argc&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; argv&lt;span class=&quot;op&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-20&quot;&gt;&lt;a href=&quot;#cb1-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;ot&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;argc &lt;span class=&quot;op&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-21&quot;&gt;&lt;a href=&quot;#cb1-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; iters &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; atoi&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;argv&lt;span class=&quot;op&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;]);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-22&quot;&gt;&lt;a href=&quot;#cb1-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; diff &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; flip_coins&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;iters&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-23&quot;&gt;&lt;a href=&quot;#cb1-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;lt;&lt;/span&gt; iters&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-24&quot;&gt;&lt;a href=&quot;#cb1-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;      printf&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;With enough trials Heads should be equal to Tails&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-25&quot;&gt;&lt;a href=&quot;#cb1-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-26&quot;&gt;&lt;a href=&quot;#cb1-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This code will be compiled and linked with a simple Makefile that also will provide a couple of other standard rules for cleaning the compiled code and run a simple test.&lt;/p&gt;
&lt;h2 id=&quot;creating-c-projects-with-vs-code&quot;&gt;Creating C++ Projects with VS Code&lt;/h2&gt;
&lt;p&gt;The &lt;a href=&quot;https://marketplace.visualstudio.com/items?itemName=ms-vscode.makefile-tools&quot;&gt;VS Code extension &lt;strong&gt;Makefile Tools&lt;/strong&gt;&lt;/a&gt; is still in preview but is actively developed. The installation process is similar to any other extension in VS Code:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9360.png&quot; alt=&quot;Makefile VSCode extension&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Makefile VSCode extension&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;After installing the extension, verify the availability of the &lt;code&gt;make&lt;/code&gt; command in the system.&lt;/p&gt;
&lt;p&gt;The most common implementation is &lt;a href=&quot;https://www.gnu.org/software/make/&quot;&gt;GNU Make&lt;/a&gt;, which includes some non-standard extensions. If your installation of &lt;code&gt;make&lt;/code&gt; is not available in the default path, you can configure it in VS Code at &lt;strong&gt;File &amp;gt; Preferences &amp;gt; Settings &amp;gt; Extensions makefile&lt;/strong&gt;.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9380.png&quot; alt=&quot;Make path&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Make path&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;To compile and link the project, you can add a Makefile to the root of the project folder. It will be detected automatically by the extension. If you have a different structure, with a Makefile in another location, you can configure it at &lt;strong&gt;File &amp;gt; Preferences &amp;gt; Settings &amp;gt; Extensions &amp;gt; makefile&lt;/strong&gt;.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9450.png&quot; alt=&quot;Makefile path&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Makefile path&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;This sample Makefile defines five simple rules:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;all&lt;/code&gt;: Cleans the compiled files from the target folder, then compiles and run the test code.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;default&lt;/code&gt;: Delegates to &lt;code&gt;CoinFlipper.cpp&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CoinFlipper.cpp&lt;/code&gt;: Compiles the single source file.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;test&lt;/code&gt;: Delegates to &lt;code&gt;CoinFlipper.cpp&lt;/code&gt;, then runs the output main function passing an argument.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;clean&lt;/code&gt;: Deletes compiled files.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-2&quot;&gt;&lt;a href=&quot;#cb2-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# A simple makefile for compiling a c++ project&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-3&quot;&gt;&lt;a href=&quot;#cb2-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-4&quot;&gt;&lt;a href=&quot;#cb2-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;SRC&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;./src&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-5&quot;&gt;&lt;a href=&quot;#cb2-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;TARGET&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;./target&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-6&quot;&gt;&lt;a href=&quot;#cb2-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;GCC &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; g++&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-7&quot;&gt;&lt;a href=&quot;#cb2-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;CFLAGS &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; -o &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;TARGET&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;/CoinFlipper.out&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-8&quot;&gt;&lt;a href=&quot;#cb2-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;ARGS &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; 101&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-9&quot;&gt;&lt;a href=&quot;#cb2-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;RM &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; rm -rf&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-10&quot;&gt;&lt;a href=&quot;#cb2-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-11&quot;&gt;&lt;a href=&quot;#cb2-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;all:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; clean default test&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-12&quot;&gt;&lt;a href=&quot;#cb2-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-13&quot;&gt;&lt;a href=&quot;#cb2-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;default:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; CoinFlipper.cpp&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-14&quot;&gt;&lt;a href=&quot;#cb2-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-15&quot;&gt;&lt;a href=&quot;#cb2-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;CoinFlipper.cpp:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-16&quot;&gt;&lt;a href=&quot;#cb2-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;GCC&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;CFLAGS&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;SRC&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;/main/CoinFlipper.cpp&lt;/span&gt;
&lt;span id=&quot;cb2-17&quot;&gt;&lt;a href=&quot;#cb2-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-18&quot;&gt;&lt;a href=&quot;#cb2-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;test:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; CoinFlipper.cpp&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-19&quot;&gt;&lt;a href=&quot;#cb2-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;TARGET&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;/CoinFlipper.out &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;ARGS&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-20&quot;&gt;&lt;a href=&quot;#cb2-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-21&quot;&gt;&lt;a href=&quot;#cb2-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;clean:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-22&quot;&gt;&lt;a href=&quot;#cb2-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;    &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;RM&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;TARGET&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;/*.out&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The Makefile Tools Extension provides a new “perspective” to the Visual Studio Code IDE. This contains three different commands and three different project configurations to run the Makefile:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9480.png&quot; alt=&quot;Makefile tools perspective&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Makefile tools perspective&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The &lt;code&gt;Configuration:[Default]&lt;/code&gt; refers to the make command configurations defined in the &lt;code&gt;.vscode/settings.json&lt;/code&gt; file. This configuration is used to pass arguments to the make utility.&lt;/p&gt;
&lt;p&gt;In the following example, two configurations are defined:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Default&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Print make version&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;Print make versions&lt;/code&gt; adds the &lt;code&gt;--version&lt;/code&gt; argument to the make utility every time the project is built using the Makefile extension. This argument is not especially useful but you can explore different arguments to fit your case.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode json&quot;&gt;&lt;code class=&quot;sourceCode json&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;dt&quot;&gt;&amp;quot;makefile.configurations&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;     &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-4&quot;&gt;&lt;a href=&quot;#cb3-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;         &lt;span class=&quot;dt&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Default&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-5&quot;&gt;&lt;a href=&quot;#cb3-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;         &lt;span class=&quot;dt&quot;&gt;&amp;quot;makeArgs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;[]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-6&quot;&gt;&lt;a href=&quot;#cb3-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;     &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-7&quot;&gt;&lt;a href=&quot;#cb3-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;     &lt;span class=&quot;fu&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-8&quot;&gt;&lt;a href=&quot;#cb3-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;         &lt;span class=&quot;dt&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Print make version&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-9&quot;&gt;&lt;a href=&quot;#cb3-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;         &lt;span class=&quot;dt&quot;&gt;&amp;quot;makeArgs&amp;quot;&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;--version&amp;quot;&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-10&quot;&gt;&lt;a href=&quot;#cb3-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;     &lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-11&quot;&gt;&lt;a href=&quot;#cb3-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; &lt;span class=&quot;ot&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-12&quot;&gt;&lt;a href=&quot;#cb3-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The second configuration is the default build target rule for the make utility, which is equivalent to running &lt;code&gt;make [target]&lt;/code&gt; directly. The IDE will let show you a list of target rules defined in the Makefile configured for the project:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9540.png&quot; alt=&quot;config build target&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;config build target&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Finally, the third configuration available in the perspective is the &lt;code&gt;Launch target&lt;/code&gt;. This shows you a list of compiled files that can be run from the perspective using the commands &lt;code&gt;Debug&lt;/code&gt; and &lt;code&gt;Run&lt;/code&gt;. This is useful if you want to debug your source code with GDB or LLDB debuggers.&lt;/p&gt;
&lt;p&gt;In this example, the only file runnable is &lt;code&gt;CoinFlipper.out&lt;/code&gt;, compiled from the source code.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9560.png&quot; alt=&quot;make launch target&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;make launch target&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The commands in the Makefile are self-explanatory:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Build&lt;/code&gt; runs make with the target configured previously.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;all&lt;/code&gt; instead of &lt;code&gt;default&lt;/code&gt; passes no arguments to the make utility.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Debug&lt;/code&gt; and &lt;code&gt;Run in terminal&lt;/code&gt; commands launch the target (&lt;code&gt;CoinFlipper.out&lt;/code&gt; in the example) with/without the debug support.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Once you build the project, the terminal view shows the result of the execution:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Building target &amp;quot;all&amp;quot; with command: &amp;quot;make all&amp;quot;
rm -rf ./target/*.out
g++ -o ./target/CoinFlipper.out ./src/main/CoinFlipper.cpp
./target/CoinFlipper.out 101
50 Heads, 51 Tails
With enough trials Heads should be equal to Tails
Target all built successfully.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As you can see from the previous image, the target was built successfully after cleaning, compiling, and running the compiled program. The extension also provides commands to run other targets easily without changing the configurations in the perspective.&lt;/p&gt;
&lt;p&gt;The following image shows the commands available for the Makefile in the sample project:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9630.png&quot; alt=&quot;The makefile commands palette.&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;The makefile commands palette.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;building-complex-projects&quot;&gt;Building Complex Projects&lt;/h2&gt;
&lt;p&gt;Makefiles are more complex than this. Many projects have several levels of dependencies, configurations, and quirks that make supports easily. For example, the &lt;a href=&quot;https://github.com/FFmpeg/FFmpeg&quot;&gt;FFmpeg&lt;/a&gt; project is a collection of libraries to work with audio, video, and subtitles among other utilities. To build it, you can download the source from GitHub and examine the Makefile:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9680.png&quot; alt=&quot;The makefile for FFmpeg.&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;The makefile for FFmpeg.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The &lt;a href=&quot;https://trac.ffmpeg.org/wiki/CompilationGuide/Generic&quot;&gt;developer documentation&lt;/a&gt; for the project states that before building the source code with the provided Makefile, you need to run the &lt;a href=&quot;/blog/autoconf/&quot;&gt;&lt;code&gt;configure&lt;/code&gt;&lt;/a&gt; script located at the root of the project’s source code. Fortunately, the Makefile Tools Extension provides a setting to define the preconfiguration files required to run before executing the make commands, again in &lt;strong&gt;File &amp;gt; Preferences &amp;gt; Settings&lt;/strong&gt;.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/vscode-make/9730.png&quot; alt=&quot;The makefile preconfiguration.&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;The makefile preconfiguration.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;In the &lt;strong&gt;Commands&lt;/strong&gt; section of the Makefile Tools Extension perspective, you can run the preconfigure command. This will run the configure script, and then you’re ready to experiment with the Makefile through the extension.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Large codebase projects need a build system to keep them under the development team’s control, and Makefiles are one the most ubiquitous and flexible ways to define building these complex software projects.&lt;/p&gt;
&lt;p&gt;With the new &lt;a href=&quot;https://marketplace.visualstudio.com/items?itemName=ms-vscode.makefile-tools&quot;&gt;Makefile Tools Extension&lt;/a&gt;, Visual Studio Code greatly simplifies access for new developers. Though it is still tagged as in preview, this extension has been thoroughly tested by the Microsoft Team, building over seventy open-source projects written in different languages (including C, C++, and Python) successfully.&lt;/p&gt;
&lt;p&gt;If you want to learn about the power of make and Makefile, consider checking out the &lt;a href=&quot;https://makefiletutorial.com/#include-makefiles&quot;&gt;Makefile Tutorial&lt;/a&gt;, and if you want the simplicity of a Makefile with the isolation of containers take a look at &lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt;.&lt;/p&gt;</content><author><name>Nicolas Bohorquez</name></author><category term="Tutorials" /><summary type="html">Microsoft announced recently a new Visual Studio Code extension to handle Makefiles. This extension provides a set of commands to the editor that will facilitate working with projects that rely on a Makefile to speed up the build. In this tutorial, you’ll set up a simple C++ project that depends on a well-known Python library to produce some sample charts. This is not a deep tutorial about make and Makefiles, but to get the most out of the extension you will need to have some concepts clear. Make is one of the most used tools to build software projects, for good reason: You can get an implementation for almost any major operating system (POSIX/Windows/MacOS) It’s technology agnostic. You can use it to build projects on any programming language (here’s an example for JavaScript. Its task runner capabilities provide a multipurpose tool for almost any task. A Makefile is a simple text file that defines rules to be executed. The usual purpose for Makefile in C++ projects is to recompile and link necessary files based on the modifications done to dependencies. However, Makefile and make are far more useful than that. The rules defined in a Makefile combine concepts like: Shell scripting Regular expressions Target notation Project structure To illustrate this power, the sample project contains a single C++ source code file. The source code for the example is pretty simple —- it flips a coin as many times as the iters argument is passed, and then prints the number of heads and tails counted from each flip. #include &amp;lt;cstdio&amp;gt; #include &amp;lt;cstdlib&amp;gt; #include &amp;lt;stdlib.h&amp;gt; #include &amp;lt;assert.h&amp;gt; #include &amp;lt;time.h&amp;gt; int flip_coins(int iters) { srand (time(NULL)); int heads, tails = 0; for(int i=0;i &amp;lt; iters;i++){ (rand() % 10 + 1) &amp;lt;= 5 ? heads++ : tails++; } printf(&amp;quot;%d Heads, %d Tails\n&amp;quot;,heads, tails); return abs(tails-heads); } int main(int argc,char* argv[]) { assert (argc == 2); int iters = atoi(argv[1]); int diff = flip_coins(iters); if(100 &amp;lt; iters) { printf(&amp;quot;With enough trials Heads should be equal to Tails\n&amp;quot;); } } This code will be compiled and linked with a simple Makefile that also will provide a couple of other standard rules for cleaning the compiled code and run a simple test. Creating C++ Projects with VS Code The VS Code extension Makefile Tools is still in preview but is actively developed. The installation process is similar to any other extension in VS Code: Makefile VSCode extension After installing the extension, verify the availability of the make command in the system. The most common implementation is GNU Make, which includes some non-standard extensions. If your installation of make is not available in the default path, you can configure it in VS Code at File &amp;gt; Preferences &amp;gt; Settings &amp;gt; Extensions makefile. Make path To compile and link the project, you can add a Makefile to the root of the project folder. It will be detected automatically by the extension. If you have a different structure, with a Makefile in another location, you can configure it at File &amp;gt; Preferences &amp;gt; Settings &amp;gt; Extensions &amp;gt; makefile. Makefile path This sample Makefile defines five simple rules: all: Cleans the compiled files from the target folder, then compiles and run the test code. default: Delegates to CoinFlipper.cpp. CoinFlipper.cpp: Compiles the single source file. test: Delegates to CoinFlipper.cpp, then runs the output main function passing an argument. clean: Deletes compiled files. # # A simple makefile for compiling a c++ project # SRC=./src TARGET=./target GCC = g++ CFLAGS = -o $(TARGET)/CoinFlipper.out ARGS = 101 RM = rm -rf all: clean default test default: CoinFlipper.cpp CoinFlipper.cpp: $(GCC) $(CFLAGS) $(SRC)/main/CoinFlipper.cpp test: CoinFlipper.cpp $(TARGET)/CoinFlipper.out $(ARGS) clean: $(RM) $(TARGET)/*.out The Makefile Tools Extension provides a new “perspective” to the Visual Studio Code IDE. This contains three different commands and three different project configurations to run the Makefile: Makefile tools perspective The Configuration:[Default] refers to the make command configurations defined in the .vscode/settings.json file. This configuration is used to pass arguments to the make utility. In the following example, two configurations are defined: Default Print make version Print make versions adds the --version argument to the make utility every time the project is built using the Makefile extension. This argument is not especially useful but you can explore different arguments to fit your case. { &amp;quot;makefile.configurations&amp;quot;: [ { &amp;quot;name&amp;quot;: &amp;quot;Default&amp;quot;, &amp;quot;makeArgs&amp;quot;: [] }, { &amp;quot;name&amp;quot;: &amp;quot;Print make version&amp;quot;, &amp;quot;makeArgs&amp;quot;: [&amp;quot;--version&amp;quot;] } ] } The second configuration is the default build target rule for the make utility, which is equivalent to running make [target] directly. The IDE will let show you a list of target rules defined in the Makefile configured for the project: config build target Finally, the third configuration available in the perspective is the Launch target. This shows you a list of compiled files that can be run from the perspective using the commands Debug and Run. This is useful if you want to debug your source code with GDB or LLDB debuggers. In this example, the only file runnable is CoinFlipper.out, compiled from the source code. make launch target The commands in the Makefile are self-explanatory: Build runs make with the target configured previously. all instead of default passes no arguments to the make utility. Debug and Run in terminal commands launch the target (CoinFlipper.out in the example) with/without the debug support. Once you build the project, the terminal view shows the result of the execution: Building target &amp;quot;all&amp;quot; with command: &amp;quot;make all&amp;quot; rm -rf ./target/*.out g++ -o ./target/CoinFlipper.out ./src/main/CoinFlipper.cpp ./target/CoinFlipper.out 101 50 Heads, 51 Tails With enough trials Heads should be equal to Tails Target all built successfully. As you can see from the previous image, the target was built successfully after cleaning, compiling, and running the compiled program. The extension also provides commands to run other targets easily without changing the configurations in the perspective. The following image shows the commands available for the Makefile in the sample project: The makefile commands palette. Building Complex Projects Makefiles are more complex than this. Many projects have several levels of dependencies, configurations, and quirks that make supports easily. For example, the FFmpeg project is a collection of libraries to work with audio, video, and subtitles among other utilities. To build it, you can download the source from GitHub and examine the Makefile: The makefile for FFmpeg. The developer documentation for the project states that before building the source code with the provided Makefile, you need to run the configure script located at the root of the project’s source code. Fortunately, the Makefile Tools Extension provides a setting to define the preconfiguration files required to run before executing the make commands, again in File &amp;gt; Preferences &amp;gt; Settings. The makefile preconfiguration. In the Commands section of the Makefile Tools Extension perspective, you can run the preconfigure command. This will run the configure script, and then you’re ready to experiment with the Makefile through the extension. Conclusion Large codebase projects need a build system to keep them under the development team’s control, and Makefiles are one the most ubiquitous and flexible ways to define building these complex software projects. With the new Makefile Tools Extension, Visual Studio Code greatly simplifies access for new developers. Though it is still tagged as in preview, this extension has been thoroughly tested by the Microsoft Team, building over seventy open-source projects written in different languages (including C, C++, and Python) successfully. If you want to learn about the power of make and Makefile, consider checking out the Makefile Tutorial, and if you want the simplicity of a Makefile with the isolation of containers take a look at Earthly.</summary></entry><entry><title type="html">Using Continuous Testing in DevOps Workflows</title><link href="https://earthly.dev/blog/continuous-testing-in-devops/" rel="alternate" type="text/html" title="Using Continuous Testing in DevOps Workflows" /><published>2021-07-27T00:00:00-04:00</published><updated>2021-07-27T00:00:00-04:00</updated><id>https://earthly.dev/blog/continuous-testing-in-devops</id><content type="html" xml:base="https://earthly.dev/blog/continuous-testing-in-devops/">&lt;p&gt;Automation testing is a crucial element to speed up your delivery process. It aims to flush out any potential regressions. The more you automate, the more confidence you gain in the quality of your software because the quality of each release of your application or library is measurable. Additionally, you reduce costs and save time and effort by reducing manual testing.&lt;/p&gt;
&lt;p&gt;The caveat is that automated tests have no value if they are not executed regularly alongside your continuous integration (CI) pipeline. CI refers to frequently merging developer code changes and building and creating an artifact that can later be tested and deployed.&lt;/p&gt;
&lt;p&gt;Extending the CI process by adding automated tests is referred to as continuous testing (CT). CT enables you to apply the fail-fast principle. You test each code change, build, and deployment against several layers of automated tests. Thus, it results in rapid feedback on the quality of your product and the state of the development process.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/actions&quot;&gt;GitHub Actions&lt;/a&gt; is a great first step for implementing CT. It’s flexible and powerful enough to bring every step of the CI/CT process into a single place. Your application, tests, and workflow configuration lives with your code in your repository. Furthermore, the learning curve for GitHub Actions is relatively smooth thanks to the &lt;a href=&quot;https://github.com/marketplace?type=actions&quot;&gt;Marketplace&lt;/a&gt; that provides thousands of Actions ready to use out of the box.&lt;/p&gt;
&lt;h2 id=&quot;what-does-it-take-to-implement-continuous-testing&quot;&gt;What Does It Take to Implement Continuous Testing?&lt;/h2&gt;
&lt;p&gt;A good CI/CT process always contains at least the following steps:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Build&lt;/li&gt;
&lt;li&gt;Deployment&lt;/li&gt;
&lt;li&gt;Integration tests&lt;/li&gt;
&lt;li&gt;End-to-end tests&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In this tutorial, you will implement these four steps using GitHub Actions, as well as add performance tests.&lt;/p&gt;
&lt;p&gt;The Build steps include code compilation and unit tests. Also, note that it’s convenient to deploy your application in a &lt;code&gt;dev&lt;/code&gt; environment before running complex tests such as integration and end-to-end. However, you may also run your application in GitHub Actions for test purposes.&lt;/p&gt;
&lt;p&gt;In this article, I assume you’ll deploy to a &lt;code&gt;dev&lt;/code&gt; environment and focus on implementing different types of tests. Here is a visual of the final workflow for this tutorial:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/40nOj1F.png&quot; alt=&quot;Final GitHub Action Workflow&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Final GitHub Action Workflow&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Implementing continuous testing can be challenging. If you are on a team that is new to this fail-fast approach, it may be a frustrating transition. In addition, seeing builds or pipelines failing can be overwhelming at the beginning. I suggest prioritizing fixing tests over focusing on new features. This may also be a significant change.&lt;/p&gt;
&lt;p&gt;To remediate those challenges, you should rely on the five DevOps principles described by &lt;a href=&quot;https://twitter.com/jezhumble&quot;&gt;Jez Humble&lt;/a&gt; in &lt;em&gt;The DevOps Handbook&lt;/em&gt;:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Culture&lt;/li&gt;
&lt;li&gt;Automate&lt;/li&gt;
&lt;li&gt;Lean&lt;/li&gt;
&lt;li&gt;Measure&lt;/li&gt;
&lt;li&gt;Sharing&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Implementing continuous testing is first a change in &lt;strong&gt;culture&lt;/strong&gt;. Selecting the right tools for CI/CT can greatly improve collaboration.&lt;/p&gt;
&lt;p&gt;Keep your process &lt;strong&gt;lean&lt;/strong&gt;. Testing should not slow down your process. Instead, select the right amount of tests at the right time in the process. Monitor your &lt;a href=&quot;https://docs.github.com/en/actions/managing-workflow-runs/viewing-job-execution-time&quot;&gt;job execution time&lt;/a&gt;, prefer small tasks that can fail fast, and provide rapid feedback instead of long-running ones.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Automate&lt;/strong&gt; as much and as early as possible because it helps validate that the integration is successful. Delaying test implementation is counterproductive.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Measure&lt;/strong&gt; your improvement and build a baseline for the quality of your software. For example, collect your code coverage, number of successful vs. failed tests, and performance metric.&lt;/p&gt;
&lt;p&gt;Don’t forget to encourage knowledge &lt;strong&gt;sharing&lt;/strong&gt;. Test automation is not a single person’s job: everyone on the team should know how the test suites work and learn how to fix simple errors when the workflows fail.&lt;/p&gt;
&lt;h2 id=&quot;implementing-cict-with-github-actions&quot;&gt;Implementing CI/CT With GitHub Actions&lt;/h2&gt;
&lt;p&gt;Now that you know the basics of CT, it’s time to see how to implement the first step by creating a GitHub Actions workflow that builds and runs your unit tests.&lt;/p&gt;
&lt;h3 id=&quot;build-a-github-actions-workflow-with-unit-tests&quot;&gt;Build a GitHub Actions Workflow with Unit Tests&lt;/h3&gt;
&lt;p&gt;The first thing you need to get started is an initial workflow. If you already committed your application to a GitHub repository, click &lt;strong&gt;Actions&lt;/strong&gt;. GitHub will automatically select and recommend a simple workflow that best suits your language.&lt;/p&gt;
&lt;p&gt;Select one of them by clicking &lt;strong&gt;Set up this workflow&lt;/strong&gt;, review the workflow steps, and commit.&lt;/p&gt;
&lt;p&gt;Right away, you should see your workflow starting to build and test your application. Many starting workflows also include linting that validates the formatting and detects potential errors.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/043P3GAA.png&quot; alt=&quot;Get Started with GitHub Action Workflow&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Get Started with GitHub Action Workflow&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;A GitHub Actions workflow contains three elements:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Triggers&lt;/strong&gt; (&lt;code&gt;on&lt;/code&gt;) specify when the workflow must be executed. The most common use case is to run a workflow on &lt;a href=&quot;https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions#on&quot;&gt;push and pull-request on the &lt;code&gt;main&lt;/code&gt; branch&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Jobs&lt;/strong&gt; determine sets of actions composing your pipeline and are executed in parallel unless dependencies between jobs are specified.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Steps&lt;/strong&gt; are the individual components of a job and can be of two types: &lt;code&gt;Scripts&lt;/code&gt; or &lt;code&gt;Actions&lt;/code&gt;. Steps defining a &lt;code&gt;run&lt;/code&gt; attribute execute a command on the host defined by &lt;code&gt;runs-on&lt;/code&gt; at the beginning of a job. Steps containing &lt;code&gt;uses&lt;/code&gt; execute an &lt;a href=&quot;https://docs.github.com/en/actions/creating-actions&quot;&gt;Action&lt;/a&gt;, a reusable automation script.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It’s straightforward to extend a workflow once you understand those three concepts. Here’s a sample workflow for a Python application:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode yaml&quot;&gt;&lt;code class=&quot;sourceCode yaml&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Python application&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;pull_request&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; main &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-6&quot;&gt;&lt;a href=&quot;#cb1-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-7&quot;&gt;&lt;a href=&quot;#cb1-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-8&quot;&gt;&lt;a href=&quot;#cb1-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-9&quot;&gt;&lt;a href=&quot;#cb1-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-10&quot;&gt;&lt;a href=&quot;#cb1-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ubuntu-latest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-11&quot;&gt;&lt;a href=&quot;#cb1-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-12&quot;&gt;&lt;a href=&quot;#cb1-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-13&quot;&gt;&lt;a href=&quot;#cb1-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/checkout@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-14&quot;&gt;&lt;a href=&quot;#cb1-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Set up Python 3.9&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-15&quot;&gt;&lt;a href=&quot;#cb1-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/setup-python@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-16&quot;&gt;&lt;a href=&quot;#cb1-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-17&quot;&gt;&lt;a href=&quot;#cb1-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;python-version&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fl&quot;&gt;3.9&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-18&quot;&gt;&lt;a href=&quot;#cb1-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Install dependencies&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-19&quot;&gt;&lt;a href=&quot;#cb1-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;      run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;|&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-20&quot;&gt;&lt;a href=&quot;#cb1-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        python -m pip install --upgrade pip&lt;/span&gt;
&lt;span id=&quot;cb1-21&quot;&gt;&lt;a href=&quot;#cb1-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        pip install flake8 pytest&lt;/span&gt;
&lt;span id=&quot;cb1-22&quot;&gt;&lt;a href=&quot;#cb1-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        if [ -f requirements.txt ]; then pip install -r requirements.txt; fi&lt;/span&gt;
&lt;span id=&quot;cb1-23&quot;&gt;&lt;a href=&quot;#cb1-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Lint with flake8&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-24&quot;&gt;&lt;a href=&quot;#cb1-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;      run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;|&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-25&quot;&gt;&lt;a href=&quot;#cb1-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        # stop the build if there are Python syntax errors or undefined names&lt;/span&gt;
&lt;span id=&quot;cb1-26&quot;&gt;&lt;a href=&quot;#cb1-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics&lt;/span&gt;
&lt;span id=&quot;cb1-27&quot;&gt;&lt;a href=&quot;#cb1-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        # exit-zero treats all errors as warnings. The GitHub editor is 127 chars wide&lt;/span&gt;
&lt;span id=&quot;cb1-28&quot;&gt;&lt;a href=&quot;#cb1-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        flake8 . --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics&lt;/span&gt;
&lt;span id=&quot;cb1-29&quot;&gt;&lt;a href=&quot;#cb1-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Test with pytest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-30&quot;&gt;&lt;a href=&quot;#cb1-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;      run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;|&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-31&quot;&gt;&lt;a href=&quot;#cb1-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        pytest&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This what a basic workflow looks like:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/KVnFfF4.png&quot; alt=&quot;Most basic GitHub Actions workflow&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;Most basic GitHub Actions workflow&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;add-code-coverage-reports&quot;&gt;Add Code Coverage Reports&lt;/h3&gt;
&lt;p&gt;On GitHub, most users rely on third parties to get coverage reports (such as &lt;a href=&quot;https://www.sonarqube.org/&quot;&gt;SonarQube&lt;/a&gt; or &lt;a href=&quot;https://about.codecov.io/&quot;&gt;Codecov&lt;/a&gt;). Integrating those SaaS into your workflow is simple, thanks to the GitHub Actions Marketplace. Most third parties providing code coverage reports have created an Action to make the integration seamless.&lt;/p&gt;
&lt;p&gt;But let’s not rely on a third party yet. Instead, generate a badge to display in your &lt;code&gt;Readme.md&lt;/code&gt;. You’re putting in place the first step toward tracking code quality.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Edit your existing &lt;code&gt;Test with xxx&lt;/code&gt; step to generate a coverage report.&lt;/li&gt;
&lt;li&gt;Save the coverage report as an artifact. &lt;a href=&quot;https://docs.github.com/en/actions/guides/storing-workflow-data-as-artifacts&quot;&gt;Storing workflow data as artifacts&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Create a new job called &lt;code&gt;gating&lt;/code&gt; and download the coverage report. This job must be executed after &lt;code&gt;build&lt;/code&gt;; therefore, you must declare &lt;code&gt;needs: build&lt;/code&gt; in your configuration.&lt;/li&gt;
&lt;li&gt;Parse the coverage report to extract the coverage value. I provided a small script that does just that.&lt;/li&gt;
&lt;li&gt;Generate the badge and add it to your README. Follow the setup step in the documentation of &lt;a href=&quot;https://github.com/Schneegans/dynamic-badges-action&quot;&gt;schneegans/dynamic-badges-action@v1.1.0&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode yml&quot;&gt;&lt;code class=&quot;sourceCode yaml&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# This workflow will install Python dependencies, run tests, and lint with a single version of Python&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-2&quot;&gt;&lt;a href=&quot;#cb2-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;# For more information see: https://help.github.com/actions/language-and-framework-guides/using-python-with-github-actions&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-3&quot;&gt;&lt;a href=&quot;#cb2-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-4&quot;&gt;&lt;a href=&quot;#cb2-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Python application&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-5&quot;&gt;&lt;a href=&quot;#cb2-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-6&quot;&gt;&lt;a href=&quot;#cb2-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-7&quot;&gt;&lt;a href=&quot;#cb2-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-8&quot;&gt;&lt;a href=&quot;#cb2-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; main &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-9&quot;&gt;&lt;a href=&quot;#cb2-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;pull_request&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-10&quot;&gt;&lt;a href=&quot;#cb2-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; main &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-11&quot;&gt;&lt;a href=&quot;#cb2-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-12&quot;&gt;&lt;a href=&quot;#cb2-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-13&quot;&gt;&lt;a href=&quot;#cb2-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-14&quot;&gt;&lt;a href=&quot;#cb2-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ubuntu-latest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-15&quot;&gt;&lt;a href=&quot;#cb2-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-16&quot;&gt;&lt;a href=&quot;#cb2-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/checkout@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-17&quot;&gt;&lt;a href=&quot;#cb2-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Set up Python 3.9&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-18&quot;&gt;&lt;a href=&quot;#cb2-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/setup-python@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-19&quot;&gt;&lt;a href=&quot;#cb2-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-20&quot;&gt;&lt;a href=&quot;#cb2-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;python-version&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fl&quot;&gt;3.9&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-21&quot;&gt;&lt;a href=&quot;#cb2-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Install dependencies&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-22&quot;&gt;&lt;a href=&quot;#cb2-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-23&quot;&gt;&lt;a href=&quot;#cb2-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Lint with flake8&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-24&quot;&gt;&lt;a href=&quot;#cb2-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-25&quot;&gt;&lt;a href=&quot;#cb2-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Test with pytest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-26&quot;&gt;&lt;a href=&quot;#cb2-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;      # Update the command to generate coverage report&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-27&quot;&gt;&lt;a href=&quot;#cb2-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; pytest --cov-report xml --cov=phonebook tests/&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-28&quot;&gt;&lt;a href=&quot;#cb2-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Upload pytest test coverage&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-29&quot;&gt;&lt;a href=&quot;#cb2-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;      # Upload the coverage result as an artifact&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-30&quot;&gt;&lt;a href=&quot;#cb2-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/upload-artifact@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-31&quot;&gt;&lt;a href=&quot;#cb2-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-32&quot;&gt;&lt;a href=&quot;#cb2-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; coverage-results&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-33&quot;&gt;&lt;a href=&quot;#cb2-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; coverage.xml&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-34&quot;&gt;&lt;a href=&quot;#cb2-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;      # Use always() to always run this step to publish test results when there are test failures&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-35&quot;&gt;&lt;a href=&quot;#cb2-35&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ${{ always() }}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-36&quot;&gt;&lt;a href=&quot;#cb2-36&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-37&quot;&gt;&lt;a href=&quot;#cb2-37&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;gating&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-38&quot;&gt;&lt;a href=&quot;#cb2-38&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ubuntu-latest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-39&quot;&gt;&lt;a href=&quot;#cb2-39&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; build&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-40&quot;&gt;&lt;a href=&quot;#cb2-40&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-41&quot;&gt;&lt;a href=&quot;#cb2-41&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-42&quot;&gt;&lt;a href=&quot;#cb2-42&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Download coverage report&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-43&quot;&gt;&lt;a href=&quot;#cb2-43&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/download-artifact@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-44&quot;&gt;&lt;a href=&quot;#cb2-44&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-45&quot;&gt;&lt;a href=&quot;#cb2-45&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; coverage-results&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-46&quot;&gt;&lt;a href=&quot;#cb2-46&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Get the Coverage&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-47&quot;&gt;&lt;a href=&quot;#cb2-47&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; bash&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-48&quot;&gt;&lt;a href=&quot;#cb2-48&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;      run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;|&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-49&quot;&gt;&lt;a href=&quot;#cb2-49&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        regex=&amp;#39;&amp;lt;coverage.+line-rate=&amp;quot;([0-9).[0-9]+)&amp;quot;.+&amp;gt;&amp;#39;&lt;/span&gt;
&lt;span id=&quot;cb2-50&quot;&gt;&lt;a href=&quot;#cb2-50&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        line=$(grep -oP $regex coverage.xml)&lt;/span&gt;
&lt;span id=&quot;cb2-51&quot;&gt;&lt;a href=&quot;#cb2-51&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        [[ $line =~ $regex ]]&lt;/span&gt;
&lt;span id=&quot;cb2-52&quot;&gt;&lt;a href=&quot;#cb2-52&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        coverage=$( bc &amp;lt;&amp;lt;&amp;lt; ${BASH_REMATCH[1]}*100 )&lt;/span&gt;
&lt;span id=&quot;cb2-53&quot;&gt;&lt;a href=&quot;#cb2-53&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        if (( $(echo &amp;quot;$coverage &amp;gt; 80&amp;quot; |bc -l) )); then&lt;/span&gt;
&lt;span id=&quot;cb2-54&quot;&gt;&lt;a href=&quot;#cb2-54&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          COLOR=green&lt;/span&gt;
&lt;span id=&quot;cb2-55&quot;&gt;&lt;a href=&quot;#cb2-55&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        else&lt;/span&gt;
&lt;span id=&quot;cb2-56&quot;&gt;&lt;a href=&quot;#cb2-56&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          COLOR=red&lt;/span&gt;
&lt;span id=&quot;cb2-57&quot;&gt;&lt;a href=&quot;#cb2-57&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        fi&lt;/span&gt;
&lt;span id=&quot;cb2-58&quot;&gt;&lt;a href=&quot;#cb2-58&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        echo &amp;quot;COVERAGE=${coverage%.*}%&amp;quot; &amp;gt;&amp;gt; $GITHUB_ENV&lt;/span&gt;
&lt;span id=&quot;cb2-59&quot;&gt;&lt;a href=&quot;#cb2-59&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        echo &amp;quot;COLOR=$COLOR&amp;quot; &amp;gt;&amp;gt; $GITHUB_ENV&lt;/span&gt;
&lt;span id=&quot;cb2-60&quot;&gt;&lt;a href=&quot;#cb2-60&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Create the Badge&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-61&quot;&gt;&lt;a href=&quot;#cb2-61&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;      # save the badge configuration in a Gist&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-62&quot;&gt;&lt;a href=&quot;#cb2-62&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; schneegans/dynamic-badges-action@v1.1.0&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-63&quot;&gt;&lt;a href=&quot;#cb2-63&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-64&quot;&gt;&lt;a href=&quot;#cb2-64&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;auth&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ${{ secrets.GIST_SECRET }}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-65&quot;&gt;&lt;a href=&quot;#cb2-65&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;gistID&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ab3bde9504060bd1feb361555e79f51d&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-66&quot;&gt;&lt;a href=&quot;#cb2-66&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; coverage.json&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-67&quot;&gt;&lt;a href=&quot;#cb2-67&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; coverage&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-68&quot;&gt;&lt;a href=&quot;#cb2-68&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ${{ env.COVERAGE }}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb2-69&quot;&gt;&lt;a href=&quot;#cb2-69&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ${{ env.COLOR }}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is what your updated workflow looks like:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/1626877878.png&quot; alt=&quot;GitHub Action workflow including code coverage badge&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;GitHub Action workflow including code coverage badge&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;And you got a badge to decorate your &lt;code&gt;readme.md&lt;/code&gt;.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/1626878146.png&quot; alt=&quot;GitHub code coverage badge&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;GitHub code coverage badge&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;extending-ct-with-other-types-of-testing&quot;&gt;Extending CT with Other Types of Testing&lt;/h2&gt;
&lt;p&gt;You have a basic CI workflow that includes unit tests and coverage reports. Now to obtain an excellent CT workflow, you need to expand with more layers of tests. You will add three new jobs:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;For API testing,&lt;/li&gt;
&lt;li&gt;For end-to-end testing&lt;/li&gt;
&lt;li&gt;For performance testing&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;add-api-testing&quot;&gt;Add API Testing&lt;/h3&gt;
&lt;p&gt;API testing is part of &lt;a href=&quot;/blog/unit-vs-integration&quot;&gt;integration testing&lt;/a&gt;. Integration testing aims to determine whether individual units meet your requirement when combined together. When performing integration testing, you target the boundary (or interfaces) of your system. In this specific case, you are aiming your test at a RESTful API. Having API tests ensures that sets of functionality meet your requirement and validates that your web server and connection to a database works properly.&lt;/p&gt;
&lt;p&gt;While you could write an API test in the same language as your application, you should also consider a tool like &lt;a href=&quot;https://blog.scottlogic.com/2020/02/04/GraduateGuideToAPITesting.html&quot;&gt;Postman/Newman&lt;/a&gt;. Postman lets you define a sequence of HTTPS calls and validate each of them using their JavaScript test framework. This makes it easy to share integration test suites. Other developers can use them to facilitate their development process, for instance, mobile developers working with a different stack than backend developers. Newman is the command-line interface that lets you run the Postman tests.&lt;/p&gt;
&lt;p&gt;Now that you have selected an API testing framework go to GitHub &lt;a href=&quot;https://github.com/marketplace?type=actions&quot;&gt;Actions Marketplace&lt;/a&gt; and look for an Action that meets your demands. For instance, &lt;a href=&quot;https://github.com/marketplace/actions/newman-action&quot;&gt;Newman Action&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Now edit your workflow configuration:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Add a new job that must be executed after the deployment using &lt;code&gt;needs: deploy&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Define the steps of your job:
&lt;ul&gt;
&lt;li&gt;Check out your repository using the Action &lt;code&gt;actions/checkout@master&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Run Newman using the Action you just found in the Marketplace.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Move the gating job at the end of the workflow by changing the &lt;code&gt;needs&lt;/code&gt; property.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode yaml&quot;&gt;&lt;code class=&quot;sourceCode yaml&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Python application&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-4&quot;&gt;&lt;a href=&quot;#cb3-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-5&quot;&gt;&lt;a href=&quot;#cb3-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; main &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-6&quot;&gt;&lt;a href=&quot;#cb3-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-7&quot;&gt;&lt;a href=&quot;#cb3-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-8&quot;&gt;&lt;a href=&quot;#cb3-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-9&quot;&gt;&lt;a href=&quot;#cb3-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-10&quot;&gt;&lt;a href=&quot;#cb3-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;deploy&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-11&quot;&gt;&lt;a href=&quot;#cb3-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;co&quot;&gt; # our deployment steps&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-12&quot;&gt;&lt;a href=&quot;#cb3-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;tests_api&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-13&quot;&gt;&lt;a href=&quot;#cb3-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; deploy&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-14&quot;&gt;&lt;a href=&quot;#cb3-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ubuntu-latest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-15&quot;&gt;&lt;a href=&quot;#cb3-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-16&quot;&gt;&lt;a href=&quot;#cb3-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/checkout@master&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-17&quot;&gt;&lt;a href=&quot;#cb3-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; matt-ball/newman-action@master&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-18&quot;&gt;&lt;a href=&quot;#cb3-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-19&quot;&gt;&lt;a href=&quot;#cb3-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;collection&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; tests_integration/postman_collection.json&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-20&quot;&gt;&lt;a href=&quot;#cb3-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;environment&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; tests_integration/postman_environment.json&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-21&quot;&gt;&lt;a href=&quot;#cb3-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;gating&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-22&quot;&gt;&lt;a href=&quot;#cb3-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; tests_api&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-23&quot;&gt;&lt;a href=&quot;#cb3-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;co&quot;&gt; # we move the gating at the end of the workflow&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now your workflow should contain four sequential jobs:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/1626878353.png&quot; alt=&quot;GitHub Actions workflow including API tests&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;GitHub Actions workflow including API tests&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;add-end-to-end-testing&quot;&gt;Add End-to-End Testing&lt;/h3&gt;
&lt;p&gt;End-to-end testing (e2e) aims to test complete use cases from the user perspective. Think of e2e as replacing a human with a robot.&lt;/p&gt;
&lt;p&gt;When it comes to selecting an e2e framework, I recommend prioritizing one that supports the Gherkin language. Gherkin promotes writing tests in natural language (aka, plain English). With this approach, more people can understand test cases, including product owners and business analysts. As a result, you foster better collaboration within the team.&lt;/p&gt;
&lt;p&gt;Verbalizing tests also ensure that you are writing them from the user’s perspective and not making the mistake of testing the functions you just coded.&lt;/p&gt;
&lt;p&gt;I selected &lt;a href=&quot;https://robotframework.org/&quot;&gt;Robot Framework&lt;/a&gt; for this example. Robot Framework uses &lt;a href=&quot;https://www.selenium.dev/&quot;&gt;Selenium&lt;/a&gt; to control a web browser and thus replace a human by simulating clicks and text entries.&lt;/p&gt;
&lt;p&gt;Once again, you can go to &lt;a href=&quot;https://github.com/marketplace?type=actions&quot;&gt;GitHub Actions Marketplace&lt;/a&gt; and look for an Action meeting your needs. For instance, &lt;a href=&quot;https://github.com/marketplace/actions/robot-framework&quot;&gt;Robot Framework Docker Action&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Add a new job called &lt;code&gt;test_e2e&lt;/code&gt; to the workflow configuration. This job must be executed after deploy using &lt;code&gt;needs: deploy&lt;/code&gt;. You will notice that since &lt;code&gt;tests_api&lt;/code&gt; and &lt;code&gt;test_e2e&lt;/code&gt; both need &lt;code&gt;deploy&lt;/code&gt;, they will be executed in parallel after the deployment.&lt;/p&gt;
&lt;p&gt;Have a look at the result:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/1626878240.png&quot; alt=&quot;GitHub Actions workflow including end-to-end tests&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;GitHub Actions workflow including end-to-end tests&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Your configuration should look along those lines to achieve this workflow:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode yaml&quot;&gt;&lt;code class=&quot;sourceCode yaml&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Python application&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-4&quot;&gt;&lt;a href=&quot;#cb4-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-5&quot;&gt;&lt;a href=&quot;#cb4-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; main &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-6&quot;&gt;&lt;a href=&quot;#cb4-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-7&quot;&gt;&lt;a href=&quot;#cb4-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-8&quot;&gt;&lt;a href=&quot;#cb4-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-9&quot;&gt;&lt;a href=&quot;#cb4-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;deploy&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-10&quot;&gt;&lt;a href=&quot;#cb4-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;tests_api&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-11&quot;&gt;&lt;a href=&quot;#cb4-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;test_e2e&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-12&quot;&gt;&lt;a href=&quot;#cb4-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ubuntu-latest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-13&quot;&gt;&lt;a href=&quot;#cb4-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; deploy&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-14&quot;&gt;&lt;a href=&quot;#cb4-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Run Robot Framework Tests&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-15&quot;&gt;&lt;a href=&quot;#cb4-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-16&quot;&gt;&lt;a href=&quot;#cb4-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Checkout&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-17&quot;&gt;&lt;a href=&quot;#cb4-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/checkout@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-18&quot;&gt;&lt;a href=&quot;#cb4-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Create folder for reports&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-19&quot;&gt;&lt;a href=&quot;#cb4-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; mkdir reports&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-20&quot;&gt;&lt;a href=&quot;#cb4-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Robot Framework Test&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-21&quot;&gt;&lt;a href=&quot;#cb4-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;        # &lt;/span&gt;&lt;span class=&quot;al&quot;&gt;NOTE&lt;/span&gt;&lt;span class=&quot;co&quot;&gt;: joonvena/robotframework-docker-action@v0.1 had permissions issue&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-22&quot;&gt;&lt;a href=&quot;#cb4-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;        # This action is based on a Docker image. I had to fall back to that image&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-23&quot;&gt;&lt;a href=&quot;#cb4-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;        # and use --user flag&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-24&quot;&gt;&lt;a href=&quot;#cb4-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;        run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;|&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-25&quot;&gt;&lt;a href=&quot;#cb4-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          docker run \&lt;/span&gt;
&lt;span id=&quot;cb4-26&quot;&gt;&lt;a href=&quot;#cb4-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            -v ${PWD}/reports:/opt/robotframework/reports:Z \&lt;/span&gt;
&lt;span id=&quot;cb4-27&quot;&gt;&lt;a href=&quot;#cb4-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            -v $/tests_e2e:/opt/robotframework/tests:Z \&lt;/span&gt;
&lt;span id=&quot;cb4-28&quot;&gt;&lt;a href=&quot;#cb4-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            --user $(id -u):$(id -g) \&lt;/span&gt;
&lt;span id=&quot;cb4-29&quot;&gt;&lt;a href=&quot;#cb4-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            -e BROWSER=chrome \&lt;/span&gt;
&lt;span id=&quot;cb4-30&quot;&gt;&lt;a href=&quot;#cb4-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;            ppodgorsek/robot-framework:latest&lt;/span&gt;
&lt;span id=&quot;cb4-31&quot;&gt;&lt;a href=&quot;#cb4-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Upload test results&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-32&quot;&gt;&lt;a href=&quot;#cb4-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/upload-artifact@v1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-33&quot;&gt;&lt;a href=&quot;#cb4-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; always()&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-34&quot;&gt;&lt;a href=&quot;#cb4-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-35&quot;&gt;&lt;a href=&quot;#cb4-35&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; robotframework report&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-36&quot;&gt;&lt;a href=&quot;#cb4-36&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; reports&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-37&quot;&gt;&lt;a href=&quot;#cb4-37&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;gating&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-38&quot;&gt;&lt;a href=&quot;#cb4-38&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;tests_api&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; test_e2e&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-39&quot;&gt;&lt;a href=&quot;#cb4-39&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;co&quot;&gt; # move the gating at the end of the workflow&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;add-performance-testing&quot;&gt;Add Performance Testing&lt;/h3&gt;
&lt;p&gt;Performance testing is a broad topic because there are multiple types of performance testing. Most online sources agree on six types:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Load testing&lt;/li&gt;
&lt;li&gt;Stress testing&lt;/li&gt;
&lt;li&gt;Soak testing&lt;/li&gt;
&lt;li&gt;Spike testing&lt;/li&gt;
&lt;li&gt;Scalability testing&lt;/li&gt;
&lt;li&gt;Capacity testing.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;However, I don’t recommend you try to include each of them. Instead, consider one of two ways to tackle performance testing:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;strong&gt;Identify bottlenecks.&lt;/strong&gt; Design an experiment that identifies bottlenecks and measures the limit of your system.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Benchmarking.&lt;/strong&gt; Identify critical elements of your application and measure its speed. The goal is to improve one performance metric over time; conversely, you want to be alerted in case of metric degradation and address the problem as soon as possible.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;As before, create a new job (called &lt;code&gt;test_performance&lt;/code&gt;). This time I did not find an Action on the Marketplace that fit my requirement. But I recommend &lt;a href=&quot;https://medium.com/nerd-for-tech/ci-build-performance-testing-with-github-action-e6b227097c83&quot;&gt;this Medium article&lt;/a&gt; to help you select your framework and implement the steps of the job yourself.&lt;/p&gt;
&lt;p&gt;Here is the workflow I came up with for my Python application:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode yml&quot;&gt;&lt;code class=&quot;sourceCode yaml&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Python application&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-2&quot;&gt;&lt;a href=&quot;#cb5-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-3&quot;&gt;&lt;a href=&quot;#cb5-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-4&quot;&gt;&lt;a href=&quot;#cb5-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-5&quot;&gt;&lt;a href=&quot;#cb5-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; main &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-6&quot;&gt;&lt;a href=&quot;#cb5-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-7&quot;&gt;&lt;a href=&quot;#cb5-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-8&quot;&gt;&lt;a href=&quot;#cb5-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-9&quot;&gt;&lt;a href=&quot;#cb5-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;deploy&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-10&quot;&gt;&lt;a href=&quot;#cb5-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;tests_api&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-11&quot;&gt;&lt;a href=&quot;#cb5-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;test_e2e&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;at&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-12&quot;&gt;&lt;a href=&quot;#cb5-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;test_performances&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-13&quot;&gt;&lt;a href=&quot;#cb5-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Check performance regression.&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-14&quot;&gt;&lt;a href=&quot;#cb5-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; ubuntu-latest&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-15&quot;&gt;&lt;a href=&quot;#cb5-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; deploy&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-16&quot;&gt;&lt;a href=&quot;#cb5-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-17&quot;&gt;&lt;a href=&quot;#cb5-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/checkout@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-18&quot;&gt;&lt;a href=&quot;#cb5-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Set up Python 3.9&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-19&quot;&gt;&lt;a href=&quot;#cb5-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; actions/setup-python@v2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-20&quot;&gt;&lt;a href=&quot;#cb5-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-21&quot;&gt;&lt;a href=&quot;#cb5-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;python-version&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fl&quot;&gt;3.9&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-22&quot;&gt;&lt;a href=&quot;#cb5-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Install dependencies&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-23&quot;&gt;&lt;a href=&quot;#cb5-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;        run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;|&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-24&quot;&gt;&lt;a href=&quot;#cb5-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          python -m pip install --upgrade pip&lt;/span&gt;
&lt;span id=&quot;cb5-25&quot;&gt;&lt;a href=&quot;#cb5-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          pip install flake8 pytest&lt;/span&gt;
&lt;span id=&quot;cb5-26&quot;&gt;&lt;a href=&quot;#cb5-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi&lt;/span&gt;
&lt;span id=&quot;cb5-27&quot;&gt;&lt;a href=&quot;#cb5-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;          if [ -f test-requirements.txt ]; then pip install -r test-requirements.txt; fi&lt;/span&gt;
&lt;span id=&quot;cb5-28&quot;&gt;&lt;a href=&quot;#cb5-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Run benchmark&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-29&quot;&gt;&lt;a href=&quot;#cb5-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; pytest tests_performances --benchmark-json output.json&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-30&quot;&gt;&lt;a href=&quot;#cb5-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; Store benchmark result&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-31&quot;&gt;&lt;a href=&quot;#cb5-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; rhysd/github-action-benchmark@v1&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-32&quot;&gt;&lt;a href=&quot;#cb5-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;        # &lt;/span&gt;&lt;span class=&quot;al&quot;&gt;NOTE&lt;/span&gt;&lt;span class=&quot;co&quot;&gt;: this action only works for public repository&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-33&quot;&gt;&lt;a href=&quot;#cb5-33&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;        # A pull-request is open with a fix&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-34&quot;&gt;&lt;a href=&quot;#cb5-34&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-35&quot;&gt;&lt;a href=&quot;#cb5-35&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;tool&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;pytest&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-36&quot;&gt;&lt;a href=&quot;#cb5-36&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;output-file-path&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; output.json&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-37&quot;&gt;&lt;a href=&quot;#cb5-37&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;          # Personal access token to deploy GitHub Pages branch&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-38&quot;&gt;&lt;a href=&quot;#cb5-38&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;github-token&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; $&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-39&quot;&gt;&lt;a href=&quot;#cb5-39&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;          # Push and deploy GitHub pages branch automatically&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-40&quot;&gt;&lt;a href=&quot;#cb5-40&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;auto-push&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-41&quot;&gt;&lt;a href=&quot;#cb5-41&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;          # Show alert with commit comment on detecting possible performance regression&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-42&quot;&gt;&lt;a href=&quot;#cb5-42&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;alert-threshold&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;200%&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-43&quot;&gt;&lt;a href=&quot;#cb5-43&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;comment-on-alert&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-44&quot;&gt;&lt;a href=&quot;#cb5-44&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;fail-on-alert&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb5-45&quot;&gt;&lt;a href=&quot;#cb5-45&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;at&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;alert-comment-cc-users&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;at&quot;&gt; &lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;#39;@xNok&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Your final workflow must look like this:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/blog/assets/images/continuous-testing-in-devops/1626878379.png&quot; alt=&quot;GitHub Actions workflow including performances tests&quot; /&gt;&lt;figcaption aria-hidden=&quot;true&quot;&gt;GitHub Actions workflow including performances tests&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Continuous testing is the next step after you successfully implement &lt;a href=&quot;/blog/continuous-integration&quot;&gt;continuous integration&lt;/a&gt;. It further improves the speed of your application development process and adds a quality control layer to it.&lt;/p&gt;
&lt;p&gt;Remember, there are three essential stages in a continuous testing workflow, each testing your system from a different perspective:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Unit tests validate the internal logic.&lt;/li&gt;
&lt;li&gt;Integration tests validate the response of the system from its boundary.&lt;/li&gt;
&lt;li&gt;End-to-end tests validate the system from the user’s perspective.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Adding performance tests can help you track important metrics and ensure that changes do not negatively impact your users.&lt;/p&gt;
&lt;p&gt;Finally, to succeed in implementing CT, remember that testing should become part of your team’s DNA and share the same five pillars as DevOps: culture, automation, lean, measurement, and sharing.&lt;/p&gt;
&lt;p&gt;As your CT process grows and becomes more ingrained in how you work, take a look at &lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly’s&lt;/a&gt; ability to produce a repeatable build process. It can help make testing in GitHub Actions a more straightforward process.&lt;/p&gt;</content><author><name>Alexandre Couëdelo</name></author><category term="Tutorials" /><summary type="html">Automation testing is a crucial element to speed up your delivery process. It aims to flush out any potential regressions. The more you automate, the more confidence you gain in the quality of your software because the quality of each release of your application or library is measurable. Additionally, you reduce costs and save time and effort by reducing manual testing. The caveat is that automated tests have no value if they are not executed regularly alongside your continuous integration (CI) pipeline. CI refers to frequently merging developer code changes and building and creating an artifact that can later be tested and deployed. Extending the CI process by adding automated tests is referred to as continuous testing (CT). CT enables you to apply the fail-fast principle. You test each code change, build, and deployment against several layers of automated tests. Thus, it results in rapid feedback on the quality of your product and the state of the development process. GitHub Actions is a great first step for implementing CT. It’s flexible and powerful enough to bring every step of the CI/CT process into a single place. Your application, tests, and workflow configuration lives with your code in your repository. Furthermore, the learning curve for GitHub Actions is relatively smooth thanks to the Marketplace that provides thousands of Actions ready to use out of the box. What Does It Take to Implement Continuous Testing? A good CI/CT process always contains at least the following steps: Build Deployment Integration tests End-to-end tests In this tutorial, you will implement these four steps using GitHub Actions, as well as add performance tests. The Build steps include code compilation and unit tests. Also, note that it’s convenient to deploy your application in a dev environment before running complex tests such as integration and end-to-end. However, you may also run your application in GitHub Actions for test purposes. In this article, I assume you’ll deploy to a dev environment and focus on implementing different types of tests. Here is a visual of the final workflow for this tutorial: Final GitHub Action Workflow Implementing continuous testing can be challenging. If you are on a team that is new to this fail-fast approach, it may be a frustrating transition. In addition, seeing builds or pipelines failing can be overwhelming at the beginning. I suggest prioritizing fixing tests over focusing on new features. This may also be a significant change. To remediate those challenges, you should rely on the five DevOps principles described by Jez Humble in The DevOps Handbook: Culture Automate Lean Measure Sharing Implementing continuous testing is first a change in culture. Selecting the right tools for CI/CT can greatly improve collaboration. Keep your process lean. Testing should not slow down your process. Instead, select the right amount of tests at the right time in the process. Monitor your job execution time, prefer small tasks that can fail fast, and provide rapid feedback instead of long-running ones. Automate as much and as early as possible because it helps validate that the integration is successful. Delaying test implementation is counterproductive. Measure your improvement and build a baseline for the quality of your software. For example, collect your code coverage, number of successful vs. failed tests, and performance metric. Don’t forget to encourage knowledge sharing. Test automation is not a single person’s job: everyone on the team should know how the test suites work and learn how to fix simple errors when the workflows fail. Implementing CI/CT With GitHub Actions Now that you know the basics of CT, it’s time to see how to implement the first step by creating a GitHub Actions workflow that builds and runs your unit tests. Build a GitHub Actions Workflow with Unit Tests The first thing you need to get started is an initial workflow. If you already committed your application to a GitHub repository, click Actions. GitHub will automatically select and recommend a simple workflow that best suits your language. Select one of them by clicking Set up this workflow, review the workflow steps, and commit. Right away, you should see your workflow starting to build and test your application. Many starting workflows also include linting that validates the formatting and detects potential errors. Get Started with GitHub Action Workflow A GitHub Actions workflow contains three elements: Triggers (on) specify when the workflow must be executed. The most common use case is to run a workflow on push and pull-request on the main branch. Jobs determine sets of actions composing your pipeline and are executed in parallel unless dependencies between jobs are specified. Steps are the individual components of a job and can be of two types: Scripts or Actions. Steps defining a run attribute execute a command on the host defined by runs-on at the beginning of a job. Steps containing uses execute an Action, a reusable automation script. It’s straightforward to extend a workflow once you understand those three concepts. Here’s a sample workflow for a Python application: name: Python application on: pull_request: branches: [ main ] jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v2 - name: Set up Python 3.9 uses: actions/setup-python@v2 with: python-version: 3.9 - name: Install dependencies run: | python -m pip install --upgrade pip pip install flake8 pytest if [ -f requirements.txt ]; then pip install -r requirements.txt; fi - name: Lint with flake8 run: | # stop the build if there are Python syntax errors or undefined names flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics # exit-zero treats all errors as warnings. The GitHub editor is 127 chars wide flake8 . --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics - name: Test with pytest run: | pytest This what a basic workflow looks like: Most basic GitHub Actions workflow Add Code Coverage Reports On GitHub, most users rely on third parties to get coverage reports (such as SonarQube or Codecov). Integrating those SaaS into your workflow is simple, thanks to the GitHub Actions Marketplace. Most third parties providing code coverage reports have created an Action to make the integration seamless. But let’s not rely on a third party yet. Instead, generate a badge to display in your Readme.md. You’re putting in place the first step toward tracking code quality. Edit your existing Test with xxx step to generate a coverage report. Save the coverage report as an artifact. Storing workflow data as artifacts. Create a new job called gating and download the coverage report. This job must be executed after build; therefore, you must declare needs: build in your configuration. Parse the coverage report to extract the coverage value. I provided a small script that does just that. Generate the badge and add it to your README. Follow the setup step in the documentation of schneegans/dynamic-badges-action@v1.1.0. # This workflow will install Python dependencies, run tests, and lint with a single version of Python # For more information see: https://help.github.com/actions/language-and-framework-guides/using-python-with-github-actions name: Python application on: push: branches: [ main ] pull_request: branches: [ main ] jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v2 - name: Set up Python 3.9 uses: actions/setup-python@v2 with: python-version: 3.9 - name: Install dependencies [...] - name: Lint with flake8 [...] - name: Test with pytest # Update the command to generate coverage report run: pytest --cov-report xml --cov=phonebook tests/ - name: Upload pytest test coverage # Upload the coverage result as an artifact uses: actions/upload-artifact@v2 with: name: coverage-results path: coverage.xml # Use always() to always run this step to publish test results when there are test failures if: ${{ always() }} gating: runs-on: ubuntu-latest needs: build steps: - name: Download coverage report uses: actions/download-artifact@v2 with: name: coverage-results - name: Get the Coverage shell: bash run: | regex=&amp;#39;&amp;lt;coverage.+line-rate=&amp;quot;([0-9).[0-9]+)&amp;quot;.+&amp;gt;&amp;#39; line=$(grep -oP $regex coverage.xml) [[ $line =~ $regex ]] coverage=$( bc &amp;lt;&amp;lt;&amp;lt; ${BASH_REMATCH[1]}*100 ) if (( $(echo &amp;quot;$coverage &amp;gt; 80&amp;quot; |bc -l) )); then COLOR=green else COLOR=red fi echo &amp;quot;COVERAGE=${coverage%.*}%&amp;quot; &amp;gt;&amp;gt; $GITHUB_ENV echo &amp;quot;COLOR=$COLOR&amp;quot; &amp;gt;&amp;gt; $GITHUB_ENV - name: Create the Badge # save the badge configuration in a Gist uses: schneegans/dynamic-badges-action@v1.1.0 with: auth: ${{ secrets.GIST_SECRET }} gistID: ab3bde9504060bd1feb361555e79f51d filename: coverage.json label: coverage message: ${{ env.COVERAGE }} color: ${{ env.COLOR }} This is what your updated workflow looks like: GitHub Action workflow including code coverage badge And you got a badge to decorate your readme.md. GitHub code coverage badge Extending CT with Other Types of Testing You have a basic CI workflow that includes unit tests and coverage reports. Now to obtain an excellent CT workflow, you need to expand with more layers of tests. You will add three new jobs: For API testing, For end-to-end testing For performance testing Add API Testing API testing is part of integration testing. Integration testing aims to determine whether individual units meet your requirement when combined together. When performing integration testing, you target the boundary (or interfaces) of your system. In this specific case, you are aiming your test at a RESTful API. Having API tests ensures that sets of functionality meet your requirement and validates that your web server and connection to a database works properly. While you could write an API test in the same language as your application, you should also consider a tool like Postman/Newman. Postman lets you define a sequence of HTTPS calls and validate each of them using their JavaScript test framework. This makes it easy to share integration test suites. Other developers can use them to facilitate their development process, for instance, mobile developers working with a different stack than backend developers. Newman is the command-line interface that lets you run the Postman tests. Now that you have selected an API testing framework go to GitHub Actions Marketplace and look for an Action that meets your demands. For instance, Newman Action. Now edit your workflow configuration: Add a new job that must be executed after the deployment using needs: deploy. Define the steps of your job: Check out your repository using the Action actions/checkout@master. Run Newman using the Action you just found in the Marketplace. Move the gating job at the end of the workflow by changing the needs property. name: Python application on: push: branches: [ main ] jobs: build: [...] deploy: [...] # our deployment steps tests_api: needs: deploy runs-on: ubuntu-latest steps: - uses: actions/checkout@master - uses: matt-ball/newman-action@master with: collection: tests_integration/postman_collection.json environment: tests_integration/postman_environment.json gating: needs: tests_api [...] # we move the gating at the end of the workflow Now your workflow should contain four sequential jobs: GitHub Actions workflow including API tests Add End-to-End Testing End-to-end testing (e2e) aims to test complete use cases from the user perspective. Think of e2e as replacing a human with a robot. When it comes to selecting an e2e framework, I recommend prioritizing one that supports the Gherkin language. Gherkin promotes writing tests in natural language (aka, plain English). With this approach, more people can understand test cases, including product owners and business analysts. As a result, you foster better collaboration within the team. Verbalizing tests also ensure that you are writing them from the user’s perspective and not making the mistake of testing the functions you just coded. I selected Robot Framework for this example. Robot Framework uses Selenium to control a web browser and thus replace a human by simulating clicks and text entries. Once again, you can go to GitHub Actions Marketplace and look for an Action meeting your needs. For instance, Robot Framework Docker Action. Add a new job called test_e2e to the workflow configuration. This job must be executed after deploy using needs: deploy. You will notice that since tests_api and test_e2e both need deploy, they will be executed in parallel after the deployment. Have a look at the result: GitHub Actions workflow including end-to-end tests Your configuration should look along those lines to achieve this workflow: name: Python application on: push: branches: [ main ] jobs: build: [...] deploy: [...] tests_api: [...] test_e2e: runs-on: ubuntu-latest needs: deploy name: Run Robot Framework Tests steps: - name: Checkout uses: actions/checkout@v2 - name: Create folder for reports run: mkdir reports - name: Robot Framework Test # NOTE: joonvena/robotframework-docker-action@v0.1 had permissions issue # This action is based on a Docker image. I had to fall back to that image # and use --user flag run: | docker run \ -v ${PWD}/reports:/opt/robotframework/reports:Z \ -v $/tests_e2e:/opt/robotframework/tests:Z \ --user $(id -u):$(id -g) \ -e BROWSER=chrome \ ppodgorsek/robot-framework:latest - name: Upload test results uses: actions/upload-artifact@v1 if: always() with: name: robotframework report path: reports gating: needs: [tests_api, test_e2e] [...] # move the gating at the end of the workflow Add Performance Testing Performance testing is a broad topic because there are multiple types of performance testing. Most online sources agree on six types: Load testing Stress testing Soak testing Spike testing Scalability testing Capacity testing. However, I don’t recommend you try to include each of them. Instead, consider one of two ways to tackle performance testing: Identify bottlenecks. Design an experiment that identifies bottlenecks and measures the limit of your system. Benchmarking. Identify critical elements of your application and measure its speed. The goal is to improve one performance metric over time; conversely, you want to be alerted in case of metric degradation and address the problem as soon as possible. As before, create a new job (called test_performance). This time I did not find an Action on the Marketplace that fit my requirement. But I recommend this Medium article to help you select your framework and implement the steps of the job yourself. Here is the workflow I came up with for my Python application: name: Python application on: push: branches: [ main ] jobs: build: [...] deploy: [...] tests_api: [...] test_e2e: [...] test_performances: name: Check performance regression. runs-on: ubuntu-latest needs: deploy steps: - uses: actions/checkout@v2 - name: Set up Python 3.9 uses: actions/setup-python@v2 with: python-version: 3.9 - name: Install dependencies run: | python -m pip install --upgrade pip pip install flake8 pytest if [ -f requirements.txt ]; then pip install -r requirements.txt; fi if [ -f test-requirements.txt ]; then pip install -r test-requirements.txt; fi - name: Run benchmark run: pytest tests_performances --benchmark-json output.json - name: Store benchmark result uses: rhysd/github-action-benchmark@v1 # NOTE: this action only works for public repository # A pull-request is open with a fix with: tool: &amp;#39;pytest&amp;#39; output-file-path: output.json # Personal access token to deploy GitHub Pages branch github-token: $ # Push and deploy GitHub pages branch automatically auto-push: true # Show alert with commit comment on detecting possible performance regression alert-threshold: &amp;#39;200%&amp;#39; comment-on-alert: true fail-on-alert: true alert-comment-cc-users: &amp;#39;@xNok&amp;#39; Your final workflow must look like this: GitHub Actions workflow including performances tests Conclusion Continuous testing is the next step after you successfully implement continuous integration. It further improves the speed of your application development process and adds a quality control layer to it. Remember, there are three essential stages in a continuous testing workflow, each testing your system from a different perspective: Unit tests validate the internal logic. Integration tests validate the response of the system from its boundary. End-to-end tests validate the system from the user’s perspective. Adding performance tests can help you track important metrics and ensure that changes do not negatively impact your users. Finally, to succeed in implementing CT, remember that testing should become part of your team’s DNA and share the same five pillars as DevOps: culture, automation, lean, measurement, and sharing. As your CT process grows and becomes more ingrained in how you work, take a look at Earthly’s ability to produce a repeatable build process. It can help make testing in GitHub Actions a more straightforward process.</summary></entry><entry><title type="html">6 Command Line Tools for Productive Programmers</title><link href="https://earthly.dev/blog/command-line-tools/" rel="alternate" type="text/html" title="6 Command Line Tools for Productive Programmers" /><published>2021-07-23T00:00:00-04:00</published><updated>2021-07-23T00:00:00-04:00</updated><id>https://earthly.dev/blog/command-line-tools</id><content type="html" xml:base="https://earthly.dev/blog/command-line-tools/">&lt;p&gt;Lately, I’ve been doing a lot more things at the command line. I’m not a hard-core terminal guy – I use VSCode more than Vim – but I’m always surprised at the number of complex tasks that can be done using just the POSIX standard command-line tools like &lt;code&gt;grep&lt;/code&gt;, &lt;code&gt;cat&lt;/code&gt; and &lt;code&gt;sort&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Tools are powerful. A good tool makes work easier and faster, and a great tool unlocks new abilities: Previously impossible things become possible and sometimes easy.&lt;/p&gt;
&lt;p&gt;As I’ve learned more, I’ve been adding some new tools to my command-line toolbox, and in this article, I’d like to share some I’ve found valuable.&lt;/p&gt;
&lt;h2 id=&quot;broot&quot;&gt;&lt;code&gt;broot&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;I’m not sure how I came across &lt;code&gt;broot&lt;/code&gt;, but it’s pretty handy. If you are in a small directory and want to see the lay of the land, &lt;code&gt;tree&lt;/code&gt; is excellent.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;✗ tree
.
├── dartboard.png
├── header.jpg
├── opensign.png
├── quote1.png
└── trophy.png

0 directories, 5 files&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;However, if the directory has many files or sub-directories, &lt;code&gt;tree&lt;/code&gt; becomes much less helpful: you only see the last screen full of information as files scroll past you.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ tree 
&amp;lt; scrolling text for a long time &amp;gt;
├── banner.js
└── index.html

328 directories, 2028 files&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;broot&lt;/code&gt; solves this problem by being aware of the size of your terminal window and adapting its output to fit it.&lt;/p&gt;
&lt;div class=&quot;wide-code&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/command-line-tools/broot-800-39409e646.png&quot; srcset=&quot;/blog/generated/assets/images/command-line-tools/broot-400-39409e646.png 400w, /blog/generated/assets/images/command-line-tools/broot-600-39409e646.png 600w, /blog/generated/assets/images/command-line-tools/broot-800-39409e646.png 800w, /blog/generated/assets/images/command-line-tools/broot-1000-39409e646.png 1000w&quot;&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;You can navigate around using the arrow keys in &lt;code&gt;broot&lt;/code&gt; and it is also helpful for tracking down disk space usage by passing in the &lt;code&gt;-w&lt;/code&gt; flag (&lt;code&gt;broot -w&lt;/code&gt;):&lt;/p&gt;
&lt;div class=&quot;wide-code&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/command-line-tools/broot2-800-84e520359.png&quot; srcset=&quot;/blog/generated/assets/images/command-line-tools/broot2-400-84e520359.png 400w, /blog/generated/assets/images/command-line-tools/broot2-600-84e520359.png 600w, /blog/generated/assets/images/command-line-tools/broot2-800-84e520359.png 800w, /blog/generated/assets/images/command-line-tools/broot2-1000-84e520359.png 1000w&quot;&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;It can do lots of other things, so take a look at the &lt;a href=&quot;https://github.com/Canop/broot&quot;&gt;GitHub guide&lt;/a&gt;, but for me, its just a better &lt;code&gt;tree&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;ℹ️ Install BRoot&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Install on MacOS using &lt;code&gt;brew&lt;/code&gt; or follow &lt;a href=&quot;https://dystroy.org/broot/install/&quot;&gt;installation instructions&lt;/a&gt; for other environments.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;brew&lt;/span&gt; install broot&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;funky&quot;&gt;Funky&lt;/h2&gt;
&lt;p&gt;If you live in the terminal, and you want to &lt;a href=&quot;https://blog.sanctum.geek.nz/unix-as-ide-files/&quot;&gt;use your terminal as an IDE&lt;/a&gt;, then it’s helpful to have your terminal change based on the current directory. There are many ways to do this. &lt;a href=&quot;https://direnv.net/&quot;&gt;&lt;code&gt;DirEnv&lt;/code&gt;&lt;/a&gt; loads and unloads &lt;code&gt;.env&lt;/code&gt; files as you enter directories. &lt;a href=&quot;https://github.com/cxreg/smartcd&quot;&gt;&lt;code&gt;smartcd&lt;/code&gt;&lt;/a&gt; is similar. It lets you run a shell script whenever you change to a particular path – you can start and stop services, change the prompt, or anything else you want.&lt;/p&gt;
&lt;p&gt;However, my favorite of this genre is the strangely named &lt;a href=&quot;https://github.com/bbugyi200/funky&quot;&gt;&lt;code&gt;funky&lt;/code&gt;&lt;/a&gt;, which “takes shell functions to the next level by making them easier to define, more flexible, and more interactive.”&lt;/p&gt;
&lt;p&gt;The way &lt;code&gt;funky&lt;/code&gt; works is simple: as you enter a directory, &lt;code&gt;funky&lt;/code&gt; looks for a &lt;code&gt;.funky&lt;/code&gt; file which contains a list of bash functions. It loads them, and when you leave, it unloads them.&lt;/p&gt;
&lt;p&gt;This means that when I’m in the directory for this Jekyll blog, I have aliases loaded for creating a new post, linting my markdown, pulling in images, and so on. I can list these by typing &lt;code&gt;funky&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb4&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb4-1&quot;&gt;&lt;a href=&quot;#cb4-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;$&lt;/span&gt; funky&lt;/span&gt;
&lt;span id=&quot;cb4-2&quot;&gt;&lt;a href=&quot;#cb4-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;lint()&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;ex&quot;&gt;markdownlint&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;--fix&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;./_posts/*.md&amp;quot;&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-3&quot;&gt;&lt;a href=&quot;#cb4-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;set-header()&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;cp&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;latest-image&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;image-folder&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;/header.jpg&amp;quot;&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb4-4&quot;&gt;&lt;a href=&quot;#cb4-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;set-image()&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;cp&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;latest-image&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;image-folder&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;date&lt;/span&gt; +%s&lt;span class=&quot;va&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;.png&amp;quot;&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;funky&lt;/code&gt; can do more than this, though. It has features for interactively adding and editing functions and for registering global functions and aliases. What I like, though, is just being able to quickly give a command, in a specific context, a short alias.&lt;/p&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;ℹ️ Install Funky&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Install Funky using pip&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb5&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb5-1&quot;&gt;&lt;a href=&quot;#cb5-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;pip3&lt;/span&gt; install pyfunky&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then add hooks to your &lt;code&gt;.zshrc&lt;/code&gt;, &lt;code&gt;bashrc&lt;/code&gt; or equivalent:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;## find where funky.sh was installed by pip and source it&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-2&quot;&gt;&lt;a href=&quot;#cb6-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;source&lt;/span&gt; /usr/local/lib/python3.9/site-packages/scripts/shell/funky.sh&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;fuzzy-finder-fzf&quot;&gt;Fuzzy Finder (FZF)&lt;/h2&gt;
&lt;div class=&quot;wide-code&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/command-line-tools/1626788538-800-b7c54354e.png&quot; srcset=&quot;/blog/generated/assets/images/command-line-tools/1626788538-400-b7c54354e.png 400w, /blog/generated/assets/images/command-line-tools/1626788538-600-b7c54354e.png 600w, /blog/generated/assets/images/command-line-tools/1626788538-800-b7c54354e.png 800w, /blog/generated/assets/images/command-line-tools/1626788538-1000-b7c54354e.png 1000w&quot;&gt;&lt;/p&gt;
&lt;figcaption&gt;
Using &lt;code&gt;fzf&lt;/code&gt; to locate the generated images for this post.
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;If &lt;code&gt;funky&lt;/code&gt; and &lt;code&gt;broot&lt;/code&gt; improved my productivity, then more tools could only improve it more. So I headed over to &lt;a href=&quot;https://lobste.rs/s/yfgwjr/what_interesting_command_line_tools_do&quot;&gt;Lobste.rs&lt;/a&gt; and asked what other tools people were using. &lt;code&gt;FZF&lt;/code&gt; came up quite a bit, and I’ve started using it myself now.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/junegunn/fzf&quot;&gt;FZF&lt;/a&gt; is a command-line fuzzy finder. It’s fast, and it interactively lets you filter options down based on a fuzzy keyword match in many places where you need to input a value at the command-line.&lt;/p&gt;
&lt;p&gt;If you install the included shortcuts (&lt;code&gt;/usr/local/opt/fzf/install&lt;/code&gt;), you can use &lt;code&gt;**&lt;/code&gt; anywhere and get an interactive fuzzy finder to narrow down to the desired path. &lt;code&gt;FZF&lt;/code&gt; also makes searching your &lt;code&gt;history&lt;/code&gt; much faster.&lt;/p&gt;
&lt;p&gt;It’s a UNIX filter that reads in input, shows you an interactive list that you filter down, and then sends the selected item out the other side but describing that way undersells its usefulness.&lt;/p&gt;
&lt;p&gt;I recommend watching this video where Alexey Samoshkin walks through many possible uses for &lt;code&gt;FZF&lt;/code&gt; with a soothing piano playing in the background:&lt;/p&gt;
&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/qgG5Jhi_Els&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;
&lt;/iframe&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;ℹ️ Install FZF&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Install FZF using your &lt;a href=&quot;https://github.com/junegunn/fzf#using-linux-package-managers&quot;&gt;package manager of choice&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb7&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb7-1&quot;&gt;&lt;a href=&quot;#cb7-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;brew&lt;/span&gt; install fzf&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then add hooks to your &lt;code&gt;.zshrc&lt;/code&gt;, &lt;code&gt;bashrc&lt;/code&gt; or equivalent:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb8&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb8-1&quot;&gt;&lt;a href=&quot;#cb8-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#ZSH&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-2&quot;&gt;&lt;a href=&quot;#cb8-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;source&lt;/span&gt; ~/.fzf.zsh &lt;/span&gt;
&lt;span id=&quot;cb8-3&quot;&gt;&lt;a href=&quot;#cb8-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;#BASH&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb8-4&quot;&gt;&lt;a href=&quot;#cb8-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;source&lt;/span&gt; ~/.fzf.bash&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;mcfly&quot;&gt;McFly&lt;/h2&gt;
&lt;div class=&quot;wide-code&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/command-line-tools/1626788971-800-0b1e50ab8.png&quot; srcset=&quot;/blog/generated/assets/images/command-line-tools/1626788971-400-0b1e50ab8.png 400w, /blog/generated/assets/images/command-line-tools/1626788971-600-0b1e50ab8.png 600w, /blog/generated/assets/images/command-line-tools/1626788971-800-0b1e50ab8.png 800w, /blog/generated/assets/images/command-line-tools/1626788971-1000-0b1e50ab8.png 1000w&quot;&gt;&lt;/p&gt;
&lt;figcaption&gt;
Using McFly to suggest common earthly commands in this path.
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;&lt;code&gt;FZF&lt;/code&gt; is excellent for filtering file paths in a command line when you want to open a file (&lt;code&gt;vim **&lt;/code&gt;), but for command-line completion, there is more information available than the raw history file. &lt;a href=&quot;https://github.com/cantino/mcfly/&quot;&gt;&lt;code&gt;McFly&lt;/code&gt;&lt;/a&gt; attempts to use this extra information to provide more relevant results.&lt;/p&gt;
&lt;p&gt;What extra information? To start with, McFly considers these options in its ranking heuristics:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The commands you typed before the command.&lt;/li&gt;
&lt;li&gt;How often you run the command.&lt;/li&gt;
&lt;li&gt;How recently have you run the command.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It tracks all this in a SQLite database where it also tracks and weighs suggestions by:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The command’s exit status.&lt;/li&gt;
&lt;li&gt;The directory you ran the command in.&lt;/li&gt;
&lt;li&gt;If you have selected it in McFly before.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Being suggested failed commands is a pet peeve of mine, but I never considered narrowing the choice based on the current directory or down-ranking items that are never selected.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;McFly&lt;/code&gt; uses a neural net to do its ranking, and one possible downside is the lag in coming up with suggestions if your SQLite database gets too large. However, &lt;code&gt;MCFLY_HISTORY_LIMIT&lt;/code&gt; is available to limit this growth.&lt;/p&gt;
&lt;p&gt;I’ve only been using it for a couple of days, so I can’t give a fair appraisal of it, but the concept makes me pretty hopeful: using extra information to customize tools towards real-world usage.&lt;/p&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;ℹ️ Install McFly&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;You can install McFly &lt;a href=&quot;https://github.com/cantino/mcfly/#installation&quot;&gt;several ways&lt;/a&gt;. Here is brew: :&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb9&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb9-1&quot;&gt;&lt;a href=&quot;#cb9-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;brew&lt;/span&gt; tap cantino/mcfly&lt;/span&gt;
&lt;span id=&quot;cb9-2&quot;&gt;&lt;a href=&quot;#cb9-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;brew&lt;/span&gt; install mcfly&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then add hooks to your &lt;code&gt;.zshrc&lt;/code&gt;, &lt;code&gt;bashrc&lt;/code&gt; or equivalent:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;mcfly&lt;/span&gt; init zsh&lt;span class=&quot;va&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The fact that the binary emits the init script rather than dumping an init script into my home directory is a nice touch. &lt;code&gt;zoxide&lt;/code&gt; - the following tool - does this as well.&lt;/p&gt;
&lt;p&gt;I found that &lt;code&gt;FZF&lt;/code&gt; was interfering with the &lt;code&gt;CTRL-R&lt;/code&gt; of McFly and had to comment out &lt;a href=&quot;https://github.com/junegunn/fzf/blob/764316a53d0eb60b315f0bbcd513de58ed57a876/shell/key-bindings.zsh#L109&quot;&gt;this line&lt;/a&gt; in the &lt;code&gt;FZF&lt;/code&gt; init script to get McFly working.&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;better-cd&quot;&gt;Better CD&lt;/h2&gt;
&lt;div class=&quot;wide-code&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/command-line-tools/1626789626-800-fe7102962.png&quot; srcset=&quot;/blog/generated/assets/images/command-line-tools/1626789626-400-fe7102962.png 400w, /blog/generated/assets/images/command-line-tools/1626789626-600-fe7102962.png 600w, /blog/generated/assets/images/command-line-tools/1626789626-800-fe7102962.png 800w, /blog/generated/assets/images/command-line-tools/1626789626-1000-fe7102962.png 1000w&quot;&gt;&lt;/p&gt;
&lt;figcaption&gt;
Using &lt;code&gt;zoxide&lt;/code&gt; as a &lt;code&gt;cd&lt;/code&gt; replacement.
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;p&gt;&lt;code&gt;FZF&lt;/code&gt; works nicely for some path completions, but I didn’t find it helpful when changing directories with &lt;code&gt;cd&lt;/code&gt;: After typing &lt;code&gt;cd **TAB&lt;/code&gt; from my home directory, it takes a while for &lt;code&gt;FZF&lt;/code&gt; to build up the full list options. It was much faster to use my existing ZSH completions of &lt;code&gt;cd TAB &amp;lt;choose a dir&amp;gt; TAB &amp;lt;choose a dir&amp;gt;&lt;/code&gt; to navigate to a folder.&lt;/p&gt;
&lt;p&gt;However, many tools exist which attempt to improve upon &lt;code&gt;cd&lt;/code&gt;. &lt;a href=&quot;https://github.com/wting/autojump&quot;&gt;&lt;code&gt;autojump&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://github.com/rupa/z&quot;&gt;&lt;code&gt;z&lt;/code&gt;&lt;/a&gt;, and &lt;a href=&quot;https://github.com/clvv/fasd&quot;&gt;&lt;code&gt;Fasd&lt;/code&gt;&lt;/a&gt; all track directory usage and give you a single key shortcut for changing to commonly accessed directories. &lt;a href=&quot;https://www.reddit.com/r/commandline/comments/4v5nlt/what_cd_tool_do_you_use_if_any_autojump_j_z_etc/&quot;&gt;&lt;code&gt;r/commandline&lt;/code&gt;&lt;/a&gt; has an detailed discussion of these various &lt;code&gt;cd&lt;/code&gt; replacements, but the one that has the most momentum is &lt;code&gt;zoxide&lt;/code&gt;. &lt;a href=&quot;https://github.com/ajeetdsouza/zoxide&quot;&gt;zoxide&lt;/a&gt; is a rewrite of z in Rust and promises improved speed.&lt;/p&gt;
&lt;p&gt;After you install it, you can use it just like &lt;code&gt;cd&lt;/code&gt; (&lt;code&gt;z ~/path/foo/bar&lt;/code&gt;), but you can also change directories based on ranked text matches of the path (&lt;code&gt;z bar&lt;/code&gt; ~= &lt;code&gt;cd ~/path/foo/bar&lt;/code&gt; ). Instead of needing to supply the full path to change locations, you can instead provide a unique sub-string of the path, and &lt;code&gt;zoxide&lt;/code&gt; will use its usage history to get you where you want.&lt;/p&gt;
&lt;p&gt;For ease of adoption, I’ve chosen to have &lt;code&gt;zoxide&lt;/code&gt; replace &lt;code&gt;cd&lt;/code&gt;, which is as simple as using the &lt;code&gt;--cmd&lt;/code&gt; flag when you add the initialization shell code (&lt;code&gt;eval &quot;$(zoxide init zsh --cmd cd)&quot;&lt;/code&gt;).&lt;/p&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;ℹ️ Install zoxide&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;zoxide&lt;/code&gt; can be installed &lt;a href=&quot;https://github.com/ajeetdsouza/zoxide#step-1-install-zoxide&quot;&gt;several ways&lt;/a&gt;. Here is brew: :&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;brew&lt;/span&gt; install zoxide&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then add hooks to your &lt;code&gt;.zshrc&lt;/code&gt;, &lt;code&gt;bashrc&lt;/code&gt; or equivalent:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb12&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb12-1&quot;&gt;&lt;a href=&quot;#cb12-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;bu&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;va&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;ex&quot;&gt;zoxide&lt;/span&gt; init zsh &lt;span class=&quot;at&quot;&gt;--cmd&lt;/span&gt; cd&lt;span class=&quot;va&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;gitupdate&quot;&gt;GitUpdate&lt;/h2&gt;
&lt;p&gt;This tool is another find from the &lt;a href=&quot;https://lobste.rs/s/yfgwjr/what_interesting_command_line_tools_do&quot;&gt;Lobste.rs&lt;/a&gt; thread. When working on a git branch, I like to commit my work frequently. For example, before I try to delete some huge block of text in a blog post, or before I attempt to refactor some piece of code, I commit my work. Of course, I’ll squash, or restructure, these commits later on, but for convenience, I have a git alias called &lt;code&gt;wip&lt;/code&gt; (’work in progress`) which gives me a low effort way to commit.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git wip = !git add --all; git ci -m WIP&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/nikitavoloboev/gitupdate&quot;&gt;&lt;code&gt;gitupdate&lt;/code&gt;&lt;/a&gt; is a simple improvement on this idea. &lt;code&gt;gitupdate .&lt;/code&gt; commits your files but uses the file names (but not extensions) of the changed files to create a more meaningful commit message. It’s great for times when the commit message doesn’t matter.&lt;/p&gt;
&lt;div class=&quot;wide-code&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/generated/assets/images/command-line-tools/1626790555-800-65425229c.png&quot; srcset=&quot;/blog/generated/assets/images/command-line-tools/1626790555-400-65425229c.png 400w, /blog/generated/assets/images/command-line-tools/1626790555-600-65425229c.png 600w, /blog/generated/assets/images/command-line-tools/1626790555-800-65425229c.png 800w, /blog/generated/assets/images/command-line-tools/1626790555-1000-65425229c.png 1000w&quot;&gt;&lt;/p&gt;
&lt;figcaption&gt;
GitUpdate generates a commit message, commits, and pushes.
&lt;/figcaption&gt;
&lt;/div&gt;
&lt;div class=&quot;notice--info&quot;&gt;
&lt;p&gt;&lt;strong&gt;ℹ️ Install GitUpdate&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb14&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb14-1&quot;&gt;&lt;a href=&quot;#cb14-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;git&lt;/span&gt; clone https://github.com/nikitavoloboev/gitupdate&lt;/span&gt;
&lt;span id=&quot;cb14-2&quot;&gt;&lt;a href=&quot;#cb14-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;go&lt;/span&gt; build&lt;/span&gt;
&lt;span id=&quot;cb14-3&quot;&gt;&lt;a href=&quot;#cb14-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;fu&quot;&gt;sudo&lt;/span&gt; cp gitupdate /usr/local/bin&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;other-tools&quot;&gt;Other Tools&lt;/h2&gt;
&lt;p&gt;There are many other helpful command-line tools. More than can be covered well in a single article. JQ, &lt;a href=&quot;/blog/mitmproxy&quot;&gt;&lt;code&gt;mitmproxy&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://pandoc.org/&quot;&gt;Pandoc&lt;/a&gt;, and &lt;a href=&quot;https://man7.org/linux/man-pages/man1/pstree.1.html&quot;&gt;PSTree&lt;/a&gt; are some I use frequently. There is also a whole class of Rust rewrites of common POSIX tools that warrant an article of their own.&lt;/p&gt;
&lt;p&gt;Of course, &lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly&lt;/a&gt; itself is a command-line tool, and one I constantly use for gluing together various development steps together. It, and the tools I use for &lt;a href=&quot;/blog/markdown-lint&quot;&gt;linting prose&lt;/a&gt;, have become a standard part of how I work.&lt;/p&gt;
&lt;p&gt;What less common command-line tools do you use? If you have tool suggestions, I’d love to hear them. You can find my Twitter account and email below, and I’d love to hear what you are using.&lt;/p&gt;</content><author><name>Adam Gordon Bell</name></author><category term="Tutorials" /><summary type="html">Lately, I’ve been doing a lot more things at the command line. I’m not a hard-core terminal guy – I use VSCode more than Vim – but I’m always surprised at the number of complex tasks that can be done using just the POSIX standard command-line tools like grep, cat and sort. Tools are powerful. A good tool makes work easier and faster, and a great tool unlocks new abilities: Previously impossible things become possible and sometimes easy. As I’ve learned more, I’ve been adding some new tools to my command-line toolbox, and in this article, I’d like to share some I’ve found valuable. broot I’m not sure how I came across broot, but it’s pretty handy. If you are in a small directory and want to see the lay of the land, tree is excellent. ✗ tree . ├── dartboard.png ├── header.jpg ├── opensign.png ├── quote1.png └── trophy.png 0 directories, 5 files However, if the directory has many files or sub-directories, tree becomes much less helpful: you only see the last screen full of information as files scroll past you. $ tree &amp;lt; scrolling text for a long time &amp;gt; ├── banner.js └── index.html 328 directories, 2028 files broot solves this problem by being aware of the size of your terminal window and adapting its output to fit it. You can navigate around using the arrow keys in broot and it is also helpful for tracking down disk space usage by passing in the -w flag (broot -w): It can do lots of other things, so take a look at the GitHub guide, but for me, its just a better tree. ℹ️ Install BRoot Install on MacOS using brew or follow installation instructions for other environments. brew install broot Funky If you live in the terminal, and you want to use your terminal as an IDE, then it’s helpful to have your terminal change based on the current directory. There are many ways to do this. DirEnv loads and unloads .env files as you enter directories. smartcd is similar. It lets you run a shell script whenever you change to a particular path – you can start and stop services, change the prompt, or anything else you want. However, my favorite of this genre is the strangely named funky, which “takes shell functions to the next level by making them easier to define, more flexible, and more interactive.” The way funky works is simple: as you enter a directory, funky looks for a .funky file which contains a list of bash functions. It loads them, and when you leave, it unloads them. This means that when I’m in the directory for this Jekyll blog, I have aliases loaded for creating a new post, linting my markdown, pulling in images, and so on. I can list these by typing funky $ funky lint() { markdownlint --fix &amp;quot;./_posts/*.md&amp;quot;; } set-header() { cp &amp;quot;$(latest-image)&amp;quot; &amp;quot;$(image-folder)/header.jpg&amp;quot;; } set-image() { cp &amp;quot;$(latest-image)&amp;quot; &amp;quot;$(image-folder)/$(date +%s).png&amp;quot;; } funky can do more than this, though. It has features for interactively adding and editing functions and for registering global functions and aliases. What I like, though, is just being able to quickly give a command, in a specific context, a short alias. ℹ️ Install Funky Install Funky using pip pip3 install pyfunky Then add hooks to your .zshrc, bashrc or equivalent: ## find where funky.sh was installed by pip and source it source /usr/local/lib/python3.9/site-packages/scripts/shell/funky.sh Fuzzy Finder (FZF) Using fzf to locate the generated images for this post. If funky and broot improved my productivity, then more tools could only improve it more. So I headed over to Lobste.rs and asked what other tools people were using. FZF came up quite a bit, and I’ve started using it myself now. FZF is a command-line fuzzy finder. It’s fast, and it interactively lets you filter options down based on a fuzzy keyword match in many places where you need to input a value at the command-line. If you install the included shortcuts (/usr/local/opt/fzf/install), you can use ** anywhere and get an interactive fuzzy finder to narrow down to the desired path. FZF also makes searching your history much faster. It’s a UNIX filter that reads in input, shows you an interactive list that you filter down, and then sends the selected item out the other side but describing that way undersells its usefulness. I recommend watching this video where Alexey Samoshkin walks through many possible uses for FZF with a soothing piano playing in the background: ℹ️ Install FZF Install FZF using your package manager of choice: brew install fzf Then add hooks to your .zshrc, bashrc or equivalent: #ZSH source ~/.fzf.zsh #BASH source ~/.fzf.bash McFly Using McFly to suggest common earthly commands in this path. FZF is excellent for filtering file paths in a command line when you want to open a file (vim **), but for command-line completion, there is more information available than the raw history file. McFly attempts to use this extra information to provide more relevant results. What extra information? To start with, McFly considers these options in its ranking heuristics: The commands you typed before the command. How often you run the command. How recently have you run the command. It tracks all this in a SQLite database where it also tracks and weighs suggestions by: The command’s exit status. The directory you ran the command in. If you have selected it in McFly before. Being suggested failed commands is a pet peeve of mine, but I never considered narrowing the choice based on the current directory or down-ranking items that are never selected. McFly uses a neural net to do its ranking, and one possible downside is the lag in coming up with suggestions if your SQLite database gets too large. However, MCFLY_HISTORY_LIMIT is available to limit this growth. I’ve only been using it for a couple of days, so I can’t give a fair appraisal of it, but the concept makes me pretty hopeful: using extra information to customize tools towards real-world usage. ℹ️ Install McFly You can install McFly several ways. Here is brew: : brew tap cantino/mcfly brew install mcfly Then add hooks to your .zshrc, bashrc or equivalent: eval &amp;quot;$(mcfly init zsh)&amp;quot; The fact that the binary emits the init script rather than dumping an init script into my home directory is a nice touch. zoxide - the following tool - does this as well. I found that FZF was interfering with the CTRL-R of McFly and had to comment out this line in the FZF init script to get McFly working. Better CD Using zoxide as a cd replacement. FZF works nicely for some path completions, but I didn’t find it helpful when changing directories with cd: After typing cd **TAB from my home directory, it takes a while for FZF to build up the full list options. It was much faster to use my existing ZSH completions of cd TAB &amp;lt;choose a dir&amp;gt; TAB &amp;lt;choose a dir&amp;gt; to navigate to a folder. However, many tools exist which attempt to improve upon cd. autojump, z, and Fasd all track directory usage and give you a single key shortcut for changing to commonly accessed directories. r/commandline has an detailed discussion of these various cd replacements, but the one that has the most momentum is zoxide. zoxide is a rewrite of z in Rust and promises improved speed. After you install it, you can use it just like cd (z ~/path/foo/bar), but you can also change directories based on ranked text matches of the path (z bar ~= cd ~/path/foo/bar ). Instead of needing to supply the full path to change locations, you can instead provide a unique sub-string of the path, and zoxide will use its usage history to get you where you want. For ease of adoption, I’ve chosen to have zoxide replace cd, which is as simple as using the --cmd flag when you add the initialization shell code (eval &quot;$(zoxide init zsh --cmd cd)&quot;). ℹ️ Install zoxide zoxide can be installed several ways. Here is brew: : brew install zoxide Then add hooks to your .zshrc, bashrc or equivalent: eval &amp;quot;$(zoxide init zsh --cmd cd)&amp;quot; GitUpdate This tool is another find from the Lobste.rs thread. When working on a git branch, I like to commit my work frequently. For example, before I try to delete some huge block of text in a blog post, or before I attempt to refactor some piece of code, I commit my work. Of course, I’ll squash, or restructure, these commits later on, but for convenience, I have a git alias called wip (’work in progress`) which gives me a low effort way to commit. git wip = !git add --all; git ci -m WIP gitupdate is a simple improvement on this idea. gitupdate . commits your files but uses the file names (but not extensions) of the changed files to create a more meaningful commit message. It’s great for times when the commit message doesn’t matter. GitUpdate generates a commit message, commits, and pushes. ℹ️ Install GitUpdate git clone https://github.com/nikitavoloboev/gitupdate go build sudo cp gitupdate /usr/local/bin Other Tools There are many other helpful command-line tools. More than can be covered well in a single article. JQ, mitmproxy, Pandoc, and PSTree are some I use frequently. There is also a whole class of Rust rewrites of common POSIX tools that warrant an article of their own. Of course, Earthly itself is a command-line tool, and one I constantly use for gluing together various development steps together. It, and the tools I use for linting prose, have become a standard part of how I work. What less common command-line tools do you use? If you have tool suggestions, I’d love to hear them. You can find my Twitter account and email below, and I’d love to hear what you are using.</summary></entry><entry><title type="html">Install `matplotlib` In A Docker Container</title><link href="https://earthly.dev/blog/python-matplotlib-docker/" rel="alternate" type="text/html" title="Install `matplotlib` In A Docker Container" /><published>2021-07-16T00:00:00-04:00</published><updated>2021-07-16T00:00:00-04:00</updated><id>https://earthly.dev/blog/python-matplotlib-docker</id><content type="html" xml:base="https://earthly.dev/blog/python-matplotlib-docker/">&lt;p&gt;&lt;code&gt;matplotlib&lt;/code&gt; is an excellent library for creating graphs and visualizations in Python. For example, I used it to generate the performance graphs in &lt;a href=&quot;/blog/python-timsort-merge&quot;&gt;my merging article&lt;/a&gt;, and internally, we use it now and again for visualizing any metrics we produce. It is a bit hard to install inside a docker container, though.&lt;/p&gt;
&lt;h2 id=&quot;installing-matplotlib-in-alpine-linux&quot;&gt;Installing Matplotlib in Alpine Linux&lt;/h2&gt;
&lt;p&gt;On Alpine, or an Alpine-based docker image, it’s &lt;em&gt;possible&lt;/em&gt; to install &lt;code&gt;matplotlib&lt;/code&gt;; however it will involve compiling it from source as pip does not provide any pre-compiled binaries – this will take quite a bit of time. If you don’t mind compiling from source, you will need to have its dependencies in place to make this work:&lt;/p&gt;
&lt;pre class=&quot;docker&quot;&gt;&lt;code&gt; FROM python:3.6-alpine
 RUN apk add g++ jpeg-dev zlib-dev libjpeg make
 RUN pip3 install matplotlib&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;installing-matplotlib-in-ubuntu&quot;&gt;Installing Matplotlib in Ubuntu&lt;/h2&gt;
&lt;p&gt;On Ubuntu, or a Ubuntu-based docker image, the process is much simpler:&lt;/p&gt;
&lt;pre class=&quot;docker&quot;&gt;&lt;code&gt; FROM ubuntu:20.10
 RUN apt-get update &amp;amp;&amp;amp; apt-get install -y python3 python3-pip
 RUN pip3 install matplotlib&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In either case, after you’ve installed it, you can quickly generate great graphs and visualizations:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; numpy &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; np&lt;/span&gt;
&lt;span id=&quot;cb3-2&quot;&gt;&lt;a href=&quot;#cb3-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;from&lt;/span&gt; scipy.interpolate &lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; splprep, splev&lt;/span&gt;
&lt;span id=&quot;cb3-3&quot;&gt;&lt;a href=&quot;#cb3-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-4&quot;&gt;&lt;a href=&quot;#cb3-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; plt&lt;/span&gt;
&lt;span id=&quot;cb3-5&quot;&gt;&lt;a href=&quot;#cb3-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;from&lt;/span&gt; matplotlib.path &lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; Path&lt;/span&gt;
&lt;span id=&quot;cb3-6&quot;&gt;&lt;a href=&quot;#cb3-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;im&quot;&gt;from&lt;/span&gt; matplotlib.patches &lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; PathPatch&lt;/span&gt;
&lt;span id=&quot;cb3-7&quot;&gt;&lt;a href=&quot;#cb3-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-8&quot;&gt;&lt;a href=&quot;#cb3-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;N &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;400&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb3-9&quot;&gt;&lt;a href=&quot;#cb3-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;t &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; np.linspace(&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; np.pi, N)&lt;/span&gt;
&lt;span id=&quot;cb3-10&quot;&gt;&lt;a href=&quot;#cb3-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;r &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;fl&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; np.cos(t)&lt;/span&gt;
&lt;span id=&quot;cb3-11&quot;&gt;&lt;a href=&quot;#cb3-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;x, y &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; r &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; np.cos(t), r &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt; np.sin(t)&lt;/span&gt;
&lt;span id=&quot;cb3-12&quot;&gt;&lt;a href=&quot;#cb3-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;fig, ax &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; plt.subplots()&lt;/span&gt;
&lt;span id=&quot;cb3-13&quot;&gt;&lt;a href=&quot;#cb3-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;ax.plot(x, y)&lt;/span&gt;
&lt;span id=&quot;cb3-14&quot;&gt;&lt;a href=&quot;#cb3-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;plt.xlabel(&lt;span class=&quot;st&quot;&gt;&amp;quot;X value&amp;quot;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb3-15&quot;&gt;&lt;a href=&quot;#cb3-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;plt.ylabel(&lt;span class=&quot;st&quot;&gt;&amp;quot;Y value&amp;quot;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&quot;cb3-16&quot;&gt;&lt;a href=&quot;#cb3-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;plt.savefig(&lt;span class=&quot;st&quot;&gt;&amp;#39;1.png&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/blog/assets/images/python-matplotlib-docker/1.png&quot; alt=&quot;Simple Graph&quot; /&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;h2 id=&quot;appendix-alpine-vs-ubuntu-pip-install&quot;&gt;Appendix: Alpine vs Ubuntu Pip Install&lt;/h2&gt;
&lt;p&gt;Why is the Ubuntu process fast and simple and the Alpine process slow? The reason is &lt;code&gt;glibc&lt;/code&gt;. The pip wheels for &lt;code&gt;matplotlib&lt;/code&gt; are compiled c/c++ programs that dynamically link to &lt;code&gt;glibc&lt;/code&gt; and Alpine does not have &lt;code&gt;glibc&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Alpine tries to stay small and so uses &lt;code&gt;musl-libc&lt;/code&gt; instead. Unfortunately, this means compiling from source on Alpine, which can be a lengthy process.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/49037742/why-does-it-take-ages-to-install-pandas-on-alpine-linux/58210701#58210701&quot;&gt;ThisGuyCantEven&lt;/a&gt; on Stack Overflow has more details:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Pip looks first for a wheel with the correct binaries, if it can’t find one, it tries to compile the binaries from the c/c++ source and links them against &lt;code&gt;musl&lt;/code&gt;. In many cases, this won’t even work unless you have the python headers from python3-dev or build tools like make.&lt;/p&gt;
&lt;p&gt;Now the silver lining, as others have mentioned, there are &lt;code&gt;apk&lt;/code&gt; packages with the proper binaries provided by the community, using these will save you the (sometimes lengthy) process of building the binaries.&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>Adam Gordon Bell</name></author><category term="Tutorials" /><summary type="html">matplotlib is an excellent library for creating graphs and visualizations in Python. For example, I used it to generate the performance graphs in my merging article, and internally, we use it now and again for visualizing any metrics we produce. It is a bit hard to install inside a docker container, though. Installing Matplotlib in Alpine Linux On Alpine, or an Alpine-based docker image, it’s possible to install matplotlib; however it will involve compiling it from source as pip does not provide any pre-compiled binaries – this will take quite a bit of time. If you don’t mind compiling from source, you will need to have its dependencies in place to make this work: FROM python:3.6-alpine RUN apk add g++ jpeg-dev zlib-dev libjpeg make RUN pip3 install matplotlib Installing Matplotlib in Ubuntu On Ubuntu, or a Ubuntu-based docker image, the process is much simpler: FROM ubuntu:20.10 RUN apt-get update &amp;amp;&amp;amp; apt-get install -y python3 python3-pip RUN pip3 install matplotlib In either case, after you’ve installed it, you can quickly generate great graphs and visualizations: import numpy as np from scipy.interpolate import splprep, splev import matplotlib.pyplot as plt from matplotlib.path import Path from matplotlib.patches import PathPatch N = 400 t = np.linspace(0, 3 * np.pi, N) r = 0.5 + np.cos(t) x, y = r * np.cos(t), r * np.sin(t) fig, ax = plt.subplots() ax.plot(x, y) plt.xlabel(&amp;quot;X value&amp;quot;) plt.ylabel(&amp;quot;Y value&amp;quot;) plt.savefig(&amp;#39;1.png&amp;#39;) Appendix: Alpine vs Ubuntu Pip Install Why is the Ubuntu process fast and simple and the Alpine process slow? The reason is glibc. The pip wheels for matplotlib are compiled c/c++ programs that dynamically link to glibc and Alpine does not have glibc. Alpine tries to stay small and so uses musl-libc instead. Unfortunately, this means compiling from source on Alpine, which can be a lengthy process. ThisGuyCantEven on Stack Overflow has more details: Pip looks first for a wheel with the correct binaries, if it can’t find one, it tries to compile the binaries from the c/c++ source and links them against musl. In many cases, this won’t even work unless you have the python headers from python3-dev or build tools like make. Now the silver lining, as others have mentioned, there are apk packages with the proper binaries provided by the community, using these will save you the (sometimes lengthy) process of building the binaries.</summary></entry><entry><title type="html">Creating a Golang Makefile</title><link href="https://earthly.dev/blog/golang-makefile/" rel="alternate" type="text/html" title="Creating a Golang Makefile" /><published>2021-07-15T00:00:00-04:00</published><updated>2021-07-15T00:00:00-04:00</updated><id>https://earthly.dev/blog/golang-makefile</id><content type="html" xml:base="https://earthly.dev/blog/golang-makefile/">&lt;div class=&quot;narrow-code&quot;&gt;
&lt;p&gt;Building and testing any large codebase is time-consuming, error-prone, and repetitive. Golang supports multi-platform builds, which is excellent, but it needs multiple commands to build the binaries for different platforms, which means more time-consuming and repetitive steps when building binaries. If that’s not enough, most projects have some dependencies that need to be installed before building the binary, and you probably want to run tests and ensure the code quality with linters and code coverage tools.&lt;/p&gt;
&lt;p&gt;If this is starting to sound like a nightmare, rest assured: there is an easier way. The utility tool &lt;a href=&quot;https://en.wikipedia.org/wiki/Make_(software)&quot;&gt;Make&lt;/a&gt; is used to automate tasks. It streamlines development and automates repetitive tasks with a single command. Make helps with testing, building, cleaning, and installing Go projects. In this tutorial, you will learn how you can leverage make and makefiles to automate all those frustrating and repetitive Golang tasks. You will learn how to build, clean, and test a Go sample project using make and a &lt;code&gt;Makefile&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&quot;adding-a-makefile-to-your-project&quot;&gt;Adding a Makefile To Your Project&lt;/h2&gt;
&lt;p&gt;To start using make commands, you first need to create a &lt;code&gt;Makefile&lt;/code&gt; in the root directory of your project. Let’s create a simple &lt;code&gt;hello world&lt;/code&gt; project with a &lt;code&gt;Makefile&lt;/code&gt; in it.&lt;/p&gt;
&lt;h3 id=&quot;main.go&quot;&gt;&lt;code&gt;main.go&lt;/code&gt;&lt;/h3&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode go&quot;&gt;&lt;code class=&quot;sourceCode go&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;package&lt;/span&gt; main&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;fmt&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;kw&quot;&gt;func&lt;/span&gt; main&lt;span class=&quot;op&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-6&quot;&gt;&lt;a href=&quot;#cb1-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; fmt&lt;span class=&quot;op&quot;&gt;.&lt;/span&gt;Println&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;hello world&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-7&quot;&gt;&lt;a href=&quot;#cb1-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To run this project, you would normally need to build the project and run the binary:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb2-1&quot;&gt;&lt;a href=&quot;#cb2-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;ex&quot;&gt;go&lt;/span&gt; build main.go&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you want a different binary name and also want to create a build for a specific OS, you can specify this during the build:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode bash&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;&lt;span id=&quot;cb3-1&quot;&gt;&lt;a href=&quot;#cb3-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;va&quot;&gt;GOARCH&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;amd64 &lt;span class=&quot;va&quot;&gt;GOOS&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;=&lt;/span&gt;darwin &lt;span class=&quot;ex&quot;&gt;go&lt;/span&gt; build &lt;span class=&quot;at&quot;&gt;-o&lt;/span&gt; hello-world main.go&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You may want the build to create binary for multiple OS. For that, you will need to run multiple commands:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GOARCH=amd64 GOOS=darwin go build -o hello-world-darwin main.go
GOARCH=amd64 GOOS=linux go build -o hello-world-linux main.go
GOARCH=amd64 GOOS=window go build -o hello-world-windows main.go&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;go run hello-world&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The above commands can be simplified using Makefile. You can specify rules to a specific command and run a simple make command. You would not need to remember the commands and the flags or environment variables needed for executing it.&lt;/p&gt;
&lt;h3 id=&quot;makefile&quot;&gt;Makefile&lt;/h3&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb6&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb6-1&quot;&gt;&lt;a href=&quot;#cb6-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;hello-world&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-2&quot;&gt;&lt;a href=&quot;#cb6-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-3&quot;&gt;&lt;a href=&quot;#cb6-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;build:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-4&quot;&gt;&lt;a href=&quot;#cb6-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; GOARCH=amd64 GOOS=darwin go build -o &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-darwin main.go&lt;/span&gt;
&lt;span id=&quot;cb6-5&quot;&gt;&lt;a href=&quot;#cb6-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; GOARCH=amd64 GOOS=linux go build -o &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-linux main.go&lt;/span&gt;
&lt;span id=&quot;cb6-6&quot;&gt;&lt;a href=&quot;#cb6-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; GOARCH=amd64 GOOS=window go build -o &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-windows main.go&lt;/span&gt;
&lt;span id=&quot;cb6-7&quot;&gt;&lt;a href=&quot;#cb6-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-8&quot;&gt;&lt;a href=&quot;#cb6-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;run:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-9&quot;&gt;&lt;a href=&quot;#cb6-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; ./&lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-10&quot;&gt;&lt;a href=&quot;#cb6-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-11&quot;&gt;&lt;a href=&quot;#cb6-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;build_and_run:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; build run&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-12&quot;&gt;&lt;a href=&quot;#cb6-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-13&quot;&gt;&lt;a href=&quot;#cb6-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;clean:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb6-14&quot;&gt;&lt;a href=&quot;#cb6-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; go clean&lt;/span&gt;
&lt;span id=&quot;cb6-15&quot;&gt;&lt;a href=&quot;#cb6-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-darwin&lt;/span&gt;
&lt;span id=&quot;cb6-16&quot;&gt;&lt;a href=&quot;#cb6-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-linux&lt;/span&gt;
&lt;span id=&quot;cb6-17&quot;&gt;&lt;a href=&quot;#cb6-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-windows&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now with these simple commands, you can build and run the Go project:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make run
make build&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Or you can use a single command for both build and run:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make build_and_run&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Finally, you can run the clean command for the cleanup of binaries:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make clean&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;These commands are very handy and help to streamline the development process. Now all of your team members can use the same command. This reduces inconsistency and helps to eliminate project build-related errors that can arise with inconsistent manual commands.&lt;/p&gt;
&lt;h2 id=&quot;improving-the-development-experience-with-makefiles&quot;&gt;Improving the Development Experience with Makefiles&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;make&lt;/code&gt; uses the Makefile as its source of commands to execute and these commands are defined as a &lt;em&gt;rules&lt;/em&gt; in the Makefile. A single rule defines target, dependencies, and the recipe of the Makefile.&lt;/p&gt;
&lt;h3 id=&quot;terminology&quot;&gt;Terminology&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Target:&lt;/strong&gt; Targets are the main component of a Makefile. The make command executes the recipe by its target name. As you saw in the last section, I used commands like &lt;code&gt;build&lt;/code&gt;, &lt;code&gt;run&lt;/code&gt;, and &lt;code&gt;build_and_clean&lt;/code&gt;. These are called &lt;em&gt;targets&lt;/em&gt;. Targets are the interface to the commands I want to execute.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Dependencies:&lt;/strong&gt; A target can have dependencies that need to be executed before running the target. For example, the &lt;code&gt;build_and_clean&lt;/code&gt; command has two dependencies: &lt;code&gt;build&lt;/code&gt; and &lt;code&gt;run&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Recipe:&lt;/strong&gt; Recipes are the actual commands that will be executed when the target is run. A recipe can be a single command or a collection of commands. You can specify multiple commands in a target using a line break. In the example above, the recipe for the run target is &lt;code&gt;./${BINARY_NAME}&lt;/code&gt;. A recipe should always contain a tab at the start.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;variables&quot;&gt;Variables&lt;/h3&gt;
&lt;p&gt;Variables are essential to any kind of script you write. So Makefiles also have a mechanism to use variables. These are useful when you want the same configs or outputs to be used for different targets. In the example above, I have added the &lt;code&gt;BINARY_NAME&lt;/code&gt; variable, which is reused across different targets.&lt;/p&gt;
&lt;p&gt;The variable can be substituted by enclosing it &lt;code&gt;${&amp;lt;variable_name&amp;gt;}&lt;/code&gt;. I have used the variable in the run command to execute the binary that was created from the build command:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb10&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb10-1&quot;&gt;&lt;a href=&quot;#cb10-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;hello-world&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-2&quot;&gt;&lt;a href=&quot;#cb10-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-3&quot;&gt;&lt;a href=&quot;#cb10-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;run:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb10-4&quot;&gt;&lt;a href=&quot;#cb10-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; ./&lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Variables can be defined either by using &lt;code&gt;=&lt;/code&gt; or &lt;code&gt;:=&lt;/code&gt;. &lt;code&gt;=&lt;/code&gt; will recursively expand the variable. This will replace the value at the point when it is substituted. For example:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb11&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb11-1&quot;&gt;&lt;a href=&quot;#cb11-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;x &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; foo&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-2&quot;&gt;&lt;a href=&quot;#cb11-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;y &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; bar&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-3&quot;&gt;&lt;a href=&quot;#cb11-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;x &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; later&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-4&quot;&gt;&lt;a href=&quot;#cb11-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-5&quot;&gt;&lt;a href=&quot;#cb11-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;all:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb11-6&quot;&gt;&lt;a href=&quot;#cb11-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; echo &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;When you run the &lt;code&gt;all&lt;/code&gt; command, it will replace the value of &lt;code&gt;x&lt;/code&gt; with the last updated value. The value has been changed to &lt;code&gt;later&lt;/code&gt;, so it will print:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt; later bar&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The other kind of variable assignment is &lt;code&gt;:=&lt;/code&gt;. These are &lt;em&gt;simple expanded&lt;/em&gt; variables. The variable is expanded at the first scan. So if you assign the variable using this operator, it will print the first value:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb13&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb13-1&quot;&gt;&lt;a href=&quot;#cb13-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;x &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;:=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; foo&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-2&quot;&gt;&lt;a href=&quot;#cb13-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;y &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;:=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; bar&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-3&quot;&gt;&lt;a href=&quot;#cb13-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;x &lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;:=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; later&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-4&quot;&gt;&lt;a href=&quot;#cb13-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-5&quot;&gt;&lt;a href=&quot;#cb13-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;all:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb13-6&quot;&gt;&lt;a href=&quot;#cb13-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; echo &lt;span class=&quot;ch&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt; foo bar&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;some-useful-tips&quot;&gt;Some Useful Tips&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;To make comments in a Makefile, you can simply add a &lt;code&gt;#&lt;/code&gt; before any line.&lt;/li&gt;
&lt;li&gt;To disable printing the recipe while running the target command, use &lt;code&gt;@&lt;/code&gt; before the recipe.&lt;/li&gt;
&lt;li&gt;Use the &lt;code&gt;SHELL&lt;/code&gt; variable to define the shell to execute the recipe.&lt;/li&gt;
&lt;li&gt;Define the &lt;code&gt;.DEFAULT_GOAL&lt;/code&gt; with the name of the target.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You can also define functions or loops in the Makefile. You can find more details on it &lt;a href=&quot;https://makefiletutorial.com&quot;&gt;in this make file tutorial&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;automating-tasks-using-makefile&quot;&gt;Automating Tasks Using Makefile&lt;/h2&gt;
&lt;p&gt;While developing a project, you will have a lot of repetitive tasks that you might like to automate. In Golang, some of those tasks are testing, running test coverage, linting, and managing dependencies. I will be creating a Makefile that contains all the rules to automate these tasks:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb15&quot;&gt;&lt;pre class=&quot;sourceCode makefile&quot;&gt;&lt;code class=&quot;sourceCode makefile&quot;&gt;&lt;span id=&quot;cb15-1&quot;&gt;&lt;a href=&quot;#cb15-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;hello-world&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-2&quot;&gt;&lt;a href=&quot;#cb15-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-3&quot;&gt;&lt;a href=&quot;#cb15-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;build:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-4&quot;&gt;&lt;a href=&quot;#cb15-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; GOARCH=amd64 GOOS=darwin go build -o &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-darwin main.go&lt;/span&gt;
&lt;span id=&quot;cb15-5&quot;&gt;&lt;a href=&quot;#cb15-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; GOARCH=amd64 GOOS=linux go build -o &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-linux main.go&lt;/span&gt;
&lt;span id=&quot;cb15-6&quot;&gt;&lt;a href=&quot;#cb15-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; GOARCH=amd64 GOOS=window go build -o &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-windows main.go&lt;/span&gt;
&lt;span id=&quot;cb15-7&quot;&gt;&lt;a href=&quot;#cb15-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-8&quot;&gt;&lt;a href=&quot;#cb15-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;run:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-9&quot;&gt;&lt;a href=&quot;#cb15-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; ./&lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-10&quot;&gt;&lt;a href=&quot;#cb15-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-11&quot;&gt;&lt;a href=&quot;#cb15-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;build_and_run:&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt; build run&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-12&quot;&gt;&lt;a href=&quot;#cb15-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-13&quot;&gt;&lt;a href=&quot;#cb15-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;clean:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-14&quot;&gt;&lt;a href=&quot;#cb15-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; go clean&lt;/span&gt;
&lt;span id=&quot;cb15-15&quot;&gt;&lt;a href=&quot;#cb15-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-darwin&lt;/span&gt;
&lt;span id=&quot;cb15-16&quot;&gt;&lt;a href=&quot;#cb15-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-linux&lt;/span&gt;
&lt;span id=&quot;cb15-17&quot;&gt;&lt;a href=&quot;#cb15-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; rm &lt;span class=&quot;ch&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;BINARY_NAME&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;}&lt;/span&gt;-windows&lt;/span&gt;
&lt;span id=&quot;cb15-18&quot;&gt;&lt;a href=&quot;#cb15-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-19&quot;&gt;&lt;a href=&quot;#cb15-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;test:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-20&quot;&gt;&lt;a href=&quot;#cb15-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; go test ./...&lt;/span&gt;
&lt;span id=&quot;cb15-21&quot;&gt;&lt;a href=&quot;#cb15-21&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-22&quot;&gt;&lt;a href=&quot;#cb15-22&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;test_coverage:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-23&quot;&gt;&lt;a href=&quot;#cb15-23&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; go test ./... -coverprofile=coverage.out&lt;/span&gt;
&lt;span id=&quot;cb15-24&quot;&gt;&lt;a href=&quot;#cb15-24&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-25&quot;&gt;&lt;a href=&quot;#cb15-25&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;dep:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-26&quot;&gt;&lt;a href=&quot;#cb15-26&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; go mod download&lt;/span&gt;
&lt;span id=&quot;cb15-27&quot;&gt;&lt;a href=&quot;#cb15-27&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-28&quot;&gt;&lt;a href=&quot;#cb15-28&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;vet:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-29&quot;&gt;&lt;a href=&quot;#cb15-29&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; go vet&lt;/span&gt;
&lt;span id=&quot;cb15-30&quot;&gt;&lt;a href=&quot;#cb15-30&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-31&quot;&gt;&lt;a href=&quot;#cb15-31&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dv&quot;&gt;lint:&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb15-32&quot;&gt;&lt;a href=&quot;#cb15-32&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt; golangci-lint run --enable-all&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;With this simple Makefile, you can now easily execute commands to run tasks:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make test
make test_coverage
make dep
make vet
make lint&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; I am using an external package, &lt;a href=&quot;https://github.com/golangci/golangci-lint&quot;&gt;&lt;code&gt;golangci-lint&lt;/code&gt;&lt;/a&gt;, for linting. If you are using &lt;code&gt;go mod&lt;/code&gt;, make sure to add it to your &lt;code&gt;go.mod&lt;/code&gt; file.&lt;/p&gt;
&lt;p&gt;Any CI/CD tool that you are using can now simply use these targets.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Golang is a popular language for developing large-scale projects. Larger projects have multiple developers and require continuous automation to scale. Streamlining the development process by automating the tasks that are required during development, testing, and release will pay off with a faster and more reliable development process and a easier release process.&lt;/p&gt;
&lt;p&gt;For next-level automation and to further improve the automation, tools like &lt;a href=&quot;https://earthly.dev/&quot;&gt;Earthly.dev&lt;/a&gt; can be helpful. If you are also using Docker along with Makefile, Earthly can help make your development process smoother, taking some of the best ideas from Makefiles and Dockerfiles and combining them into one specification.&lt;/p&gt;
&lt;/div&gt;</content><author><name>Milap Neupane</name></author><category term="Tutorials" /><summary type="html">Building and testing any large codebase is time-consuming, error-prone, and repetitive. Golang supports multi-platform builds, which is excellent, but it needs multiple commands to build the binaries for different platforms, which means more time-consuming and repetitive steps when building binaries. If that’s not enough, most projects have some dependencies that need to be installed before building the binary, and you probably want to run tests and ensure the code quality with linters and code coverage tools. If this is starting to sound like a nightmare, rest assured: there is an easier way. The utility tool Make is used to automate tasks. It streamlines development and automates repetitive tasks with a single command. Make helps with testing, building, cleaning, and installing Go projects. In this tutorial, you will learn how you can leverage make and makefiles to automate all those frustrating and repetitive Golang tasks. You will learn how to build, clean, and test a Go sample project using make and a Makefile. Adding a Makefile To Your Project To start using make commands, you first need to create a Makefile in the root directory of your project. Let’s create a simple hello world project with a Makefile in it. main.go package main import &amp;quot;fmt&amp;quot; func main() { fmt.Println(&amp;quot;hello world&amp;quot;) } To run this project, you would normally need to build the project and run the binary: go build main.go If you want a different binary name and also want to create a build for a specific OS, you can specify this during the build: GOARCH=amd64 GOOS=darwin go build -o hello-world main.go You may want the build to create binary for multiple OS. For that, you will need to run multiple commands: GOARCH=amd64 GOOS=darwin go build -o hello-world-darwin main.go GOARCH=amd64 GOOS=linux go build -o hello-world-linux main.go GOARCH=amd64 GOOS=window go build -o hello-world-windows main.go go run hello-world The above commands can be simplified using Makefile. You can specify rules to a specific command and run a simple make command. You would not need to remember the commands and the flags or environment variables needed for executing it. Makefile BINARY_NAME=hello-world build: GOARCH=amd64 GOOS=darwin go build -o ${BINARY_NAME}-darwin main.go GOARCH=amd64 GOOS=linux go build -o ${BINARY_NAME}-linux main.go GOARCH=amd64 GOOS=window go build -o ${BINARY_NAME}-windows main.go run: ./${BINARY_NAME} build_and_run: build run clean: go clean rm ${BINARY_NAME}-darwin rm ${BINARY_NAME}-linux rm ${BINARY_NAME}-windows Now with these simple commands, you can build and run the Go project: make run make build Or you can use a single command for both build and run: make build_and_run Finally, you can run the clean command for the cleanup of binaries: make clean These commands are very handy and help to streamline the development process. Now all of your team members can use the same command. This reduces inconsistency and helps to eliminate project build-related errors that can arise with inconsistent manual commands. Improving the Development Experience with Makefiles make uses the Makefile as its source of commands to execute and these commands are defined as a rules in the Makefile. A single rule defines target, dependencies, and the recipe of the Makefile. Terminology Target: Targets are the main component of a Makefile. The make command executes the recipe by its target name. As you saw in the last section, I used commands like build, run, and build_and_clean. These are called targets. Targets are the interface to the commands I want to execute. Dependencies: A target can have dependencies that need to be executed before running the target. For example, the build_and_clean command has two dependencies: build and run. Recipe: Recipes are the actual commands that will be executed when the target is run. A recipe can be a single command or a collection of commands. You can specify multiple commands in a target using a line break. In the example above, the recipe for the run target is ./${BINARY_NAME}. A recipe should always contain a tab at the start. Variables Variables are essential to any kind of script you write. So Makefiles also have a mechanism to use variables. These are useful when you want the same configs or outputs to be used for different targets. In the example above, I have added the BINARY_NAME variable, which is reused across different targets. The variable can be substituted by enclosing it ${&amp;lt;variable_name&amp;gt;}. I have used the variable in the run command to execute the binary that was created from the build command: BINARY_NAME=hello-world run: ./${BINARY_NAME} Variables can be defined either by using = or :=. = will recursively expand the variable. This will replace the value at the point when it is substituted. For example: x = foo y = $(x) bar x = later all: echo $(y) When you run the all command, it will replace the value of x with the last updated value. The value has been changed to later, so it will print: &amp;gt; later bar The other kind of variable assignment is :=. These are simple expanded variables. The variable is expanded at the first scan. So if you assign the variable using this operator, it will print the first value: x := foo y := $(x) bar x := later all: echo $(y) &amp;gt; foo bar Some Useful Tips To make comments in a Makefile, you can simply add a # before any line. To disable printing the recipe while running the target command, use @ before the recipe. Use the SHELL variable to define the shell to execute the recipe. Define the .DEFAULT_GOAL with the name of the target. You can also define functions or loops in the Makefile. You can find more details on it in this make file tutorial. Automating Tasks Using Makefile While developing a project, you will have a lot of repetitive tasks that you might like to automate. In Golang, some of those tasks are testing, running test coverage, linting, and managing dependencies. I will be creating a Makefile that contains all the rules to automate these tasks: BINARY_NAME=hello-world build: GOARCH=amd64 GOOS=darwin go build -o ${BINARY_NAME}-darwin main.go GOARCH=amd64 GOOS=linux go build -o ${BINARY_NAME}-linux main.go GOARCH=amd64 GOOS=window go build -o ${BINARY_NAME}-windows main.go run: ./${BINARY_NAME} build_and_run: build run clean: go clean rm ${BINARY_NAME}-darwin rm ${BINARY_NAME}-linux rm ${BINARY_NAME}-windows test: go test ./... test_coverage: go test ./... -coverprofile=coverage.out dep: go mod download vet: go vet lint: golangci-lint run --enable-all With this simple Makefile, you can now easily execute commands to run tasks: make test make test_coverage make dep make vet make lint Note: I am using an external package, golangci-lint, for linting. If you are using go mod, make sure to add it to your go.mod file. Any CI/CD tool that you are using can now simply use these targets. Conclusion Golang is a popular language for developing large-scale projects. Larger projects have multiple developers and require continuous automation to scale. Streamlining the development process by automating the tasks that are required during development, testing, and release will pay off with a faster and more reliable development process and a easier release process. For next-level automation and to further improve the automation, tools like Earthly.dev can be helpful. If you are also using Docker along with Makefile, Earthly can help make your development process smoother, taking some of the best ideas from Makefiles and Dockerfiles and combining them into one specification.</summary></entry></feed>
<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<link rel="icon" type="image/png" href="/blog/assets/images/favicon.png">
<!-- begin _includes/seo.html -->





<title>Understanding and Using Makefile Flags - Earthly Blog</title>
<meta name="description" content="make is a commonplace utility in the development world. It automates the process of generating executables, documentations, and other non-source fi...">


  <meta name="author" content="Aniket Bhattacharyea">
  
  <meta property="article:author" content="Aniket Bhattacharyea">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Earthly Blog">
<meta property="og:title" content="Understanding and Using Makefile Flags">
<meta property="og:url" content="https://earthly.dev/blog/make-flags/">


  <meta property="og:description" content="make is a commonplace utility in the development world. It automates the process of generating executables, documentations, and other non-source fi...">



  <meta property="og:image" content="/blog/generated/assets/images/make-flags/header-800-3ebf309dd.jpg">



  <meta name="twitter:site" content="@EarthlyTech">
  <meta name="twitter:title" content="Understanding and Using Makefile Flags">
  <meta name="twitter:description" content="make is a commonplace utility in the development world. It automates the process of generating executables, documentations, and other non-source fi...">
  <meta name="twitter:url" content="https://earthly.dev/blog/make-flags/">

  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://earthly.dev/blog/generated/assets/images/make-flags/header-800-3ebf309dd.jpg">
  

  



  <meta property="article:published_time" content="2021-09-02T00:00:00-04:00">





  

  


<link rel="canonical" href="https://earthly.dev/blog/make-flags/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Organization",
      "url": "https://earthly.dev/blog/",
      "logo": "/assets/images/logo-header.png"
    
  }
</script>






<!-- end _includes/seo.html -->



  <link href="/blog/feed.xml" type="application/atom+xml" rel="alternate" title="Earthly Blog Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/blog/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-161831101-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-161831101-5');
</script>
  <!-- Facebook Pixel Code -->
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '259843109045285');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=259843109045285&ev=PageView&noscript=1"
    />
</noscript>
 <!-- End Facebook Pixel Code -->
  <!-- Twitter universal website tag code -->
<script>
  !function(e,t,n,s,u,a){e.twq||(s=e.twq=function(){s.exe?s.exe.apply(s,arguments):s.queue.push(arguments);
  },s.version='1.1',s.queue=[],u=t.createElement(n),u.async=!0,u.src='//static.ads-twitter.com/uwt.js',
  a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(u,a))}(window,document,'script');
  // Insert Twitter Pixel ID and Standard Event data below
  twq('init','o5s6p');
  twq('track','PageView');
  </script>
  <!-- End Twitter universal website tag code -->


  </head>

  <body class="layout--single">
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/blog/assets/images/white-logo.png" alt="Earthly"></a>
        
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/blog/">Blog home</a>
            </li><li class="masthead__menu-item">
              <a href="/blog/categories/articles/">Articles</a>
            </li><li class="masthead__menu-item">
              <a href="/blog/categories/news/">News</a>
            </li><li class="masthead__menu-item">
              <a href="/blog/categories/tutorials/">Tutorials</a>
            </li><li class="masthead__menu-item">
              <a href="https://github.com/earthly/earthly">GitHub</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      




  







<div class="page__hero"
  style=" background-image: url('');"
>
  
      <picture class="page__hero-image"><source srcset="/blog/generated/assets/images/make-flags/header-400-22160e8a1.webp 400w, /blog/generated/assets/images/make-flags/header-600-22160e8a1.webp 600w, /blog/generated/assets/images/make-flags/header-800-22160e8a1.webp 800w, /blog/generated/assets/images/make-flags/header-1000-22160e8a1.webp 1000w, /blog/generated/assets/images/make-flags/header-1200-22160e8a1.webp 1200w" type="image/webp"><source srcset="/blog/generated/assets/images/make-flags/header-400-22160e8a1.png 400w, /blog/generated/assets/images/make-flags/header-600-22160e8a1.png 600w, /blog/generated/assets/images/make-flags/header-800-22160e8a1.png 800w, /blog/generated/assets/images/make-flags/header-1000-22160e8a1.png 1000w, /blog/generated/assets/images/make-flags/header-1200-22160e8a1.png 1200w" type="image/png"><img src="/blog/generated/assets/images/make-flags/header-800-22160e8a1.jpg" alt="Understanding and Using Makefile Flags"></picture>

  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar">
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Understanding and Using Makefile Flags">
    <meta itemprop="description" content="make is a commonplace utility in the development world. It automates the process of generating executables, documentations, and other non-source files from the source code by dividing the build process into separate interrelated steps. Using make eliminates the need for typing out long and complex commands to compile the source code. make also compiles only the modified files, thereby saving time and processing resources.Usually, the build process involves invoking various command-line tools, like the compiler or preprocessor. Often you need to pass options to these tools as per your requirements. However, hard-coding these options in your makefile can lead to difficulties. As an example, consider the following makefile snippet:Makefilemain.o: main.c    gcc -Wall -c main.cThis snippet compiles main.c to main.o by invoking gcc with the -Wall option. But let’s say that you do not wish to pass the -Wall option; instead, you want to pass the -Werror option. The only way of doing that is to edit the makefile to change the options. There is no convenient way to override the options without modifying the makefile. This is where make flags come into play.Flags in make are just variables containing options that should be passed to the tools used in the compilation process. Although you can use any variable for this purpose, make defines some commonly used flags with default values for some common tools, including C and C++ compiler, C preprocessor, lex, and yacc. For example, CFLAGS is used to pass options to the C compiler, while CXXFLAGS is used in conjunction with the C++ compiler.Why Should You Use Flags?There are a few benefits to using flags over hard-coded options.First, just like any other makefile variable, these flags can be overridden when invoking make from the command line. This feature offers a way to use any flag the user desires, as well as provides a default. For example, consider the following makefile:MakefileCFLAGS = -gall: main.o    gcc -o main $(CFLAGS) main.oWhen you run make, it executes gcc -o main -g main.o. The value of (CFLAGS) &lt; /code &gt; issubstitutedwhenthecommandisexecuted.However, youcanchangethevalueof &lt; code&gt;(CFLAGS) by providing the new value when invoking make:shellmake CFLAGS=&quot;-Wall&quot;This time, the command that will be executed is gcc -o main -Wall main.o. The value of $(CFLAGS) provided in the command line overrides the defined value in the makefile.Since any make variable can be overridden by providing its value in the command line, you may wonder why the manual recommends using special names for the variables. The reason is that by using the flags you can make use of the implicit rules provided by make. The implicit rules are a list of built-in rules that utilize the flags. For example, consider the following makefile:MakefileCC = gccCFLAGS = -g # Flag to pass to gccCPPFLAGS = -I. # Flag to pass to the C preprocessorall: main.oIf you have a main.c file in the project directory, running make will automatically compile it to main.o, even though you did not explicitly add any coding to build main.o. This is because make uses a built-in rule of the form $(CC) $(CPPFLAGS) $(CFLAGS) -c -o x.o x.c&lt;/code&gt; to compile any C file &lt;code&gt;x.c&lt;/code&gt; into &lt;code&gt;x.o&lt;/code&gt;. Thus, using implicit rules, you don’t have to explicitly write the coding.&lt;/p&gt; &lt;p&gt;Another reason is that these flags are standardized and have been used for a long time, so anyone building your software will expect you to use these flags. Using any other variable would force them to go through your &lt;code&gt;makefile&lt;/code&gt; in order to figure out which variable is being used. Instead, by sticking to the standard, you can save them time.&lt;/p&gt; &lt;h2 id=&quot;how-to-use-make-flags&quot;&gt;How to Use &lt;code&gt;Make&lt;/code&gt; Flags&lt;/h2&gt; &lt;p&gt;You can use &lt;code&gt;make&lt;/code&gt; flags just like any other &lt;code&gt;make&lt;/code&gt; variable. Define the flags with default values using the &lt;code&gt;=&lt;/code&gt; operator, and use the flags using the &lt;code&gt;$(…) syntax:MakefileCC = gcc # It is a recommended practice to define the C compiler with CCCFLAGS = -Wall # Defines -Wall as default flagmain.o: main.c    $(CC) $(CFLAGS) -c main.cYou can also override the flags when invoking main, as explained earlier:shellmake CFLAGS=&quot;-g -Wall&quot;Since make already defines these flags with default values (an empty string for most of them), you don’t have to define them in the makefile explicitly if you don’t want to have a default value, and you can use them directly from the command line. For example, the following makefile is valid, and CFLAGS is set to the empty string, which means no options are passed to the compiler.MakefileCC = gcc # It is a recommended practice to define the C compiler with CCmain.o: main.c    $(CC) $(CFLAGS) -c main.cYou can still define CFLAGS from the command line:shellmake CFLAGS=&quot;-Wall&quot;Some Commonly Used FlagsHere are a few commonly used flags. For a full list of flags, check the manual.CFLAGSThis flag should contain the options to give to the C compiler. These options can include debug options, optimization level, warning levels, and any extra flags that you want to use.MakefileCC = gccCFLAGS = -g -Wall # Passes -g and -Wall to gccmain.o: main.c    $(CC) $(CFLAGS) -c main.c If you have options that are required for proper compilation, the manual suggests putting the optional ones in CFLAGS and adding the required options to CFLAGS separately. This way the user can override CFLAGS via the command line, but the required options will not be overridden.MakefileCFLAGS = -g # Optional. Not required for proper compilationALL_CFLAGS = -I. $(CFLAGS) # -I. is required for proper compilationmain.o: main.c        $(CC) -c $(ALL_CFLAGS) main.cCXXFLAGSThis flag is similar to CFLAGS, except that you should use CXXFLAGS when invoking a C++ compiler.MakefileCXX = g++CXXFLAGS = -g -Wall # Passes -g and -Wall to g++main.o: main.cpp    $(CXX) $(CXXFLAGS) -o main.o main.cppCPPFLAGSCPPFLAGS is used to pass extra flags to the C preprocessor. These flags are also used by any programs that use the C preprocessor, including the C, C++, and Fortran compilers. You do not need to explicitly call the C preprocessor. Pass CPPFLAGS to the compiler, and these will be used when the compiler invokes the preprocessor. The most common use case of CPPFLAGS is to include directories to the compiler search path using the -I option.MakefileCC = gccCFLAGS = -g -WallCPPFLAGS = - I /usr/foo/bar # Search for header files in /usr/foo/barmain.o: main.c    $(CC) $(CPPFLAGS) $(CFLAGS) -c main.c LDFLAGSYou can use LDFLAGS to pass extra flags to the linker lD. Similar to CPPFLAGS, these flags are automatically passed to the linker when the compiler invokes it. The most common use is to specify directories where the libraries can be found, using the -L option. You should not include the names of the libraries in LDFLAGS; instead they go into LDLIBS.MakefileLDFLAGS = -L. \ # Search for libraries in the current directory          -L/usr/foo # Search for libraries in /usr/foomain.o: main.c    gcc $(LDFLAGS) -c main.c LDLIBSThe LDLIBS flag should contain the space-separated list of libraries that are used by your programs. For this flag, the -l option followed by the name of the library is used. For example, if your software uses libm, the math library, then you need to include the -lm option.MakefileLDFLAGS = -L. \ # Search for libraries in the current directory          -L/usr/foo # Search for libraries in /usr/fooLDLIBS = -lm -lfoo # Use libm and libfoomain.o: main.c    gcc $(LDFLAGS) -c main.c $(LDLIBS)Keep in mind that LDLIBS should be included after you have listed all your source files. Otherwise the linker will not be able to link the symbols properly.LFLAGSThis flag is used if you are working with lex, a tool used to generate lexical analyzers. Lex takes a list of token definitions in a .l file and generates a C program that can take an input and tokenize it accordingly. You can find a basic introduction to lex on IBM’s documentation site.MakefileLEX = flex # Use flex as the lex programLFLAGS = -d # enable debuglexer.c: lexer.l    $(LEX) $(LFLAGS) lexer.lYFLAGSThis flag is used to pass options to yacc. This is a tool that is often used in conjunction with lex. Yacc is a parser generator; it converts a grammar definition in a .y file into a C program, which can parse the tokenized output of lex into a parse tree. IBM has a tutorial if you’d like to find out more about yacc.MakefileYACC = bison # Use bison as the yacc programYFLAGS = -v \ # Verbose mode        -g # Generate graphparser.c: parser.y    $(YACC) $(YFLAGS) parser.yMAKEFLAGSThis is an interesting flag that is used in recursive invocation of make. If you have modules or subsystems in your project, it is likely that each subsystem will have its own makefile. The top-level makefile will then recursively call make for each of the modules. The MAKEFLAGS variable is automatically set up by make, and it contains all the flags and command line variables that you passed to the top-level make. The MAKEFLAGS variables will pass these options and variables down to each sub-make.To test this, create a directory called subdir and create a makefile in this subdir with the following content:Makefileall: echo $(MAKEFLAGS)This will print out the value of the MAKEFLAGS variable.Then in your top-level makefile, write the following:Makefilesubsystem: cd subdir &amp;&amp; $(MAKE)This makefile recursively calls make in the subdir subdirectory.Now you can run make from your project root with options:shell$  make -sk CFLAGS=&quot;-g&quot;ks -- CFLAGS=-gAs you can see, the options -k and -s were passed to the sub-make, as well as the variables.Note that the options -C, -f, -o, and -W are not put into MAKEFLAGS and not passed down. You can read more about MAKEFLAGS on GNU.org.ConclusionUsing make flags ensures your makefile follows the standard and offers an easy and powerful way to customize the behaviors of the compilation tools by providing them options. However, make flags are limited and require a deep understanding of the right tools to use.If you are looking for a powerful alternative to make, Earthly may be the right choice for you. It is a modern take on the make utility. Tailored for the container era, Earthly provides reproducible and understandable builds with minimal effort.">
    <meta itemprop="datePublished" content="2021-09-02T00:00:00-04:00">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Understanding and Using Makefile Flags
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
        
        &nbsp;	&nbsp;<i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-09-02T00:00:00-04:00">September 2, 2021</time>
        

      </span>
    
    <span>
      
      
      
      <div class="author__avatar_top">
          <picture class="image-author"><source srcset="/blog/generated/assets/images/authors/aniket-240-e5e4f940c.webp 240w" type="image/webp"><source srcset="/blog/generated/assets/images/authors/aniket-240-20da2ef2f.jpg 240w" type="image/jpeg"><img src="/blog/generated/assets/images/authors/aniket-240-20da2ef2f.jpg" alt="Aniket Bhattacharyea %"></picture>

          &nbsp;	&nbsp;
          Aniket Bhattacharyea
      </div>
      
    </span>
  </p>


        </header>
      
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#why-should-you-use-flags">Why Should You Use Flags?</a></li><li><a href="#how-to-use-make-flags">How to Use Make Flags</a></li><li><a href="#some-commonly-used-flags">Some Commonly Used Flags</a><ul><li><a href="#cflags">CFLAGS</a></li><li><a href="#cxxflags">CXXFLAGS</a></li><li><a href="#cppflags">CPPFLAGS</a></li><li><a href="#ldflags">LDFLAGS</a></li><li><a href="#ldlibs">LDLIBS</a></li><li><a href="#lflags">LFLAGS</a></li><li><a href="#yflags">YFLAGS</a></li><li><a href="#makeflags">MAKEFLAGS</a></li></ul></li><li><a href="#conclusion">Conclusion</a></li></ul>

            </nav>
          </aside>
        
        <p><code>make</code> is a commonplace utility in the development world. It automates the process of generating executables, documentations, and other non-source files from the source code by dividing the build process into separate interrelated steps. Using <code>make</code> eliminates the need for typing out long and complex commands to compile the source code. <code>make</code> also compiles only the modified files, thereby saving time and processing resources.</p>
<p>Usually, the build process involves invoking various command-line tools, like the compiler or preprocessor. Often you need to pass options to these tools as per your requirements. However, hard-coding these options in your <code>makefile</code> can lead to difficulties. As an example, consider the following <code>makefile</code> snippet:</p>
<pre><code>Makefile
main.o: main.c
    gcc -Wall -c main.c</code></pre>
<p>This snippet compiles <code>main.c</code> to <code>main.o</code> by invoking <code>gcc</code> with the <code>-Wall</code> option. But let’s say that you do not wish to pass the <code>-Wall</code> option; instead, you want to pass the <code>-Werror</code> option. The only way of doing that is to edit the <code>makefile</code> to change the options. There is no convenient way to override the options without modifying the <code>makefile</code>. This is where <code>make</code> flags come into play.</p>
<p>Flags in <code>make</code> are just variables containing options that should be passed to the tools used in the compilation process. Although you can use any variable for this purpose, <code>make</code> defines some commonly used flags with default values for some common tools, including C and C++ compiler, C preprocessor, <code>lex</code>, and <code>yacc</code>. For example, <code>CFLAGS</code> is used to pass options to the C compiler, while <code>CXXFLAGS</code> is used in conjunction with the C++ compiler.</p>
<h2 id="why-should-you-use-flags">Why Should You Use Flags?</h2>
<p>There are a few benefits to using flags over hard-coded options.</p>
<p>First, just like any other <code>makefile</code> variable, these flags can be overridden when invoking <code>make</code> from the command line. This feature offers a way to use any flag the user desires, as well as provides a default. For example, consider the following <code>makefile</code>:</p>
<pre><code>Makefile
CFLAGS = -g

all: main.o
    gcc -o main $(CFLAGS) main.o</code></pre>
<p>When you run <code>make</code>, it executes <code>gcc -o main -g main.o</code>. The value of <code>$(CFLAGS)</code> is substituted when the command is executed. However, you can change the value of <code>$(CFLAGS)</code> by providing the new value when invoking <code>make</code>:</p>
<pre><code>shell
make CFLAGS=&quot;-Wall&quot;</code></pre>
<p>This time, the command that will be executed is <code>gcc -o main -Wall main.o</code>. The value of <code>$(CFLAGS)</code> provided in the command line overrides the defined value in the <code>makefile</code>.</p>
<p>Since any <code>make</code> variable can be overridden by providing its value in the command line, you may wonder why the manual recommends using special names for the variables. The reason is that by using the flags you can make use of the implicit rules provided by <code>make</code>. The <a href="https://www.gnu.org/software/make/manual/html_node/Catalogue-of-Rules.html#Catalogue-of-Rules">implicit rules</a> are a list of built-in rules that utilize the flags. For example, consider the following <code>makefile</code>:</p>
<pre><code>Makefile
CC = gcc
CFLAGS = -g # Flag to pass to gcc
CPPFLAGS = -I. # Flag to pass to the C preprocessor

all: main.o</code></pre>
<p>If you have a <code>main.c</code> file in the project directory, running <code>make</code> will automatically compile it to <code>main.o</code>, even though you did not explicitly add any coding to build <code>main.o</code>. This is because <code>make</code> uses a built-in rule of the form <code>$(CC) $(CPPFLAGS) $(CFLAGS) -c -o x.o x.c</code> to compile any C file <code>x.c</code> into <code>x.o</code>. Thus, using implicit rules, you don’t have to explicitly write the coding.</p>
<p>Another reason is that these flags are standardized and have been used for a long time, so anyone building your software will expect you to use these flags. Using any other variable would force them to go through your <code>makefile</code> in order to figure out which variable is being used. Instead, by sticking to the standard, you can save them time.</p>
<h2 id="how-to-use-make-flags">How to Use <code>Make</code> Flags</h2>
<p>You can use <code>make</code> flags just like any other <code>make</code> variable. Define the flags with default values using the <code>=</code> operator, and use the flags using the <code>$(...)</code> syntax:</p>
<pre><code>Makefile
CC = gcc # It is a recommended practice to define the C compiler with CC
CFLAGS = -Wall # Defines -Wall as default flag

main.o: main.c
    $(CC) $(CFLAGS) -c main.c</code></pre>
<p>You can also override the flags when invoking main, as explained earlier:</p>
<pre><code>shell
make CFLAGS=&quot;-g -Wall&quot;</code></pre>
<p>Since <code>make</code> already defines these flags with default values (an empty string for most of them), you don’t have to define them in the <code>makefile</code> explicitly if you don’t want to have a default value, and you can use them directly from the command line. For example, the following <code>makefile</code> is valid, and <code>CFLAGS</code> is set to the empty string, which means no options are passed to the compiler.</p>
<pre><code>Makefile
CC = gcc # It is a recommended practice to define the C compiler with CC

main.o: main.c
    $(CC) $(CFLAGS) -c main.c</code></pre>
<p>You can still define <code>CFLAGS</code> from the command line:</p>
<pre><code>shell
make CFLAGS=&quot;-Wall&quot;</code></pre>
<h2 id="some-commonly-used-flags">Some Commonly Used Flags</h2>
<p>Here are a few commonly used flags. For a full list of flags, check the <a href="https://www.gnu.org/software/make/manual/make.html#index-ARFLAGS">manual</a>.</p>
<h3 id="cflags">CFLAGS</h3>
<p>This flag should contain the options to give to the C compiler. These options can include debug options, optimization level, warning levels, and any extra flags that you want to use.</p>
<pre><code>Makefile
CC = gcc

CFLAGS = -g -Wall # Passes -g and -Wall to gcc

main.o: main.c
    $(CC) $(CFLAGS) -c main.c </code></pre>
<p>If you have options that are required for proper compilation, the <a href="https://www.gnu.org/software/make/manual/html_node/Command-Variables.html#Command-Variables">manual suggests</a> putting the optional ones in <code>CFLAGS</code> and adding the required options to <code>CFLAGS</code> separately. This way the user can override <code>CFLAGS</code> via the command line, but the required options will not be overridden.</p>
<pre><code>Makefile
CFLAGS = -g # Optional. Not required for proper compilation
ALL_CFLAGS = -I. $(CFLAGS) # -I. is required for proper compilation
main.o: main.c
        $(CC) -c $(ALL_CFLAGS) main.c</code></pre>
<h3 id="cxxflags">CXXFLAGS</h3>
<p>This flag is similar to <code>CFLAGS</code>, except that you should use <code>CXXFLAGS</code> when invoking a <a href="/blog/g++-makefile">C++ compiler</a>.</p>
<pre><code>Makefile
CXX = g++

CXXFLAGS = -g -Wall # Passes -g and -Wall to g++

main.o: main.cpp
    $(CXX) $(CXXFLAGS) -o main.o main.cpp</code></pre>
<h3 id="cppflags">CPPFLAGS</h3>
<p><code>CPPFLAGS</code> is used to pass extra flags to the C preprocessor. These flags are also used by any programs that use the C preprocessor, including the C, C++, and Fortran compilers. You do not need to explicitly call the C preprocessor. Pass <code>CPPFLAGS</code> to the compiler, and these will be used when the compiler invokes the preprocessor. The most common use case of <code>CPPFLAGS</code> is to include directories to the compiler search path using the <code>-I</code> option.</p>
<pre><code>Makefile
CC = gcc
CFLAGS = -g -Wall
CPPFLAGS = - I /usr/foo/bar # Search for header files in /usr/foo/bar

main.o: main.c
    $(CC) $(CPPFLAGS) $(CFLAGS) -c main.c </code></pre>
<h3 id="ldflags">LDFLAGS</h3>
<p>You can use <code>LDFLAGS</code> to pass extra flags to the linker <code>lD</code>. Similar to <code>CPPFLAGS</code>, these flags are automatically passed to the linker when the compiler invokes it. The most common use is to specify directories where the libraries can be found, using the <code>-L</code> option. You should not include the names of the libraries in <code>LDFLAGS</code>; instead they go into <code>LDLIBS</code>.</p>
<pre><code>Makefile
LDFLAGS = -L. \ # Search for libraries in the current directory
          -L/usr/foo # Search for libraries in /usr/foo

main.o: main.c
    gcc $(LDFLAGS) -c main.c </code></pre>
<h3 id="ldlibs">LDLIBS</h3>
<p>The <code>LDLIBS</code> flag should contain the space-separated list of libraries that are used by your programs. For this flag, the <code>-l</code> option followed by the name of the library is used. For example, if your software uses <code>libm</code>, the math library, then you need to include the <code>-lm</code> option.</p>
<pre><code>Makefile
LDFLAGS = -L. \ # Search for libraries in the current directory
          -L/usr/foo # Search for libraries in /usr/foo

LDLIBS = -lm -lfoo # Use libm and libfoo

main.o: main.c
    gcc $(LDFLAGS) -c main.c $(LDLIBS)</code></pre>
<p>Keep in mind that <code>LDLIBS</code> should be included <em>after</em> you have listed all your source files. Otherwise the linker will not be able to link the symbols properly.</p>
<h3 id="lflags">LFLAGS</h3>
<p>This flag is used if you are working with <code>lex</code>, a tool used to generate lexical analyzers. <code>Lex</code> takes a list of token definitions in a <code>.l</code> file and generates a C program that can take an input and tokenize it accordingly. You can find a basic introduction to <code>lex</code> <a href="https://www.ibm.com/docs/en/zos/2.4.0?topic=tools-generating-lexical-analyzer-using-lex#genlex">on IBM’s documentation site</a>.</p>
<pre><code>Makefile
LEX = flex # Use flex as the lex program
LFLAGS = -d # enable debug

lexer.c: lexer.l
    $(LEX) $(LFLAGS) lexer.l</code></pre>
<h3 id="yflags">YFLAGS</h3>
<p>This flag is used to pass options to <code>yacc</code>. This is a tool that is often used in conjunction with <code>lex</code>. <code>Yacc</code> is a parser generator; it converts a grammar definition in a <code>.y</code> file into a C program, which can parse the tokenized output of <code>lex</code> into a parse tree. <a href="https://www.ibm.com/docs/en/zos/2.4.0?topic=tools-generating-parser-using-yacc#genyac">IBM</a> has a tutorial if you’d like to find out more about <code>yacc</code>.</p>
<pre><code>Makefile
YACC = bison # Use bison as the yacc program
YFLAGS = -v \ # Verbose mode
        -g # Generate graph

parser.c: parser.y
    $(YACC) $(YFLAGS) parser.y</code></pre>
<h3 id="makeflags">MAKEFLAGS</h3>
<p>This is an interesting flag that is used in recursive invocation of <code>make</code>. If you have modules or subsystems in your project, it is likely that each subsystem will have its own <code>makefile</code>. The top-level <code>makefile</code> will then recursively call <code>make</code> for each of the modules. The <code>MAKEFLAGS</code> variable is automatically set up by <code>make</code>, and it contains all the flags and command line variables that you passed to the top-level <code>make</code>. The <code>MAKEFLAGS</code> variables will pass these options and variables down to each sub-<code>make</code>.</p>
<p>To test this, create a directory called <code>subdir</code> and create a <code>makefile</code> in this <code>subdir</code> with the following content:</p>
<pre><code>Makefile
all:
 echo $(MAKEFLAGS)</code></pre>
<p>This will print out the value of the <code>MAKEFLAGS</code> variable.</p>
<p>Then in your top-level <code>makefile</code>, write the following:</p>
<pre><code>Makefile
subsystem:
 cd subdir &amp;&amp; $(MAKE)</code></pre>
<p>This <code>makefile</code> recursively calls <code>make</code> in the <code>subdir</code> subdirectory.</p>
<p>Now you can run <code>make</code> from your project root with options:</p>
<pre><code>shell
$  make -sk CFLAGS=&quot;-g&quot;
ks -- CFLAGS=-g</code></pre>
<p>As you can see, the options <code>-k</code> and <code>-s</code> were passed to the sub-<code>make</code>, as well as the variables.</p>
<p>Note that the options <code>-C</code>, <code>-f</code>, <code>-o</code>, and <code>-W</code> are not put into <code>MAKEFLAGS</code> and not passed down. You can read more about <code>MAKEFLAGS</code> <a href="https://www.gnu.org/software/make/manual/html_node/Options_002fRecursion.html#Options_002fRecursion">on GNU.org</a>.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Using <code>make</code> flags ensures your <code>makefile</code> follows the standard and offers an easy and powerful way to customize the behaviors of the compilation tools by providing them options. However, <code>make</code> flags are limited and require a deep understanding of the right tools to use.</p>
<p>If you are looking for a powerful alternative to <code>make</code>, <a href="https://earthly.dev/">Earthly</a> may be the right choice for you. It is a modern take on the <code>make</code> utility. Tailored for the container era, Earthly provides reproducible and understandable builds with minimal effort.</p>

        
      </section>

      


<div itemscope itemtype="https://schema.org/Person">
  
    <div class="author__avatar">
      
        <picture class="image-author"><source srcset="/blog/generated/assets/images/authors/aniket-240-e5e4f940c.webp 240w" type="image/webp"><source srcset="/blog/generated/assets/images/authors/aniket-240-20da2ef2f.jpg 240w" type="image/jpeg"><img src="/blog/generated/assets/images/authors/aniket-240-20da2ef2f.jpg" alt="Aniket Bhattacharyea %"></picture>

      
    </div>
  
  <div class="author__content">
    
      <div class="author__name heading" itemprop="name">
        Aniket Bhattacharyea
    
    
      </div>
    
      <div class="author__bio" itemprop="description">
        <p>Aniket is a student doing a Master’s in Mathematics and has a passion for computers and software.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <!-- <button class="btn btn--inverse">Follow</button> -->
    <ul class="author__urls social-icons">
      

     

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

      <footer class="page__meta">
        
        



  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/blog/categories/tutorials" class="page__taxonomy-item" rel="tag">Tutorials</a>
    
    </span>
  </p>






        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-09-02T00:00:00-04:00">September 2, 2021</time></p>


      </footer>

      

      
  <nav class="pagination">
    
      <a href="/blog/jq-select/" class="pagination--pager" title="An Introduction to JQ
">Previous</a>
    
    
      <a href="/blog/10-continous-delivery/" class="pagination--pager" title="10+ Best Continuous Delivery Tools
">Next</a>
    
  </nav>

    </div>
  </article>

  
  
    <div class="page__related">
      <div class="page__related-title heading">You may also enjoy</div>
      <div class="grid__wrapper">
        
          










<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <picture><source srcset="/blog/generated/assets/images/example/teaser-600-fc9eab451.webp 600w, /blog/generated/assets/images/example/teaser-800-fc9eab451.webp 800w" type="image/webp"><source srcset="/blog/generated/assets/images/example/teaser-600-b449882ef.jpg 600w, /blog/generated/assets/images/example/teaser-800-b449882ef.jpg 800w" type="image/jpeg"><img src="/blog/generated/assets/images/example/teaser-800-b449882ef.jpg"></picture>

      </div>
    
    
    <div class="archive__item-title no_toc heading" itemprop="headline">
    
      
      
        <a href="/blog/example/" rel="permalink">Example Post
</a>
      
    
    </div>
    
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">

This post is in the future, and won’t show up in the published site


Image without figure


An image with the alt text hidden.





An image with alt text...</p>
  </article>
</div>

        
          










<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <picture><source srcset="/blog/generated/assets/images/10-continous-delivery/header-600-aae60f084.webp 600w, /blog/generated/assets/images/10-continous-delivery/header-800-aae60f084.webp 800w" type="image/webp"><source srcset="/blog/generated/assets/images/10-continous-delivery/header-600-495449b49.jpg 600w, /blog/generated/assets/images/10-continous-delivery/header-800-495449b49.jpg 800w" type="image/jpeg"><img src="/blog/generated/assets/images/10-continous-delivery/header-800-495449b49.jpg"></picture>

      </div>
    
    
    <div class="archive__item-title no_toc heading" itemprop="headline">
    
      
      
        <a href="/blog/10-continous-delivery/" rel="permalink">10+ Best Continuous Delivery Tools
</a>
      
    
    </div>
    
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
Draft.dev Article Checklist



 Add in Author page


 Create header image in Canva


 Optional: Find ways to break up content with quotes or images


 Verif...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/earthlytech" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/earthly/earthly" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
    

    
      <li><a href="/blog/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 <a href="https://earthly.dev/">Earthly</a>. </div>

      </footer>
    </div>

    <script src="/blog/assets/js/vendor/jquery/jquery-3.5.1.js"></script>
<script src="/blog/assets/js/plugins/jquery.fitvids.js"></script>
<script src="/blog/assets/js/plugins/smooth-scroll.js"></script>
<script src="/blog/assets/js/plugins/gumshoe.js"></script>
<script src="/blog/assets/js/plugins/jquery.magnific-popup.js"></script>
<script src="/blog/assets/js/main.min.js"></script>
<script src="/blog/assets/js/externallinks.js"></script>

  <script> // minified version of https://earthly.dev/assets/js/analytics.js
    function setCookie(e,t,r){var i="";if(r){var o=new Date;o.setTime(o.getTime()+24*r*60*60*1e3),i="; expires="+o.toUTCString()}document.cookie=e+"="+(t||"")+i+"; path=/"}function getCookie(e){for(var t=e+"=",r=document.cookie.split(";"),i=0;i<r.length;i++){for(var o=r[i];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null}function uuidv4(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))}function getAnalyticCookie(){cookieName="earthlyID";var e=getCookie(cookieName);return null==e&&(e=uuidv4()),setCookie(cookieName,e,36500),e}jQuery.ajax({type:"POST",url:"https://api.earthly.dev/analytics",data:JSON.stringify({key:"website",url:window.location.href,referrer:document.referrer,earthlyID:getAnalyticCookie()})});
</script>




  </body>
</html>

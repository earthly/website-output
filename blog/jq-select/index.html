<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<link rel="icon" type="image/png" href="/blog/assets/images/favicon.png">
<!-- begin _includes/seo.html -->





<title>JQ Select Explained: Selecting elements from JSON with Examples - Earthly Blog</title>
<meta name="description" content="Background: Fingers, Head, and GoogleWhenever I reach a stopping point in my work, I use a bash alias called gwip1 to create a ‚Äòwork in progress‚Äô c...">


  <meta name="author" content="Adam Gordon Bell">
  
  <meta property="article:author" content="Adam Gordon Bell">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Earthly Blog">
<meta property="og:title" content="An Introduction to JQ">
<meta property="og:url" content="https://earthly.dev/blog/jq-select/">


  <meta property="og:description" content="Background: Fingers, Head, and GoogleWhenever I reach a stopping point in my work, I use a bash alias called gwip1 to create a ‚Äòwork in progress‚Äô c...">



  <meta property="og:image" content="/blog/generated/assets/images/jq-select/header-800-9692dfee3.jpg">



  <meta name="twitter:site" content="@EarthlyTech">
  <meta name="twitter:title" content="An Introduction to JQ">
  <meta name="twitter:description" content="Background: Fingers, Head, and GoogleWhenever I reach a stopping point in my work, I use a bash alias called gwip1 to create a ‚Äòwork in progress‚Äô c...">
  <meta name="twitter:url" content="https://earthly.dev/blog/jq-select/">

  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://earthly.dev/blog/generated/assets/images/jq-select/header-800-9692dfee3.jpg">
  

  



  <meta property="article:published_time" content="2021-08-24T00:00:00-04:00">





  

  


<link rel="canonical" href="https://earthly.dev/blog/jq-select/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Organization",
      "url": "https://earthly.dev/blog/",
      "logo": "/assets/images/logo-header.png"
    
  }
</script>






<!-- end _includes/seo.html -->



  <link href="/blog/feed.xml" type="application/atom+xml" rel="alternate" title="Earthly Blog Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/blog/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-161831101-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-161831101-5');
</script>
  <!-- Facebook Pixel Code -->
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '259843109045285');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=259843109045285&ev=PageView&noscript=1"
    />
</noscript>
 <!-- End Facebook Pixel Code -->
  <!-- Twitter universal website tag code -->
<script>
  !function(e,t,n,s,u,a){e.twq||(s=e.twq=function(){s.exe?s.exe.apply(s,arguments):s.queue.push(arguments);
  },s.version='1.1',s.queue=[],u=t.createElement(n),u.async=!0,u.src='//static.ads-twitter.com/uwt.js',
  a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(u,a))}(window,document,'script');
  // Insert Twitter Pixel ID and Standard Event data below
  twq('init','o5s6p');
  twq('track','PageView');
  </script>
  <!-- End Twitter universal website tag code -->


  </head>

  <body class="layout--single">
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/blog/assets/images/white-logo.png" alt="Earthly"></a>
        
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/blog/">Blog home</a>
            </li><li class="masthead__menu-item">
              <a href="/blog/categories/articles/">Articles</a>
            </li><li class="masthead__menu-item">
              <a href="/blog/categories/news/">News</a>
            </li><li class="masthead__menu-item">
              <a href="/blog/categories/tutorials/">Tutorials</a>
            </li><li class="masthead__menu-item">
              <a href="https://github.com/earthly/earthly">GitHub</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      




  







<div class="page__hero"
  style=" background-image: url('');"
>
  
      <picture class="page__hero-image"><source srcset="/blog/generated/assets/images/jq-select/header-400-cec6c713b.webp 400w, /blog/generated/assets/images/jq-select/header-600-cec6c713b.webp 600w, /blog/generated/assets/images/jq-select/header-800-cec6c713b.webp 800w, /blog/generated/assets/images/jq-select/header-1000-cec6c713b.webp 1000w, /blog/generated/assets/images/jq-select/header-1200-cec6c713b.webp 1200w" type="image/webp"><source srcset="/blog/generated/assets/images/jq-select/header-400-cec6c713b.png 400w, /blog/generated/assets/images/jq-select/header-600-cec6c713b.png 600w, /blog/generated/assets/images/jq-select/header-800-cec6c713b.png 800w, /blog/generated/assets/images/jq-select/header-1000-cec6c713b.png 1000w, /blog/generated/assets/images/jq-select/header-1200-cec6c713b.png 1200w" type="image/png"><img src="/blog/generated/assets/images/jq-select/header-800-cec6c713b.jpg" alt="An Introduction to JQ"></picture>

  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar">
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="An Introduction to JQ">
    <meta itemprop="description" content="Background: Fingers, Head, and GoogleWhenever I reach a stopping point in my work, I use a bash alias called gwip1 to create a ‚Äòwork in progress‚Äô commit. It happens without conscious thinking on my part. The same way my fingers know the vim key bindings, they know gwip.Other actions, I know how they work, but I have to think about them every time. They are in my head, not my fingers.2However, some things never stick in my head, nor my fingers, and I have to google them every time. jq is one of these.I know it‚Äôs a powerful tool, but I always end up back at Google and then coping and pasting a solution from somewhere. So I solve my problem but never learn the tool.It‚Äôs time to fix that. In this article, I‚Äôm going to go over the basics building blocks of jq in enough depth that you will be able to understand how jq works. Of course, you still might occasionally need to head to google to find a function name or check your syntax, but at least you‚Äôll have a firm grounding in the basics.What Is JQjq is a lightweight, command-line JSON processor. I install it with brew (brew install jq), but it‚Äôs a single portable executable, so it‚Äôs easy to install on Linux, Windows, or macOS. To use it, you construct one or more filters, and it applies those filters to a JSON document.The simplest filter is the identity filter which returns all its input (.):$ echo &#39;{&quot;key1&quot;:{&quot;key2&quot;:&quot;value1&quot;}}&#39; | jq &#39;.&#39;{  &quot;key1&quot;: {    &quot;key2&quot;: &quot;value1&quot;  }}This filter is handy for just pretty-printing a JSON document.3 I‚Äôm going to ignore the pretty-printing and jump right into using jq to transform JSON documents.Using JQ to Select ElementsI‚Äôm going to use jq to filter the data returned by the GitHub repository API. The data I get back by default looks like this:$ curl https://api.github.com/repos/stedolan/jq{  &quot;id&quot;: 5101141,  &quot;node_id&quot;: &quot;MDEwOlJlcG9zaXRvcnk1MTAxMTQx&quot;,  &quot;name&quot;: &quot;jq&quot;,  &quot;full_name&quot;: &quot;stedolan/jq&quot;,  &quot;private&quot;: false,  &quot;owner&quot;: {    &quot;login&quot;: &quot;stedolan&quot;,    &quot;id&quot;: 79765  },  &quot;html_url&quot;: &quot;https://github.com/stedolan/jq&quot;,  &quot;description&quot;: &quot;Command-line JSON processor&quot;,  &quot;stargazers_count&quot;: 19967,  &quot;watchers_count&quot;: 19967,  &quot;language&quot;: &quot;C&quot;,  &quot;license&quot;: {    &quot;key&quot;: &quot;other&quot;,    &quot;name&quot;: &quot;Other&quot;,    &quot;spdx_id&quot;: &quot;NOASSERTION&quot;,    &quot;url&quot;: null,    &quot;node_id&quot;: &quot;MDc6TGljZW5zZTA=&quot;  }}jq lets us treat the JSON document as an object and select elements inside of it.Here is how I filter the JSON document to select the value of the name key:$ curl https://api.github.com/repos/stedolan/jq | jq &#39; .name&#39; &quot;jq&quot;Similarly, for selecting the value of the owner key:$ curl https://api.github.com/repos/stedolan/jq | jq &#39; .owner&#39; {    &quot;login&quot;: &quot;stedolan&quot;,    &quot;id&quot;: 79765}You can drill in as far as you want like this:$ curl https://api.github.com/repos/stedolan/jq | jq &#39; .owner.login&#39; &quot;stedolan&quot;What I Learned: Object Identifier-Indexjq lets you select elements in a JSON document like it‚Äôs a JavaScript object. Just start with . ( for the whole document) and drill down to the value you want. It ends up looking something like this:jq &#39;.key.subkey.subsubkey&#39;Using JQ to Select ArraysIf you curl the GitHub Issues API, you will get back an array of issues:$ curl https://api.github.com/repos/stedolan/jq/issues?per_page=5    [  {    &quot;id&quot;: 966024429,    &quot;number&quot;: 2341,    &quot;title&quot;: &quot;Question about license.&quot;,    &quot;body&quot;: &quot;I would like to create a [winget](https://github.com/microsoft/winget-cli) package for jq. üôèüèª&quot;  },  {      &quot;id&quot;: 962477084,    &quot;number&quot;: 2340,    &quot;title&quot;: &quot;visibility of wiki pages&quot;,    &quot;body&quot;: &quot;The visibility of wiki pages to search engines is generally limited; for example, the search result for \&quot;jq Cookbook\&quot; looks like this:&quot;  },  {       &quot;id&quot;: 955350543,    &quot;number&quot;: 2337,    &quot;title&quot;: &quot;Release 1.6 does not have pre-autoreconf&#39;ed configure script&quot;,    &quot;body&quot;: &quot;If you have a usage question, please ask us on either Stack Overflow (https://stackoverflow.com/questions/tagged/jq) or in the #jq channel (http://irc.lc/freenode/%23jq/) on Freenode (https://webchat.freenode.net/).&quot;  },  {    &quot;id&quot;: 954792209,    &quot;number&quot;: 2336,    &quot;title&quot;: &quot;Fix typo&quot;,    &quot;body&quot;: &quot;&quot;  },  {    &quot;id&quot;: 940627936,    &quot;number&quot;: 2334,    &quot;title&quot;: &quot;Compile error messages don&#39;t provide column only line number&quot;,    &quot;body&quot;: &quot;Compile errors in filter expressions don&#39;t include the column number where the parser approximately or exactly locates the error. Most filter expressions are one-liners (are multiple lines even supported?), so the information that the error is on line 1 is not helpful.&quot;  }]To get a specific element in the array, give jq an index:$ curl https://api.github.com/repos/stedolan/jq/issues?per_page=5 | jq &#39;.[4]&#39;  {    &quot;id&quot;: 940627936,    &quot;number&quot;: 2334,    &quot;title&quot;: &quot;Compile error messages don&#39;t provide column only line number&quot;,    &quot;body&quot;: &quot;Compile errors in filter expressions don&#39;t include the column number where the parser approximately or exactly locates the error. Most filter expressions are one-liners (are multiple lines even supported?), so the information that the error is on line 1 is not helpful.&quot;  }Side Note: Array Indexing in jqArray indexing has some helpful convenience syntax.You can select ranges:$ echo &quot;[1,2,3,4,5]&quot; | jq &#39;.[2:4]&#39;[3,4]You can select one sided ranges:$ echo &quot;[1,2,3,4,5]&quot; | jq &#39;.[2:]&#39;[3,4,5]Also, you can use negatives to select from the end:$ echo &quot;[1,2,3,4,5]&quot; | jq &#39;.[-2:]&#39;[4,5]You can use the array index with the object index:$ curl https://api.github.com/repos/stedolan/jq/issues?per_page=5 | jq &#39;.[4].title&#39; &quot;Compile error messages don&#39;t provide column only line number&quot;And you can use [] to get all the elements in the array. For example, here is how I would get the titles of the issues returned by my API request:$ curl https://api.github.com/repos/stedolan/jq/issues?per_page=5 | jq &#39;.[].title&#39; &quot;Question about license.&quot;&quot;visibility of wiki pages&quot;&quot;Release 1.6 does not have pre-autoreconf&#39;ed configure script&quot;&quot;Fix typo&quot;&quot;Compile error messages don&#39;t provide column only line number&quot;What I Learned: Array-Indexjq lets you select the whole array [], a specific element [3], or ranges [2:5] and combine these with the object index if needed.It ends up looking something like this:jq &#39;.key[].subkey[2]Side Note: Removing Quotes From JQ OutputThe -r option in jq gives you raw strings if you need that.$ echo &#39;[&quot;1&quot;,&quot;2&quot;,&quot;3&quot;]&#39; | jq -r &#39;.[]&#39;123The -j option (for join) can combine together your output.$ echo &#39;[&quot;1&quot;,&quot;2&quot;,&quot;3&quot;]&#39; | jq -j &#39;.[]&#39;123Putting Elements in an Array using jqOnce you start using the array index to select elements, you have a new problem. The data returned won‚Äôt be a valid JSON document. In the example above, the issue titles were new line delimited:&quot;Question about license.&quot;&quot;visibility of wiki pages&quot;&quot;Release 1.6 does not have pre-autoreconf&#39;ed configure script&quot;&quot;Fix typo&quot;&quot;Compile error messages don&#39;t provide column only line number&quot;...In fact, whenever you ask jq to return an unwrapped collection of elements, it prints them each on a new line. You can see this by explicitly asking jq to ignore its input and instead return two numbers:$ echo &#39;&quot;&quot;&#39; | jq &#39;1,2&#39; 12You can resolve this the same way you would turn the text 1,2 into an array in JavaScript: By wrapping it in an array constructor [ ‚Ä¶ ].$ echo &#39;&quot;&quot;&#39; | jq &#39;[1,2]&#39; [  1,  2]Similarly, to put a generated collection of results into a JSON array, you wrap it in an array constructor [ ‚Ä¶ ].My GitHub issue title filter (.[].title) then becomes [ .[].title ] like this:$ curl https://api.github.com/repos/stedolan/jq/issues?per_page=5 | \  jq &#39;[ .[].title ] &#39; [  &quot;Question about license.&quot;,  &quot;visibility of wiki pages&quot;,  &quot;Release 1.6 does not have pre-autoreconf&#39;ed configure script&quot;,  &quot;Fix typo&quot;,  &quot;Compile error messages don&#39;t provide column only line number&quot;]Now I have a valid JSON document.What I Learned: Array ConstructorsIf your jq query returns more than one element, they will be returned newline delimited.$ echo &#39;[{&quot;a&quot;:&quot;b&quot;},{&quot;a&quot;:&quot;c&quot;}]&#39; | jq -r &#39;.[].a&#39;  &quot;b&quot;  &quot;c&quot;To turn these values into a JSON array, what you do is similar to creating an array in JavaScript: You wrap the values in an array constructor ([‚Ä¶]).It ends up looking something like this:$ echo &#39;[{&quot;a&quot;:&quot;b&quot;},{&quot;a&quot;:&quot;c&quot;}]&#39; | jq -r &#39;[ .[].a ]&#39;[  &quot;b&quot;,  &quot;c&quot;]Using jq to Select Multiple FieldsThe GitHub issues API has a lot of details I don‚Äôt care about. I want to select multiple fields from the returned JSON document and leave the rest behind.The easiest way to do this is using , to specify multiple filters:$ curl https://api.github.com/repos/stedolan/jq/issues?per_page=2 | \   jq &#39; .[].title, .[].number&#39;&quot;Question about license.&quot;&quot;visibility of wiki pages&quot;23412340But this is returning the results of one selection after the other. To change the ordering, I can factor out the array selector:$ curl https://api.github.com/repos/stedolan/jq/issues?per_page=2 | \  jq &#39;.[] |  .title, .number&#39;&quot;Question about license.&quot;2341&quot;visibility of wiki pages&quot;2340This refactoring uses a pipe (|), which I‚Äôll talk about shortly, and runs my object selectors (.title and .number) on each array element.If you wrap the query in the array constructor you get this:$ curl https://api.github.com/repos/stedolan/jq/issues?per_page=2 | \  jq &#39;[ .[] |  .title, .number ]&#39;[  &quot;Question about license.&quot;,  2341,  &quot;visibility of wiki pages&quot;,  2340]But this still isn‚Äôt the JSON document I need. To get these values into a proper JSON object, I need an object constructor { ‚Ä¶ }.Putting Elements Into an Object Using jqLet‚Äôs look at some simple examples before showing how my GitHub query can use an object constructor.A Little ExampleI have an array that contains my name ([‚ÄúAdam‚Äù,‚ÄúGordon‚Äù,‚ÄúBell‚Äù]), and I want to turn it into a JSON object like this:{  &quot;first_name&quot;:&quot;Adam&quot;,  &quot;last_name&quot;:&quot;Bell&quot;}I can select the elements I need using array indexing like this:$ echo &#39;[&quot;Adam&quot;,&quot;Gordon&quot;,&quot;Bell&quot;]&#39; | jq -r &#39;.[0], .[2]&#39;AdamBellTo wrap those values into the shape I need, I can replace the values with the array indexes that return them:{  &quot;first_name&quot;:.[0],  &quot;last_name&quot;:.[2]}Or on a single line like this:$ echo &#39;[&quot;Adam&quot;,&quot;Gordon&quot;,&quot;Bell&quot;]&#39; | jq -r &#39;{ &quot;first_name&quot;:.[0], &quot;last_name&quot;: .[2]}&#39;{  &quot;first_name&quot;: &quot;Adam&quot;,  &quot;last_name&quot;: &quot;Bell&quot;}This syntax is the same syntax for creating an object in a JSON document. The only difference is you can use the object and array queries you‚Äôve built up as the values.Back to GitHubReturning to my GitHub API problem, to wrap the number and the title up into an array I use the object constructor like this:$ curl https://api.github.com/repos/stedolan/jq/issues?per_page=2 | \  jq &#39;[ .[] | { title: .title, number: .number} ]&#39;[  {    &quot;title&quot;: &quot;Question about license.&quot;,    &quot;number&quot;: 2341  },  {    &quot;title&quot;: &quot;visibility of wiki pages&quot;,    &quot;number&quot;: 2340  }]What I Learned: Object ConstructorsTo put the elements you‚Äôve selected back into a JSON document, you can wrap them in an object constructor { ‚Ä¶ }.If you were building up a JSON object out of several selectors, it would end up looking something like this:jq &#39;{ &quot;key1&quot;: &lt;&lt;jq filter&gt;&gt;, &quot;key2&quot;: &lt;&lt;jq filter&gt;&gt; }&#39;Which is the same syntax for an object in a JSON document, except with jq you can use filters as values.4Sorting and Counting With JQThe next problem I have is that I want to summarize some this JSON data. Each issue returned by GitHub has a collection of labels:$ curl https://api.github.com/repos/stedolan/jq/issues/2289 | \     jq &#39; { title: .title, number: .number, labels: .labels} &#39;  {    &quot;title&quot;: &quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&quot;,    &quot;number&quot;: 2289,    &quot;labels&quot;: [      &quot;feature request&quot;,      &quot;dependencies&quot;    ]  }jq Built-in FunctionsIf I want those labels in alphabetical order I can use the built in sort function. It works like this:$  echo &#39;[&quot;3&quot;,&quot;2&quot;,&quot;1&quot;]&#39; | jq &#39;sort&#39;[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;]This is similar to how I would sort an array in JavaScript:const l = [&quot;3&quot;,&quot;2&quot;,&quot;1&quot;];l.sort();Other built-ins that mirror JavaScript functionality are available, like length, reverse, and tostring and they can all be used in a similar way:$  echo &#39;[&quot;3&quot;,&quot;2&quot;,&quot;1&quot;]&#39; | jq &#39;reverse&#39;[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;]$  echo &#39;[&quot;3&quot;,&quot;2&quot;,&quot;1&quot;]&#39; | jq &#39;length&#39;3If I can combine these built-ins with the selectors I‚Äôve built up so far, I‚Äôll have solved my label sorting problem. So I‚Äôll show that next.What I Learned: jq built-insjq has many built-in functions. There are probably too many to remember but the built-ins tend to mirror JavaScript functions, so give those a try before heading to jq manual , and you might get lucky.5Pipes and FiltersBefore I can use sort to sort the labels from my GitHub API request, I need to explain how pipes and filters work in jq.jq is a filter in the UNIX command line sense. You pipe (|) a JSON document to it, and it filters it and outputs it to standard out. We could easily use this feature to chain together jq invocations like this:echo &#39;{&quot;title&quot;:&quot;JQ Select&quot;}&#39; | jq &#39;.title&#39; | jq &#39;length&#39;9This is a wordy, though simple, way to determine the length of a string in a JSON document. We can use this same idea to combine various jq built-in functions with the features we have seen so far. But there is an easier way. You can use pipes inside of jq. Conceptually they work just like shell pipes:echo &#39;{&quot;title&quot;:&quot;JQ Select&quot;}&#39; | jq &#39;.title | length&#39;9Here are some more examples:.title | length will return the length of the title.number | tostring will return our issue number as a string.[] | .key will return the values of key key in the array (this is equivalent to this .[].key)This means that sorting my labels array is simple. I can just change .labels to .labels | sort:$ curl https://api.github.com/repos/stedolan/jq/issues/2289 | \  jq &#39; { title: .title, number: .number, labels: .labels | sort } &#39;      {    &quot;title&quot;: &quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&quot;,    &quot;number&quot;: 2289,    &quot;labels&quot;: [      &quot;dependencies&quot;,      &quot;feature request&quot;    ]  }And if you want just a label count that is easy as well:$ curl https://api.github.com/repos/stedolan/jq/issues/2289 | \  jq &#39; { title: .title, number: .number, labels: .labels | length } &#39;      {    &quot;title&quot;: &quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&quot;,    &quot;number&quot;: 2289,    &quot;labels&quot;: 2  }What I Learned: Pipes and FiltersEverything in jq is a filter that you can combine with pipes (|). This mimics the behavior of a UNIX shell.You can use the pipes and the jq built-ins to build complicated transformations from simple operations.It ends up looking something like this:jq &#39; .key1.subkey2[] | sort &#39; # sortingjq &#39; .key2.subkey | length&#39; # length of string or arrayjq &#39; .key3 | floor | tostring | length&#39; # and so onMaps and Selects Using JQThe issues list I was looking at has many low-quality issues in it.6 Let‚Äôs say I want to grab all the items that are labeled. This would let me skip all the drive-by fix-my-problem issues.Unfortunately, it‚Äôs impossible to do this with the GitHub API unless you specify all the possible labels in your query. However, I can easily do this query on the command line by filtering our results with jq. However, to do so, I‚Äôm going to need a couple more jq functions.Our query so far looks like this:  jq &#39;[ .[] | { title: .title, number: .number, labels: .labels | length } ]&#39;The first thing we can do is simplify it using map.  jq &#39;map({ title: .title, number: .number, labels: .labels | length }) map(‚Ä¶) let‚Äôs you unwrap an array, apply a filter and then rewrap the results back into an array. You can think of it as a shorthand for [ .[] | ‚Ä¶ ] and it comes up quite a bit in my experience, so it‚Äôs worth it committing to memory.We can combine that with a select statement that looks like this:map(select(.labels &gt; 0))select is a built-in function that takes a boolean expression and only returns elements that match. It‚Äôs similar to the WHERE clause in a SQL statement or array filter in JavaScript.Like map, I find select comes up quite a bit, so while you may have to come back to this article or google it the first few times you need it, with luck, it will start to stick to your memory after that.Putting this all together looks like this:curl https://api.github.com/repos/stedolan/jq/issues?per_page=100 | \   jq &#39;map({ title: .title, number: .number, labels: .labels | length }) |    map(select(.labels &gt; 0))&#39;[  {    &quot;title&quot;: &quot;Bump lxml from 4.3.1 to 4.6.3 in /docs&quot;,    &quot;number&quot;: 2295,    &quot;labels&quot;: 1  },  {    &quot;title&quot;: &quot;Bump pyyaml from 3.13 to 5.4 in /docs&quot;,    &quot;number&quot;: 2291,    &quot;labels&quot;: 1  },  {    &quot;title&quot;: &quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&quot;,    &quot;number&quot;: 2289,    &quot;labels&quot;: 1  },  {    &quot;title&quot;: &quot;Debugging help through showing pipeline intermediates. &quot;,    &quot;number&quot;: 2206,    &quot;labels&quot;: 1  }]This uses three object indexes, two maps, two pipes, a length function, and a select predicate. But if you‚Äôve followed along, this should all make sense. It‚Äôs all just composing together filters until you get the result you need.Now lets talk about how we can put this knowledge into practice.In ReviewWhat I LearnedHere is what I‚Äôve learned so far:jq lets you select elements by starting with a . and accessing keys and arrays like it‚Äôs a JavaScript Object (which is it is). This feature uses the Object and Array index jq creates of a JSON document and look like this:jq &#39;.key[0].subkey[2:3].subsubkey&#39;jq programs can contain object constructors { ‚Ä¶ } and array constructors [ ‚Ä¶ ]. You use these when you want to wrap back up something you‚Äôve pulled out of a JSON document using the above indexes:jq &#39;[ { key1: .key1, key2: .key2 }  ]&#39;jq contains built-in functions (length,sort,select,map) and pipes (|), and you can compose these together just like you can combine pipes and filters at the command line:  jq &#39;map({ order-of-magitude: .items | length | tostring | length }) Next Steps for Mastering jqReading about (or writing about) a tool is not enough to master it. Action is needed. Here is my process for cementing this knowledge:Complete the jq Tutorialjq-tutorial is not a tutorial at all, but a collection of around 20 interactive exercises that test you knowledge of jq. I‚Äôve found it extremely helpful.Try Using Your Memory FirstWhenever I need to extract data or transform a JSON document, I try to do it first without looking anything up. If memory fails me, sometimes jqterm, which has auto-completion, is helpful. Often, I still need to look something up, but science has shown that repeated retrieval yields retention. So over time, my retention should improve.Use ItIf you don‚Äôt use a tool, you will never master it. So when I have a task that can be solved using jq, then it is what I use. At least for the next little while, even if there is an easier way to do it. Whether it‚Äôs exploring a REST API or looking at docker inspect results, JSON is everywhere, so opportunities abound.Learn MoreLastly, to deepen my knowledge, I‚Äôm learning about recursive descent, declaring variables, and defining functions and advanced features found in the manual. Of course, these things rarely come up, but after writing all this, I‚Äôm hooked on this tool.Doing all this isn‚Äôt necessary, but if you follow me in some of these steps, I think using jq will become second nature.ConclusionSo far I‚Äôve only covered the basics of jq. The jq query language is a full programming language and you can do lots of exciting things with it. You convert from JSON to CSV. You can define you own functions and even find primes with jq:# Denoting the input by $n, which is assumed to be a positive integer,# eratosthenes/0 produces an array of primes less than or equal to $n:def eratosthenes:  (. + 1) as $n  | (($n|sqrt) / 2) as $s  | [null, null, range(2; $n)]  | reduce (2, 1 + (2 * range(1; $s))) as $i (.; erase($i))  | map(select(.));However, simple stuff ‚Äì like selecting elements, filtering by key, or value ‚Äì is often all you need.I hope this helps make jq more approachable and that you no longer have to go to google every time you want to query a JSON document7.While you‚Äôre here:Earthly is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today.alias gwip=‚Äògit commit -a -m ‚Äúwork in progress - fixup‚Äù‚Äô I use this alias all the time and it gives me confidence that I can always get back to my last good state. I almost never end up reverting though, and the commits all get fixuped away, so I think it‚Äôs more useful psychologically than anything else.‚Ü©Ô∏éA note for the pedants: automated behavior is stored in your basal ganglia. It feels like it‚Äôs in my fingers, but really, these actions just fired at a level below my awareness.‚Ü©Ô∏éBy default, jq pretty-prints all its output. This means that its output is not character-for-character identical to its input.‚Ü©Ô∏éIt‚Äôs possible to use jq filters as keys in the Object constructor as well, but that is outside the scope of this guide.‚Ü©Ô∏éYou also aren‚Äôt limited by the built-ins. You can write your own functions as well.‚Ü©Ô∏éPeople can‚Äôt figure out how to do something with jq and open an issue. Please don‚Äôt do this. GitHub issues aren‚Äôt the place to post your random struggles with understanding a tool.‚Ü©Ô∏éA lot of the credit for the strength of this jq summary goes to Michael Lynch who is writing a book about writing and provided me extensive feedback on an earlier draft of this article.‚Ü©Ô∏é">
    <meta itemprop="datePublished" content="2021-08-24T00:00:00-04:00">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">An Introduction to JQ
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          17 minute read
        
        
        &nbsp;	&nbsp;<i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-08-24T00:00:00-04:00">August 24, 2021</time>
        

      </span>
    
    <span>
      
      
      
      <div class="author__avatar_top">
          <picture class="image-author"><source srcset="/blog/generated/assets/images/authors/adamgordonbell-240-fc29677ee.webp 240w" type="image/webp"><source srcset="/blog/generated/assets/images/authors/adamgordonbell-240-ad4309f1a.png 240w" type="image/png"><img src="/blog/generated/assets/images/authors/adamgordonbell-240-ad4309f1a.png" alt="Adam Gordon Bell %"></picture>

          &nbsp;	&nbsp;
          Adam Gordon Bell
      </div>
      
    </span>
  </p>


        </header>
      
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#background-fingers-head-and-google">Background: Fingers, Head, and Google</a></li><li><a href="#what-is-jq">What Is JQ</a></li><li><a href="#using-jq-to-select-elements">Using JQ to Select Elements</a></li><li><a href="#using-jq-to-select-arrays">Using JQ to Select Arrays</a></li><li><a href="#putting-elements-in-an-array-using-jq">Putting Elements in an Array using jq</a></li><li><a href="#using-jq-to-select-multiple-fields">Using jq to Select Multiple Fields</a></li><li><a href="#putting-elements-into-an-object-using-jq">Putting Elements Into an Object Using jq</a><ul><li><a href="#a-little-example">A Little Example</a></li><li><a href="#back-to-github">Back to GitHub</a></li></ul></li><li><a href="#sorting-and-counting-with-jq">Sorting and Counting With JQ</a><ul><li><a href="#jq-built-in-functions">jq Built-in Functions</a></li><li><a href="#pipes-and-filters">Pipes and Filters</a></li></ul></li><li><a href="#maps-and-selects-using-jq">Maps and Selects Using JQ</a></li><li><a href="#in-review">In Review</a><ul><li><a href="#next-steps-for-mastering-jq">Next Steps for Mastering jq</a><ul><li><a href="#complete-the-jq-tutorial">1. Complete the jq Tutorial</a></li><li><a href="#try-using-your-memory-first">2. Try Using Your Memory First</a></li><li><a href="#use-it">3. Use It</a></li><li><a href="#learn-more">4. Learn More</a></li></ul></li></ul></li><li><a href="#conclusion">Conclusion</a></li></ul>

            </nav>
          </aside>
        
        <!-- Code blocks have seperate results so need $ at beginning -->
<!-- markdownlint-disable MD014 -->
<h2 id="background-fingers-head-and-google">Background: Fingers, Head, and Google</h2>
<p>Whenever I reach a stopping point in my work, I use a bash alias called <code>gwip</code><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> to create a ‚Äòwork in progress‚Äô commit. It happens without conscious thinking on my part. The same way my fingers know the vim key bindings, they know <code>gwip</code>.</p>
<p>Other actions, I know how they work, but I have to think about them every time. They are in my head, not my fingers.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>However, some things never stick in my head, nor my fingers, and I have to google them every time. <strong><code>jq</code> is one of these.</strong></p>
<p>I know it‚Äôs a powerful tool, but I always end up back at Google and then coping and pasting a solution from somewhere. So I solve my problem but never learn the tool.</p>
<p>It‚Äôs time to fix that. <strong>In this article, I‚Äôm going to go over the basics building blocks of <code>jq</code> in enough depth that you will be able to understand how jq works.</strong> Of course, you still might occasionally need to head to google to find a function name or check your syntax, but at least you‚Äôll have a firm grounding in the basics.</p>
<h2 id="what-is-jq">What Is JQ</h2>
<p><code>jq</code> is a lightweight, command-line JSON processor. I install it with brew (<code>brew install jq</code>), but it‚Äôs a single portable executable, so it‚Äôs easy to install on Linux, Windows, or macOS. To use it, you construct one or more filters, and it applies those filters to a JSON document.</p>
<p>The simplest filter is the identity filter which returns all its input (<code>.</code>):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">&#39;{&quot;key1&quot;:{&quot;key2&quot;:&quot;value1&quot;}}&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;.&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;key1&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;key2&quot;</span><span class="fu">:</span> <span class="st">&quot;value1&quot;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>This filter is handy for just pretty-printing a JSON document.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> I‚Äôm going to ignore the pretty-printing and jump right into using <code>jq</code> to transform JSON documents.</p>
<h2 id="using-jq-to-select-elements">Using JQ to Select Elements</h2>
<p>I‚Äôm going to use <code>jq</code> to filter the data returned by the GitHub repository API. The data I get back by default looks like this:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> curl https://api.github.com/repos/stedolan/jq</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="dv">5101141</span><span class="fu">,</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;node_id&quot;</span><span class="fu">:</span> <span class="st">&quot;MDEwOlJlcG9zaXRvcnk1MTAxMTQx&quot;</span><span class="fu">,</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;jq&quot;</span><span class="fu">,</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;full_name&quot;</span><span class="fu">:</span> <span class="st">&quot;stedolan/jq&quot;</span><span class="fu">,</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;private&quot;</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;owner&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;login&quot;</span><span class="fu">:</span> <span class="st">&quot;stedolan&quot;</span><span class="fu">,</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="dv">79765</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;html_url&quot;</span><span class="fu">:</span> <span class="st">&quot;https://github.com/stedolan/jq&quot;</span><span class="fu">,</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;Command-line JSON processor&quot;</span><span class="fu">,</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;stargazers_count&quot;</span><span class="fu">:</span> <span class="dv">19967</span><span class="fu">,</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;watchers_count&quot;</span><span class="fu">:</span> <span class="dv">19967</span><span class="fu">,</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;language&quot;</span><span class="fu">:</span> <span class="st">&quot;C&quot;</span><span class="fu">,</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;license&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;key&quot;</span><span class="fu">:</span> <span class="st">&quot;other&quot;</span><span class="fu">,</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Other&quot;</span><span class="fu">,</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;spdx_id&quot;</span><span class="fu">:</span> <span class="st">&quot;NOASSERTION&quot;</span><span class="fu">,</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;url&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;node_id&quot;</span><span class="fu">:</span> <span class="st">&quot;MDc6TGljZW5zZTA=&quot;</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<!-- <div class="notice--info">
**Side Note: Omitting Details**

The JSON documents returned by the GitHub API are too large to show inline in a blog post. Therefore, for ease of explanation, I will omit non-relevant details.
</div> -->
<p><code>jq</code> lets us treat the JSON document as an object and select elements inside of it.</p>
<p>Here is how I filter the JSON document to select the value of the <code>name</code> key:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> curl https://api.github.com/repos/stedolan/jq <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39; .name&#39;</span> </span></code></pre></div>
<pre><code>&quot;jq&quot;</code></pre>
<figcaption>
</figcaption>
<p>Similarly, for selecting the value of the <code>owner</code> key:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> curl https://api.github.com/repos/stedolan/jq <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39; .owner&#39;</span> </span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;login&quot;</span><span class="fu">:</span> <span class="st">&quot;stedolan&quot;</span><span class="fu">,</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="dv">79765</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>You can drill in as far as you want like this:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> curl https://api.github.com/repos/stedolan/jq <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39; .owner.login&#39;</span> </span></code></pre></div>
<pre><code>&quot;stedolan&quot;</code></pre>
<div class="notice--big--primary">
<!-- markdownlint-disable MD036 -->
<p><strong>What I Learned: Object Identifier-Index</strong></p>
<p><code>jq</code> lets you select elements in a JSON document like it‚Äôs a JavaScript object. Just start with <code>.</code> ( for the whole document) and drill down to the value you want. It ends up looking something like this:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">jq</span> <span class="st">&#39;.key.subkey.subsubkey&#39;</span></span></code></pre></div>
</div>
<h2 id="using-jq-to-select-arrays">Using JQ to Select Arrays</h2>
<p>If you <code>curl</code> the GitHub Issues API, you will get back an array of issues:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> curl https://api.github.com/repos/stedolan/jq/issues<span class="pp">?</span>per_page=5    </span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ot">[</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="dv">966024429</span><span class="fu">,</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;number&quot;</span><span class="fu">:</span> <span class="dv">2341</span><span class="fu">,</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;Question about license.&quot;</span><span class="fu">,</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;body&quot;</span><span class="fu">:</span> <span class="st">&quot;I would like to create a [winget](https://github.com/microsoft/winget-cli) package for jq. üôèüèª&quot;</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="dv">962477084</span><span class="fu">,</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;number&quot;</span><span class="fu">:</span> <span class="dv">2340</span><span class="fu">,</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;visibility of wiki pages&quot;</span><span class="fu">,</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;body&quot;</span><span class="fu">:</span> <span class="st">&quot;The visibility of wiki pages to search engines is generally limited; for example, the search result for </span><span class="ch">\&quot;</span><span class="st">jq Cookbook</span><span class="ch">\&quot;</span><span class="st"> looks like this:&quot;</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="dv">955350543</span><span class="fu">,</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;number&quot;</span><span class="fu">:</span> <span class="dv">2337</span><span class="fu">,</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;Release 1.6 does not have pre-autoreconf&#39;ed configure script&quot;</span><span class="fu">,</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;body&quot;</span><span class="fu">:</span> <span class="st">&quot;If you have a usage question, please ask us on either Stack Overflow (https://stackoverflow.com/questions/tagged/jq) or in the #jq channel (http://irc.lc/freenode/%23jq/) on Freenode (https://webchat.freenode.net/).&quot;</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="dv">954792209</span><span class="fu">,</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;number&quot;</span><span class="fu">:</span> <span class="dv">2336</span><span class="fu">,</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;Fix typo&quot;</span><span class="fu">,</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;body&quot;</span><span class="fu">:</span> <span class="st">&quot;&quot;</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="dv">940627936</span><span class="fu">,</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;number&quot;</span><span class="fu">:</span> <span class="dv">2334</span><span class="fu">,</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;Compile error messages don&#39;t provide column only line number&quot;</span><span class="fu">,</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;body&quot;</span><span class="fu">:</span> <span class="st">&quot;Compile errors in filter expressions don&#39;t include the column number where the parser approximately or exactly locates the error. Most filter expressions are one-liners (are multiple lines even supported?), so the information that the error is on line 1 is not helpful.&quot;</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="ot">]</span></span></code></pre></div>
<p>To get a specific element in the array, give <code>jq</code> an index:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> curl https://api.github.com/repos/stedolan/jq/issues<span class="pp">?</span>per_page=5 <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;.[4]&#39;</span> </span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">{</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="dv">940627936</span><span class="fu">,</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;number&quot;</span><span class="fu">:</span> <span class="dv">2334</span><span class="fu">,</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;Compile error messages don&#39;t provide column only line number&quot;</span><span class="fu">,</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;body&quot;</span><span class="fu">:</span> <span class="st">&quot;Compile errors in filter expressions don&#39;t include the column number where the parser approximately or exactly locates the error. Most filter expressions are one-liners (are multiple lines even supported?), so the information that the error is on line 1 is not helpful.&quot;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span></code></pre></div>
<div class="notice--info">
<p><strong>Side Note: Array Indexing in <code>jq</code></strong></p>
<p>Array indexing has some helpful convenience syntax.</p>
<p>You can select ranges:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">&quot;[1,2,3,4,5]&quot;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;.[2:4]&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ot">[</span><span class="dv">3</span><span class="ot">,</span><span class="dv">4</span><span class="ot">]</span></span></code></pre></div>
<p>You can select one sided ranges:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">&quot;[1,2,3,4,5]&quot;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;.[2:]&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ot">[</span><span class="dv">3</span><span class="ot">,</span><span class="dv">4</span><span class="ot">,</span><span class="dv">5</span><span class="ot">]</span></span></code></pre></div>
<p>Also, you can use negatives to select from the end:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">&quot;[1,2,3,4,5]&quot;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;.[-2:]&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="ot">[</span><span class="dv">4</span><span class="ot">,</span><span class="dv">5</span><span class="ot">]</span></span></code></pre></div>
</div>
<p>You can use the array index with the object index:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> curl https://api.github.com/repos/stedolan/jq/issues<span class="pp">?</span>per_page=5 <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;.[4].title&#39;</span> </span></code></pre></div>
<pre><code>&quot;Compile error messages don&#39;t provide column only line number&quot;</code></pre>
<p>And you can use <code>[]</code> to get all the elements in the array. For example, here is how I would get the titles of the issues returned by my API request:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> curl https://api.github.com/repos/stedolan/jq/issues<span class="pp">?</span>per_page=5 <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;.[].title&#39;</span> </span></code></pre></div>
<pre><code>&quot;Question about license.&quot;
&quot;visibility of wiki pages&quot;
&quot;Release 1.6 does not have pre-autoreconf&#39;ed configure script&quot;
&quot;Fix typo&quot;
&quot;Compile error messages don&#39;t provide column only line number&quot;</code></pre>
<div class="notice--big--primary">
<p><strong>What I Learned: Array-Index</strong></p>
<p><code>jq</code> lets you select the whole array <code>[]</code>, a specific element <code>[3]</code>, or ranges <code>[2:5]</code> and combine these with the object index if needed.</p>
<p>It ends up looking something like this:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="ex">jq</span> <span class="st">&#39;.key[].subkey[2]</span></span></code></pre></div>
</div>
<div class="notice--info">
<p><strong>Side Note: Removing Quotes From JQ Output</strong></p>
<p>The <code>-r</code> option in <code>jq</code> gives you raw strings if you need that.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">&#39;[&quot;1&quot;,&quot;2&quot;,&quot;3&quot;]&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> <span class="st">&#39;.[]&#39;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="ex">1</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="ex">2</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="ex">3</span></span></code></pre></div>
<p>The <code>-j</code> option (for join) can combine together your output.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">&#39;[&quot;1&quot;,&quot;2&quot;,&quot;3&quot;]&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-j</span> <span class="st">&#39;.[]&#39;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="ex">123</span></span></code></pre></div>
</div>
<h2 id="putting-elements-in-an-array-using-jq">Putting Elements in an Array using <code>jq</code></h2>
<p>Once you start using the array index to select elements, you have a new problem. The data returned won‚Äôt be a valid JSON document. In the example above, the issue titles were new line delimited:</p>
<pre><code>&quot;Question about license.&quot;
&quot;visibility of wiki pages&quot;
&quot;Release 1.6 does not have pre-autoreconf&#39;ed configure script&quot;
&quot;Fix typo&quot;
&quot;Compile error messages don&#39;t provide column only line number&quot;
...</code></pre>
<p>In fact, whenever you ask <code>jq</code> to return an unwrapped collection of elements, it prints them each on a new line. You can see this by explicitly asking <code>jq</code> to ignore its input and instead return two numbers:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">&#39;&quot;&quot;&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;1,2&#39;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="ex">1</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="ex">2</span></span></code></pre></div>
<p>You can resolve this the same way you would turn the text <code>1,2</code> into an array in JavaScript: By wrapping it in an array constructor <code>[ ... ]</code>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">&#39;&quot;&quot;&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;[1,2]&#39;</span> </span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="ot">[</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="ot">,</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="ot">]</span></span></code></pre></div>
<p>Similarly, to put a generated collection of results into a JSON array, you wrap it in an array constructor <code>[ ... ]</code>.</p>
<p>My GitHub issue title filter (<code>.[].title</code>) then becomes <code>[ .[].title ]</code> like this:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> curl https://api.github.com/repos/stedolan/jq/issues<span class="pp">?</span>per_page=5 <span class="kw">|</span> <span class="dt">\</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="ex">jq</span> <span class="st">&#39;[ .[].title ] &#39;</span> </span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="ot">[</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Question about license.&quot;</span><span class="ot">,</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;visibility of wiki pages&quot;</span><span class="ot">,</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Release 1.6 does not have pre-autoreconf&#39;ed configure script&quot;</span><span class="ot">,</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Fix typo&quot;</span><span class="ot">,</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Compile error messages don&#39;t provide column only line number&quot;</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="ot">]</span></span></code></pre></div>
<p>Now I have a valid JSON document.</p>
<div class="notice--big--primary">
<!-- markdownlint-disable MD036 -->
<p><strong>What I Learned: Array Constructors</strong></p>
<p>If your <code>jq</code> query returns more than one element, they will be returned newline delimited.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">&#39;[{&quot;a&quot;:&quot;b&quot;},{&quot;a&quot;:&quot;c&quot;}]&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> <span class="st">&#39;.[].a&#39;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;b&quot;</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;c&quot;</span></span></code></pre></div>
<p>To turn these values into a JSON array, what you do is similar to creating an array in JavaScript: You wrap the values in an array constructor (<code>[...]</code>).</p>
<p>It ends up looking something like this:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">&#39;[{&quot;a&quot;:&quot;b&quot;},{&quot;a&quot;:&quot;c&quot;}]&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> <span class="st">&#39;[ .[].a ]&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="ot">[</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;b&quot;</span><span class="ot">,</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;c&quot;</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="ot">]</span></span></code></pre></div>
</div>
<h2 id="using-jq-to-select-multiple-fields">Using <code>jq</code> to Select Multiple Fields</h2>
<p>The GitHub issues API has a lot of details I don‚Äôt care about. I want to select multiple fields from the returned JSON document and leave the rest behind.</p>
<p>The easiest way to do this is using <code>,</code> to specify multiple filters:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> curl https://api.github.com/repos/stedolan/jq/issues<span class="pp">?</span>per_page=2 <span class="kw">|</span> <span class="ex">\ </span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="ex">jq</span> <span class="st">&#39; .[].title, .[].number&#39;</span></span></code></pre></div>
<pre><code>&quot;Question about license.&quot;
&quot;visibility of wiki pages&quot;
2341
2340</code></pre>
<p>But this is returning the results of one selection after the other. To change the ordering, I can factor out the array selector:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> curl https://api.github.com/repos/stedolan/jq/issues<span class="pp">?</span>per_page=2 <span class="kw">|</span> <span class="dt">\</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="ex">jq</span> <span class="st">&#39;.[] |  .title, .number&#39;</span></span></code></pre></div>
<pre><code>&quot;Question about license.&quot;
2341
&quot;visibility of wiki pages&quot;
2340</code></pre>
<p>This refactoring uses a pipe (|), which I‚Äôll talk about shortly, and runs my object selectors (<code>.title</code> and <code>.number</code>) on each array element.</p>
<p>If you wrap the query in the array constructor you get this:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> curl https://api.github.com/repos/stedolan/jq/issues<span class="pp">?</span>per_page=2 <span class="kw">|</span> <span class="dt">\</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="ex">jq</span> <span class="st">&#39;[ .[] |  .title, .number ]&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="ot">[</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Question about license.&quot;</span><span class="ot">,</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2341</span><span class="ot">,</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;visibility of wiki pages&quot;</span><span class="ot">,</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2340</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="ot">]</span></span></code></pre></div>
<p>But this still isn‚Äôt the JSON document I need. To get these values into a proper JSON object, I need an object constructor <code>{ ... }</code>.</p>
<h2 id="putting-elements-into-an-object-using-jq">Putting Elements Into an Object Using <code>jq</code></h2>
<p>Let‚Äôs look at some simple examples before showing how my GitHub query can use an object constructor.</p>
<h3 id="a-little-example">A Little Example</h3>
<p>I have an array that contains my name (<code>["Adam","Gordon","Bell"]</code>), and I want to turn it into a JSON object like this:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;first_name&quot;</span><span class="fu">:</span><span class="st">&quot;Adam&quot;</span><span class="fu">,</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;last_name&quot;</span><span class="fu">:</span><span class="st">&quot;Bell&quot;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>I can select the elements I need using array indexing like this:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">&#39;[&quot;Adam&quot;,&quot;Gordon&quot;,&quot;Bell&quot;]&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> <span class="st">&#39;.[0], .[2]&#39;</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Adam</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="ex">Bell</span></span></code></pre></div>
<p>To wrap those values into the shape I need, I can replace the values with the array indexes that return them:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;first_name&quot;</span><span class="fu">:</span><span class="er">.</span><span class="ot">[</span><span class="dv">0</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;last_name&quot;</span><span class="fu">:</span><span class="er">.</span><span class="ot">[</span><span class="dv">2</span><span class="ot">]</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>Or on a single line like this:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">&#39;[&quot;Adam&quot;,&quot;Gordon&quot;,&quot;Bell&quot;]&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> <span class="st">&#39;{ &quot;first_name&quot;:.[0], &quot;last_name&quot;: .[2]}&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;first_name&quot;</span><span class="fu">:</span> <span class="st">&quot;Adam&quot;</span><span class="fu">,</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;last_name&quot;</span><span class="fu">:</span> <span class="st">&quot;Bell&quot;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>This syntax is the same syntax for creating an object in a JSON document. The only difference is you can use the object and array queries you‚Äôve built up as the values.</p>
<h3 id="back-to-github">Back to GitHub</h3>
<p>Returning to my GitHub API problem, to wrap the number and the title up into an array I use the object constructor like this:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> curl https://api.github.com/repos/stedolan/jq/issues<span class="pp">?</span>per_page=2 <span class="kw">|</span> <span class="dt">\</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="ex">jq</span> <span class="st">&#39;[ .[] | { title: .title, number: .number} ]&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="ot">[</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;Question about license.&quot;</span><span class="fu">,</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;number&quot;</span><span class="fu">:</span> <span class="dv">2341</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;visibility of wiki pages&quot;</span><span class="fu">,</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;number&quot;</span><span class="fu">:</span> <span class="dv">2340</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="ot">]</span></span></code></pre></div>
<div class="notice--big--primary">
<p><strong>What I Learned: Object Constructors</strong></p>
<p>To put the elements you‚Äôve selected back into a JSON document, you can wrap them in an object constructor <code>{ ... }</code>.</p>
<p>If you were building up a JSON object out of several selectors, it would end up looking something like this:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="ex">jq</span> <span class="st">&#39;{ &quot;key1&quot;: &lt;&lt;jq filter&gt;&gt;, &quot;key2&quot;: &lt;&lt;jq filter&gt;&gt; }&#39;</span></span></code></pre></div>
<p>Which is the same syntax for an object in a JSON document, except with <code>jq</code> you can use filters as values.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
</div>
<h2 id="sorting-and-counting-with-jq">Sorting and Counting With JQ</h2>
<p>The next problem I have is that I want to summarize some this JSON data. Each issue returned by GitHub has a collection of labels:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> curl https://api.github.com/repos/stedolan/jq/issues/2289 <span class="kw">|</span> <span class="ex">\ </span>  </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="ex">jq</span> <span class="st">&#39; { title: .title, number: .number, labels: .labels} &#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&quot;</span><span class="fu">,</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;number&quot;</span><span class="fu">:</span> <span class="dv">2289</span><span class="fu">,</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;labels&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;feature request&quot;</span><span class="ot">,</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;dependencies&quot;</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span></code></pre></div>
<h3 id="jq-built-in-functions"><code>jq</code> Built-in Functions</h3>
<p>If I want those labels in alphabetical order I can use the built in <code>sort</code> function. It works like this:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span>  echo <span class="st">&#39;[&quot;3&quot;,&quot;2&quot;,&quot;1&quot;]&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;sort&#39;</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="ex">[</span><span class="st">&quot;1&quot;</span><span class="ex">,</span> <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>]</span></code></pre></div>
<p>This is similar to how I would sort an array in JavaScript:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> l <span class="op">=</span> [<span class="st">&quot;3&quot;</span><span class="op">,</span><span class="st">&quot;2&quot;</span><span class="op">,</span><span class="st">&quot;1&quot;</span>]<span class="op">;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>l<span class="op">.</span><span class="fu">sort</span>()<span class="op">;</span></span></code></pre></div>
<p>Other built-ins that mirror JavaScript functionality are available, like <code>length</code>, <code>reverse</code>, and <code>tostring</code> and they can all be used in a similar way:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span>  echo <span class="st">&#39;[&quot;3&quot;,&quot;2&quot;,&quot;1&quot;]&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;reverse&#39;</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="ex">[</span><span class="st">&quot;1&quot;</span><span class="ex">,</span> <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>]</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span>  echo <span class="st">&#39;[&quot;3&quot;,&quot;2&quot;,&quot;1&quot;]&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;length&#39;</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="ex">3</span></span></code></pre></div>
<p>If I can combine these built-ins with the selectors I‚Äôve built up so far, I‚Äôll have solved my label sorting problem. So I‚Äôll show that next.</p>
<div class="notice--big--primary">
<p><strong>What I Learned: <code>jq</code> built-ins</strong></p>
<p><code>jq</code> has many built-in functions. There are probably too many to remember but the built-ins tend to mirror JavaScript functions, so give those a try before heading to <a href="https://stedolan.github.io/jq/manual/#Builtinoperatorsandfunctions">jq manual</a> , and you might get lucky.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
</div>
<h3 id="pipes-and-filters">Pipes and Filters</h3>
<p>Before I can use <code>sort</code> to sort the labels from my GitHub API request, I need to explain how pipes and filters work in <code>jq</code>.</p>
<p><code>jq</code> is a filter in the UNIX command line sense. You pipe (<code>|</code>) a JSON document to it, and it filters it and outputs it to standard out. We could easily use this feature to chain together jq invocations like this:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&#39;{&quot;title&quot;:&quot;JQ Select&quot;}&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;.title&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;length&#39;</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="ex">9</span></span></code></pre></div>
<p>This is a wordy, though simple, way to determine the length of a string in a JSON document. We can use this same idea to combine various <code>jq</code> built-in functions with the features we have seen so far. But there is an easier way. You can use pipes inside of <code>jq</code>. Conceptually they work just like shell pipes:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&#39;{&quot;title&quot;:&quot;JQ Select&quot;}&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;.title | length&#39;</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="ex">9</span></span></code></pre></div>
<p>Here are some more examples:</p>
<ul>
<li><code>.title | length</code> will return the length of the title</li>
<li><code>.number | tostring</code> will return our issue number as a string</li>
<li><code>.[] | .key</code> will return the values of key <code>key</code> in the array (this is equivalent to this <code>.[].key</code>)</li>
</ul>
<p>This means that sorting my labels array is simple. I can just change <code>.labels</code> to <code>.labels | sort</code>:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> curl https://api.github.com/repos/stedolan/jq/issues/2289 <span class="kw">|</span> <span class="dt">\</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="ex">jq</span> <span class="st">&#39; { title: .title, number: .number, labels: .labels | sort } &#39;</span>    </span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&quot;</span><span class="fu">,</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;number&quot;</span><span class="fu">:</span> <span class="dv">2289</span><span class="fu">,</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;labels&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;dependencies&quot;</span><span class="ot">,</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;feature request&quot;</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span></code></pre></div>
<p>And if you want just a label count that is easy as well:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> curl https://api.github.com/repos/stedolan/jq/issues/2289 <span class="kw">|</span> <span class="dt">\</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="ex">jq</span> <span class="st">&#39; { title: .title, number: .number, labels: .labels | length } &#39;</span>    </span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&quot;</span><span class="fu">,</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;number&quot;</span><span class="fu">:</span> <span class="dv">2289</span><span class="fu">,</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;labels&quot;</span><span class="fu">:</span> <span class="dv">2</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span></code></pre></div>
<div class="notice--big--primary">
<p><strong>What I Learned: Pipes and Filters</strong></p>
<p>Everything in <code>jq</code> is a filter that you can combine with pipes (<code>|</code>). This mimics the behavior of a UNIX shell.</p>
<p>You can use the pipes and the <code>jq</code> built-ins to build complicated transformations from simple operations.</p>
<p>It ends up looking something like this:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="ex">jq</span> <span class="st">&#39; .key1.subkey2[] | sort &#39;</span> <span class="co"># sorting</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="ex">jq</span> <span class="st">&#39; .key2.subkey | length&#39;</span> <span class="co"># length of string or array</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="ex">jq</span> <span class="st">&#39; .key3 | floor | tostring | length&#39;</span> <span class="co"># and so on</span></span></code></pre></div>
</div>
<h2 id="maps-and-selects-using-jq">Maps and Selects Using JQ</h2>
<p>The issues list I was looking at has many low-quality issues in it.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> Let‚Äôs say I want to grab all the items that are labeled. This would let me skip all the drive-by fix-my-problem issues.</p>
<p>Unfortunately, it‚Äôs impossible to do this with the GitHub API unless you specify all the possible labels in your query. However, I can easily do this query on the command line by filtering our results with <code>jq</code>. However, to do so, I‚Äôm going to need a couple more <code>jq</code> functions.</p>
<p>Our query so far looks like this:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>  <span class="ex">jq</span> <span class="st">&#39;[ .[] | { title: .title, number: .number, labels: .labels | length } ]&#39;</span></span></code></pre></div>
<p>The first thing we can do is simplify it using <code>map</code>.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>  <span class="ex">jq</span> <span class="st">&#39;map({ title: .title, number: .number, labels: .labels | length }) </span></span></code></pre></div>
<p><code>map(...)</code> let‚Äôs you unwrap an array, apply a filter and then rewrap the results back into an array. You can think of it as a shorthand for <code>[ .[] | ...  ]</code> and it comes up quite a bit in my experience, so it‚Äôs worth it committing to memory.</p>
<p>We can combine that with a select statement that looks like this:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="ex">map</span><span class="er">(</span><span class="cf">select</span><span class="kw">(</span><span class="ex">.labels</span> <span class="op">&gt;</span> 0<span class="kw">))</span></span></code></pre></div>
<p><code>select</code> is a built-in function that takes a boolean expression and only returns elements that match. It‚Äôs similar to the <code>WHERE</code> clause in a SQL statement or array filter in JavaScript.</p>
<p>Like <code>map</code>, I find <code>select</code> comes up quite a bit, so while you may have to come back to this article or google it the first few times you need it, with luck, it will start to stick to your memory after that.</p>
<p>Putting this all together looks like this:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> https://api.github.com/repos/stedolan/jq/issues<span class="pp">?</span>per_page=100 <span class="kw">|</span> <span class="dt">\</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>   <span class="ex">jq</span> <span class="st">&#39;map({ title: .title, number: .number, labels: .labels | length }) | </span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="st">   map(select(.labels &gt; 0))&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="ot">[</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;Bump lxml from 4.3.1 to 4.6.3 in /docs&quot;</span><span class="fu">,</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;number&quot;</span><span class="fu">:</span> <span class="dv">2295</span><span class="fu">,</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;labels&quot;</span><span class="fu">:</span> <span class="dv">1</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;Bump pyyaml from 3.13 to 5.4 in /docs&quot;</span><span class="fu">,</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;number&quot;</span><span class="fu">:</span> <span class="dv">2291</span><span class="fu">,</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;labels&quot;</span><span class="fu">:</span> <span class="dv">1</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;Bump jinja2 from 2.10 to 2.11.3 in /docs&quot;</span><span class="fu">,</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;number&quot;</span><span class="fu">:</span> <span class="dv">2289</span><span class="fu">,</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;labels&quot;</span><span class="fu">:</span> <span class="dv">1</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;Debugging help through showing pipeline intermediates. &quot;</span><span class="fu">,</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;number&quot;</span><span class="fu">:</span> <span class="dv">2206</span><span class="fu">,</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;labels&quot;</span><span class="fu">:</span> <span class="dv">1</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a><span class="ot">]</span></span></code></pre></div>
<p>This uses three object indexes, two maps, two pipes, a <code>length</code> function, and a <code>select</code> predicate. But if you‚Äôve followed along, this should all make sense. It‚Äôs all just composing together filters until you get the result you need.</p>
<p>Now lets talk about how we can put this knowledge into practice.</p>
<h2 id="in-review">In Review</h2>
<div class="notice--big--primary">
<p><strong>What I Learned</strong></p>
<p>Here is what I‚Äôve learned so far:</p>
<p><code>jq</code> lets you select elements by starting with a <code>.</code> and accessing keys and arrays like it‚Äôs a JavaScript Object (which is it is). This feature uses the Object and Array index <code>jq</code> creates of a JSON document and look like this:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="ex">jq</span> <span class="st">&#39;.key[0].subkey[2:3].subsubkey&#39;</span></span></code></pre></div>
<p><code>jq</code> programs can contain object constructors <code>{ ... }</code> and array constructors <code>[ ... ]</code>. You use these when you want to wrap back up something you‚Äôve pulled out of a JSON document using the above indexes:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="ex">jq</span> <span class="st">&#39;[ { key1: .key1, key2: .key2 }  ]&#39;</span></span></code></pre></div>
<p><code>jq</code> contains built-in functions (<code>length</code>,<code>sort</code>,<code>select</code>,<code>map</code>) and pipes (<code>|</code>), and you can compose these together just like you can combine pipes and filters at the command line:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>  <span class="ex">jq</span> <span class="st">&#39;map({ order-of-magitude: .items | length | tostring | length }) </span></span></code></pre></div>
</div>
<!-- markdownlint-enable MD036 -->
<h3 id="next-steps-for-mastering-jq">Next Steps for Mastering <code>jq</code></h3>
<p>Reading about (or writing about) a tool is not enough to master it. Action is needed. Here is my process for cementing this knowledge:</p>
<h4 id="complete-the-jq-tutorial">1. Complete the <code>jq</code> Tutorial</h4>
<p><a href="https://github.com/rjz/jq-tutorial">jq-tutorial</a> is not a tutorial at all, but a collection of around 20 interactive exercises that test you knowledge of <code>jq</code>. I‚Äôve found it extremely helpful.</p>
<h4 id="try-using-your-memory-first">2. Try Using Your Memory First</h4>
<p>Whenever I need to extract data or transform a JSON document, I try to do it first without looking anything up. If memory fails me, sometimes <a href="https://jqterm.com/">jqterm</a>, which has auto-completion, is helpful. Often, I still need to look something up, but science has shown that <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3983480/">repeated retrieval yields retention</a>. So over time, my retention should improve.</p>
<h4 id="use-it">3. Use It</h4>
<p>If you don‚Äôt use a tool, you will never master it. So when I have a task that can be solved using <code>jq</code>, then it is what I use. At least for the next little while, even if there is an easier way to do it. Whether it‚Äôs exploring a REST API or looking at <code>docker inspect</code> results, JSON is everywhere, so opportunities abound.</p>
<h4 id="learn-more">4. Learn More</h4>
<p>Lastly, to deepen my knowledge, I‚Äôm learning about recursive descent, declaring variables, and defining functions and advanced features found in the <a href="https://stedolan.github.io/jq/manual/#Advancedfeatures">manual</a>. Of course, these things rarely come up, but after writing all this, I‚Äôm hooked on this tool.</p>
<p>Doing all this isn‚Äôt necessary, but if you follow me in some of these steps, I think using <code>jq</code> will become second nature.</p>
<h2 id="conclusion">Conclusion</h2>
<p>So far I‚Äôve only covered the basics of <code>jq</code>. The <code>jq</code> query language is a full programming language and you can do lots of exciting things with it. You convert from <a href="/blog/convert-to-from-json/#convert-json-to-csv-via-the-command-line-using-jq">JSON to CSV</a>. You can define you own functions and even <a href="https://rosettacode.org/wiki/Sieve_of_Eratosthenes#jq">find primes</a> with <code>jq</code>:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="pp"># Denoting the input by $n, which is assumed to be a positive integer,</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="pp"># eratosthenes/0 produces an array of primes less than or equal to $n:</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>def eratosthenes<span class="op">:</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  (<span class="op">.</span> <span class="op">+</span> <span class="dv">1</span>) as <span class="op">$</span>n</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> ((<span class="op">$</span>n<span class="op">|</span><span class="fu">sqrt</span>) <span class="op">/</span> <span class="dv">2</span>) as <span class="op">$</span>s</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> [<span class="fu">null</span>, <span class="fu">null</span>, <span class="fu">range</span>(<span class="dv">2</span>; <span class="op">$</span>n)]</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> reduce (<span class="dv">2</span>, <span class="dv">1</span> <span class="op">+</span> (<span class="dv">2</span> <span class="op">*</span> <span class="fu">range</span>(<span class="dv">1</span>; <span class="op">$</span>s))) as <span class="op">$</span>i (<span class="op">.</span>; erase(<span class="op">$</span>i))</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> <span class="fu">map</span>(select(<span class="op">.</span>));</span></code></pre></div>
<p>However, simple stuff ‚Äì like selecting elements, filtering by key, or value ‚Äì is often all you need.</p>
<p>I hope this helps make <code>jq</code> more approachable and that you no longer have to go to google every time you want to query a JSON document<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>.</p>
<div class="notice--info notice--big">
<p>
<strong>While you‚Äôre here:</strong>
</p>
<p>
<a href="https://earthly.dev/">Earthly</a> is a syntax for defining your build. It works with your existing build system. Get repeatable and understandable builds today.
</p>
</div>
<!-- markdownlint-enable MD014 -->
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p><code>alias gwip='git commit -a -m "work in progress - fixup"'</code> I use this alias all the time and it gives me confidence that I can always get back to my last good state. I almost never end up reverting though, and the commits all get <code>fixup</code>ed away, so I think it‚Äôs more useful psychologically than anything else.<a href="#fnref1" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn2" role="doc-endnote"><p>A note for the pedants: automated behavior is stored in your basal ganglia. It feels like it‚Äôs in my fingers, but really, these actions just fired at a level below my awareness.<a href="#fnref2" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn3" role="doc-endnote"><p>By default, <code>jq</code> pretty-prints all its output. This means that its output is not character-for-character identical to its input.<a href="#fnref3" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn4" role="doc-endnote"><p>It‚Äôs possible to use jq filters as keys in the Object constructor as well, but that is outside the scope of this guide.<a href="#fnref4" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn5" role="doc-endnote"><p>You also aren‚Äôt limited by the built-ins. You can write your <a href="https://stedolan.github.io/jq/manual/#Advancedfeatures">own functions</a> as well.<a href="#fnref5" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn6" role="doc-endnote"><p>People can‚Äôt figure out how to do something with <code>jq</code> and open an issue. Please don‚Äôt do this. GitHub issues aren‚Äôt the place to post your random struggles with understanding a tool.<a href="#fnref6" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn7" role="doc-endnote"><p>A lot of the credit for the strength of this <code>jq</code> summary goes to <a href="https://refactoringenglish.com/">Michael Lynch</a> who is writing a book about writing and provided me extensive feedback on an earlier draft of this article.<a href="#fnref7" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
</ol>
</section>

        
      </section>

      


<div itemscope itemtype="https://schema.org/Person">
  
    <div class="author__avatar">
      
        <picture class="image-author"><source srcset="/blog/generated/assets/images/authors/adamgordonbell-240-fc29677ee.webp 240w" type="image/webp"><source srcset="/blog/generated/assets/images/authors/adamgordonbell-240-ad4309f1a.png 240w" type="image/png"><img src="/blog/generated/assets/images/authors/adamgordonbell-240-ad4309f1a.png" alt="Adam Gordon Bell %"></picture>

      
    </div>
  
  <div class="author__content">
    
      <div class="author__name heading" itemprop="name">
        Adam Gordon Bell
    
    
      
        
          <a href="https://twitter.com/adamgordonbell" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label"></span></a>
        
      
        
          <a href="mailto:adam+website@earthly.dev" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label"></span></a>
        
      
        
          <a href="https://corecursive.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label"></span></a>
        
      
    
      </div>
    
      <div class="author__bio" itemprop="description">
        <p>Spreading the word about Earthly. Host of CoRecursive podcast. Physical Embodiment of Cunningham‚Äôs Law</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <!-- <button class="btn btn--inverse">Follow</button> -->
    <ul class="author__urls social-icons">
      

     

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

      <footer class="page__meta">
        
        



  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/blog/categories/tutorials" class="page__taxonomy-item" rel="tag">Tutorials</a>
    
    </span>
  </p>




<p class="page__taxonomy">
  <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i>Author:</strong>
  <span itemprop="keywords">
    <a href="/blog/authors/Adam/" class="page__taxonomy-item" rel="tag">Adam Gordon Bell</a>
  </span>
</p>



        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-08-24T00:00:00-04:00">August 24, 2021</time></p>


      </footer>

      

      
  <nav class="pagination">
    
      <a href="/blog/plotting-rainfall-data-with-python-and-matplotlib/" class="pagination--pager" title="Plotting Precipitation with Python, Pandas and Matplotlib
">Previous</a>
    
    
      <a href="/blog/10-continous-delivery/" class="pagination--pager" title="10+ Best Continuous Delivery Tools
">Next</a>
    
  </nav>

    </div>
  </article>

  
  
    <div class="page__related">
      <div class="page__related-title heading">You may also enjoy</div>
      <div class="grid__wrapper">
        
          










<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <picture><source srcset="/blog/generated/assets/images/example/teaser-600-fc9eab451.webp 600w, /blog/generated/assets/images/example/teaser-800-fc9eab451.webp 800w" type="image/webp"><source srcset="/blog/generated/assets/images/example/teaser-600-b449882ef.jpg 600w, /blog/generated/assets/images/example/teaser-800-b449882ef.jpg 800w" type="image/jpeg"><img src="/blog/generated/assets/images/example/teaser-800-b449882ef.jpg"></picture>

      </div>
    
    
    <div class="archive__item-title no_toc heading" itemprop="headline">
    
      
      
        <a href="/blog/example/" rel="permalink">Example Post
</a>
      
    
    </div>
    
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">

This post is in the future, and won‚Äôt show up in the published site


Image without figure


An image with the alt text hidden.





An image with alt text...</p>
  </article>
</div>

        
          










<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <picture><source srcset="/blog/generated/assets/images/10-continous-delivery/header-600-aae60f084.webp 600w, /blog/generated/assets/images/10-continous-delivery/header-800-aae60f084.webp 800w" type="image/webp"><source srcset="/blog/generated/assets/images/10-continous-delivery/header-600-495449b49.jpg 600w, /blog/generated/assets/images/10-continous-delivery/header-800-495449b49.jpg 800w" type="image/jpeg"><img src="/blog/generated/assets/images/10-continous-delivery/header-800-495449b49.jpg"></picture>

      </div>
    
    
    <div class="archive__item-title no_toc heading" itemprop="headline">
    
      
      
        <a href="/blog/10-continous-delivery/" rel="permalink">10+ Best Continuous Delivery Tools
</a>
      
    
    </div>
    
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
Draft.dev Article Checklist



 Add in Author page


 Create header image in Canva


 Optional: Find ways to break up content with quotes or images


 Verif...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/earthlytech" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/earthly/earthly" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
    

    
      <li><a href="/blog/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 <a href="https://earthly.dev/">Earthly</a>. </div>

      </footer>
    </div>

    <script src="/blog/assets/js/vendor/jquery/jquery-3.5.1.js"></script>
<script src="/blog/assets/js/plugins/jquery.fitvids.js"></script>
<script src="/blog/assets/js/plugins/smooth-scroll.js"></script>
<script src="/blog/assets/js/plugins/gumshoe.js"></script>
<script src="/blog/assets/js/plugins/jquery.magnific-popup.js"></script>
<script src="/blog/assets/js/main.min.js"></script>
<script src="/blog/assets/js/externallinks.js"></script>

  <script> // minified version of https://earthly.dev/assets/js/analytics.js
    function setCookie(e,t,r){var i="";if(r){var o=new Date;o.setTime(o.getTime()+24*r*60*60*1e3),i="; expires="+o.toUTCString()}document.cookie=e+"="+(t||"")+i+"; path=/"}function getCookie(e){for(var t=e+"=",r=document.cookie.split(";"),i=0;i<r.length;i++){for(var o=r[i];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null}function uuidv4(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))}function getAnalyticCookie(){cookieName="earthlyID";var e=getCookie(cookieName);return null==e&&(e=uuidv4()),setCookie(cookieName,e,36500),e}jQuery.ajax({type:"POST",url:"https://api.earthly.dev/analytics",data:JSON.stringify({key:"website",url:window.location.href,referrer:document.referrer,earthlyID:getAnalyticCookie()})});
</script>




  </body>
</html>
